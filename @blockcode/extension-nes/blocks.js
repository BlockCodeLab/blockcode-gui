import{Text as c,Spinner as g} from"@blockcode/ui";import{connectDevice as x,downloadDevice as w,showDownloadScreen as D} from"@blockcode/device-pyboard";var p={en:{"extension.nes.name":"NES emulator","extension.nes.download":"Download ROM to Arcade"},"zh-Hans":{"extension.nes.name":"NES \u6A21\u62DF\u5668","extension.nes.download":"\u4E0B\u8F7D ROM \u5230\u6E38\u620F\u673A"}};var f="./assets/icon-16f050497ba2f212.png";import{jsx as t} from"preact/jsx-runtime";var h=[{usbVendorId:12346}],e=(i,l,s)=>{if(!e.id)e.id=`download.${Date.now()}`;if(s<100)i({id:e.id,icon:t(g,{level:"success"}),message:t(c,{id:"blocks.alert.downloading",defaultMessage:"Downloading...{progress}%",progress:s})});else i({id:e.id,icon:null,message:t(c,{id:"blocks.alert.downloadCompleted",defaultMessage:"Download completed."})}),setTimeout(()=>{l(e.id),delete e.id},1000)},b={iconURI:f,name:t(c,{id:"extension.nes.name",defaultMessage:"Broadcast"}),blocks:[{button:"DOWNLOAD_ROM",text:t(c,{id:"extension.nes.download",defaultMessage:"Download ROM to Arcade"}),async onClick({context:i,createAlert:l,removeAlert:s}){if(e.id)return;const{device:M,setDevice:u}=i;let a;try{a=M||await x(h,u)}catch(d){console.log(d)}if(!a)return;const n=document.createElement("input");n.type="file",n.accept=".nes",n.multiple=!0,n.click(),n.addEventListener("change",async({target:d})=>{const r=[];for(let o of d.files)r.push({id:`nes/${o.name}`,content:await o.arrayBuffer()});try{await D(a,"arcade"),w(a,r,(o)=>e(l,s,o))}catch(o){console.log(o)}})}}],translations:p};export{b as default};
