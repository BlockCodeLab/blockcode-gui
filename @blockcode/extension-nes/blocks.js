import{Text as c,Spinner as g} from"@blockcode/ui";import{connectDevice as w,downloadDevice as x,showDownloadScreen as D} from"@blockcode/device-pyboard";var p={en:{"extension.nes.name":"NES emulator","extension.nes.download":"Download ROM to Arcade"},"zh-Hans":{"extension.nes.name":"NES \u6A21\u62DF\u5668","extension.nes.download":"\u4E0B\u8F7D ROM \u5230\u6E38\u620F\u673A"}};var f="./assets/icon-16f050497ba2f212.png";import{jsx as a} from"preact/jsx-runtime";var h=[{usbVendorId:12346}],e=(i,d,s)=>{if(!e.id)e.id=`download.${Date.now()}`;if(s<100)i({id:e.id,icon:a(g,{level:"success"}),message:a(c,{id:"blocks.alert.downloading",defaultMessage:"Downloading...{progress}%",progress:s})});else i({id:e.id,icon:null,message:a(c,{id:"blocks.alert.downloadCompleted",defaultMessage:"Download completed."})}),setTimeout(()=>{d(e.id),delete e.id},1000)},b={iconURI:f,name:a(c,{id:"extension.nes.name",defaultMessage:"Broadcast"}),blocks:[{button:"DOWNLOAD_ROM",text:a(c,{id:"extension.nes.download",defaultMessage:"Download ROM to Arcade"}),async onClick({context:i,createAlert:d,removeAlert:s}){if(e.id)return;const{device:M,setDevice:u}=i;let n;try{n=M||await w(h,u)}catch(l){console.log(l)}if(!n)return;const o=document.createElement("input");o.type="file",o.accept=".nes",o.multiple=!0,o.click(),o.addEventListener("change",async({target:l})=>{const r=[];for(let t of l.files)r.push({id:`nes/${t.name}`,content:await t.arrayBuffer()});try{await D(n,"arcade"),await x(n,r,(t)=>e(d,s,t)),await configDevice(n,{"latest-game":key}),n.hardwareReset()}catch(t){}})}}],translations:p};export{b as default};
