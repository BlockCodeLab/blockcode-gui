var l8=Object.create;var{defineProperty:_8,getPrototypeOf:c8,getOwnPropertyNames:s8}=Object;var n8=Object.prototype.hasOwnProperty;var R8=(M,I,j)=>{j=M!=null?l8(c8(M)):{};const g=I||!M||!M.__esModule?_8(j,"default",{value:M,enumerable:!0}):j;for(let C of s8(M))if(!n8.call(g,C))_8(g,C,{get:()=>M[C],enumerable:!0});return g};var o8=(M,I)=>()=>(I||M((I={exports:{}}).exports,I),I.exports);var L8=(M)=>{return import.meta.require(M)};var E8=o8((z8,a0)=>{/*!
 * Paper.js v0.12.17 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, Jürg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Thu Nov 3 21:15:36 2022 +0100
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 Jürg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */var Y6=function(M,I){M=M||(()=>({}));var{window:j,document:g}=M,C=new function(){var $=/^(statics|enumerable|beans|preserve)$/,Q=[],J=Q.slice,U=Object.create,K=Object.getOwnPropertyDescriptor,Z=Object.defineProperty,H=Q.forEach||function(O,F){for(var V=0,L=this.length;V<L;V++)O.call(F,this[V],V,this)},W=function(O,F){for(var V in this)if(this.hasOwnProperty(V))O.call(F,this[V],V,this)},Y=Object.assign||function(O){for(var F=1,V=arguments.length;F<V;F++){var L=arguments[F];for(var B in L)if(L.hasOwnProperty(B))O[B]=L[B]}return O},X=function(O,F,V){if(O){var L=K(O,"length");(L&&typeof L.value==="number"?H:W).call(O,F,V=V||O)}return V};function A(O,F,V,L,B){var D={};function _(G,S){if(S=S||(S=K(F,G))&&(S.get?S:S.value),typeof S==="string"&&S[0]==="#")S=O[S.substring(1)]||S;var P=typeof S==="function",w=S,k=B||P&&!S.base?S&&S.get?G in O:O[G]:null,x;if(!B||!k){if(P&&k)S.base=k;if(P&&L!==!1&&(x=G.match(/^([gs]et|is)(([A-Z])(.*))$/)))D[x[3].toLowerCase()+x[4]]=x[2];if(!w||P||!w.get||typeof w.get!=="function"||!q.isPlainObject(w))w={value:w,writable:!0};if((K(O,G)||{configurable:!0}).configurable)w.configurable=!0,w.enumerable=V!=null?V:!x;Z(O,G,w)}}if(F){for(var T in F)if(F.hasOwnProperty(T)&&!$.test(T))_(T);for(var T in D){var E=D[T],R=O["set"+E],z=O["get"+E]||R&&O["is"+E];if(z&&(L===!0||z.length===0))_(T,{get:z,set:R})}}return O}function q(){for(var O=0,F=arguments.length;O<F;O++){var V=arguments[O];if(V)Y(this,V)}return this}return A(q,{inject:function(O){if(O){var F=O.statics===!0?O:O.statics,V=O.beans,L=O.preserve;if(F!==O)A(this.prototype,O,O.enumerable,V,L);A(this,F,null,V,L)}for(var B=1,D=arguments.length;B<D;B++)this.inject(arguments[B]);return this},extend:function(){var O=this,F,V;for(var L=0,B,D=arguments.length;L<D&&!(F&&V);L++)B=arguments[L],F=F||B.initialize,V=V||B.prototype;if(F=F||function(){O.apply(this,arguments)},V=F.prototype=V||U(this.prototype),Z(V,"constructor",{value:F,writable:!0,configurable:!0}),A(F,this),arguments.length)this.inject.apply(F,arguments);return F.base=O,F}}).inject({enumerable:!1,initialize:q,set:q,inject:function(){for(var O=0,F=arguments.length;O<F;O++){var V=arguments[O];if(V)A(this,V,V.enumerable,V.beans,V.preserve)}return this},extend:function(){var O=U(this);return O.inject.apply(O,arguments)},each:function(O,F){return X(this,O,F)},clone:function(){return new this.constructor(this)},statics:{set:Y,each:X,create:U,define:Z,describe:K,clone:function(O){return Y(new O.constructor,O)},isPlainObject:function(O){var F=O!=null&&O.constructor;return F&&(F===Object||F===q||F.name==="Object")},pick:function(O,F){return O!==I?O:F},slice:function(O,F,V){return J.call(O,F,V)}}})};if(typeof a0!=="undefined")a0.exports=C;C.inject({enumerable:!1,toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+C.each(this,function($,Q){if(!/^_/.test(Q)){var J=typeof $;this.push(Q+": "+(J==="number"?D0.instance.number($):J==="string"?"'"+$+"'":$))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function($){return C.importJSON($,this)},exportJSON:function($){return C.exportJSON(this,$)},toJSON:function(){return C.serialize(this)},set:function($,Q){if($)C.filter(this,$,Q,this._prioritize);return this}},{beans:!1,statics:{exports:{},extend:function $(){var Q=$.base.apply(this,arguments),J=Q.prototype._class;if(J&&!C.exports[J])C.exports[J]=Q;return Q},equals:function($,Q){if($===Q)return!0;if($&&$.equals)return $.equals(Q);if(Q&&Q.equals)return Q.equals($);if($&&Q&&typeof $==="object"&&typeof Q==="object"){if(Array.isArray($)&&Array.isArray(Q)){var J=$.length;if(J!==Q.length)return!1;while(J--)if(!C.equals($[J],Q[J]))return!1}else{var U=Object.keys($),J=U.length;if(J!==Object.keys(Q).length)return!1;while(J--){var K=U[J];if(!(Q.hasOwnProperty(K)&&C.equals($[K],Q[K])))return!1}}return!0}return!1},read:function($,Q,J,U){if(this===C){var K=this.peek($,Q);return $.__index++,K}var Z=this.prototype,H=Z._readIndex,W=Q||H&&$.__index||0,Y=$.length,X=$[W];if(U=U||Y-W,X instanceof this||J&&J.readNull&&X==null&&U<=1){if(H)$.__index=W+1;return X&&J&&J.clone?X.clone():X}if(X=C.create(Z),H)X.__read=!0;if(X=X.initialize.apply(X,W>0||W+U<Y?C.slice($,W,W+U):$)||X,H){$.__index=W+X.__read;var A=X.__filtered;if(A)$.__filtered=A,X.__filtered=I;X.__read=I}return X},peek:function($,Q){return $[$.__index=Q||$.__index||0]},remain:function($){return $.length-($.__index||0)},readList:function($,Q,J,U){var K=[],Z,H=Q||0,W=U?H+U:$.length;for(var Y=H;Y<W;Y++)K.push(Array.isArray(Z=$[Y])?this.read(Z,0,J):this.read($,Y,J,1));return K},readNamed:function($,Q,J,U,K){var Z=this.getNamed($,Q),H=Z!==I;if(H){var W=$.__filtered;if(!W){var Y=this.getSource($);W=$.__filtered=C.create(Y),W.__unfiltered=Y}W[Q]=I}return this.read(H?[Z]:$,J,U,K)},readSupported:function($,Q){var J=this.getSource($),U=this,K=!1;if(J)Object.keys(J).forEach(function(Z){if(Z in Q){var H=U.readNamed($,Z);if(H!==I)Q[Z]=H;K=!0}});return K},getSource:function($){var Q=$.__source;if(Q===I){var J=$.length===1&&$[0];Q=$.__source=J&&C.isPlainObject(J)?J:null}return Q},getNamed:function($,Q){var J=this.getSource($);if(J)return Q?J[Q]:$.__filtered||J},hasNamed:function($,Q){return!!this.getNamed($,Q)},filter:function($,Q,J,U){var K;function Z(A){if(!(J&&(A in J))&&!(K&&(A in K))){var q=Q[A];if(q!==I)$[A]=q}}if(U){var H={};for(var W=0,Y,X=U.length;W<X;W++)if((Y=U[W])in Q)Z(Y),H[Y]=!0;K=H}return Object.keys(Q.__unfiltered||Q).forEach(Z),$},isPlainValue:function($,Q){return C.isPlainObject($)||Array.isArray($)||Q&&typeof $==="string"},serialize:function($,Q,J,U){Q=Q||{};var K=!U,Z;if(K)Q.formatter=new D0(Q.precision),U={length:0,definitions:{},references:{},add:function(q,O){var F="#"+q._id,V=this.references[F];if(!V){this.length++;var L=O.call(q),B=q._class;if(B&&L[0]!==B)L.unshift(B);this.definitions[F]=L,V=this.references[F]=[F]}return V}};if($&&$._serialize){Z=$._serialize(Q,U);var H=$._class;if(H&&!$._compactSerialize&&(K||!J)&&Z[0]!==H)Z.unshift(H)}else if(Array.isArray($)){Z=[];for(var W=0,Y=$.length;W<Y;W++)Z[W]=C.serialize($[W],Q,J,U)}else if(C.isPlainObject($)){Z={};var X=Object.keys($);for(var W=0,Y=X.length;W<Y;W++){var A=X[W];Z[A]=C.serialize($[A],Q,J,U)}}else if(typeof $==="number")Z=Q.formatter.number($,Q.precision);else Z=$;return K&&U.length>0?[["dictionary",U.definitions],Z]:Z},deserialize:function($,Q,J,U,K){var Z=$,H=!J,W=H&&$&&$.length&&$[0][0]==="dictionary";if(J=J||{},Array.isArray($)){var Y=$[0],X=Y==="dictionary";if($.length==1&&/^#/.test(Y))return J.dictionary[Y];Y=C.exports[Y],Z=[];for(var A=Y?1:0,q=$.length;A<q;A++)Z.push(C.deserialize($[A],Q,J,X,W));if(Y){var O=Z;if(Q)Z=Q(Y,O,H||K);else Z=new Y(O)}}else if(C.isPlainObject($)){if(Z={},U)J.dictionary=Z;for(var F in $)Z[F]=C.deserialize($[F],Q,J)}return W?Z[1]:Z},exportJSON:function($,Q){var J=C.serialize($,Q);return Q&&Q.asString==!1?J:JSON.stringify(J)},importJSON:function($,Q){return C.deserialize(typeof $==="string"?JSON.parse($):$,function(J,U,K){var Z=K&&Q&&Q.constructor===J,H=Z?Q:C.create(J.prototype);if(U.length===1&&H instanceof Q0&&(Z||!(H instanceof t0))){var W=U[0];if(C.isPlainObject(W)){if(W.insert=!1,Z)U=U.concat([Q0.INSERT])}}if((Z?H.set:J).apply(H,U),Z)Q=null;return H})},push:function($,Q){var J=Q.length;if(J<4096)$.push.apply($,Q);else{var U=$.length;$.length+=J;for(var K=0;K<J;K++)$[U+K]=Q[K]}return $},splice:function($,Q,J,U){var K=Q&&Q.length,Z=J===I;if(J=Z?$.length:J,J>$.length)J=$.length;for(var H=0;H<K;H++)Q[H]._index=J+H;if(Z)return C.push($,Q),[];else{var W=[J,U];if(Q)C.push(W,Q);var Y=$.splice.apply($,W);for(var H=0,X=Y.length;H<X;H++)Y[H]._index=I;for(var H=J+K,X=$.length;H<X;H++)$[H]._index=H;return Y}},capitalize:function($){return $.replace(/\b[a-z]/g,function(Q){return Q.toUpperCase()})},camelize:function($){return $.replace(/-(.)/g,function(Q,J){return J.toUpperCase()})},hyphenate:function($){return $.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var a={on:function($,Q){if(typeof $!=="string")C.each($,function(Z,H){this.on(H,Z)},this);else{var J=this._eventTypes,U=J&&J[$],K=this._callbacks=this._callbacks||{};if(K=K[$]=K[$]||[],K.indexOf(Q)===-1){if(K.push(Q),U&&U.install&&K.length===1)U.install.call(this,$)}}return this},off:function($,Q){if(typeof $!=="string"){C.each($,function(H,W){this.off(W,H)},this);return}var J=this._eventTypes,U=J&&J[$],K=this._callbacks&&this._callbacks[$],Z;if(K){if(!Q||(Z=K.indexOf(Q))!==-1&&K.length===1){if(U&&U.uninstall)U.uninstall.call(this,$);delete this._callbacks[$]}else if(Z!==-1)K.splice(Z,1)}return this},once:function($,Q){return this.on($,function J(){Q.apply(this,arguments),this.off($,J)})},emit:function($,Q){var J=this._callbacks&&this._callbacks[$];if(!J)return!1;var U=C.slice(arguments,1),K=Q&&Q.target&&!Q.currentTarget;if(J=J.slice(),K)Q.currentTarget=this;for(var Z=0,H=J.length;Z<H;Z++)if(J[Z].apply(this,U)==!1){if(Q&&Q.stop)Q.stop();break}if(K)delete Q.currentTarget;return!0},responds:function($){return!!(this._callbacks&&this._callbacks[$])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function($){var Q=this._eventTypes,J=this._callbacks,U=$?"install":"uninstall";if(Q){for(var K in J)if(J[K].length>0){var Z=Q[K],H=Z&&Z[U];if(H)H.call(this,K)}}},statics:{inject:function $(Q){var J=Q._events;if(J){var U={};C.each(J,function(K,Z){var H=typeof K==="string",W=H?K:Z,Y=C.capitalize(W),X=W.substring(2).toLowerCase();U[X]=H?{}:K,W="_"+W,Q["get"+Y]=function(){return this[W]},Q["set"+Y]=function(A){var q=this[W];if(q)this.off(X,q);if(A)this.on(X,A);this[W]=A}}),Q._eventTypes=U}return $.base.apply(this,arguments)}}},$0=C.extend({_class:"PaperScope",initialize:function $(){W0=this,this.settings=new C({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=$._id++,$._scopes[this._id]=this;var Q=$.prototype;if(!this.support){var J=L0.getContext(1,1)||{};Q.support={nativeDash:"setLineDash"in J||"mozDash"in J,nativeBlendModes:q8.nativeModes},L0.release(J)}if(!this.agent){var U=M.navigator.userAgent.toLowerCase(),K=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(U)||[])[0],Z=K==="darwin"?"mac":K,H=Q.agent=Q.browser={platform:Z};if(Z)H[Z]=!0;if(U.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(W,Y,X,A,q){if(!H.chrome){var O=Y==="opera"?A:/^(node|trident)$/.test(Y)?q:X;H.version=O,H.versionNumber=parseFloat(O),Y={trident:"msie",jsdom:"node"}[Y]||Y,H.name=Y,H[Y]=!0}}),H.chrome)delete H.webkit;if(H.atom)delete H.chrome}},version:"0.12.17",getView:function(){var $=this.project;return $&&$._view},getPaper:function(){return this},execute:function($,Q){},install:function($){var Q=this;C.each(["project","view","tool"],function(U){C.define($,U,{configurable:!0,get:function(){return Q[U]}})});for(var J in this)if(!/^_/.test(J)&&this[J])$[J]=this[J]},setup:function($){return W0=this,this.project=new Q8($),this},createCanvas:function($,Q){return L0.getCanvas($,Q)},activate:function(){W0=this},clear:function(){var $=this.projects,Q=this.tools;for(var J=$.length-1;J>=0;J--)$[J].remove();for(var J=Q.length-1;J>=0;J--)Q[J].remove()},remove:function(){this.clear(),delete $0._scopes[this._id]},statics:new function(){function $(Q){return Q+="Attribute",function(J,U){return J[Q](U)||J[Q]("data-paper-"+U)}}return{_scopes:{},_id:0,get:function(Q){return this._scopes[Q]||null},getAttribute:$("get"),hasAttribute:$("has")}}}),T0=C.extend(a,{initialize:function($){if(this._scope=W0,this._index=this._scope[this._list].push(this)-1,$||!this._scope[this._reference])this.activate()},activate:function(){if(!this._scope)return!1;var $=this._scope[this._reference];if($&&$!==this)$.emit("deactivate");return this._scope[this._reference]=this,this.emit("activate",$),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){if(this._index==null)return!1;if(C.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this)this._scope[this._reference]=null;return this._scope=null,!0},getView:function(){return this._scope.getView()}}),A0={findItemBoundsCollisions:function($,Q,J){function U(H){var W=new Array(H.length);for(var Y=0;Y<H.length;Y++){var X=H[Y].getBounds();W[Y]=[X.left,X.top,X.right,X.bottom]}return W}var K=U($),Z=!Q||Q===$?K:U(Q);return this.findBoundsCollisions(K,Z,J||0)},findCurveBoundsCollisions:function($,Q,J,U){function K(O){var{min:F,max:V}=Math,L=new Array(O.length);for(var B=0;B<O.length;B++){var D=O[B];L[B]=[F(D[0],D[2],D[4],D[6]),F(D[1],D[3],D[5],D[7]),V(D[0],D[2],D[4],D[6]),V(D[1],D[3],D[5],D[7])]}return L}var Z=K($),H=!Q||Q===$?Z:K(Q);if(U){var W=this.findBoundsCollisions(Z,H,J||0,!1,!0),Y=this.findBoundsCollisions(Z,H,J||0,!0,!0),X=[];for(var A=0,q=W.length;A<q;A++)X[A]={hor:W[A],ver:Y[A]};return X}return this.findBoundsCollisions(Z,H,J||0)},findBoundsCollisions:function($,Q,J,U,K){var Z=!Q||$===Q,H=Z?$:$.concat(Q),W=$.length,Y=H.length;function X(d,l,r){var n=0,e=d.length;while(n<e){var c=e+n>>>1;if(H[d[c]][l]<r)n=c+1;else e=c}return n-1}var A=U?1:0,q=A+2,O=U?0:1,F=O+2,V=new Array(Y);for(var L=0;L<Y;L++)V[L]=L;V.sort(function(d,l){return H[d][A]-H[l][A]});var B=[],D=new Array(W);for(var L=0;L<Y;L++){var _=V[L],T=H[_],E=Z?_:_-W,R=_<W,z=Z||!R,G=R?[]:null;if(B.length){var S=X(B,q,T[A]-J)+1;if(B.splice(0,S),Z&&K){G=G.concat(B);for(var P=0;P<B.length;P++){var w=B[P];D[w].push(E)}}else{var k=T[F],x=T[O];for(var P=0;P<B.length;P++){var w=B[P],b=H[w],f=w<W,h=Z||w>=W;if(K||(R&&h||z&&f)&&(k>=b[O]-J&&x<=b[F]+J)){if(R&&h)G.push(Z?w:w-W);if(z&&f)D[w].push(E)}}}}if(R){if($===Q)G.push(_);D[_]=G}if(B.length){var u=T[q],v=X(B,q,u);B.splice(v+1,0,_)}else B.push(_)}for(var L=0;L<D.length;L++){var m=D[L];if(m)m.sort(function(l,r){return l-r})}return D}},D0=C.extend({initialize:function($){this.precision=C.pick($,5),this.multiplier=Math.pow(10,this.precision)},number:function($){return this.precision<16?Math.round($*this.multiplier)/this.multiplier:$},pair:function($,Q,J){return this.number($)+(J||",")+this.number(Q)},point:function($,Q){return this.number($.x)+(Q||",")+this.number($.y)},size:function($,Q){return this.number($.width)+(Q||",")+this.number($.height)},rectangle:function($,Q){return this.point($,Q)+(Q||",")+this.size($,Q)}});D0.instance=new D0;var Z0=new function(){var $=[[0.5773502691896257],[0,0.7745966692414834],[0.33998104358485626,0.8611363115940526],[0,0.5384693101056831,0.906179845938664],[0.2386191860831969,0.6612093864662645,0.932469514203152],[0,0.4058451513773972,0.7415311855993945,0.9491079123427585],[0.1834346424956498,0.525532409916329,0.7966664774136267,0.9602898564975363],[0,0.3242534234038089,0.6133714327005904,0.8360311073266358,0.9681602395076261],[0.14887433898163122,0.4333953941292472,0.6794095682990244,0.8650633666889845,0.9739065285171717],[0,0.26954315595234496,0.5190961292068118,0.7301520055740494,0.8870625997680953,0.978228658146057],[0.1252334085114689,0.3678314989981802,0.5873179542866175,0.7699026741943047,0.9041172563704749,0.9815606342467192],[0,0.2304583159551348,0.44849275103644687,0.6423493394403402,0.8015780907333099,0.9175983992229779,0.9841830547185881],[0.10805494870734367,0.31911236892788974,0.5152486363581541,0.6872929048116855,0.827201315069765,0.9284348836635735,0.9862838086968123],[0,0.20119409399743451,0.3941513470775634,0.5709721726085388,0.7244177313601701,0.8482065834104272,0.937273392400706,0.9879925180204854],[0.09501250983763744,0.2816035507792589,0.45801677765722737,0.6178762444026438,0.755404408355003,0.8656312023878318,0.9445750230732326,0.9894009349916499]],Q=[[1],[0.8888888888888888,0.5555555555555556],[0.6521451548625461,0.34785484513745385],[0.5688888888888889,0.47862867049936647,0.23692688505618908],[0.46791393457269104,0.3607615730481386,0.17132449237917036],[0.4179591836734694,0.3818300505051189,0.27970539148927664,0.1294849661688697],[0.362683783378362,0.31370664587788727,0.22238103445337448,0.10122853629037626],[0.3302393550012598,0.31234707704000286,0.26061069640293544,0.1806481606948574,0.08127438836157441],[0.29552422471475287,0.26926671930999635,0.21908636251598204,0.1494513491505806,0.06667134430868814],[0.2729250867779006,0.26280454451024665,0.23319376459199048,0.18629021092773426,0.1255803694649046,0.05566856711617366],[0.24914704581340277,0.2334925365383548,0.20316742672306592,0.16007832854334622,0.10693932599531843,0.04717533638651183],[0.2325515532308739,0.22628318026289723,0.2078160475368885,0.17814598076194574,0.13887351021978725,0.09212149983772845,0.04048400476531588],[0.2152638534631578,0.2051984637212956,0.18553839747793782,0.15720316715819355,0.12151857068790319,0.08015808715976021,0.03511946033175186],[0.2025782419255613,0.19843148532711158,0.1861610000155622,0.16626920581699392,0.13957067792615432,0.10715922046717194,0.07036604748810812,0.03075324199611727],[0.1894506104550685,0.18260341504492358,0.16915651939500254,0.14959598881657674,0.12462897125553388,0.09515851168249279,0.062253523938647894,0.027152459411754096]],J=Math.abs,U=Math.sqrt,K=Math.pow,Z=Math.log2||function(q){return Math.log(q)*Math.LOG2E},H=0.000000000001,W=0.000000000000000112;function Y(q,O,F){return q<O?O:q>F?F:q}function X(q,O,F){function V(S){var P=S*134217729,w=S-P,k=w+P,x=S-k;return[k,x]}var L=O*O-q*F,B=O*O+q*F;if(J(L)*3<B){var D=V(q),_=V(O),T=V(F),E=O*O,R=_[0]*_[0]-E+2*_[0]*_[1]+_[1]*_[1],z=q*F,G=D[0]*T[0]-z+D[0]*T[1]+D[1]*T[0]+D[1]*T[1];L=E-z+(R-G)}return L}function A(){var q=Math.max.apply(Math,arguments);return q&&(q<0.00000001||q>1e8)?K(2,-Math.round(Z(q))):0}return{EPSILON:H,MACHINE_EPSILON:W,CURVETIME_EPSILON:0.00000001,GEOMETRIC_EPSILON:0.0000001,TRIGONOMETRIC_EPSILON:0.00000001,ANGULAR_EPSILON:0.00001,KAPPA:4*(U(2)-1)/3,isZero:function(q){return q>=-H&&q<=H},isMachineZero:function(q){return q>=-W&&q<=W},clamp:Y,integrate:function(q,O,F,V){var L=$[V-2],B=Q[V-2],D=(F-O)*0.5,_=D+O,T=0,E=V+1>>1,R=V&1?B[T++]*q(_):0;while(T<E){var z=D*L[T];R+=B[T++]*(q(_+z)+q(_-z))}return D*R},findRoot:function(q,O,F,V,L,B,D){for(var _=0;_<B;_++){var T=q(F),E=T/O(F),R=F-E;if(J(E)<D){F=R;break}if(T>0)L=F,F=R<=V?(V+L)*0.5:R;else V=F,F=R>=L?(V+L)*0.5:R}return Y(F,V,L)},solveQuadratic:function(q,O,F,V,L,B){var D,_=Infinity;if(J(q)<H){if(J(O)<H)return J(F)<H?-1:0;D=-F/O}else{O*=-0.5;var T=X(q,O,F);if(T&&J(T)<W){var E=A(J(q),J(O),J(F));if(E)q*=E,O*=E,F*=E,T=X(q,O,F)}if(T>=-W){var R=T<0?0:U(T),z=O+(O<0?-R:R);if(z===0)D=F/q,_=-D;else D=z/q,_=F/z}}var G=0,S=L==null,P=L-H,w=B+H;if(isFinite(D)&&(S||D>P&&D<w))V[G++]=S?D:Y(D,L,B);if(_!==D&&isFinite(_)&&(S||_>P&&_<w))V[G++]=S?_:Y(_,L,B);return G},solveCubic:function(q,O,F,V,L,B,D){var _=A(J(q),J(O),J(F),J(V)),T,E,R,z,G;if(_)q*=_,O*=_,F*=_,V*=_;function S(v){T=v;var m=q*T;E=m+O,R=E*T+F,z=(m+E)*T+R,G=R*T+V}if(J(q)<H)q=O,E=F,R=V,T=Infinity;else if(J(V)<H)E=O,R=F,T=0;else{S(-(O/q)/3);var P=G/q,w=K(J(P),0.3333333333333333),k=P<0?-1:1,x=-z/q,b=x>0?1.324717957244746*Math.max(w,U(x)):w,f=T-k*b;if(f!==T){do S(f),f=z===0?T:T-G/z/(1+W);while(k*f>k*T);if(J(q)*T*T>J(V/T))R=-V/T,E=(R-F)/T}}var h=Z0.solveQuadratic(q,E,R,L,B,D),u=B==null;if(isFinite(T)&&(h===0||h>0&&T!==L[0]&&T!==L[1])&&(u||T>B-H&&T<D+H))L[h++]=u?T:Y(T,B,D);return h}}},b0={_id:1,_pools:{},get:function($){if($){var Q=this._pools[$];if(!Q)Q=this._pools[$]={_id:1};return Q._id++}else return this._id++}},y=C.extend({_class:"Point",_readIndex:!0,initialize:function $(Q,J){var U=typeof Q,K=this.__read,Z=0;if(U==="number"){var H=typeof J==="number";if(this._set(Q,H?J:Q),K)Z=H?2:1}else if(U==="undefined"||Q===null){if(this._set(0,0),K)Z=Q===null?1:0}else{var W=U==="string"?Q.split(/[\s,]+/)||[]:Q;if(Z=1,Array.isArray(W))this._set(+W[0],+(W.length>1?W[1]:W[0]));else if("x"in W)this._set(W.x||0,W.y||0);else if("width"in W)this._set(W.width||0,W.height||0);else if("angle"in W)this._set(W.length||0,0),this.setAngle(W.angle||0);else this._set(0,0),Z=0}if(K)this.__read=Z;return this},set:"#initialize",_set:function($,Q){return this.x=$,this.y=Q,this},equals:function($){return this===$||$&&(this.x===$.x&&this.y===$.y||Array.isArray($)&&this.x===$[0]&&this.y===$[1])||!1},clone:function(){return new y(this.x,this.y)},toString:function(){var $=D0.instance;return"{ x: "+$.number(this.x)+", y: "+$.number(this.y)+" }"},_serialize:function($){var Q=$.formatter;return[Q.number(this.x),Q.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function($){if(this.isZero()){var Q=this._angle||0;this._set(Math.cos(Q)*$,Math.sin(Q)*$)}else{var J=$/this.getLength();if(Z0.isZero(J))this.getAngle();this._set(this.x*J,this.y*J)}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180/Math.PI},setAngle:function($){this.setAngleInRadians.call(this,$*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(!arguments.length)return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x);else{var $=y.read(arguments),Q=this.getLength()*$.getLength();if(Z0.isZero(Q))return NaN;else{var J=this.dot($)/Q;return Math.acos(J<-1?-1:J>1?1:J)}}},setAngleInRadians:function($){if(this._angle=$,!this.isZero()){var Q=this.getLength();this._set(Math.cos($)*Q,Math.sin($)*Q)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var $=y.read(arguments);return Math.atan2(this.cross($),this.dot($))*180/Math.PI},getDistance:function(){var $=arguments,Q=y.read($),J=Q.x-this.x,U=Q.y-this.y,K=J*J+U*U,Z=C.read($);return Z?K:Math.sqrt(K)},normalize:function($){if($===I)$=1;var Q=this.getLength(),J=Q!==0?$/Q:0,U=new y(this.x*J,this.y*J);if(J>=0)U._angle=this._angle;return U},rotate:function($,Q){if($===0)return this.clone();$=$*Math.PI/180;var J=Q?this.subtract(Q):this,U=Math.sin($),K=Math.cos($);return J=new y(J.x*K-J.y*U,J.x*U+J.y*K),Q?J.add(Q):J},transform:function($){return $?$._transformPoint(this):this},add:function(){var $=y.read(arguments);return new y(this.x+$.x,this.y+$.y)},subtract:function(){var $=y.read(arguments);return new y(this.x-$.x,this.y-$.y)},multiply:function(){var $=y.read(arguments);return new y(this.x*$.x,this.y*$.y)},divide:function(){var $=y.read(arguments);return new y(this.x/$.x,this.y/$.y)},modulo:function(){var $=y.read(arguments);return new y(this.x%$.x,this.y%$.y)},negate:function(){return new y(-this.x,-this.y)},isInside:function(){return t.read(arguments).contains(this)},isClose:function(){var $=arguments,Q=y.read($),J=C.read($);return this.getDistance(Q)<=J},isCollinear:function(){var $=y.read(arguments);return y.isCollinear(this.x,this.y,$.x,$.y)},isColinear:"#isCollinear",isOrthogonal:function(){var $=y.read(arguments);return y.isOrthogonal(this.x,this.y,$.x,$.y)},isZero:function(){var $=Z0.isZero;return $(this.x)&&$(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function($){return this.x*($>1&&$<4?-1:1)>=0&&this.y*($>2?-1:1)>=0},dot:function(){var $=y.read(arguments);return this.x*$.x+this.y*$.y},cross:function(){var $=y.read(arguments);return this.x*$.y-this.y*$.x},project:function(){var $=y.read(arguments),Q=$.isZero()?0:this.dot($)/$.dot($);return new y($.x*Q,$.y*Q)},statics:{min:function(){var $=arguments,Q=y.read($),J=y.read($);return new y(Math.min(Q.x,J.x),Math.min(Q.y,J.y))},max:function(){var $=arguments,Q=y.read($),J=y.read($);return new y(Math.max(Q.x,J.x),Math.max(Q.y,J.y))},random:function(){return new y(Math.random(),Math.random())},isCollinear:function($,Q,J,U){return Math.abs($*U-Q*J)<=Math.sqrt(($*$+Q*Q)*(J*J+U*U))*0.00000001},isOrthogonal:function($,Q,J,U){return Math.abs($*J+Q*U)<=Math.sqrt(($*$+Q*Q)*(J*J+U*U))*0.00000001}}},C.each(["round","ceil","floor","abs"],function($){var Q=Math[$];this[$]=function(){return new y(Q(this.x),Q(this.y))}},{})),x0=y.extend({initialize:function $(Q,J,U,K){this._x=Q,this._y=J,this._owner=U,this._setter=K},_set:function($,Q,J){if(this._x=$,this._y=Q,!J)this._owner[this._setter](this);return this},getX:function(){return this._x},setX:function($){this._x=$,this._owner[this._setter](this)},getY:function(){return this._y},setY:function($){this._y=$,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function($){this._owner._changeSelection(this._getSelection(),$)},_getSelection:function(){return this._setter==="setPosition"?4:0}}),s=C.extend({_class:"Size",_readIndex:!0,initialize:function $(Q,J){var U=typeof Q,K=this.__read,Z=0;if(U==="number"){var H=typeof J==="number";if(this._set(Q,H?J:Q),K)Z=H?2:1}else if(U==="undefined"||Q===null){if(this._set(0,0),K)Z=Q===null?1:0}else{var W=U==="string"?Q.split(/[\s,]+/)||[]:Q;if(Z=1,Array.isArray(W))this._set(+W[0],+(W.length>1?W[1]:W[0]));else if("width"in W)this._set(W.width||0,W.height||0);else if("x"in W)this._set(W.x||0,W.y||0);else this._set(0,0),Z=0}if(K)this.__read=Z;return this},set:"#initialize",_set:function($,Q){return this.width=$,this.height=Q,this},equals:function($){return $===this||$&&(this.width===$.width&&this.height===$.height||Array.isArray($)&&this.width===$[0]&&this.height===$[1])||!1},clone:function(){return new s(this.width,this.height)},toString:function(){var $=D0.instance;return"{ width: "+$.number(this.width)+", height: "+$.number(this.height)+" }"},_serialize:function($){var Q=$.formatter;return[Q.number(this.width),Q.number(this.height)]},add:function(){var $=s.read(arguments);return new s(this.width+$.width,this.height+$.height)},subtract:function(){var $=s.read(arguments);return new s(this.width-$.width,this.height-$.height)},multiply:function(){var $=s.read(arguments);return new s(this.width*$.width,this.height*$.height)},divide:function(){var $=s.read(arguments);return new s(this.width/$.width,this.height/$.height)},modulo:function(){var $=s.read(arguments);return new s(this.width%$.width,this.height%$.height)},negate:function(){return new s(-this.width,-this.height)},isZero:function(){var $=Z0.isZero;return $(this.width)&&$(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function($,Q){return new s(Math.min($.width,Q.width),Math.min($.height,Q.height))},max:function($,Q){return new s(Math.max($.width,Q.width),Math.max($.height,Q.height))},random:function(){return new s(Math.random(),Math.random())}}},C.each(["round","ceil","floor","abs"],function($){var Q=Math[$];this[$]=function(){return new s(Q(this.width),Q(this.height))}},{})),m0=s.extend({initialize:function $(Q,J,U,K){this._width=Q,this._height=J,this._owner=U,this._setter=K},_set:function($,Q,J){if(this._width=$,this._height=Q,!J)this._owner[this._setter](this);return this},getWidth:function(){return this._width},setWidth:function($){this._width=$,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function($){this._height=$,this._owner[this._setter](this)}}),t=C.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function $(Q,J,U,K){var Z=arguments,H=typeof Q,W;if(H==="number")this._set(Q,J,U,K),W=4;else if(H==="undefined"||Q===null)this._set(0,0,0,0),W=Q===null?1:0;else if(Z.length===1){if(Array.isArray(Q))this._set.apply(this,Q),W=1;else if(Q.x!==I||Q.width!==I)this._set(Q.x||0,Q.y||0,Q.width||0,Q.height||0),W=1;else if(Q.from===I&&Q.to===I){if(this._set(0,0,0,0),C.readSupported(Z,this))W=1}}if(W===I){var Y=y.readNamed(Z,"from"),X=C.peek(Z),A=Y.x,q=Y.y,O,F;if(X&&X.x!==I||C.hasNamed(Z,"to")){var V=y.readNamed(Z,"to");if(O=V.x-A,F=V.y-q,O<0)A=V.x,O=-O;if(F<0)q=V.y,F=-F}else{var L=s.read(Z);O=L.width,F=L.height}this._set(A,q,O,F),W=Z.__index}var B=Z.__filtered;if(B)this.__filtered=B;if(this.__read)this.__read=W;return this},set:"#initialize",_set:function($,Q,J,U){return this.x=$,this.y=Q,this.width=J,this.height=U,this},clone:function(){return new t(this.x,this.y,this.width,this.height)},equals:function($){var Q=C.isPlainValue($)?t.read(arguments):$;return Q===this||Q&&this.x===Q.x&&this.y===Q.y&&this.width===Q.width&&this.height===Q.height||!1},toString:function(){var $=D0.instance;return"{ x: "+$.number(this.x)+", y: "+$.number(this.y)+", width: "+$.number(this.width)+", height: "+$.number(this.height)+" }"},_serialize:function($){var Q=$.formatter;return[Q.number(this.x),Q.number(this.y),Q.number(this.width),Q.number(this.height)]},getPoint:function($){var Q=$?y:x0;return new Q(this.x,this.y,this,"setPoint")},setPoint:function(){var $=y.read(arguments);this.x=$.x,this.y=$.y},getSize:function($){var Q=$?s:m0;return new Q(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var $=s.read(arguments),Q=this._sx,J=this._sy,U=$.width,K=$.height;if(Q)this.x+=(this.width-U)*Q;if(J)this.y+=(this.height-K)*J;this.width=U,this.height=K,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function($){if(!this._fw){var Q=$-this.x;this.width-=this._sx===0.5?Q*2:Q}this.x=$,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function($){if(!this._fh){var Q=$-this.y;this.height-=this._sy===0.5?Q*2:Q}this.y=$,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function($){if(!this._fw){var Q=$-this.x;this.width=this._sx===0.5?Q*2:Q}this.x=$-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function($){if(!this._fh){var Q=$-this.y;this.height=this._sy===0.5?Q*2:Q}this.y=$-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function($){if(this._fw||this._sx===0.5)this.x=$-this.width/2;else{if(this._sx)this.x+=($-this.x)*2*this._sx;this.width=($-this.x)*2}this._sx=0.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function($){if(this._fh||this._sy===0.5)this.y=$-this.height/2;else{if(this._sy)this.y+=($-this.y)*2*this._sy;this.height=($-this.y)*2}this._sy=0.5,this._fh=0},getCenter:function($){var Q=$?y:x0;return new Q(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var $=y.read(arguments);return this.setCenterX($.x),this.setCenterY($.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return this.width===0||this.height===0},contains:function($){return $&&$.width!==I||(Array.isArray($)?$:arguments).length===4?this._containsRectangle(t.read(arguments)):this._containsPoint(y.read(arguments))},_containsPoint:function($){var{x:Q,y:J}=$;return Q>=this.x&&J>=this.y&&Q<=this.x+this.width&&J<=this.y+this.height},_containsRectangle:function($){var{x:Q,y:J}=$;return Q>=this.x&&J>=this.y&&Q+$.width<=this.x+this.width&&J+$.height<=this.y+this.height},intersects:function(){var $=t.read(arguments),Q=C.read(arguments)||0;return $.x+$.width>this.x-Q&&$.y+$.height>this.y-Q&&$.x<this.x+this.width+Q&&$.y<this.y+this.height+Q},intersect:function(){var $=t.read(arguments),Q=Math.max(this.x,$.x),J=Math.max(this.y,$.y),U=Math.min(this.x+this.width,$.x+$.width),K=Math.min(this.y+this.height,$.y+$.height);return new t(Q,J,U-Q,K-J)},unite:function(){var $=t.read(arguments),Q=Math.min(this.x,$.x),J=Math.min(this.y,$.y),U=Math.max(this.x+this.width,$.x+$.width),K=Math.max(this.y+this.height,$.y+$.height);return new t(Q,J,U-Q,K-J)},include:function(){var $=y.read(arguments),Q=Math.min(this.x,$.x),J=Math.min(this.y,$.y),U=Math.max(this.x+this.width,$.x),K=Math.max(this.y+this.height,$.y);return new t(Q,J,U-Q,K-J)},expand:function(){var $=s.read(arguments),Q=$.width,J=$.height;return new t(this.x-Q/2,this.y-J/2,this.width+Q,this.height+J)},scale:function($,Q){return this.expand(this.width*$-this.width,this.height*(Q===I?$:Q)-this.height)}},C.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function($,Q){var J=$.join(""),U=/^[RL]/.test(J);if(Q>=4)$[1]+=U?"Y":"X";var K=$[U?0:1],Z=$[U?1:0],H="get"+K,W="get"+Z,Y="set"+K,X="set"+Z,A="get"+J,q="set"+J;this[A]=function(O){var F=O?y:x0;return new F(this[H](),this[W](),this,q)},this[q]=function(){var O=y.read(arguments);this[Y](O.x),this[X](O.y)}},{beans:!0})),b8=t.extend({initialize:function $(Q,J,U,K,Z,H){this._set(Q,J,U,K,!0),this._owner=Z,this._setter=H},_set:function($,Q,J,U,K){if(this._x=$,this._y=Q,this._width=J,this._height=U,!K)this._owner[this._setter](this);return this}},new function(){var $=t.prototype;return C.each(["x","y","width","height"],function(Q){var J=C.capitalize(Q),U="_"+Q;this["get"+J]=function(){return this[U]},this["set"+J]=function(K){if(this[U]=K,!this._dontNotify)this._owner[this._setter](this)}},C.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(Q){var J="set"+Q;this[J]=function(){this._dontNotify=!0,$[J].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(Q){var J=this._owner;if(J._changeSelection)J._changeSelection(2,Q)}}))}),q0=C.extend({_class:"Matrix",initialize:function $(Q,J){var U=arguments,K=U.length,Z=!0;if(K>=6)this._set.apply(this,U);else if(K===1||K===2)if(Q instanceof $)this._set(Q._a,Q._b,Q._c,Q._d,Q._tx,Q._ty,J);else if(Array.isArray(Q))this._set.apply(this,J?Q.concat([J]):Q);else Z=!1;else if(!K)this.reset();else Z=!1;if(!Z)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function($,Q,J,U,K,Z,H){if(this._a=$,this._b=Q,this._c=J,this._d=U,this._tx=K,this._ty=Z,!H)this._changed();return this},_serialize:function($,Q){return C.serialize(this.getValues(),$,!0,Q)},_changed:function(){var $=this._owner;if($)if($._applyMatrix)$.transform(null,!0);else $._changed(25)},clone:function(){return new q0(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function($){return $===this||$&&this._a===$._a&&this._b===$._b&&this._c===$._c&&this._d===$._d&&this._tx===$._tx&&this._ty===$._ty},toString:function(){var $=D0.instance;return"[["+[$.number(this._a),$.number(this._c),$.number(this._tx)].join(", ")+"], ["+[$.number(this._b),$.number(this._d),$.number(this._ty)].join(", ")+"]]"},reset:function($){if(this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,!$)this._changed();return this},apply:function($,Q){var J=this._owner;if(J)return J.transform(null,C.pick($,!0),Q),this.isIdentity();return!1},translate:function(){var $=y.read(arguments),Q=$.x,J=$.y;return this._tx+=Q*this._a+J*this._c,this._ty+=Q*this._b+J*this._d,this._changed(),this},scale:function(){var $=arguments,Q=y.read($),J=y.read($,0,{readNull:!0});if(J)this.translate(J);if(this._a*=Q.x,this._b*=Q.x,this._c*=Q.y,this._d*=Q.y,J)this.translate(J.negate());return this._changed(),this},rotate:function($){$*=Math.PI/180;var Q=y.read(arguments,1),J=Q.x,U=Q.y,K=Math.cos($),Z=Math.sin($),H=J-J*K+U*Z,W=U-J*Z-U*K,Y=this._a,X=this._b,A=this._c,q=this._d;return this._a=K*Y+Z*A,this._b=K*X+Z*q,this._c=-Z*Y+K*A,this._d=-Z*X+K*q,this._tx+=H*Y+W*A,this._ty+=H*X+W*q,this._changed(),this},shear:function(){var $=arguments,Q=y.read($),J=y.read($,0,{readNull:!0});if(J)this.translate(J);var U=this._a,K=this._b;if(this._a+=Q.y*this._c,this._b+=Q.y*this._d,this._c+=Q.x*U,this._d+=Q.x*K,J)this.translate(J.negate());return this._changed(),this},skew:function(){var $=arguments,Q=y.read($),J=y.read($,0,{readNull:!0}),U=Math.PI/180,K=new y(Math.tan(Q.x*U),Math.tan(Q.y*U));return this.shear(K,J)},append:function($,Q){if($){var J=this._a,U=this._b,K=this._c,Z=this._d,H=$._a,W=$._c,Y=$._b,X=$._d,A=$._tx,q=$._ty;if(this._a=H*J+Y*K,this._c=W*J+X*K,this._b=H*U+Y*Z,this._d=W*U+X*Z,this._tx+=A*J+q*K,this._ty+=A*U+q*Z,!Q)this._changed()}return this},prepend:function($,Q){if($){var J=this._a,U=this._b,K=this._c,Z=this._d,H=this._tx,W=this._ty,Y=$._a,X=$._c,A=$._b,q=$._d,O=$._tx,F=$._ty;if(this._a=Y*J+X*U,this._c=Y*K+X*Z,this._b=A*J+q*U,this._d=A*K+q*Z,this._tx=Y*H+X*W+O,this._ty=A*H+q*W+F,!Q)this._changed()}return this},appended:function($){return this.clone().append($)},prepended:function($){return this.clone().prepend($)},invert:function(){var $=this._a,Q=this._b,J=this._c,U=this._d,K=this._tx,Z=this._ty,H=$*U-Q*J,W=null;if(H&&!isNaN(H)&&isFinite(K)&&isFinite(Z))this._a=U/H,this._b=-Q/H,this._c=-J/H,this._d=$/H,this._tx=(J*Z-U*K)/H,this._ty=(Q*K-$*Z)/H,W=this;return W},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new q0(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0},isInvertible:function(){var $=this._a*this._d-this._c*this._b;return $&&!isNaN($)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function($,Q,J){return arguments.length<3?this._transformPoint(y.read(arguments)):this._transformCoordinates($,Q,J)},_transformPoint:function($,Q,J){var{x:U,y:K}=$;if(!Q)Q=new y;return Q._set(U*this._a+K*this._c+this._tx,U*this._b+K*this._d+this._ty,J)},_transformCoordinates:function($,Q,J){for(var U=0,K=2*J;U<K;U+=2){var Z=$[U],H=$[U+1];Q[U]=Z*this._a+H*this._c+this._tx,Q[U+1]=Z*this._b+H*this._d+this._ty}return Q},_transformCorners:function($){var{x:Q,y:J}=$,U=Q+$.width,K=J+$.height,Z=[Q,J,U,J,U,K,Q,K];return this._transformCoordinates(Z,Z,4)},_transformBounds:function($,Q,J){var U=this._transformCorners($),K=U.slice(0,2),Z=K.slice();for(var H=2;H<8;H++){var W=U[H],Y=H&1;if(W<K[Y])K[Y]=W;else if(W>Z[Y])Z[Y]=W}if(!Q)Q=new t;return Q._set(K[0],K[1],Z[0]-K[0],Z[1]-K[1],J)},inverseTransform:function(){return this._inverseTransform(y.read(arguments))},_inverseTransform:function($,Q,J){var U=this._a,K=this._b,Z=this._c,H=this._d,W=this._tx,Y=this._ty,X=U*H-K*Z,A=null;if(X&&!isNaN(X)&&isFinite(W)&&isFinite(Y)){var q=$.x-this._tx,O=$.y-this._ty;if(!Q)Q=new y;A=Q._set((q*H-O*Z)/X,(O*U-q*K)/X,J)}return A},decompose:function(){var $=this._a,Q=this._b,J=this._c,U=this._d,K=$*U-Q*J,Z=Math.sqrt,H=Math.atan2,W=180/Math.PI,Y,X,A;if($!==0||Q!==0){var q=Z($*$+Q*Q);Y=Math.acos($/q)*(Q>0?1:-1),X=[q,K/q],A=[H($*J+Q*U,q*q),0]}else if(J!==0||U!==0){var O=Z(J*J+U*U);Y=Math.asin(J/O)*(U>0?1:-1),X=[K/O,O],A=[0,H($*J+Q*U,O*O)]}else Y=0,A=X=[0,0];return{translation:this.getTranslation(),rotation:Y*W,scaling:new y(X),skewing:new y(A[0]*W,A[1]*W)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new y(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function($){if(!this.isIdentity())$.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},C.each(["a","b","c","d","tx","ty"],function($){var Q=C.capitalize($),J="_"+$;this["get"+Q]=function(){return this[J]},this["set"+Q]=function(U){this[J]=U,this._changed()}},{})),G0=C.extend({_class:"Line",initialize:function $(Q,J,U,K,Z){var H=!1;if(arguments.length>=4)this._px=Q,this._py=J,this._vx=U,this._vy=K,H=Z;else this._px=Q.x,this._py=Q.y,this._vx=J.x,this._vy=J.y,H=U;if(!H)this._vx-=this._px,this._vy-=this._py},getPoint:function(){return new y(this._px,this._py)},getVector:function(){return new y(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function($,Q){return G0.intersect(this._px,this._py,this._vx,this._vy,$._px,$._py,$._vx,$._vy,!0,Q)},getSide:function($,Q){return G0.getSide(this._px,this._py,this._vx,this._vy,$.x,$.y,!0,Q)},getDistance:function($){return Math.abs(this.getSignedDistance($))},getSignedDistance:function($){return G0.getSignedDistance(this._px,this._py,this._vx,this._vy,$.x,$.y,!0)},isCollinear:function($){return y.isCollinear(this._vx,this._vy,$._vx,$._vy)},isOrthogonal:function($){return y.isOrthogonal(this._vx,this._vy,$._vx,$._vy)},statics:{intersect:function($,Q,J,U,K,Z,H,W,Y,X){if(!Y)J-=$,U-=Q,H-=K,W-=Z;var A=J*W-U*H;if(!Z0.isMachineZero(A)){var q=$-K,O=Q-Z,F=(H*O-W*q)/A,V=(J*O-U*q)/A,L=0.000000000001,B=-L,D=1+L;if(X||B<F&&F<D&&B<V&&V<D){if(!X)F=F<=0?0:F>=1?1:F;return new y($+F*J,Q+F*U)}}},getSide:function($,Q,J,U,K,Z,H,W){if(!H)J-=$,U-=Q;var Y=K-$,X=Z-Q,A=Y*U-X*J;if(!W&&Z0.isMachineZero(A)){if(A=(Y*J+Y*J)/(J*J+U*U),A>=0&&A<=1)A=0}return A<0?-1:A>0?1:0},getSignedDistance:function($,Q,J,U,K,Z,H){if(!H)J-=$,U-=Q;return J===0?U>0?K-$:$-K:U===0?J<0?Z-Q:Q-Z:((K-$)*U-(Z-Q)*J)/(U>J?U*Math.sqrt(1+J*J/(U*U)):J*Math.sqrt(1+U*U/(J*J)))},getDistance:function($,Q,J,U,K,Z,H){return Math.abs(G0.getSignedDistance($,Q,J,U,K,Z,H))}}}),Q8=T0.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function $(Q){T0.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new A8(null,null,this),this._view=_0.create(this,Q||L0.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function($,Q){return C.serialize(this._children,$,!0,Q)},_changed:function($,Q){if($&1){var J=this._view;if(J){if(J._needsUpdate=!0,!J._requested&&J._autoUpdate)J.requestUpdate()}}var U=this._changes;if(U&&Q){var K=this._changesById,Z=Q._id,H=K[Z];if(H)H.flags|=$;else U.push(K[Z]={item:Q,flags:$})}},clear:function(){var $=this._children;for(var Q=$.length-1;Q>=0;Q--)$[Q].remove()},isEmpty:function(){return!this._children.length},remove:function $(){if(!$.base.call(this))return!1;if(this._view)this._view.remove();return!0},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function($){this._currentStyle.set($)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new t0({project:this,insert:!0})},getSymbolDefinitions:function(){var $=[],Q={};return this.getItems({class:F8,match:function(J){var U=J._definition,K=U._id;if(!Q[K])Q[K]=!0,$.push(U);return!1}}),$},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var $=this._selectionItems,Q=[];for(var J in $){var U=$[J],K=U._selection;if(K&1&&U.isInserted())Q.push(U);else if(!K)this._updateSelection(U)}return Q},_updateSelection:function($){var Q=$._id,J=this._selectionItems;if($._selection){if(J[Q]!==$)this._selectionCount++,J[Q]=$}else if(J[Q]===$)this._selectionCount--,delete J[Q]},selectAll:function(){var $=this._children;for(var Q=0,J=$.length;Q<J;Q++)$[Q].setFullySelected(!0)},deselectAll:function(){var $=this._selectionItems;for(var Q in $)$[Q].setFullySelected(!1)},addLayer:function($){return this.insertLayer(I,$)},insertLayer:function($,Q){if(Q instanceof t0){Q._remove(!1,!0),C.splice(this._children,[Q],$,0),Q._setProject(this,!0);var J=Q._name;if(J)Q.setName(J);if(this._changes)Q._changed(5);if(!this._activeLayer)this._activeLayer=Q}else Q=null;return Q},_insertItem:function($,Q,J){if(Q=this.insertLayer($,Q)||(this._activeLayer||this._insertItem(I,new t0(Q0.NO_INSERT),!0)).insertChild($,Q),J&&Q.activate)Q.activate();return Q},getItems:function($){return Q0._getItems(this,$)},getItem:function($){return Q0._getItems(this,$,null,null,!0)[0]||null},importJSON:function($){this.activate();var Q=this._activeLayer;return C.importJSON($,Q&&Q.isEmpty()&&Q)},removeOn:function($){var Q=this._removeSets;if(Q){if($==="mouseup")Q.mousedrag=null;var J=Q[$];if(J){for(var U in J){var K=J[U];for(var Z in Q){var H=Q[Z];if(H&&H!=J)delete H[K._id]}K.remove()}Q[$]=null}}},draw:function($,Q,J){this._updateVersion++,$.save(),Q.applyToContext($);var U=this._children,K=new C({offset:new y(0,0),pixelRatio:J,viewMatrix:Q.isIdentity()?null:Q,matrices:[new q0],updateMatrix:!0});for(var Z=0,H=U.length;Z<H;Z++)U[Z].draw($,K);if($.restore(),this._selectionCount>0){$.save(),$.strokeWidth=1;var W=this._selectionItems,Y=this._scope.settings.handleSize,X=this._updateVersion;for(var A in W)W[A]._drawSelection($,Q,Y,W,X);$.restore()}}}),Q0=C.extend(a,{statics:{extend:function $(Q){if(Q._serializeFields)Q._serializeFields=C.set({},this.prototype._serializeFields,Q._serializeFields);return $.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new q0,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var $=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return C.each($,function(Q){this._events[Q]={install:function(J){this.getView()._countItemEvent(J,1)},uninstall:function(J){this.getView()._countItemEvent(J,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:$}})},{initialize:function $(){},_initialize:function($,Q){var J=$&&C.isPlainObject($),U=J&&$.internal===!0,K=this._matrix=new q0,Z=J&&$.project||W0.project,H=W0.settings;if(this._id=U?null:b0.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&H.applyMatrix,Q)K.translate(Q);if(K._owner=this,this._style=new A8(Z._currentStyle,this,Z),U||J&&$.insert==!1||!H.insertItems&&!(J&&$.insert==!0))this._setProject(Z);else(J&&$.parent||Z)._insertItem(I,this,!0);if(J&&$!==Q0.NO_INSERT&&$!==Q0.INSERT)this.set($,{internal:!0,insert:!0,project:!0,parent:!0});return J},_serialize:function($,Q){var J={},U=this;function K(Z){for(var H in Z){var W=U[H];if(!C.equals(W,H==="leading"?Z.fontSize*1.2:Z[H]))J[H]=C.serialize(W,$,H!=="data",Q)}}if(K(this._serializeFields),!(this instanceof d0))K(this._style._defaults);return[this._class,J]},_changed:function($){var Q=this._symbol,J=this._parent||Q,U=this._project;if($&8)this._bounds=this._position=this._decomposed=I;if($&16)this._globalMatrix=I;if(J&&$&72)Q0._clearBoundsCache(J);if($&2)Q0._clearBoundsCache(this);if(U)U._changed($,this);if(Q)Q._changed($)},getId:function(){return this._id},getName:function(){return this._name},setName:function($){if(this._name)this._removeNamed();if($===+$+"")throw new Error("Names consisting only of numbers are not supported.");var Q=this._getOwner();if($&&Q){var{_children:J,_namedChildren:U}=Q;if((U[$]=U[$]||[]).push(this),!($ in J))J[$]=this}this._name=$||I,this._changed(256)},getStyle:function(){return this._style},setStyle:function($){this.getStyle().set($)}},C.each(["locked","visible","blendMode","opacity","guide"],function($){var Q=C.capitalize($),J="_"+$,U={locked:256,visible:265};this["get"+Q]=function(){return this[J]},this["set"+Q]=function(K){if(K!=this[J])this[J]=K,this._changed(U[$]||257)}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function($){if($!==this._selection){this._selection=$;var Q=this._project;if(Q)Q._updateSelection(this),this._changed(257)}},_changeSelection:function($,Q){var J=this._selection;this.setSelection(Q?J|$:J&~$)},isSelected:function(){if(this._selectChildren){var $=this._children;for(var Q=0,J=$.length;Q<J;Q++)if($[Q].isSelected())return!0}return!!(this._selection&1)},setSelected:function($){if(this._selectChildren){var Q=this._children;for(var J=0,U=Q.length;J<U;J++)Q[J].setSelected($)}this._changeSelection(1,$)},isFullySelected:function(){var $=this._children,Q=!!(this._selection&1);if($&&Q){for(var J=0,U=$.length;J<U;J++)if(!$[J].isFullySelected())return!1;return!0}return Q},setFullySelected:function($){var Q=this._children;if(Q)for(var J=0,U=Q.length;J<U;J++)Q[J].setFullySelected($);this._changeSelection(1,$)},isClipMask:function(){return this._clipMask},setClipMask:function($){if(this._clipMask!=($=!!$)){if(this._clipMask=$,$)this.setFillColor(null),this.setStrokeColor(null);if(this._changed(257),this._parent)this._parent._changed(2048)}},getData:function(){if(!this._data)this._data={};return this._data},setData:function($){this._data=$},getPosition:function($){var Q=$?y:x0,J=this._position||(this._position=this._getPositionFromBounds());return new Q(J.x,J.y,this,"setPosition")},setPosition:function(){this.translate(y.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function($){return this._pivot?this._matrix._transformPoint(this._pivot):($||this.getBounds()).getCenter(!0)},getPivot:function(){var $=this._pivot;return $?new x0($.x,$.y,this,"setPivot"):null},setPivot:function(){this._pivot=y.read(arguments,0,{clone:!0,readNull:!0}),this._position=I}},C.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function($,Q){this[Q]=function(J){return this.getBounds(J,$)}},{beans:!0,getBounds:function($,Q){var J=Q||$ instanceof q0,U=C.set({},J?Q:$,this._boundsOptions);if(!U.stroke||this.getStrokeScaling())U.cacheItem=this;var K=this._getCachedBounds(J&&$,U).rect;return!arguments.length?new b8(K.x,K.y,K.width,K.height,this,"setBounds"):K},setBounds:function(){var $=t.read(arguments),Q=this.getBounds(),J=this._matrix,U=new q0,K=$.getCenter();if(U.translate(K),$.width!=Q.width||$.height!=Q.height){if(!J.isInvertible())J.set(J._backup||new q0().translate(J.getTranslation())),Q=this.getBounds();U.scale(Q.width!==0?$.width/Q.width:0,Q.height!==0?$.height/Q.height:0)}K=Q.getCenter(),U.translate(-K.x,-K.y),this.transform(U)},_getBounds:function($,Q){var J=this._children;if(!J||!J.length)return new t;return Q0._updateBoundsCache(this,Q.cacheItem),Q0._getBounds(J,$,Q)},_getBoundsCacheKey:function($,Q){return[$.stroke?1:0,$.handle?1:0,Q?1:0].join("")},_getCachedBounds:function($,Q,J){$=$&&$._orNullIfIdentity();var U=Q.internal&&!J,K=Q.cacheItem,Z=U?null:this._matrix._orNullIfIdentity(),H=K&&(!$||$.equals(Z))&&this._getBoundsCacheKey(Q,U),W=this._bounds;if(Q0._updateBoundsCache(this._parent||this._symbol,K),H&&W&&H in W){var Y=W[H];return{rect:Y.rect.clone(),nonscaling:Y.nonscaling}}var X=this._getBounds($||Z,Q),A=X.rect||X,q=this._style,O=X.nonscaling||q.hasStroke()&&!q.getStrokeScaling();if(H){if(!W)this._bounds=W={};var Y=W[H]={rect:A.clone(),nonscaling:O,internal:U}}return{rect:A,nonscaling:O}},_getStrokeMatrix:function($,Q){var J=this.getStrokeScaling()?null:Q&&Q.internal?this:this._parent||this._symbol&&this._symbol._item,U=J?J.getViewMatrix().invert():$;return U&&U._shiftless()},statics:{_updateBoundsCache:function($,Q){if($&&Q){var J=Q._id,U=$._boundsCache=$._boundsCache||{ids:{},list:[]};if(!U.ids[J])U.list.push(Q),U.ids[J]=Q}},_clearBoundsCache:function($){var Q=$._boundsCache;if(Q){$._bounds=$._position=$._boundsCache=I;for(var J=0,U=Q.list,K=U.length;J<K;J++){var Z=U[J];if(Z!==$){if(Z._bounds=Z._position=I,Z._boundsCache)Q0._clearBoundsCache(Z)}}}},_getBounds:function($,Q,J){var U=Infinity,K=-U,Z=U,H=K,W=!1;J=J||{};for(var Y=0,X=$.length;Y<X;Y++){var A=$[Y];if(A._visible&&!A.isEmpty(!0)){var q=A._getCachedBounds(Q&&Q.appended(A._matrix),J,!0),O=q.rect;if(U=Math.min(O.x,U),Z=Math.min(O.y,Z),K=Math.max(O.x+O.width,K),H=Math.max(O.y+O.height,H),q.nonscaling)W=!0}}return{rect:isFinite(U)?new t(U,Z,K-U,H-Z):new t,nonscaling:W}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var $=this._decompose();return $?$.rotation:0},setRotation:function($){var Q=this.getRotation();if(Q!=null&&$!=null){var J=this._decomposed;if(this.rotate($-Q),J)J.rotation=$,this._decomposed=J}},getScaling:function(){var $=this._decompose(),Q=$&&$.scaling;return new x0(Q?Q.x:1,Q?Q.y:1,this,"setScaling")},setScaling:function(){var $=this.getScaling(),Q=y.read(arguments,0,{clone:!0,readNull:!0});if($&&Q&&!$.equals(Q)){var J=this.getRotation(),U=this._decomposed,K=new q0,Z=Z0.isZero;if(Z($.x)||Z($.y)){if(K.translate(U.translation),J)K.rotate(J);K.scale(Q.x,Q.y),this._matrix.set(K)}else{var H=this.getPosition(!0);if(K.translate(H),J)K.rotate(J);if(K.scale(Q.x/$.x,Q.y/$.y),J)K.rotate(-J);K.translate(H.negate()),this.transform(K)}if(U)U.scaling=Q,this._decomposed=U}},getMatrix:function(){return this._matrix},setMatrix:function(){var $=this._matrix;$.set.apply($,arguments)},getGlobalMatrix:function($){var Q=this._globalMatrix;if(Q){var J=this._parent,U=[];while(J){if(!J._globalMatrix){Q=null;for(var K=0,Z=U.length;K<Z;K++)U[K]._globalMatrix=null;break}U.push(J),J=J._parent}}if(!Q){Q=this._globalMatrix=this._matrix.clone();var J=this._parent;if(J)Q.prepend(J.getGlobalMatrix(!0))}return $?Q:Q.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function($){if(this._applyMatrix=this._canApplyMatrix&&!!$)this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function($,Q){if(this._project!==$){if(this._project)this._installEvents(!1);this._project=$;var J=this._children;for(var U=0,K=J&&J.length;U<K;U++)J[U]._setProject($);Q=!0}if(Q)this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function $(Q){$.base.call(this,Q);var J=this._children;for(var U=0,K=J&&J.length;U<K;U++)J[U]._installEvents(Q)},getLayer:function(){var $=this;while($=$._parent)if($ instanceof t0)return $;return null},getParent:function(){return this._parent},setParent:function($){return $.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function($){this.removeChildren(),this.addChildren($)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var $=this._getOwner();return $&&$._children[this._index+1]||null},getPreviousSibling:function(){var $=this._getOwner();return $&&$._children[this._index-1]||null},getIndex:function(){return this._index},equals:function($){return $===this||$&&this._class===$._class&&this._style.equals($._style)&&this._matrix.equals($._matrix)&&this._locked===$._locked&&this._visible===$._visible&&this._blendMode===$._blendMode&&this._opacity===$._opacity&&this._clipMask===$._clipMask&&this._guide===$._guide&&this._equals($)||!1},_equals:function($){return C.equals(this._children,$._children)},clone:function($){var Q=new this.constructor(Q0.NO_INSERT),J=this._children,U=C.pick($?$.insert:I,$===I||$===!0),K=C.pick($?$.deep:I,!0);if(J)Q.copyAttributes(this);if(!J||K)Q.copyContent(this);if(!J)Q.copyAttributes(this);if(U)Q.insertAbove(this);var Z=this._name,H=this._parent;if(Z&&H){var J=H._children,W=Z,Y=1;while(J[Z])Z=W+" "+Y++;if(Z!==W)Q.setName(Z)}return Q},copyContent:function($){var Q=$._children;for(var J=0,U=Q&&Q.length;J<U;J++)this.addChild(Q[J].clone(!1),!0)},copyAttributes:function($,Q){this.setStyle($._style);var J=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"];for(var U=0,K=J.length;U<K;U++){var Z=J[U];if($.hasOwnProperty(Z))this[Z]=$[Z]}if(!Q)this._matrix.set($._matrix,!0);this.setApplyMatrix($._applyMatrix),this.setPivot($._pivot),this.setSelection($._selection);var{_data:H,_name:W}=$;if(this._data=H?C.clone(H):null,W)this.setName(W)},rasterize:function($,Q){var J,U,K;if(C.isPlainObject($))J=$.resolution,U=$.insert,K=$.raster;else J=$,U=Q;if(!K)K=new e0(Q0.NO_INSERT);var Z=this.getStrokeBounds(),H=(J||this.getView().getResolution())/72,W=Z.getTopLeft().floor(),Y=Z.getBottomRight().ceil(),X=new s(Y.subtract(W)),A=X.multiply(H);if(K.setSize(A,!0),!A.isZero()){var q=K.getContext(!0),O=new q0().scale(H).translate(W.negate());q.save(),O.applyToContext(q),this.draw(q,new C({matrices:[O]})),q.restore()}if(K._matrix.set(new q0().translate(W.add(X.divide(2))).scale(1/H)),U===I||U)K.insertAbove(this);return K},contains:function(){var $=this._matrix;return $.isInvertible()&&!!this._contains($._inverseTransform(y.read(arguments)))},_contains:function($){var Q=this._children;if(Q){for(var J=Q.length-1;J>=0;J--)if(Q[J].contains($))return!0;return!1}return $.isInside(this.getInternalBounds())},isInside:function(){return t.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new X0.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function($,Q){if(!($ instanceof Q0))return!1;return this._asPathItem().getIntersections($._asPathItem(),null,Q,!0).length>0}},new function(){function $(){var U=arguments;return this._hitTest(y.read(U),p0.getOptions(U))}function Q(){var U=arguments,K=y.read(U),Z=p0.getOptions(U),H=[];return this._hitTest(K,new C({all:H},Z)),H}function J(U,K,Z,H){var W=this._children;if(W)for(var Y=W.length-1;Y>=0;Y--){var X=W[Y],A=X!==H&&X._hitTest(U,K,Z);if(A&&!K.all)return A}return null}return Q8.inject({hitTest:$,hitTestAll:Q,_hitTest:J}),{hitTest:$,hitTestAll:Q,_hitTestChildren:J}},{_hitTest:function($,Q,J){if(this._locked||!this._visible||this._guide&&!Q.guides||this.isEmpty())return null;var U=this._matrix,K=J?J.appended(U):this.getGlobalMatrix().prepend(this.getView()._matrix),Z=Math.max(Q.tolerance,0.000000000001),H=Q._tolerancePadding=new s(X0._getStrokePadding(Z,U._shiftless().invert()));if($=U._inverseTransform($),!$||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(H.multiply(2))._containsPoint($))return null;var W=!(Q.guides&&!this._guide||Q.selected&&!this.isSelected()||Q.type&&Q.type!==C.hyphenate(this._class)||Q.class&&!(this instanceof Q.class)),Y=Q.match,X=this,A,q;function O(T){if(T&&Y&&!Y(T))T=null;if(T&&Q.all)Q.all.push(T);return T}function F(T,E){var R=E?A["get"+E]():X.getPosition();if($.subtract(R).divide(H).length<=1)return new p0(T,X,{name:E?C.hyphenate(E):T,point:R})}var{position:V,center:L,bounds:B}=Q;if(W&&this._parent&&(V||L||B)){if(L||B)A=this.getInternalBounds();if(q=V&&F("position")||L&&F("center","Center"),!q&&B){var D=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"];for(var _=0;_<8&&!q;_++)q=F("bounds",D[_])}q=O(q)}if(!q)q=this._hitTestChildren($,Q,K)||W&&O(this._hitTestSelf($,Q,K,this.getStrokeScaling()?null:K._shiftless().invert()))||null;if(q&&q.point)q.point=U.transform(q.point);return q},_hitTestSelf:function($,Q){if(Q.fill&&this.hasFill()&&this._contains($))return new p0("fill",this)},matches:function($,Q){function J(H,W){for(var Y in H)if(H.hasOwnProperty(Y)){var X=H[Y],A=W[Y];if(C.isPlainObject(X)&&C.isPlainObject(A)){if(!J(X,A))return!1}else if(!C.equals(X,A))return!1}return!0}var U=typeof $;if(U==="object"){for(var K in $)if($.hasOwnProperty(K)&&!this.matches(K,$[K]))return!1;return!0}else if(U==="function")return $(this);else if($==="match")return Q(this);else{var Z=/^(empty|editable)$/.test($)?this["is"+C.capitalize($)]():$==="type"?C.hyphenate(this._class):this[$];if($==="class"){if(typeof Q==="function")return this instanceof Q;Z=this._class}if(typeof Q==="function")return!!Q(Z);else if(Q){if(Q.test)return Q.test(Z);else if(C.isPlainObject(Q))return J(Q,Z)}return C.equals(Z,Q)}},getItems:function($){return Q0._getItems(this,$,this._matrix)},getItem:function($){return Q0._getItems(this,$,this._matrix,null,!0)[0]||null},statics:{_getItems:function $(Q,J,U,K,Z){if(!K){var H=typeof J==="object"&&J,W=H&&H.overlapping,Y=H&&H.inside,X=W||Y,O=X&&t.read([X]);if(K={items:[],recursive:H&&H.recursive!==!1,inside:!!Y,overlapping:!!W,rect:O,path:W&&new X0.Rectangle({rectangle:O,insert:!1})},H)J=C.filter({},J,{recursive:!0,inside:!0,overlapping:!0})}var A=Q._children,q=K.items,O=K.rect;U=O&&(U||new q0);for(var F=0,V=A&&A.length;F<V;F++){var L=A[F],B=U&&U.appended(L._matrix),D=!0;if(O){var X=L.getBounds(B);if(!O.intersects(X))continue;if(!(O.contains(X)||K.overlapping&&(X.contains(O)||K.path.intersects(L,B))))D=!1}if(D&&L.matches(J)){if(q.push(L),Z)break}if(K.recursive!==!1)$(L,J,B,K,Z);if(Z&&q.length>0)break}return q}}},{importJSON:function($){var Q=C.importJSON($,this);return Q!==this?this.addChild(Q):Q},addChild:function($){return this.insertChild(I,$)},insertChild:function($,Q){var J=Q?this.insertChildren($,[Q]):null;return J&&J[0]},addChildren:function($){return this.insertChildren(this._children.length,$)},insertChildren:function($,Q){var J=this._children;if(J&&Q&&Q.length>0){Q=C.slice(Q);var U={};for(var K=Q.length-1;K>=0;K--){var Z=Q[K],H=Z&&Z._id;if(!Z||U[H])Q.splice(K,1);else Z._remove(!1,!0),U[H]=!0}C.splice(J,Q,$,0);var W=this._project,Y=W._changes;for(var K=0,X=Q.length;K<X;K++){var Z=Q[K],A=Z._name;if(Z._parent=this,Z._setProject(W,!0),A)Z.setName(A);if(Y)Z._changed(5)}this._changed(11)}else Q=null;return Q},_insertItem:"#insertChild",_insertAt:function($,Q){var J=$&&$._getOwner(),U=$!==this&&J?this:null;if(U)U._remove(!1,!0),J._insertItem($._index+Q,U);return U},insertAbove:function($){return this._insertAt($,1)},insertBelow:function($){return this._insertAt($,0)},sendToBack:function(){var $=this._getOwner();return $?$._insertItem(0,this):null},bringToFront:function(){var $=this._getOwner();return $?$._insertItem(I,this):null},appendTop:"#addChild",appendBottom:function($){return this.insertChild(0,$)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function($){return $._insertItem(I,this)},copyTo:function($){return this.clone(!1).addTo($)},reduce:function($){var Q=this._children;if(Q&&Q.length===1){var J=Q[0].reduce($);if(this._parent)J.insertAbove(this),this.remove();else J.remove();return J}return this},_removeNamed:function(){var $=this._getOwner();if($){var{_children:Q,_namedChildren:J}=$,U=this._name,K=J[U],Z=K?K.indexOf(this):-1;if(Z!==-1){if(Q[U]==this)delete Q[U];if(K.splice(Z,1),K.length)Q[U]=K[0];else delete J[U]}}},_remove:function($,Q){var J=this._getOwner(),U=this._project,K=this._index;if(this._style)this._style._dispose();if(J){if(this._name)this._removeNamed();if(K!=null){if(U._activeLayer===this)U._activeLayer=this.getNextSibling()||this.getPreviousSibling();C.splice(J._children,null,K,1)}if(this._installEvents(!1),$&&U._changes)this._changed(5);if(Q)J._changed(11,this);return this._parent=null,!0}return!1},remove:function(){return this._remove(!0,!0)},replaceWith:function($){var Q=$&&$.insertBelow(this);if(Q)this.remove();return Q},removeChildren:function($,Q){if(!this._children)return null;$=$||0,Q=C.pick(Q,this._children.length);var J=C.splice(this._children,null,$,Q-$);for(var U=J.length-1;U>=0;U--)J[U]._remove(!0,!1);if(J.length>0)this._changed(11);return J},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var $=0,Q=this._children.length;$<Q;$++)this._children[$]._index=$;this._changed(11)}},isEmpty:function($){var Q=this._children,J=Q?Q.length:0;if($){for(var U=0;U<J;U++)if(!Q[U].isEmpty($))return!1;return!0}return!J},isEditable:function(){var $=this;while($){if(!$._visible||$._locked)return!1;$=$._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function($){function Q(H){var W=[];do W.unshift(H);while(H=H._parent);return W}var J=Q(this),U=Q($);for(var K=0,Z=Math.min(J.length,U.length);K<Z;K++)if(J[K]!=U[K])return J[K]._index<U[K]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return this._parent?this._parent.isInserted():!1},isAbove:function($){return this._getOrder($)===-1},isBelow:function($){return this._getOrder($)===1},isParent:function($){return this._parent===$},isChild:function($){return $&&$._parent===this},isDescendant:function($){var Q=this;while(Q=Q._parent)if(Q===$)return!0;return!1},isAncestor:function($){return $?$.isDescendant(this):!1},isSibling:function($){return this._parent===$._parent},isGroupedWith:function($){var Q=this._parent;while(Q){if(Q._parent&&/^(Group|Layer|CompoundPath)$/.test(Q._class)&&$.isDescendant(Q))return!0;Q=Q._parent}return!1}},C.each(["rotate","scale","shear","skew"],function($){var Q=$==="rotate";this[$]=function(){var J=arguments,U=(Q?C:y).read(J),K=y.read(J,0,{readNull:!0});return this.transform(new q0()[$](U,K||this.getPosition(!0)))}},{translate:function(){var $=new q0;return this.transform($.translate.apply($,arguments))},transform:function($,Q,J){var U=this._matrix,K=$&&!$.isIdentity(),Z=J&&this._canApplyMatrix||this._applyMatrix&&(K||!U.isIdentity()||Q&&this._children);if(!K&&!Z)return this;if(K){if(!$.isInvertible()&&U.isInvertible())U._backup=U.getValues();U.prepend($,!0);var H=this._style,W=H.getFillColor(!0),Y=H.getStrokeColor(!0);if(W)W.transform($);if(Y)Y.transform($)}if(Z&&(Z=this._transformContent(U,Q,J))){var X=this._pivot;if(X)U._transformPoint(X,X,!0);if(U.reset(!0),J&&this._canApplyMatrix)this._applyMatrix=!0}var A=this._bounds,q=this._position;if(K||Z)this._changed(25);var O=K&&A&&$.decompose();if(O&&O.skewing.isZero()&&O.rotation%90===0){for(var F in A){var V=A[F];if(V.nonscaling)delete A[F];else if(Z||!V.internal){var L=V.rect;$._transformBounds(L,L)}}this._bounds=A;var B=A[this._getBoundsCacheKey(this._boundsOptions||{})];if(B)this._position=this._getPositionFromBounds(B.rect)}else if(K&&q&&this._pivot)this._position=$._transformPoint(q,q);return this},_transformContent:function($,Q,J){var U=this._children;if(U){for(var K=0,Z=U.length;K<Z;K++)U[K].transform($,Q,J);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(y.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(y.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(y.read(arguments))},localToParent:function(){return this._matrix._transformPoint(y.read(arguments))},fitBounds:function($,Q){$=t.read(arguments);var J=this.getBounds(),U=J.height/J.width,K=$.height/$.width,Z=(Q?U>K:U<K)?$.width/J.width:$.height/J.height,H=new t(new y,new s(J.width*Z,J.height*Z));H.setCenter($.getCenter()),this.setBounds(H)}}),{_setStyles:function($,Q,J){var U=this._style,K=this._matrix;if(U.hasFill())$.fillStyle=U.getFillColor().toCanvasStyle($,K);if(U.hasStroke()){$.strokeStyle=U.getStrokeColor().toCanvasStyle($,K),$.lineWidth=U.getStrokeWidth();var Z=U.getStrokeJoin(),H=U.getStrokeCap(),W=U.getMiterLimit();if(Z)$.lineJoin=Z;if(H)$.lineCap=H;if(W)$.miterLimit=W;if(W0.support.nativeDash){var Y=U.getDashArray(),X=U.getDashOffset();if(Y&&Y.length)if("setLineDash"in $)$.setLineDash(Y),$.lineDashOffset=X;else $.mozDash=Y,$.mozDashOffset=X}}if(U.hasShadow()){var A=Q.pixelRatio||1,q=J._shiftless().prepend(new q0().scale(A,A)),O=q.transform(new y(U.getShadowBlur(),0)),F=q.transform(this.getShadowOffset());$.shadowColor=U.getShadowColor().toCanvasStyle($),$.shadowBlur=O.getLength(),$.shadowOffsetX=F.x,$.shadowOffsetY=F.y}},draw:function($,Q,J){var U=this._updateVersion=this._project._updateVersion;if(!this._visible||this._opacity===0)return;var{matrices:K,viewMatrix:Z}=Q,H=this._matrix,W=K[K.length-1].appended(H);if(!W.isInvertible())return;if(Z=Z?Z.appended(W):W,K.push(W),Q.updateMatrix)this._globalMatrix=W;var Y=this._blendMode,X=Z0.clamp(this._opacity,0,1),A=Y==="normal",q=q8.nativeModes[Y],O=A&&X===1||Q.dontStart||Q.clip||(q||A&&X<1)&&this._canComposite(),F=Q.pixelRatio||1,V,L,B;if(!O){var D=this.getStrokeBounds(Z);if(!D.width||!D.height){K.pop();return}if(B=Q.offset,L=Q.offset=D.getTopLeft().floor(),V=$,$=L0.getContext(D.getSize().ceil().add(1).multiply(F)),F!==1)$.scale(F,F)}$.save();var _=J?J.appended(H):this._canScaleStroke&&!this.getStrokeScaling(!0)&&Z,T=!O&&Q.clipItem,E=!_||T;if(O){if($.globalAlpha=X,q)$.globalCompositeOperation=Y}else if(E)$.translate(-L.x,-L.y);if(E)(O?H:Z).applyToContext($);if(T)Q.clipItem.draw($,Q.extend({clip:!0}));if(_){$.setTransform(F,0,0,F,0,0);var R=Q.offset;if(R)$.translate(-R.x,-R.y)}if(this._draw($,Q,Z,_),$.restore(),K.pop(),Q.clip&&!Q.dontFinish)$.clip(this.getFillRule());if(!O)q8.process(Y,$,V,X,L.subtract(B).multiply(F)),L0.release($),Q.offset=B},_isUpdated:function($){var Q=this._parent;if(Q instanceof g0)return Q._isUpdated($);var J=this._updateVersion===$;if(!J&&Q&&Q._visible&&Q._isUpdated($))this._updateVersion=$,J=!0;return J},_drawSelection:function($,Q,J,U,K){var Z=this._selection,H=Z&1,W=Z&2||H&&this._selectBounds,Y=Z&4;if(!this._drawSelected)H=!1;if((H||W||Y)&&this._isUpdated(K)){var X,A=this.getSelectedColor(!0)||(X=this.getLayer())&&X.getSelectedColor(!0),q=Q.appended(this.getGlobalMatrix(!0)),O=J/2;if($.strokeStyle=$.fillStyle=A?A.toCanvasStyle($):"#009dec",H)this._drawSelected($,q,U);if(Y){var F=this.getPosition(!0),V=this._parent,L=V?V.localToGlobal(F):F,B=L.x,D=L.y;$.beginPath(),$.arc(B,D,O,0,Math.PI*2,!0),$.stroke();var _=[[0,-1],[1,0],[0,1],[-1,0]],T=O,E=J+1;for(var R=0;R<4;R++){var z=_[R],G=z[0],S=z[1];$.moveTo(B+G*T,D+S*T),$.lineTo(B+G*E,D+S*E),$.stroke()}}if(W){var P=q._transformCorners(this.getInternalBounds());$.beginPath();for(var R=0;R<8;R++)$[!R?"moveTo":"lineTo"](P[R],P[++R]);$.closePath(),$.stroke();for(var R=0;R<8;R++)$.fillRect(P[R]-O,P[++R]-O,J,J)}}},_canComposite:function(){return!1}},C.each(["down","drag","up","move"],function($){this["removeOn"+C.capitalize($)]=function(){var Q={};return Q[$]=!0,this.removeOn(Q)}},{removeOn:function($){for(var Q in $)if($[Q]){var J="mouse"+Q,U=this._project,K=U._removeSets=U._removeSets||{};K[J]=K[J]||{},K[J][this._id]=this}return this}}),{tween:function($,Q,J){if(!J){if(J=Q,Q=$,$=null,!J)J=Q,Q=null}var U=J&&J.easing,K=J&&J.start,Z=J!=null&&(typeof J==="number"?J:J.duration),H=new m8(this,$,Q,Z,U,K);function W(Y){if(H._handleFrame(Y.time*1000),!H.running)this.off("frame",W)}if(Z)this.on("frame",W);return H},tweenTo:function($,Q){return this.tween(null,$,Q)},tweenFrom:function($,Q){return this.tween($,null,Q)}}),d0=Q0.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function $(Q){if(this._children=[],this._namedChildren={},!this._initialize(Q))this.addChildren(Array.isArray(Q)?Q:arguments)},_changed:function $(Q){if($.base.call(this,Q),Q&2050)this._clipItem=I},_getClipItem:function(){var $=this._clipItem;if($===I){$=null;var Q=this._children;for(var J=0,U=Q.length;J<U;J++)if(Q[J]._clipMask){$=Q[J];break}this._clipItem=$}return $},isClipped:function(){return!!this._getClipItem()},setClipped:function($){var Q=this.getFirstChild();if(Q)Q.setClipMask($)},_getBounds:function $(Q,J){var U=this._getClipItem();return U?U._getCachedBounds(U._matrix.prepended(Q),C.set({},J,{stroke:!1})):$.base.call(this,Q,J)},_hitTestChildren:function $(Q,J,U){var K=this._getClipItem();return(!K||K.contains(Q))&&$.base.call(this,Q,J,U,K)},_draw:function($,Q){var J=Q.clip,U=!J&&this._getClipItem();if(Q=Q.extend({clipItem:U,clip:!1}),J)$.beginPath(),Q.dontStart=Q.dontFinish=!0;else if(U)U.draw($,Q.extend({clip:!0}));var K=this._children;for(var Z=0,H=K.length;Z<H;Z++){var W=K[Z];if(W!==U)W.draw($,Q)}}}),t0=d0.extend({_class:"Layer",initialize:function $(){d0.apply(this,arguments)},_getOwner:function(){return this._parent||this._index!=null&&this._project},isInserted:function $(){return this._parent?$.base.call(this):this._index!=null},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),k0=Q0.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function $(Q,J){this._initialize(Q,J)},_equals:function($){return this._type===$._type&&this._size.equals($._size)&&C.equals(this._radius,$._radius)},copyContent:function($){this.setType($._type),this.setSize($._size),this.setRadius($._radius)},getType:function(){return this._type},setType:function($){this._type=$},getShape:"#getType",setShape:"#setType",getSize:function(){var $=this._size;return new m0($.width,$.height,this,"setSize")},setSize:function(){var $=s.read(arguments);if(!this._size)this._size=$.clone();else if(!this._size.equals($)){var Q=this._type,J=$.width,U=$.height;if(Q==="rectangle")this._radius.set(s.min(this._radius,$.divide(2).abs()));else if(Q==="circle")J=U=(J+U)/2,this._radius=J/2;else if(Q==="ellipse")this._radius._set(J/2,U/2);this._size._set(J,U),this._changed(9)}},getRadius:function(){var $=this._radius;return this._type==="circle"?$:new m0($.width,$.height,this,"setRadius")},setRadius:function($){var Q=this._type;if(Q==="circle"){if($===this._radius)return;var J=$*2;this._radius=$,this._size._set(J,J)}else if($=s.read(arguments),!this._radius)this._radius=$.clone();else{if(this._radius.equals($))return;if(this._radius.set($),Q==="rectangle"){var J=s.max(this._size,$.multiply(2));this._size.set(J)}else if(Q==="ellipse")this._size._set($.width*2,$.height*2)}this._changed(9)},isEmpty:function(){return!1},toPath:function($){var Q=new X0[C.capitalize(this._type)]({center:new y,size:this._size,radius:this._radius,insert:!1});if(Q.copyAttributes(this),W0.settings.applyMatrix)Q.setApplyMatrix(!0);if($===I||$)Q.insertAbove(this);return Q},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function($,Q,J,U){var K=this._style,Z=K.hasFill(),H=K.hasStroke(),W=Q.dontFinish||Q.clip,Y=!U;if(Z||H||W){var X=this._type,A=this._radius,q=X==="circle";if(!Q.dontStart)$.beginPath();if(Y&&q)$.arc(0,0,A,0,Math.PI*2,!0);else{var O=q?A:A.width,F=q?A:A.height,V=this._size,L=V.width,B=V.height;if(Y&&X==="rectangle"&&O===0&&F===0)$.rect(-L/2,-B/2,L,B);else{var D=L/2,_=B/2,T=0.44771525016920644,E=O*T,R=F*T,z=[-D,-_+F,-D,-_+R,-D+E,-_,-D+O,-_,D-O,-_,D-E,-_,D,-_+R,D,-_+F,D,_-F,D,_-R,D-E,_,D-O,_,-D+O,_,-D+E,_,-D,_-R,-D,_-F];if(U)U.transform(z,z,32);if($.moveTo(z[0],z[1]),$.bezierCurveTo(z[2],z[3],z[4],z[5],z[6],z[7]),D!==O)$.lineTo(z[8],z[9]);if($.bezierCurveTo(z[10],z[11],z[12],z[13],z[14],z[15]),_!==F)$.lineTo(z[16],z[17]);if($.bezierCurveTo(z[18],z[19],z[20],z[21],z[22],z[23]),D!==O)$.lineTo(z[24],z[25]);$.bezierCurveTo(z[26],z[27],z[28],z[29],z[30],z[31])}}$.closePath()}if(!W&&(Z||H)){if(this._setStyles($,Q,J),Z)$.fill(K.getFillRule()),$.shadowColor="rgba(0,0,0,0)";if(H)$.stroke()}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function($,Q){var J=new t(this._size).setCenter(0,0),U=this._style,K=Q.stroke&&U.hasStroke()&&U.getStrokeWidth();if($)J=$._transformBounds(J);return K?J.expand(X0._getStrokePadding(K,this._getStrokeMatrix($,Q))):J}},new function(){function $(J,U,K){var Z=J._radius;if(!Z.isZero()){var H=J._size.divide(2);for(var W=1;W<=4;W++){var Y=new y(W>1&&W<4?-1:1,W>2?-1:1),X=Y.multiply(H),A=X.subtract(Y.multiply(Z)),q=new t(K?X.add(Y.multiply(K)):X,A);if(q.contains(U))return{point:A,quadrant:W}}}}function Q(J,U,K,Z){var H=J.divide(U);return(!Z||H.isInQuadrant(Z))&&H.subtract(H.normalize()).multiply(U).divide(K).length<=1}return{_contains:function J(U){if(this._type==="rectangle"){var K=$(this,U);return K?U.subtract(K.point).divide(this._radius).getLength()<=1:J.base.call(this,U)}else return U.divide(this.size).getLength()<=0.5},_hitTestSelf:function J(U,K,Z,H){var W=!1,Y=this._style,X=K.stroke&&Y.hasStroke(),A=K.fill&&Y.hasFill();if(X||A){var q=this._type,O=this._radius,F=X?Y.getStrokeWidth()/2:0,V=K._tolerancePadding.add(X0._getStrokePadding(F,!Y.getStrokeScaling()&&H));if(q==="rectangle"){var L=V.multiply(2),B=$(this,U,L);if(B)W=Q(U.subtract(B.point),O,V,B.quadrant);else{var D=new t(this._size).setCenter(0,0),_=D.expand(L),T=D.expand(L.negate());W=_._containsPoint(U)&&!T._containsPoint(U)}}else W=Q(U,O,V)}return W?new p0(X?"stroke":"fill",this):J.base.apply(this,arguments)}}},{statics:new function(){function $(Q,J,U,K,Z){var H=C.create(k0.prototype);return H._type=Q,H._size=U,H._radius=K,H._initialize(C.getNamed(Z),J),H}return{Circle:function(){var Q=arguments,J=y.readNamed(Q,"center"),U=C.readNamed(Q,"radius");return $("circle",J,new s(U*2),U,Q)},Rectangle:function(){var Q=arguments,J=t.readNamed(Q,"rectangle"),U=s.min(s.readNamed(Q,"radius"),J.getSize(!0).divide(2));return $("rectangle",J.getCenter(!0),J.getSize(!0),U,Q)},Ellipse:function(){var Q=arguments,J=k0._readEllipse(Q),U=J.radius;return $("ellipse",J.center,U.multiply(2),U,Q)},_readEllipse:function(Q){var J,U;if(C.hasNamed(Q,"radius"))J=y.readNamed(Q,"center"),U=s.readNamed(Q,"radius");else{var K=t.readNamed(Q,"rectangle");J=K.getCenter(!0),U=K.getSize(!0).divide(2)}return{center:J,radius:U}}}}}),e0=Q0.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function $(Q,J){if(!this._initialize(Q,J!==I&&y.read(arguments))){var U,K=typeof Q,Z=K==="string"?g.getElementById(Q):K==="object"?Q:null;if(Z&&Z!==Q0.NO_INSERT){if(Z.getContext||Z.naturalHeight!=null)U=Z;else if(Z){var H=s.read(arguments);if(!H.isZero())U=L0.getCanvas(H)}}if(U)this.setImage(U);else this.setSource(Q)}if(!this._size)this._size=new s,this._loaded=!1},_equals:function($){return this.getSource()===$.getSource()},copyContent:function($){var{_image:Q,_canvas:J}=$;if(Q)this._setImage(Q);else if(J){var U=L0.getCanvas($._size);U.getContext("2d").drawImage(J,0,0),this._setImage(U)}this._crossOrigin=$._crossOrigin},getSize:function(){var $=this._size;return new m0($?$.width:0,$?$.height:0,this,"setSize")},setSize:function($,Q){var J=s.read(arguments);if(!J.equals(this._size))if(J.width>0&&J.height>0){var U=!Q&&this.getElement();if(this._setImage(L0.getCanvas(J)),U)this.getContext(!0).drawImage(U,0,0,J.width,J.height)}else{if(this._canvas)L0.release(this._canvas);this._size=J.clone()}else if(Q)this.clear()},getWidth:function(){return this._size?this._size.width:0},setWidth:function($){this.setSize($,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function($){this.setSize(this.getWidth(),$)},getLoaded:function(){return this._loaded},isEmpty:function(){var $=this._size;return!$||$.width===0&&$.height===0},getResolution:function(){var $=this._matrix,Q=new y(0,0).transform($),J=new y(1,0).transform($).subtract(Q),U=new y(0,1).transform($).subtract(Q);return new s(72/J.getLength(),72/U.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function($){var Q=this;function J(U){var K=Q.getView(),Z=U&&U.type||"load";if(K&&Q.responds(Z))W0=K._scope,Q.emit(Z,new K8(U))}if(this._setImage($),this._loaded)setTimeout(J,0);else if($)I0.add($,{load:function(U){Q._setImage($),J(U)},error:J})},_setImage:function($){if(this._canvas)L0.release(this._canvas);if($&&$.getContext)this._image=null,this._canvas=$,this._loaded=!0;else this._image=$,this._canvas=null,this._loaded=!!($&&$.src&&$.complete);this._size=new s($?$.naturalWidth||$.width:0,$?$.naturalHeight||$.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var $=L0.getContext(this._size);try{if(this._image)$.drawImage(this._image,0,0);this._canvas=$.canvas}catch(Q){L0.release($)}}return this._canvas},setCanvas:"#setImage",getContext:function($){if(!this._context)this._context=this.getCanvas().getContext("2d");if($)this._image=null,this._changed(1025);return this._context},setContext:function($){this._context=$},getSource:function(){var $=this._image;return $&&$.src||this.toDataURL()},setSource:function($){var Q=new M.Image,J=this._crossOrigin;if(J)Q.crossOrigin=J;if($)Q.src=$;this.setImage(Q)},getCrossOrigin:function(){var $=this._image;return $&&$.crossOrigin||this._crossOrigin||""},setCrossOrigin:function($){this._crossOrigin=$;var Q=this._image;if(Q)Q.crossOrigin=$},getSmoothing:function(){return this._smoothing},setSmoothing:function($){this._smoothing=typeof $==="string"?$:$?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var $=t.read(arguments),Q=L0.getContext($.getSize());return Q.drawImage(this.getCanvas(),$.x,$.y,$.width,$.height,0,0,$.width,$.height),Q.canvas},getSubRaster:function(){var $=t.read(arguments),Q=new e0(Q0.NO_INSERT);return Q._setImage(this.getSubCanvas($)),Q.translate($.getCenter().subtract(this.getSize().divide(2))),Q._matrix.prepend(this._matrix),Q.insertAbove(this),Q},toDataURL:function(){var $=this._image,Q=$&&$.src;if(/^data:/.test(Q))return Q;var J=this.getCanvas();return J?J.toDataURL.apply(J,arguments):null},drawImage:function($){var Q=y.read(arguments,1);this.getContext(!0).drawImage($,Q.x,Q.y)},getAverageColor:function($){var Q,J;if(!$)Q=this.getBounds();else if($ instanceof r0)J=$,Q=$.getBounds();else if(typeof $==="object"){if("width"in $)Q=new t($);else if("x"in $)Q=new t($.x-0.5,$.y-0.5,1,1)}if(!Q)return null;var U=32,K=Math.min(Q.width,U),Z=Math.min(Q.height,U),H=e0._sampleContext;if(!H)H=e0._sampleContext=L0.getContext(new s(U));else H.clearRect(0,0,U+1,U+1);H.save();var W=new q0().scale(K/Q.width,Z/Q.height).translate(-Q.x,-Q.y);if(W.applyToContext(H),J)J.draw(H,new C({clip:!0,matrices:[W]}));this._matrix.applyToContext(H);var Y=this.getElement(),X=this._size;if(Y)H.drawImage(Y,-X.width/2,-X.height/2);H.restore();var A=H.getImageData(0.5,0.5,Math.ceil(K),Math.ceil(Z)).data,q=[0,0,0],O=0;for(var F=0,V=A.length;F<V;F+=4){var L=A[F+3];O+=L,L/=255,q[0]+=A[F]*L,q[1]+=A[F+1]*L,q[2]+=A[F+2]*L}for(var F=0;F<3;F++)q[F]/=O;return O?z0.read(q):null},getPixel:function(){var $=y.read(arguments),Q=this.getContext().getImageData($.x,$.y,1,1).data;return new z0("rgb",[Q[0]/255,Q[1]/255,Q[2]/255],Q[3]/255)},setPixel:function(){var $=arguments,Q=y.read($),J=z0.read($),U=J._convert("rgb"),K=J._alpha,Z=this.getContext(!0),H=Z.createImageData(1,1),W=H.data;W[0]=U[0]*255,W[1]=U[1]*255,W[2]=U[2]*255,W[3]=K!=null?K*255:255,Z.putImageData(H,Q.x,Q.y)},clear:function(){var $=this._size;this.getContext(!0).clearRect(0,0,$.width+1,$.height+1)},createImageData:function(){var $=s.read(arguments);return this.getContext().createImageData($.width,$.height)},getImageData:function(){var $=t.read(arguments);if($.isEmpty())$=new t(this._size);return this.getContext().getImageData($.x,$.y,$.width,$.height)},putImageData:function($){var Q=y.read(arguments,1);this.getContext(!0).putImageData($,Q.x,Q.y)},setImageData:function($){this.setSize($),this.getContext(!0).putImageData($,0,0)},_getBounds:function($,Q){var J=new t(this._size).setCenter(0,0);return $?$._transformBounds(J):J},_hitTestSelf:function($){if(this._contains($)){var Q=this;return new p0("pixel",Q,{offset:$.add(Q._size.divide(2)).round(),color:{get:function(){return Q.getPixel(this.offset)}}})}},_draw:function($,Q,J){var U=this.getElement();if(U&&U.width>0&&U.height>0){$.globalAlpha=Z0.clamp(this._opacity,0,1),this._setStyles($,Q,J);var K=this._smoothing,Z=K==="off";V0.setPrefixed($,Z?"imageSmoothingEnabled":"imageSmoothingQuality",Z?!1:K),$.drawImage(U,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),F8=Q0.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function $(Q,J){if(!this._initialize(Q,J!==I&&y.read(arguments,1)))this.setDefinition(Q instanceof l0?Q:new l0(Q))},_equals:function($){return this._definition===$._definition},copyContent:function($){this.setDefinition($._definition)},getDefinition:function(){return this._definition},setDefinition:function($){this._definition=$,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function($,Q){var J=this._definition._item;return J._getCachedBounds(J._matrix.prepended($),Q)},_hitTestSelf:function($,Q,J){var U=Q.extend({all:!1}),K=this._definition._item._hitTest($,U,J);if(K)K.item=this;return K},_draw:function($,Q){this._definition._item.draw($,Q)}}),l0=C.extend({_class:"SymbolDefinition",initialize:function $(Q,J){if(this._id=b0.get(),this.project=W0.project,Q)this.setItem(Q,J)},_serialize:function($,Q){return Q.add(this,function(){return C.serialize([this._class,this._item],$,!1,Q)})},_changed:function($){if($&8)Q0._clearBoundsCache(this);if($&1)this.project._changed($)},getItem:function(){return this._item},setItem:function($,Q){if($._symbol)$=$.clone();if(this._item)this._item._symbol=null;if(this._item=$,$.remove(),$.setSelected(!1),!Q)$.setPosition(new y);$._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function($){return new F8(this,$)},clone:function(){return new l0(this._item.clone(!1))},equals:function($){return $===this||$&&this._item.equals($._item)||!1}}),p0=C.extend({_class:"HitResult",initialize:function $(Q,J,U){if(this.type=Q,this.item=J,U)this.inject(U)},statics:{getOptions:function($){var Q=$&&C.read($);return new C({type:null,tolerance:W0.settings.hitTolerance,fill:!Q,stroke:!Q,segments:!Q,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},Q)}}}),i=C.extend({_class:"Segment",beans:!0,_selection:0,initialize:function $(Q,J,U,K,Z,H){var W=arguments.length,Y,X,A,q;if(W>0)if(Q==null||typeof Q==="object")if(W===1&&Q&&"point"in Q)Y=Q.point,X=Q.handleIn,A=Q.handleOut,q=Q.selection;else Y=Q,X=J,A=U,q=K;else Y=[Q,J],X=U!==I?[U,K]:null,A=Z!==I?[Z,H]:null;if(new T8(Y,this,"_point"),new T8(X,this,"_handleIn"),new T8(A,this,"_handleOut"),q)this.setSelection(q)},_serialize:function($,Q){var J=this._point,U=this._selection,K=U||this.hasHandles()?[J,this._handleIn,this._handleOut]:J;if(U)K.push(U);return C.serialize(K,$,!0,Q)},_changed:function($){var Q=this._path;if(!Q)return;var J=Q._curves,U=this._index,K;if(J){if((!$||$===this._point||$===this._handleIn)&&(K=U>0?J[U-1]:Q._closed?J[J.length-1]:null))K._changed();if((!$||$===this._point||$===this._handleOut)&&(K=J[U]))K._changed()}Q._changed(41)},getPoint:function(){return this._point},setPoint:function(){this._point.set(y.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(y.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(y.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var $=this._handleIn,Q=this._handleOut;return!$.isZero()&&!Q.isZero()&&$.isCollinear(Q)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function($){var Q=this._selection,J=this._path;if(this._selection=$=$||0,J&&$!==Q)J._updateSelection(this,Q,$),J._changed(257)},_changeSelection:function($,Q){var J=this._selection;this.setSelection(Q?J|$:J&~$)},isSelected:function(){return!!(this._selection&7)},setSelected:function($){this._changeSelection(7,$)},getIndex:function(){return this._index!==I?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var $=this._path,Q=this._index;if($){if(Q>0&&!$._closed&&Q===$._segments.length-1)Q--;return $.getCurves()[Q]||null}return null},getLocation:function(){var $=this.getCurve();return $?new u0($,this===$._segment1?0:1):null},getNext:function(){var $=this._path&&this._path._segments;return $&&($[this._index+1]||this._path._closed&&$[0])||null},smooth:function($,Q,J){var U=$||{},K=U.type,Z=U.factor,H=this.getPrevious(),W=this.getNext(),Y=(H||this)._point,X=this._point,A=(W||this)._point,q=Y.getDistance(X),O=X.getDistance(A);if(!K||K==="catmull-rom"){var F=Z===I?0.5:Z,V=Math.pow(q,F),L=V*V,B=Math.pow(O,F),D=B*B;if(!Q&&H){var _=2*D+3*B*V+L,T=3*B*(B+V);this.setHandleIn(T!==0?new y((D*Y._x+_*X._x-L*A._x)/T-X._x,(D*Y._y+_*X._y-L*A._y)/T-X._y):new y)}if(!J&&W){var _=2*L+3*V*B+D,T=3*V*(V+B);this.setHandleOut(T!==0?new y((L*A._x+_*X._x-D*Y._x)/T-X._x,(L*A._y+_*X._y-D*Y._y)/T-X._y):new y)}}else if(K==="geometric"){if(H&&W){var E=Y.subtract(A),R=Z===I?0.4:Z,z=R*q/(q+O);if(!Q)this.setHandleIn(E.multiply(z));if(!J)this.setHandleOut(E.multiply(z-R))}}else throw new Error("Smoothing method \'"+K+"\' not supported.")},getPrevious:function(){var $=this._path&&this._path._segments;return $&&($[this._index-1]||this._path._closed&&$[$.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var $=this._path;return $&&this._index===$._segments.length-1||!1},reverse:function(){var $=this._handleIn,Q=this._handleOut,J=$.clone();$.set(Q),Q.set(J)},reversed:function(){return new i(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new i(this._point,this._handleIn,this._handleOut)},equals:function($){return $===this||$&&this._class===$._class&&this._point.equals($._point)&&this._handleIn.equals($._handleIn)&&this._handleOut.equals($._handleOut)||!1},toString:function(){var $=["point: "+this._point];if(!this._handleIn.isZero())$.push("handleIn: "+this._handleIn);if(!this._handleOut.isZero())$.push("handleOut: "+this._handleOut);return"{ "+$.join(", ")+" }"},transform:function($){this._transformCoordinates($,new Array(6),!0),this._changed()},interpolate:function($,Q,J){var U=1-J,K=J,Z=$._point,H=Q._point,W=$._handleIn,Y=Q._handleIn,X=Q._handleOut,A=$._handleOut;this._point._set(U*Z._x+K*H._x,U*Z._y+K*H._y,!0),this._handleIn._set(U*W._x+K*Y._x,U*W._y+K*Y._y,!0),this._handleOut._set(U*A._x+K*X._x,U*A._y+K*X._y,!0),this._changed()},_transformCoordinates:function($,Q,J){var U=this._point,K=!J||!this._handleIn.isZero()?this._handleIn:null,Z=!J||!this._handleOut.isZero()?this._handleOut:null,H=U._x,W=U._y,Y=2;if(Q[0]=H,Q[1]=W,K)Q[Y++]=K._x+H,Q[Y++]=K._y+W;if(Z)Q[Y++]=Z._x+H,Q[Y++]=Z._y+W;if($)if($._transformCoordinates(Q,Q,Y/2),H=Q[0],W=Q[1],J){if(U._x=H,U._y=W,Y=2,K)K._x=Q[Y++]-H,K._y=Q[Y++]-W;if(Z)Z._x=Q[Y++]-H,Z._y=Q[Y++]-W}else{if(!K)Q[Y++]=H,Q[Y++]=W;if(!Z)Q[Y++]=H,Q[Y++]=W}return Q}}),T8=y.extend({initialize:function $(Q,J,U){var K,Z,H;if(!Q)K=Z=0;else if((K=Q[0])!==I)Z=Q[1];else{var W=Q;if((K=W.x)===I)W=y.read(arguments),K=W.x;Z=W.y,H=W.selected}if(this._x=K,this._y=Z,this._owner=J,J[U]=this,H)this.setSelected(!0)},_set:function($,Q){return this._x=$,this._y=Q,this._owner._changed(this),this},getX:function(){return this._x},setX:function($){this._x=$,this._owner._changed(this)},getY:function(){return this._y},setY:function($){this._y=$,this._owner._changed(this)},isZero:function(){var $=Z0.isZero;return $(this._x)&&$(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function($){this._owner._changeSelection(this._getSelection(),$)},_getSelection:function(){var $=this._owner;return this===$._point?1:this===$._handleIn?2:this===$._handleOut?4:0}}),p=C.extend({_class:"Curve",beans:!0,initialize:function $(Q,J,U,K,Z,H,W,Y){var X=arguments.length,A,q,O,F,V,L;if(X===3)this._path=Q,A=J,q=U;else if(!X)A=new i,q=new i;else if(X===1){if("segment1"in Q)A=new i(Q.segment1),q=new i(Q.segment2);else if("point1"in Q)O=Q.point1,V=Q.handle1,L=Q.handle2,F=Q.point2;else if(Array.isArray(Q))O=[Q[0],Q[1]],F=[Q[6],Q[7]],V=[Q[2]-Q[0],Q[3]-Q[1]],L=[Q[4]-Q[6],Q[5]-Q[7]]}else if(X===2)A=new i(Q),q=new i(J);else if(X===4)O=Q,V=J,L=U,F=K;else if(X===8)O=[Q,J],F=[W,Y],V=[U-Q,K-J],L=[Z-W,H-Y];this._segment1=A||new i(O,null,V),this._segment2=q||new i(F,L,null)},_serialize:function($,Q){return C.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],$,!0,Q)},_changed:function(){this._length=this._bounds=I},clone:function(){return new p(this._segment1,this._segment2)},toString:function(){var $=["point1: "+this._segment1._point];if(!this._segment1._handleOut.isZero())$.push("handle1: "+this._segment1._handleOut);if(!this._segment2._handleIn.isZero())$.push("handle2: "+this._segment2._handleIn);return $.push("point2: "+this._segment2._point),"{ "+$.join(", ")+" }"},classify:function(){return p.classify(this.getValues())},remove:function(){var $=!1;if(this._path){var Q=this._segment2,J=Q._handleOut;if($=Q.remove(),$)this._segment1._handleOut.set(J)}return $},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(y.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(y.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(y.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(y.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var $=this._path&&this._path._curves;return $&&($[this._segment1._index+1]||this._path._closed&&$[0])||null},getPrevious:function(){var $=this._path&&this._path._curves;return $&&($[this._segment1._index-1]||this._path._closed&&$[$.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var $=this._path;return $&&this._segment1._index===$._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function($){this.getPoint1().setSelected($),this.getHandle1().setSelected($),this.getHandle2().setSelected($),this.getPoint2().setSelected($)},getValues:function($){return p.getValues(this._segment1,this._segment2,$)},getPoints:function(){var $=this.getValues(),Q=[];for(var J=0;J<8;J+=2)Q.push(new y($[J],$[J+1]));return Q}},{getLength:function(){if(this._length==null)this._length=p.getLength(this.getValues(),0,1);return this._length},getArea:function(){return p.getArea(this.getValues())},getLine:function(){return new G0(this._segment1._point,this._segment2._point)},getPart:function($,Q){return new p(p.getPart(this.getValues(),$,Q))},getPartLength:function($,Q){return p.getLength(this.getValues(),$,Q)},divideAt:function($){return this.divideAtTime($&&$.curve===this?$.time:this.getTimeAt($))},divideAtTime:function($,Q){var J=0.00000001,U=1-J,K=null;if($>=J&&$<=U){var Z=p.subdivide(this.getValues(),$),H=Z[0],W=Z[1],Y=Q||this.hasHandles(),X=this._segment1,A=this._segment2,q=this._path;if(Y)X._handleOut._set(H[2]-H[0],H[3]-H[1]),A._handleIn._set(W[4]-W[6],W[5]-W[7]);var O=H[6],F=H[7],V=new i(new y(O,F),Y&&new y(H[4]-O,H[5]-F),Y&&new y(W[2]-O,W[3]-F));if(q)q.insert(X._index+1,V),K=this.getNext();else this._segment2=V,this._changed(),K=new p(V,A)}return K},splitAt:function($){var Q=this._path;return Q?Q.splitAt($):null},splitAtTime:function($){return this.splitAt(this.getLocationAtTime($))},divide:function($,Q){return this.divideAtTime($===I?0.5:Q?$:this.getTimeAt($))},split:function($,Q){return this.splitAtTime($===I?0.5:Q?$:this.getTimeAt($))},reversed:function(){return new p(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function($,Q,J,U){var{_point:K,_handleOut:Z}=$,H=Q._handleIn,W=Q._point,Y=K.x,X=K.y,A=W.x,q=W.y,O=U?[Y,X,Y,X,A,q,A,q]:[Y,X,Y+Z._x,X+Z._y,A+H._x,q+H._y,A,q];if(J)J._transformCoordinates(O,O,4);return O},subdivide:function($,Q){var J=$[0],U=$[1],K=$[2],Z=$[3],H=$[4],W=$[5],Y=$[6],X=$[7];if(Q===I)Q=0.5;var A=1-Q,q=A*J+Q*K,O=A*U+Q*Z,F=A*K+Q*H,V=A*Z+Q*W,L=A*H+Q*Y,B=A*W+Q*X,D=A*q+Q*F,_=A*O+Q*V,T=A*F+Q*L,E=A*V+Q*B,R=A*D+Q*T,z=A*_+Q*E;return[[J,U,q,O,D,_,R,z],[R,z,T,E,L,B,Y,X]]},getMonoCurves:function($,Q){var J=[],U=Q?0:1,K=$[U+0],Z=$[U+2],H=$[U+4],W=$[U+6];if(K>=Z===Z>=H&&Z>=H===H>=W||p.isStraight($))J.push($);else{var Y=3*(Z-H)-K+W,X=2*(K+H)-4*Z,A=Z-K,q=0.00000001,O=1-q,F=[],V=Z0.solveQuadratic(Y,X,A,F,q,O);if(!V)J.push($);else{F.sort();var L=F[0],B=p.subdivide($,L);if(J.push(B[0]),V>1)L=(F[1]-L)/(1-L),B=p.subdivide(B[1],L),J.push(B[0]);J.push(B[1])}}return J},solveCubic:function($,Q,J,U,K,Z){var H=$[Q],W=$[Q+2],Y=$[Q+4],X=$[Q+6],A=0;if(!(H<J&&X<J&&W<J&&Y<J||H>J&&X>J&&W>J&&Y>J)){var q=3*(W-H),O=3*(Y-W)-q,F=X-H-q-O;A=Z0.solveCubic(F,O,q,H-J,U,K,Z)}return A},getTimeOf:function($,Q){var J=new y($[0],$[1]),U=new y($[6],$[7]),K=0.000000000001,Z=0.0000001,H=Q.isClose(J,K)?0:Q.isClose(U,K)?1:null;if(H===null){var W=[Q.x,Q.y],Y=[];for(var X=0;X<2;X++){var A=p.solveCubic($,X,W[X],Y,0,1);for(var q=0;q<A;q++){var O=Y[q];if(Q.isClose(p.getPoint($,O),Z))return O}}}return Q.isClose(J,Z)?0:Q.isClose(U,Z)?1:null},getNearestTime:function($,Q){if(p.isStraight($)){var J=$[0],U=$[1],K=$[6],Z=$[7],H=K-J,W=Z-U,Y=H*H+W*W;if(Y===0)return 0;var X=((Q.x-J)*H+(Q.y-U)*W)/Y;return X<0.000000000001?0:X>0.999999999999?1:p.getTimeOf($,new y(J+X*H,U+X*W))}var A=100,q=Infinity,O=0;function F(B){if(B>=0&&B<=1){var D=Q.getDistance(p.getPoint($,B),!0);if(D<q)return q=D,O=B,!0}}for(var V=0;V<=A;V++)F(V/A);var L=1/(A*2);while(L>0.00000001)if(!F(O-L)&&!F(O+L))L/=2;return O},getPart:function($,Q,J){var U=Q>J;if(U){var K=Q;Q=J,J=K}if(Q>0)$=p.subdivide($,Q)[1];if(J<1)$=p.subdivide($,(J-Q)/(1-Q))[0];return U?[$[6],$[7],$[4],$[5],$[2],$[3],$[0],$[1]]:$},isFlatEnough:function($,Q){var J=$[0],U=$[1],K=$[2],Z=$[3],H=$[4],W=$[5],Y=$[6],X=$[7],A=3*K-2*J-Y,q=3*Z-2*U-X,O=3*H-2*Y-J,F=3*W-2*X-U;return Math.max(A*A,O*O)+Math.max(q*q,F*F)<=16*Q*Q},getArea:function($){var Q=$[0],J=$[1],U=$[2],K=$[3],Z=$[4],H=$[5],W=$[6],Y=$[7];return 3*((Y-J)*(U+Z)-(W-Q)*(K+H)+K*(Q-Z)-U*(J-H)+Y*(Z+Q/3)-W*(H+J/3))/20},getBounds:function($){var Q=$.slice(0,2),J=Q.slice(),U=[0,0];for(var K=0;K<2;K++)p._addBounds($[K],$[K+2],$[K+4],$[K+6],K,0,Q,J,U);return new t(Q[0],Q[1],J[0]-Q[0],J[1]-Q[1])},_addBounds:function($,Q,J,U,K,Z,H,W,Y){function X(R,z){var G=R-z,S=R+z;if(G<H[K])H[K]=G;if(S>W[K])W[K]=S}Z/=2;var A=H[K]+Z,q=W[K]-Z;if($<A||Q<A||J<A||U<A||$>q||Q>q||J>q||U>q)if(Q<$!=Q<U&&J<$!=J<U)X($,0),X(U,0);else{var O=3*(Q-J)-$+U,F=2*($+J)-4*Q,V=Q-$,L=Z0.solveQuadratic(O,F,V,Y),B=0.00000001,D=1-B;X(U,0);for(var _=0;_<L;_++){var T=Y[_],E=1-T;if(B<=T&&T<=D)X(E*E*E*$+3*E*E*T*Q+3*E*T*T*J+T*T*T*U,Z)}}}}},C.each(["getBounds","getStrokeBounds","getHandleBounds"],function($){this[$]=function(){if(!this._bounds)this._bounds={};var Q=this._bounds[$];if(!Q)Q=this._bounds[$]=X0[$]([this._segment1,this._segment2],!1,this._path);return Q.clone()}},{}),C.each({isStraight:function($,Q,J,U){if(Q.isZero()&&J.isZero())return!0;else{var K=U.subtract($);if(K.isZero())return!1;else if(K.isCollinear(Q)&&K.isCollinear(J)){var Z=new G0($,U),H=0.0000001;if(Z.getDistance($.add(Q))<H&&Z.getDistance(U.add(J))<H){var W=K.dot(K),Y=K.dot(Q)/W,X=K.dot(J)/W;return Y>=0&&Y<=1&&X<=0&&X>=-1}}}return!1},isLinear:function($,Q,J,U){var K=U.subtract($).divide(3);return Q.equals(K)&&J.negate().equals(K)}},function($,Q){this[Q]=function(J){var U=this._segment1,K=this._segment2;return $(U._point,U._handleOut,K._handleIn,K._point,J)},this.statics[Q]=function(J,U){var K=J[0],Z=J[1],H=J[6],W=J[7];return $(new y(K,Z),new y(J[2]-K,J[3]-Z),new y(J[4]-H,J[5]-W),new y(H,W),U)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function($){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>($||0)},isCollinear:function($){return $&&this.isStraight()&&$.isStraight()&&this.getLine().isCollinear($.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(0.5).y)<0.00000001},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(0.5).x)<0.00000001}}),{beans:!1,getLocationAt:function($,Q){return this.getLocationAtTime(Q?$:this.getTimeAt($))},getLocationAtTime:function($){return $!=null&&$>=0&&$<=1?new u0(this,$):null},getTimeAt:function($,Q){return p.getTimeAt(this.getValues(),$,Q)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var $=y.read(arguments);return $.isZero()?[]:p.getTimesWithTangent(this.getValues(),$)},getOffsetAtTime:function($){return this.getPartLength(0,$)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(y.read(arguments)))},getOffsetOf:function(){var $=this.getLocationOf.apply(this,arguments);return $?$.getOffset():null},getTimeOf:function(){return p.getTimeOf(this.getValues(),y.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var $=y.read(arguments),Q=this.getValues(),J=p.getNearestTime(Q,$),U=p.getPoint(Q,J);return new u0(this,J,U,null,$.getDistance(U))},getNearestPoint:function(){var $=this.getNearestLocation.apply(this,arguments);return $?$.getPoint():$}},new function(){var $=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return C.each($,function(Q){this[Q+"At"]=function(J,U){var K=this.getValues();return p[Q](K,U?J:p.getTimeAt(K,J))},this[Q+"AtTime"]=function(J){return p[Q](this.getValues(),J)}},{statics:{_evaluateMethods:$}})},new function(){function $(U){var K=U[0],Z=U[1],H=U[2],W=U[3],Y=U[4],X=U[5],A=U[6],q=U[7],O=9*(H-Y)+3*(A-K),F=6*(K+Y)-12*H,V=3*(H-K),L=9*(W-X)+3*(q-Z),B=6*(Z+X)-12*W,D=3*(W-Z);return function(_){var T=(O*_+F)*_+V,E=(L*_+B)*_+D;return Math.sqrt(T*T+E*E)}}function Q(U,K){return Math.max(2,Math.min(16,Math.ceil(Math.abs(K-U)*32)))}function J(U,K,Z,H){if(K==null||K<0||K>1)return null;var W=U[0],Y=U[1],X=U[2],A=U[3],q=U[4],O=U[5],F=U[6],V=U[7],L=Z0.isZero;if(L(X-W)&&L(A-Y))X=W,A=Y;if(L(q-F)&&L(O-V))q=F,O=V;var B=3*(X-W),D=3*(q-X)-B,_=F-W-B-D,T=3*(A-Y),E=3*(O-A)-T,R=V-Y-T-E,z,G;if(Z===0)z=K===0?W:K===1?F:((_*K+D)*K+B)*K+W,G=K===0?Y:K===1?V:((R*K+E)*K+T)*K+Y;else{var S=0.00000001,P=1-S;if(K<S)z=B,G=T;else if(K>P)z=3*(F-q),G=3*(V-O);else z=(3*_*K+2*D)*K+B,G=(3*R*K+2*E)*K+T;if(H){if(z===0&&G===0&&(K<S||K>P))z=q-X,G=O-A;var w=Math.sqrt(z*z+G*G);if(w)z/=w,G/=w}if(Z===3){var q=6*_*K+2*D,O=6*R*K+2*E,k=Math.pow(z*z+G*G,1.5);z=k!==0?(z*O-G*q)/k:0,G=0}}return Z===2?new y(G,-z):new y(z,G)}return{statics:{classify:function(U){var K=U[0],Z=U[1],H=U[2],W=U[3],Y=U[4],X=U[5],A=U[6],q=U[7],O=K*(q-X)+Z*(Y-A)+A*X-q*Y,F=H*(Z-q)+W*(A-K)+K*q-Z*A,V=Y*(W-Z)+X*(K-H)+H*Z-W*K,L=3*V,B=L-F,D=B-F+O,_=Math.sqrt(D*D+B*B+L*L),T=_!==0?1/_:0,E=Z0.isZero,R="serpentine";D*=T,B*=T,L*=T;function z(w,k,x){var b=k!==I,f=b&&k>0&&k<1,h=b&&x>0&&x<1;if(b&&(!(f||h)||w==="loop"&&!(f&&h)))w="arch",f=h=!1;return{type:w,roots:f||h?f&&h?k<x?[k,x]:[x,k]:[f?k:x]:null}}if(E(D))return E(B)?z(E(L)?"line":"quadratic"):z(R,L/(3*B));var G=3*B*B-4*D*L;if(E(G))return z("cusp",B/(2*D));var S=G>0?Math.sqrt(G/3):Math.sqrt(-G),P=2*D;return z(G>0?R:"loop",(B+S)/P,(B-S)/P)},getLength:function(U,K,Z,H){if(K===I)K=0;if(Z===I)Z=1;if(p.isStraight(U)){var W=U;if(Z<1)W=p.subdivide(W,Z)[0],K/=Z;if(K>0)W=p.subdivide(W,K)[1];var Y=W[6]-W[0],X=W[7]-W[1];return Math.sqrt(Y*Y+X*X)}return Z0.integrate(H||$(U),K,Z,Q(K,Z))},getTimeAt:function(U,K,Z){if(Z===I)Z=K<0?1:0;if(K===0)return Z;var H=Math.abs,W=0.000000000001,Y=K>0,X=Y?Z:0,A=Y?1:Z,q=$(U),O=p.getLength(U,X,A,q),F=H(K)-O;if(H(F)<W)return Y?A:X;else if(F>W)return null;var V=K/O,L=0;function B(D){return L+=Z0.integrate(q,Z,D,Q(Z,D)),Z=D,L-K}return Z0.findRoot(B,q,Z+V,X,A,32,0.000000000001)},getPoint:function(U,K){return J(U,K,0,!1)},getTangent:function(U,K){return J(U,K,1,!0)},getWeightedTangent:function(U,K){return J(U,K,1,!1)},getNormal:function(U,K){return J(U,K,2,!0)},getWeightedNormal:function(U,K){return J(U,K,2,!1)},getCurvature:function(U,K){return J(U,K,3,!1).x},getPeaks:function(U){var K=U[0],Z=U[1],H=U[2],W=U[3],Y=U[4],X=U[5],A=U[6],q=U[7],O=-K+3*H-3*Y+A,F=3*K-6*H+3*Y,V=-3*K+3*H,L=-Z+3*W-3*X+q,B=3*Z-6*W+3*X,D=-3*Z+3*W,_=0.00000001,T=1-_,E=[];return Z0.solveCubic(9*(O*O+L*L),9*(O*F+B*L),2*(F*F+B*B)+3*(V*O+D*L),V*F+B*D,E,_,T),E.sort()}}}},new function(){function $(F,V,L,B,D,_,T){var E=!T&&L.getPrevious()===D,R=!T&&L!==D&&L.getNext()===D,z=0.00000001,G=1-z;if(B!==null&&B>=(E?z:0)&&B<=(R?G:1)){if(_!==null&&_>=(R?z:0)&&_<=(E?G:1)){var S=new u0(L,B,null,T),P=new u0(D,_,null,T);if(S._intersection=P,P._intersection=S,!V||V(S))u0.insert(F,S,!0)}}}function Q(F,V,L,B,D,_,T,E,R,z,G,S,P){if(++R>=4096||++E>=40)return R;var w=0.000000001,k=V[0],x=V[1],b=V[6],f=V[7],h=G0.getSignedDistance,u=h(k,x,b,f,V[2],V[3]),v=h(k,x,b,f,V[4],V[5]),m=u*v>0?0.75:0.4444444444444444,d=m*Math.min(0,u,v),l=m*Math.max(0,u,v),r=h(k,x,b,f,F[0],F[1]),n=h(k,x,b,f,F[2],F[3]),e=h(k,x,b,f,F[4],F[5]),c=h(k,x,b,f,F[6],F[7]),J0=J(r,n,e,c),o=J0[0],F0=J0[1],U0,H0;if(u===0&&v===0&&r===0&&n===0&&e===0&&c===0||(U0=U(o,F0,d,l))==null||(H0=U(o.reverse(),F0.reverse(),d,l))==null)return R;var Y0=z+(G-z)*U0,K0=z+(G-z)*H0;if(Math.max(P-S,K0-Y0)<w){var S0=(Y0+K0)/2,C0=(S+P)/2;$(D,_,T?B:L,T?C0:S0,T?L:B,T?S0:C0)}else{F=p.getPart(F,U0,H0);var w0=P-S;if(H0-U0>0.8)if(K0-Y0>w0){var M0=p.subdivide(F,0.5),S0=(Y0+K0)/2;R=Q(V,M0[0],B,L,D,_,!T,E,R,S,P,Y0,S0),R=Q(V,M0[1],B,L,D,_,!T,E,R,S,P,S0,K0)}else{var M0=p.subdivide(V,0.5),C0=(S+P)/2;R=Q(M0[0],F,B,L,D,_,!T,E,R,S,C0,Y0,K0),R=Q(M0[1],F,B,L,D,_,!T,E,R,C0,P,Y0,K0)}else if(w0===0||w0>=w)R=Q(V,F,B,L,D,_,!T,E,R,S,P,Y0,K0);else R=Q(F,V,L,B,D,_,T,E,R,Y0,K0,S,P)}return R}function J(F,V,L,B){var D=[0,F],_=[0.3333333333333333,V],T=[0.6666666666666666,L],E=[1,B],R=V-(2*F+B)/3,z=L-(F+2*B)/3,G;if(R*z<0)G=[[D,_,E],[D,T,E]];else{var S=R/z;G=[S>=2?[D,_,E]:S<=0.5?[D,T,E]:[D,_,T,E],[D,E]]}return(R||z)<0?G.reverse():G}function U(F,V,L,B){if(F[0][1]<L)return K(F,!0,L);else if(V[0][1]>B)return K(V,!1,B);else return F[0][0]}function K(F,V,L){var B=F[0][0],D=F[0][1];for(var _=1,T=F.length;_<T;_++){var E=F[_][0],R=F[_][1];if(V?R>=L:R<=L)return R===L?E:B+(L-D)*(E-B)/(R-D);B=E,D=R}return null}function Z(F,V,L,B,D){var _=Z0.isZero;if(_(B)&&_(D)){var T=p.getTimeOf(F,new y(V,L));return T===null?[]:[T]}var E=Math.atan2(-D,B),R=Math.sin(E),z=Math.cos(E),G=[],S=[];for(var P=0;P<8;P+=2){var w=F[P]-V,k=F[P+1]-L;G.push(w*z-k*R,w*R+k*z)}return p.solveCubic(G,1,0,S,0,1),S}function H(F,V,L,B,D,_,T){var E=V[0],R=V[1],z=V[6],G=V[7],S=Z(F,E,R,z-E,G-R);for(var P=0,w=S.length;P<w;P++){var k=S[P],x=p.getPoint(F,k),b=p.getTimeOf(V,x);if(b!==null)$(D,_,T?B:L,T?b:k,T?L:B,T?k:b)}}function W(F,V,L,B,D,_){var T=G0.intersect(F[0],F[1],F[6],F[7],V[0],V[1],V[6],V[7]);if(T)$(D,_,L,p.getTimeOf(F,T),B,p.getTimeOf(V,T))}function Y(F,V,L,B,D,_){var T=0.000000000001,E=Math.min,R=Math.max;if(R(F[0],F[2],F[4],F[6])+T>E(V[0],V[2],V[4],V[6])&&E(F[0],F[2],F[4],F[6])-T<R(V[0],V[2],V[4],V[6])&&R(F[1],F[3],F[5],F[7])+T>E(V[1],V[3],V[5],V[7])&&E(F[1],F[3],F[5],F[7])-T<R(V[1],V[3],V[5],V[7])){var z=q(F,V);if(z)for(var G=0;G<2;G++){var S=z[G];$(D,_,L,S[0],B,S[1],!0)}else{var P=p.isStraight(F),w=p.isStraight(V),k=P&&w,x=P&&!w,b=D.length;if((k?W:P||w?H:Q)(x?V:F,x?F:V,x?B:L,x?L:B,D,_,x,0,0,0,1,0,1),!k||D.length===b)for(var G=0;G<4;G++){var f=G>>1,h=G&1,u=f*6,v=h*6,m=new y(F[u],F[u+1]),d=new y(V[v],V[v+1]);if(m.isClose(d,T))$(D,_,L,f,B,h)}}}return D}function X(F,V,L,B){var D=p.classify(F);if(D.type==="loop"){var _=D.roots;$(L,B,V,_[0],V,_[1])}return L}function A(F,V,L,B,D,_){var T=0.0000001,E=!V;if(E)V=F;var R=F.length,z=V.length,G=new Array(R),S=E?G:new Array(z),P=[];for(var w=0;w<R;w++)G[w]=F[w].getValues(B);if(!E)for(var w=0;w<z;w++)S[w]=V[w].getValues(D);var k=A0.findCurveBoundsCollisions(G,S,T);for(var x=0;x<R;x++){var b=F[x],f=G[x];if(E)X(f,b,P,L);var h=k[x];if(h)for(var u=0;u<h.length;u++){if(_&&P.length)return P;var v=h[u];if(!E||v>x){var m=V[v],d=S[v];Y(f,d,b,m,P,L)}}}return P}function q(F,V){function L(c){var J0=c[6]-c[0],o=c[7]-c[1];return J0*J0+o*o}var B=Math.abs,D=G0.getDistance,_=0.00000001,T=0.0000001,E=p.isStraight(F),R=p.isStraight(V),z=E&&R,G=L(F)<L(V),S=G?V:F,P=G?F:V,w=S[0],k=S[1],x=S[6]-w,b=S[7]-k;if(D(w,k,x,b,P[0],P[1],!0)<T&&D(w,k,x,b,P[6],P[7],!0)<T){if(!z&&D(w,k,x,b,S[2],S[3],!0)<T&&D(w,k,x,b,S[4],S[5],!0)<T&&D(w,k,x,b,P[2],P[3],!0)<T&&D(w,k,x,b,P[4],P[5],!0)<T)E=R=z=!0}else if(z)return null;if(E^R)return null;var f=[F,V],h=[];for(var u=0;u<4&&h.length<2;u++){var v=u&1,m=v^1,d=u>>1,l=p.getTimeOf(f[v],new y(f[m][d?6:0],f[m][d?7:1]));if(l!=null){var r=v?[d,l]:[l,d];if(!h.length||B(r[0]-h[0][0])>_&&B(r[1]-h[0][1])>_)h.push(r)}if(u>2&&!h.length)break}if(h.length!==2)h=null;else if(!z){var n=p.getPart(F,h[0][0],h[1][0]),e=p.getPart(V,h[0][1],h[1][1]);if(B(e[2]-n[2])>T||B(e[3]-n[3])>T||B(e[4]-n[4])>T||B(e[5]-n[5])>T)h=null}return h}function O(F,V){var L=F[0],B=F[1],D=F[2],_=F[3],T=F[4],E=F[5],R=F[6],z=F[7],G=V.normalize(),S=G.x,P=G.y,w=3*R-9*T+9*D-3*L,k=3*z-9*E+9*_-3*B,x=6*T-12*D+6*L,b=6*E-12*_+6*B,f=3*D-3*L,h=3*_-3*B,u=2*w*P-2*k*S,v=[];if(Math.abs(u)<Z0.CURVETIME_EPSILON){var m=w*h-k*f,u=w*b-k*x;if(u!=0){var d=-m/u;if(d>=0&&d<=1)v.push(d)}}else{var l=(x*x-4*w*f)*P*P+(-2*x*b+4*k*f+4*w*h)*S*P+(b*b-4*k*h)*S*S,r=x*P-b*S;if(l>=0&&u!=0){var n=Math.sqrt(l),e=-(r+n)/u,c=(-r+n)/u;if(e>=0&&e<=1)v.push(e);if(c>=0&&c<=1)v.push(c)}}return v}return{getIntersections:function(F){var V=this.getValues(),L=F&&F!==this&&F.getValues();return L?Y(V,L,this,F,[]):X(V,this,[])},statics:{getOverlaps:q,getIntersections:A,getCurveLineIntersections:Z,getTimesWithTangent:O}}}),u0=C.extend({_class:"CurveLocation",initialize:function $(Q,J,U,K,Z){if(J>=0.99999999){var H=Q.getNext();if(H)J=0,Q=H}this._setCurve(Q),this._time=J,this._point=U||Q.getPointAtTime(J),this._overlap=K,this._distance=Z,this._intersection=this._next=this._previous=null},_setPath:function($){this._path=$,this._version=$?$._version:0},_setCurve:function($){this._setPath($._path),this._curve=$,this._segment=null,this._segment1=$._segment1,this._segment2=$._segment2},_setSegment:function($){var Q=$.getCurve();if(Q)this._setCurve(Q);else this._setPath($._path),this._segment1=$,this._segment2=null;this._segment=$,this._time=$===this._segment1?0:1,this._point=$._point.clone()},getSegment:function(){var $=this._segment;if(!$){var Q=this.getCurve(),J=this.getTime();if(J===0)$=Q._segment1;else if(J===1)$=Q._segment2;else if(J!=null)$=Q.getPartLength(0,J)<Q.getPartLength(J,1)?Q._segment1:Q._segment2;this._segment=$}return $},getCurve:function(){var $=this._path,Q=this;if($&&$._version!==this._version)this._time=this._offset=this._curveOffset=this._curve=null;function J(U){var K=U&&U.getCurve();if(K&&(Q._time=K.getTimeOf(Q._point))!=null)return Q._setCurve(K),K}return this._curve||J(this._segment)||J(this._segment1)||J(this._segment2.getPrevious())},getPath:function(){var $=this.getCurve();return $&&$._path},getIndex:function(){var $=this.getCurve();return $&&$.getIndex()},getTime:function(){var $=this.getCurve(),Q=this._time;return $&&Q==null?this._time=$.getTimeOf(this._point):Q},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var $=this._offset;if($==null){$=0;var Q=this.getPath(),J=this.getIndex();if(Q&&J!=null){var U=Q.getCurves();for(var K=0;K<J;K++)$+=U[K].getLength()}this._offset=$+=this.getCurveOffset()}return $},getCurveOffset:function(){var $=this._curveOffset;if($==null){var Q=this.getCurve(),J=this.getTime();this._curveOffset=$=J!=null&&Q&&Q.getPartLength(0,J)}return $},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var $=this.getCurve(),Q=$&&$.divideAtTime(this.getTime());if(Q)this._setSegment(Q._segment1);return Q},split:function(){var $=this.getCurve(),Q=$._path,J=$&&$.splitAtTime(this.getTime());if(J)this._setSegment(Q.getLastSegment());return J},equals:function($,Q){var J=this===$;if(!J&&$ instanceof u0){var U=this.getCurve(),K=$.getCurve(),Z=U._path,H=K._path;if(Z===H){var W=Math.abs,Y=0.0000001,X=W(this.getOffset()-$.getOffset()),A=!Q&&this._intersection,q=!Q&&$._intersection;J=(X<Y||Z&&W(Z.getLength()-X)<Y)&&(!A&&!q||A&&q&&A.equals(q,!0))}}return J},toString:function(){var $=[],Q=this.getPoint(),J=D0.instance;if(Q)$.push("point: "+Q);var U=this.getIndex();if(U!=null)$.push("index: "+U);var K=this.getTime();if(K!=null)$.push("time: "+J.number(K));if(this._distance!=null)$.push("distance: "+J.number(this._distance));return"{ "+$.join(", ")+" }"},isTouching:function(){var $=this._intersection;if($&&this.getTangent().isCollinear($.getTangent())){var Q=this.getCurve(),J=$.getCurve();return!(Q.isStraight()&&J.isStraight()&&Q.getLine().intersect(J.getLine()))}return!1},isCrossing:function(){var $=this._intersection;if(!$)return!1;var Q=this.getTime(),J=$.getTime(),U=0.00000001,K=1-U,Z=Q>=U&&Q<=K,H=J>=U&&J<=K;if(Z&&H)return!this.isTouching();var W=this.getCurve(),Y=W&&Q<U?W.getPrevious():W,X=$.getCurve(),A=X&&J<U?X.getPrevious():X;if(Q>K)W=W.getNext();if(J>K)X=X.getNext();if(!Y||!W||!A||!X)return!1;var q=[];function O(S,P){var w=S.getValues(),k=p.classify(w).roots||p.getPeaks(w),x=k.length,b=p.getLength(w,P&&x?k[x-1]:0,!P&&x?k[0]:1);q.push(x?b:b/32)}function F(S,P,w){return P<w?S>P&&S<w:S>P||S<w}if(!Z)O(Y,!0),O(W,!1);if(!H)O(A,!0),O(X,!1);var V=this.getPoint(),L=Math.min.apply(Math,q),B=Z?W.getTangentAtTime(Q):W.getPointAt(L).subtract(V),D=Z?B.negate():Y.getPointAt(-L).subtract(V),_=H?X.getTangentAtTime(J):X.getPointAt(L).subtract(V),T=H?_.negate():A.getPointAt(-L).subtract(V),E=D.getAngle(),R=B.getAngle(),z=T.getAngle(),G=_.getAngle();return!!(Z?F(E,z,G)^F(R,z,G)&&F(E,G,z)^F(R,G,z):F(z,E,R)^F(G,E,R)&&F(z,R,E)^F(G,R,E))},hasOverlap:function(){return!!this._overlap}},C.each(p._evaluateMethods,function($){var Q=$+"At";this[$]=function(){var J=this.getCurve(),U=this.getTime();return U!=null&&J&&J[Q](U,!0)}},{preserve:!0}),new function(){function $(Q,J,U){var K=Q.length,Z=0,H=K-1;function W(V,L){for(var B=V+L;B>=-1&&B<=K;B+=L){var D=Q[(B%K+K)%K];if(!J.getPoint().isClose(D.getPoint(),0.0000001))break;if(J.equals(D))return D}return null}while(Z<=H){var Y=Z+H>>>1,X=Q[Y],A;if(U&&(A=J.equals(X)?X:W(Y,-1)||W(Y,1))){if(J._overlap)A._overlap=A._intersection._overlap=!0;return A}var q=J.getPath(),O=X.getPath(),F=q!==O?q._id-O._id:J.getIndex()+J.getTime()-(X.getIndex()+X.getTime());if(F<0)H=Y-1;else Z=Y+1}return Q.splice(Z,0,J),J}return{statics:{insert:$,expand:function(Q){var J=Q.slice();for(var U=Q.length-1;U>=0;U--)$(J,Q[U]._intersection,!1);return J}}}}),r0=Q0.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function $(){},statics:{create:function($){var Q,J,U;if(C.isPlainObject($))J=$.segments,Q=$.pathData;else if(Array.isArray($))J=$;else if(typeof $==="string")Q=$;if(J){var K=J[0];U=K&&Array.isArray(K[0])}else if(Q)U=(Q.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(Q);var Z=U?g0:X0;return new Z($)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function($){if(this.isClockwise()!=($=!!$))this.reverse()},setPathData:function($){var Q=$&&$.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),J,U=!1,K,Z,H=new y,W=new y;function Y(T,E){var R=+J[T];if(U)R+=H[E];return R}function X(T){return new y(Y(T,"x"),Y(T+1,"y"))}this.clear();for(var A=0,q=Q&&Q.length;A<q;A++){var O=Q[A],F=O[0],V=F.toLowerCase();J=O.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var L=J&&J.length;if(U=F===V,K==="z"&&!/[mz]/.test(V))this.moveTo(H);switch(V){case"m":case"l":var B=V==="m";for(var D=0;D<L;D+=2)if(this[B?"moveTo":"lineTo"](H=X(D)),B)W=H,B=!1;Z=H;break;case"h":case"v":var _=V==="h"?"x":"y";H=H.clone();for(var D=0;D<L;D++)H[_]=Y(D,_),this.lineTo(H);Z=H;break;case"c":for(var D=0;D<L;D+=6)this.cubicCurveTo(X(D),Z=X(D+2),H=X(D+4));break;case"s":for(var D=0;D<L;D+=4)this.cubicCurveTo(/[cs]/.test(K)?H.multiply(2).subtract(Z):H,Z=X(D),H=X(D+2)),K=V;break;case"q":for(var D=0;D<L;D+=4)this.quadraticCurveTo(Z=X(D),H=X(D+2));break;case"t":for(var D=0;D<L;D+=2)this.quadraticCurveTo(Z=/[qt]/.test(K)?H.multiply(2).subtract(Z):H,H=X(D)),K=V;break;case"a":for(var D=0;D<L;D+=7)this.arcTo(H=X(D+5),new s(+J[D],+J[D+1]),+J[D+2],+J[D+4],+J[D+3]);break;case"z":this.closePath(0.000000000001),H=W;break}K=V}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function($){var Q=$.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding($):{};return Q.onPath||!!(this.getFillRule()==="evenodd"?Q.windingL&1||Q.windingR&1:Q.winding)},getIntersections:function($,Q,J,U){var K=this===$||!$,Z=this._matrix._orNullIfIdentity(),H=K?Z:(J||$._matrix)._orNullIfIdentity();return K||this.getBounds(Z).intersects($.getBounds(H),0.000000000001)?p.getIntersections(this.getCurves(),!K&&$.getCurves(),Q,Z,H,U):[]},getCrossings:function($){return this.getIntersections($,function(Q){return Q.isCrossing()})},getNearestLocation:function(){var $=y.read(arguments),Q=this.getCurves(),J=Infinity,U=null;for(var K=0,Z=Q.length;K<Z;K++){var H=Q[K].getNearestLocation($);if(H._distance<J)J=H._distance,U=H}return U},getNearestPoint:function(){var $=this.getNearestLocation.apply(this,arguments);return $?$.getPoint():$},interpolate:function($,Q,J){var U=!this._children,K=U?"_segments":"_children",Z=$[K],H=Q[K],W=this[K];if(!Z||!H||Z.length!==H.length)throw new Error("Invalid operands in interpolate() call: "+$+", "+Q);var Y=W.length,X=H.length;if(Y<X){var A=U?i:X0;for(var q=Y;q<X;q++)this.add(new A)}else if(Y>X)this[U?"removeSegments":"removeChildren"](X,Y);for(var q=0;q<X;q++)W[q].interpolate(Z[q],H[q],J);if(U)this.setClosed($._closed),this._changed(9)},compare:function($){var Q=!1;if($){var J=this._children||[this],U=$._children?$._children.slice():[$],K=J.length,Z=U.length,H=[],W=0;Q=!0;var Y=A0.findItemBoundsCollisions(J,U,Z0.GEOMETRIC_EPSILON);for(var X=K-1;X>=0&&Q;X--){var A=J[X];Q=!1;var q=Y[X];if(q){for(var O=q.length-1;O>=0&&!Q;O--)if(A.compare(U[q[O]])){if(!H[q[O]])H[q[O]]=!0,W++;Q=!0}}}Q=Q&&W===Z}return Q}}),X0=r0.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function $(Q){this._closed=!1,this._segments=[],this._version=0;var J=arguments,U=Array.isArray(Q)?typeof Q[0]==="object"?Q:J:Q&&(Q.size===I&&(Q.x!==I||Q.point!==I))?J:null;if(U&&U.length>0)this.setSegments(U);else if(this._curves=I,this._segmentSelection=0,!U&&typeof Q==="string")this.setPathData(Q),Q=null;this._initialize(!U&&Q)},_equals:function($){return this._closed===$._closed&&C.equals(this._segments,$._segments)},copyContent:function($){this.setSegments($._segments),this._closed=$._closed},_changed:function $(Q){if($.base.call(this,Q),Q&8){if(this._length=this._area=I,Q&32)this._version++;else if(this._curves)for(var J=0,U=this._curves.length;J<U;J++)this._curves[J]._changed()}else if(Q&64)this._bounds=I},getStyle:function(){var $=this._parent;return($ instanceof g0?$:this)._style},getSegments:function(){return this._segments},setSegments:function($){var Q=this.isFullySelected(),J=$&&$.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=I,J){var U=$[J-1];if(typeof U==="boolean")this.setClosed(U),J--;this._add(i.readList($,0,{},J))}if(Q)this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var $=this._curves,Q=this._segments;if(!$){var J=this._countCurves();$=this._curves=new Array(J);for(var U=0;U<J;U++)$[U]=new p(this,Q[U],Q[U+1]||Q[0])}return $},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var $=this.getCurves();return $[$.length-1]},isClosed:function(){return this._closed},setClosed:function($){if(this._closed!=($=!!$)){if(this._closed=$,this._curves){var Q=this._curves.length=this._countCurves();if($)this._curves[Q-1]=new p(this,this._segments[Q-1],this._segments[0])}this._changed(41)}}},{beans:!0,getPathData:function($,Q){var J=this._segments,U=J.length,K=new D0(Q),Z=new Array(6),H=!0,W,Y,X,A,q,O,F,V,L=[];function B(_,T){if(_._transformCoordinates($,Z),W=Z[0],Y=Z[1],H)L.push("M"+K.pair(W,Y)),H=!1;else if(q=Z[2],O=Z[3],q===W&&O===Y&&F===X&&V===A){if(!T){var E=W-X,R=Y-A;L.push(E===0?"v"+K.number(R):R===0?"h"+K.number(E):"l"+K.pair(E,R))}}else L.push("c"+K.pair(F-X,V-A)+" "+K.pair(q-X,O-A)+" "+K.pair(W-X,Y-A));X=W,A=Y,F=Z[4],V=Z[5]}if(!U)return"";for(var D=0;D<U;D++)B(J[D]);if(this._closed&&U>0)B(J[0],!0),L.push("z");return L.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function($){var Q=this._segments,J=new Array(6);for(var U=0,K=Q.length;U<K;U++)Q[U]._transformCoordinates($,J,!0);return!0},_add:function($,H){var J=this._segments,U=this._curves,K=$.length,Z=H==null,H=Z?J.length:H;for(var W=0;W<K;W++){var Y=$[W];if(Y._path)Y=$[W]=Y.clone();if(Y._path=this,Y._index=H+W,Y._selection)this._updateSelection(Y,0,Y._selection)}if(Z)C.push(J,$);else{J.splice.apply(J,[H,0].concat($));for(var W=H+K,X=J.length;W<X;W++)J[W]._index=W}if(U){var A=this._countCurves(),q=H>0&&H+K-1===A?H-1:H,O=q,F=Math.min(q+K,A);if($._curves)U.splice.apply(U,[q,0].concat($._curves)),O+=$._curves.length;for(var W=O;W<F;W++)U.splice(W,0,new p(this,null,null));this._adjustCurves(q,F)}return this._changed(41),$},_adjustCurves:function($,Q){var J=this._segments,U=this._curves,K;for(var Z=$;Z<Q;Z++)K=U[Z],K._path=this,K._segment1=J[Z],K._segment2=J[Z+1]||J[0],K._changed();if(K=U[this._closed&&!$?J.length-1:$-1])K._segment2=J[$]||J[0],K._changed();if(K=U[Q])K._segment1=J[Q],K._changed()},_countCurves:function(){var $=this._segments.length;return!this._closed&&$>0?$-1:$},add:function($){var Q=arguments;return Q.length>1&&typeof $!=="number"?this._add(i.readList(Q)):this._add([i.read(Q)])[0]},insert:function($,Q){var J=arguments;return J.length>2&&typeof Q!=="number"?this._add(i.readList(J,1),$):this._add([i.read(J,1)],$)[0]},addSegment:function(){return this._add([i.read(arguments)])[0]},insertSegment:function($){return this._add([i.read(arguments,1)],$)[0]},addSegments:function($){return this._add(i.readList($))},insertSegments:function($,Q){return this._add(i.readList(Q),$)},removeSegment:function($){return this.removeSegments($,$+1)[0]||null},removeSegments:function($,Q,J){$=$||0,Q=C.pick(Q,this._segments.length);var U=this._segments,K=this._curves,Z=U.length,H=U.splice($,Q-$),W=H.length;if(!W)return H;for(var Y=0;Y<W;Y++){var X=H[Y];if(X._selection)this._updateSelection(X,X._selection,0);X._index=X._path=null}for(var Y=$,A=U.length;Y<A;Y++)U[Y]._index=Y;if(K){var q=$>0&&Q===Z+(this._closed?1:0)?$-1:$,K=K.splice(q,W);for(var Y=K.length-1;Y>=0;Y--)K[Y]._path=null;if(J)H._curves=K.slice(1);this._adjustCurves(q,q)}return this._changed(41),H},clear:"#removeSegments",hasHandles:function(){var $=this._segments;for(var Q=0,J=$.length;Q<J;Q++)if($[Q].hasHandles())return!0;return!1},clearHandles:function(){var $=this._segments;for(var Q=0,J=$.length;Q<J;Q++)$[Q].clearHandles()},getLength:function(){if(this._length==null){var $=this.getCurves(),Q=0;for(var J=0,U=$.length;J<U;J++)Q+=$[J].getLength();this._length=Q}return this._length},getArea:function(){var $=this._area;if($==null){var Q=this._segments,J=this._closed;$=0;for(var U=0,K=Q.length;U<K;U++){var Z=U+1===K;$+=p.getArea(p.getValues(Q[U],Q[Z?0:U+1],null,Z&&!J))}this._area=$}return $},isFullySelected:function(){var $=this._segments.length;return this.isSelected()&&$>0&&this._segmentSelection===$*7},setFullySelected:function($){if($)this._selectSegments(!0);this.setSelected($)},setSelection:function $(Q){if(!(Q&1))this._selectSegments(!1);$.base.call(this,Q)},_selectSegments:function($){var Q=this._segments,J=Q.length,U=$?7:0;this._segmentSelection=U*J;for(var K=0;K<J;K++)Q[K]._selection=U},_updateSelection:function($,Q,J){$._selection=J;var U=this._segmentSelection+=J-Q;if(U>0)this.setSelected(!0)},divideAt:function($){var Q=this.getLocationAt($),J;return Q&&(J=Q.getCurve().divideAt(Q.getCurveOffset()))?J._segment1:null},splitAt:function($){var Q=this.getLocationAt($),J=Q&&Q.index,U=Q&&Q.time,K=0.00000001,Z=1-K;if(U>Z)J++,U=0;var H=this.getCurves();if(J>=0&&J<H.length){if(U>=K)H[J++].divideAtTime(U);var W=this.removeSegments(J,this._segments.length,!0),Y;if(this._closed)this.setClosed(!1),Y=this;else Y=new X0(Q0.NO_INSERT),Y.insertAbove(this),Y.copyAttributes(this);return Y._add(W,0),this.addSegment(W[0]),Y}return null},split:function($,Q){var J,U=Q===I?$:(J=this.getCurves()[$])&&J.getLocationAtTime(Q);return U!=null?this.splitAt(U):null},join:function($,Q){var J=Q||0;if($&&$!==this){var U=$._segments,K=this.getLastSegment(),Z=$.getLastSegment();if(!Z)return this;if(K&&K._point.isClose(Z._point,J))$.reverse();var H=$.getFirstSegment();if(K&&K._point.isClose(H._point,J))K.setHandleOut(H._handleOut),this._add(U.slice(1));else{var W=this.getFirstSegment();if(W&&W._point.isClose(H._point,J))$.reverse();if(Z=$.getLastSegment(),W&&W._point.isClose(Z._point,J))W.setHandleIn(Z._handleIn),this._add(U.slice(0,U.length-1),0);else this._add(U.slice())}if($._closed)this._add([U[0]]);$.remove()}var Y=this.getFirstSegment(),X=this.getLastSegment();if(Y!==X&&Y._point.isClose(X._point,J))Y.setHandleIn(X._handleIn),X.remove(),this.setClosed(!0);return this},reduce:function($){var Q=this.getCurves(),J=$&&$.simplify,U=J?0.0000001:0;for(var K=Q.length-1;K>=0;K--){var Z=Q[K];if(!Z.hasHandles()&&(!Z.hasLength(U)||J&&Z.isCollinear(Z.getNext())))Z.remove()}return this},reverse:function(){this._segments.reverse();for(var $=0,Q=this._segments.length;$<Q;$++){var J=this._segments[$],U=J._handleIn;J._handleIn=J._handleOut,J._handleOut=U,J._index=$}this._curves=null,this._changed(9)},flatten:function($){var Q=new D8(this,$||0.25,256,!0),J=Q.parts,U=J.length,K=[];for(var Z=0;Z<U;Z++)K.push(new i(J[Z].curve.slice(0,2)));if(!this._closed&&U>0)K.push(new i(J[U-1].curve.slice(6)));this.setSegments(K)},simplify:function($){var Q=new y8(this).fit($||2.5);if(Q)this.setSegments(Q);return!!Q},smooth:function($){var Q=this,J=$||{},U=J.type||"asymmetric",K=this._segments,Z=K.length,H=this._closed;function W(o,F0){var U0=o&&o.index;if(U0!=null){var H0=o.path;if(H0&&H0!==Q)throw new Error(o._class+" "+U0+" of "+H0+" is not part of "+Q);if(F0&&o instanceof p)U0++}else U0=typeof o==="number"?o:F0;return Math.min(U0<0&&H?U0%Z:U0<0?U0+Z:U0,Z-1)}var Y=H&&J.from===I&&J.to===I,X=W(J.from,0),A=W(J.to,Z-1);if(X>A)if(H)X-=Z;else{var q=X;X=A,A=q}if(/^(?:asymmetric|continuous)$/.test(U)){var O=U==="asymmetric",F=Math.min,V=A-X+1,L=V-1,B=Y?F(V,4):1,D=B,_=B,T=[];if(!H)D=F(1,X),_=F(1,Z-A-1);if(L+=D+_,L<=1)return;for(var E=0,R=X-D;E<=L;E++,R++)T[E]=K[(R<0?R+Z:R)%Z]._point;var z=T[0]._x+2*T[1]._x,G=T[0]._y+2*T[1]._y,S=2,P=L-1,w=[z],k=[G],x=[S],b=[],f=[];for(var E=1;E<L;E++){var h=E<P,u=h?1:O?1:2,v=h?4:O?2:7,m=h?4:O?3:8,d=h?2:O?0:1,l=u/S;S=x[E]=v-l,z=w[E]=m*T[E]._x+d*T[E+1]._x-l*z,G=k[E]=m*T[E]._y+d*T[E+1]._y-l*G}b[P]=w[P]/x[P],f[P]=k[P]/x[P];for(var E=L-2;E>=0;E--)b[E]=(w[E]-b[E+1])/x[E],f[E]=(k[E]-f[E+1])/x[E];b[L]=(3*T[L]._x-b[P])/2,f[L]=(3*T[L]._y-f[P])/2;for(var E=D,r=L-_,R=X;E<=r;E++,R++){var n=K[R<0?R+Z:R],e=n._point,c=b[E]-e._x,J0=f[E]-e._y;if(Y||E<r)n.setHandleOut(c,J0);if(Y||E>D)n.setHandleIn(-c,-J0)}}else for(var E=X;E<=A;E++)K[E<0?E+Z:E].smooth(J,!Y&&E===X,!Y&&E===A)},toShape:function($){if(!this._closed)return null;var Q=this._segments,J,U,K,Z;function H(O,F){var V=Q[O],L=V.getNext(),B=Q[F],D=B.getNext();return V._handleOut.isZero()&&L._handleIn.isZero()&&B._handleOut.isZero()&&D._handleIn.isZero()&&L._point.subtract(V._point).isCollinear(D._point.subtract(B._point))}function W(O){var F=Q[O],V=F.getPrevious(),L=F.getNext();return V._handleOut.isZero()&&F._handleIn.isZero()&&F._handleOut.isZero()&&L._handleIn.isZero()&&F._point.subtract(V._point).isOrthogonal(L._point.subtract(F._point))}function Y(O){var F=Q[O],V=F.getNext(),L=F._handleOut,B=V._handleIn,D=0.5522847498307936;if(L.isOrthogonal(B)){var _=F._point,T=V._point,E=new G0(_,L,!0).intersect(new G0(T,B,!0),!0);return E&&Z0.isZero(L.getLength()/E.subtract(_).getLength()-D)&&Z0.isZero(B.getLength()/E.subtract(T).getLength()-D)}return!1}function X(O,F){return Q[O]._point.getDistance(Q[F]._point)}if(!this.hasHandles()&&Q.length===4&&H(0,2)&&H(1,3)&&W(1))J=k0.Rectangle,U=new s(X(0,3),X(0,1)),Z=Q[1]._point.add(Q[2]._point).divide(2);else if(Q.length===8&&Y(0)&&Y(2)&&Y(4)&&Y(6)&&H(1,5)&&H(3,7))J=k0.Rectangle,U=new s(X(1,6),X(0,3)),K=U.subtract(new s(X(0,7),X(1,2))).divide(2),Z=Q[3]._point.add(Q[4]._point).divide(2);else if(Q.length===4&&Y(0)&&Y(1)&&Y(2)&&Y(3)){if(Z0.isZero(X(0,2)-X(1,3)))J=k0.Circle,K=X(0,2)/2;else J=k0.Ellipse,K=new s(X(2,0)/2,X(3,1)/2);Z=Q[1]._point}if(J){var A=this.getPosition(!0),q=new J({center:A,size:U,radius:K,insert:!1});if(q.copyAttributes(this,!0),q._matrix.prepend(this._matrix),q.rotate(Z.subtract(A).getAngle()+90),$===I||$)q.insertAbove(this);return q}return null},toPath:"#clone",compare:function $(Q){if(!Q||Q instanceof g0)return $.base.call(this,Q);var J=this.getCurves(),U=Q.getCurves(),K=J.length,Z=U.length;if(!K||!Z)return K==Z;var H=J[0].getValues(),W=[],Y=0,X,A=0,q;for(var O=0;O<Z;O++){var B=U[O].getValues();W.push(B);var F=p.getOverlaps(H,B);if(F){X=!O&&F[0][0]>0?Z-1:O,q=F[0][1];break}}var V=Math.abs,L=0.00000001,B=W[X],D;while(H&&B){var F=p.getOverlaps(H,B);if(F){var _=F[0][0];if(V(_-A)<L){if(A=F[1][0],A===1)H=++Y<K?J[Y].getValues():null,A=0;var T=F[0][1];if(V(T-q)<L){if(!D)D=[X,T];if(q=F[1][1],q===1){if(++X>=Z)X=0;B=W[X]||U[X].getValues(),q=0}if(!H)return D[0]===X&&D[1]===q;continue}}}break}return!1},_hitTestSelf:function($,Q,J,U){var K=this,Z=this.getStyle(),H=this._segments,W=H.length,Y=this._closed,X=Q._tolerancePadding,A=X,q,O,F,V,L,B,D=Q.stroke&&Z.hasStroke(),_=Q.fill&&Z.hasFill(),T=Q.curves,E=D?Z.getStrokeWidth()/2:_&&Q.tolerance>0||T?0:null;if(E!==null)if(E>0)q=Z.getStrokeJoin(),O=Z.getStrokeCap(),F=Z.getMiterLimit(),A=A.add(X0._getStrokePadding(E,U));else q=O="round";function R(b,f){return $.subtract(b).divide(f).length<=1}function z(b,f,h){if(!Q.selected||f.isSelected()){var u=b._point;if(f!==u)f=f.add(u);if(R(f,A))return new p0(h,K,{segment:b,point:f})}}function G(b,f){return(f||Q.segments)&&z(b,b._point,"segment")||!f&&Q.handles&&(z(b,b._handleIn,"handle-in")||z(b,b._handleOut,"handle-out"))}function S(b){V.add(b)}function P(b){var f=Y||b._index>0&&b._index<W-1;if((f?q:O)==="round")return R(b._point,A);else{if(V=new X0({internal:!0,closed:!0}),f){if(!b.isSmooth())X0._addBevelJoin(b,q,E,F,null,U,S,!0)}else if(O==="square")X0._addSquareCap(b,O,E,null,U,S,!0);if(!V.isEmpty()){var h;return V.contains($)||(h=V.getNearestLocation($))&&R(h.getPoint(),X)}}}if(Q.ends&&!Q.segments&&!Y){if(B=G(H[0],!0)||G(H[W-1],!0))return B}else if(Q.segments||Q.handles){for(var w=0;w<W;w++)if(B=G(H[w]))return B}if(E!==null){if(L=this.getNearestLocation($),L){var k=L.getTime();if(k===0||k===1&&W>1){if(!P(L.getSegment()))L=null}else if(!R(L.getPoint(),A))L=null}if(!L&&q==="miter"&&W>1)for(var w=0;w<W;w++){var x=H[w];if($.getDistance(x._point)<=F*E&&P(x)){L=x.getLocation();break}}}return!L&&_&&this._contains($)||L&&!D&&!T?new p0("fill",this):L?new p0(D?"stroke":"curve",this,{location:L,point:L.getPoint()}):null}},C.each(p._evaluateMethods,function($){this[$+"At"]=function(Q){var J=this.getLocationAt(Q);return J&&J[$]()}},{beans:!1,getLocationOf:function(){var $=y.read(arguments),Q=this.getCurves();for(var J=0,U=Q.length;J<U;J++){var K=Q[J].getLocationOf($);if(K)return K}return null},getOffsetOf:function(){var $=this.getLocationOf.apply(this,arguments);return $?$.getOffset():null},getLocationAt:function($){if(typeof $==="number"){var Q=this.getCurves(),J=0;for(var U=0,K=Q.length;U<K;U++){var Z=J,H=Q[U];if(J+=H.getLength(),J>$)return H.getLocationAt($-Z)}if(Q.length>0&&$<=this.getLength())return new u0(Q[Q.length-1],1)}else if($&&$.getPath&&$.getPath()===this)return $;return null},getOffsetsWithTangent:function(){var $=y.read(arguments);if($.isZero())return[];var Q=[],J=0,U=this.getCurves();for(var K=0,Z=U.length;K<Z;K++){var H=U[K],W=H.getTimesWithTangent($);for(var Y=0,X=W.length;Y<X;Y++){var A=J+H.getOffsetAtTime(W[Y]);if(Q.indexOf(A)<0)Q.push(A)}J+=H.length}return Q}}),new function(){function $(J,U,K,Z){if(Z<=0)return;var H=Z/2,W=Z-2,Y=H-1,X=new Array(6),A,q;function O(_){var T=X[_],E=X[_+1];if(A!=T||q!=E)J.beginPath(),J.moveTo(A,q),J.lineTo(T,E),J.stroke(),J.beginPath(),J.arc(T,E,H,0,Math.PI*2,!0),J.fill()}for(var F=0,V=U.length;F<V;F++){var L=U[F],B=L._selection;if(L._transformCoordinates(K,X),A=X[0],q=X[1],B&2)O(2);if(B&4)O(4);if(J.fillRect(A-H,q-H,Z,Z),W>0&&!(B&1)){var D=J.fillStyle;J.fillStyle="#ffffff",J.fillRect(A-Y,q-Y,W,W),J.fillStyle=D}}}function Q(J,U,K){var Z=U._segments,H=Z.length,W=new Array(6),Y=!0,X,A,q,O,F,V,L,B;function D(T){if(K)T._transformCoordinates(K,W),X=W[0],A=W[1];else{var E=T._point;X=E._x,A=E._y}if(Y)J.moveTo(X,A),Y=!1;else{if(K)F=W[2],V=W[3];else{var R=T._handleIn;F=X+R._x,V=A+R._y}if(F===X&&V===A&&L===q&&B===O)J.lineTo(X,A);else J.bezierCurveTo(L,B,F,V,X,A)}if(q=X,O=A,K)L=W[4],B=W[5];else{var R=T._handleOut;L=q+R._x,B=O+R._y}}for(var _=0;_<H;_++)D(Z[_]);if(U._closed&&H>0)D(Z[0])}return{_draw:function(J,U,K,Z){var H=U.dontStart,W=U.dontFinish||U.clip,Y=this.getStyle(),X=Y.hasFill(),A=Y.hasStroke(),q=Y.getDashArray(),O=!W0.support.nativeDash&&A&&q&&q.length;if(!H)J.beginPath();if(X||A&&!O||W){if(Q(J,this,Z),this._closed)J.closePath()}function F(T){return q[(T%O+O)%O]}if(!W&&(X||A)){if(this._setStyles(J,U,K),X)J.fill(Y.getFillRule()),J.shadowColor="rgba(0,0,0,0)";if(A){if(O){if(!H)J.beginPath();var V=new D8(this,0.25,32,!1,Z),L=V.length,B=-Y.getDashOffset(),D,_=0;while(B>0)B-=F(_--)+F(_--);while(B<L){if(D=B+F(_++),B>0||D>0)V.drawPart(J,Math.max(B,0),Math.max(D,0));B=D+F(_++)}}J.stroke()}}},_drawSelected:function(J,U){J.beginPath(),Q(J,this,U),J.stroke(),$(J,this._segments,U,W0.settings.handleSize)}}},new function(){function $(Q){var J=Q._segments;if(!J.length)throw new Error("Use a moveTo() command first");return J[J.length-1]}return{moveTo:function(){var Q=this._segments;if(Q.length===1)this.removeSegment(0);if(!Q.length)this._add([new i(y.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new i(y.read(arguments))])},cubicCurveTo:function(){var Q=arguments,J=y.read(Q),U=y.read(Q),K=y.read(Q),Z=$(this);Z.setHandleOut(J.subtract(Z._point)),this._add([new i(K,U.subtract(K))])},quadraticCurveTo:function(){var Q=arguments,J=y.read(Q),U=y.read(Q),K=$(this)._point;this.cubicCurveTo(J.add(K.subtract(J).multiply(0.3333333333333333)),J.add(U.subtract(J).multiply(0.3333333333333333)),U)},curveTo:function(){var Q=arguments,J=y.read(Q),U=y.read(Q),K=C.pick(C.read(Q),0.5),Z=1-K,H=$(this)._point,W=J.subtract(H.multiply(Z*Z)).subtract(U.multiply(K*K)).divide(2*K*Z);if(W.isNaN())throw new Error("Cannot put a curve through points with parameter = "+K);this.quadraticCurveTo(W,U)},arcTo:function(){var Q=arguments,J=Math.abs,U=Math.sqrt,K=$(this),Z=K._point,H=y.read(Q),W,Y=C.peek(Q),X=C.pick(Y,!0),A,q,O,F;if(typeof X==="boolean")var V=Z.add(H).divide(2),W=V.add(V.subtract(Z).rotate(X?-90:90));else if(C.remain(Q)<=2)W=H,H=y.read(Q);else if(!Z.equals(H)){var L=s.read(Q),B=Z0.isZero;if(B(L.width)||B(L.height))return this.lineTo(H);var D=C.read(Q),X=!!C.read(Q),_=!!C.read(Q),V=Z.add(H).divide(2),T=Z.subtract(V).rotate(-D),E=T.x,R=T.y,z=J(L.width),G=J(L.height),S=z*z,P=G*G,w=E*E,k=R*R,x=U(w/S+k/P);if(x>1)z*=x,G*=x,S=z*z,P=G*G;if(x=(S*P-S*k-P*w)/(S*k+P*w),J(x)<0.000000000001)x=0;if(x<0)throw new Error("Cannot create an arc with the given arguments");if(A=new y(z*R/G,-G*E/z).multiply((_===X?-1:1)*U(x)).rotate(D).add(V),F=new q0().translate(A).rotate(D).scale(z,G),O=F._inverseTransform(Z),q=O.getDirectedAngle(F._inverseTransform(H)),!X&&q>0)q-=360;else if(X&&q<0)q+=360}if(W){var b=new G0(Z.add(W).divide(2),W.subtract(Z).rotate(90),!0),f=new G0(W.add(H).divide(2),H.subtract(W).rotate(90),!0),h=new G0(Z,H),u=h.getSide(W);if(A=b.intersect(f,!0),!A){if(!u)return this.lineTo(H);throw new Error("Cannot create an arc with the given arguments")}O=Z.subtract(A),q=O.getDirectedAngle(H.subtract(A));var v=h.getSide(A,!0);if(v===0)q=u*J(q);else if(u===v)q+=q<0?360:-360}if(q){var m=0.00001,d=J(q),l=d>=360?4:Math.ceil((d-m)/90),r=q/l,n=r*Math.PI/360,e=1.3333333333333333*Math.sin(n)/(1+Math.cos(n)),c=[];for(var J0=0;J0<=l;J0++){var T=H,o=null;if(J0<l)if(o=O.rotate(90).multiply(e),F)T=F._transformPoint(O),o=F._transformPoint(O.add(o)).subtract(T);else T=A.add(O);if(!J0)K.setHandleOut(o);else{var F0=O.rotate(-90).multiply(e);if(F)F0=F._transformPoint(O.add(F0)).subtract(T);c.push(new i(T,F0,o))}O=O.rotate(r)}this._add(c)}},lineBy:function(){var Q=y.read(arguments),J=$(this)._point;this.lineTo(J.add(Q))},curveBy:function(){var Q=arguments,J=y.read(Q),U=y.read(Q),K=C.read(Q),Z=$(this)._point;this.curveTo(Z.add(J),Z.add(U),K)},cubicCurveBy:function(){var Q=arguments,J=y.read(Q),U=y.read(Q),K=y.read(Q),Z=$(this)._point;this.cubicCurveTo(Z.add(J),Z.add(U),Z.add(K))},quadraticCurveBy:function(){var Q=arguments,J=y.read(Q),U=y.read(Q),K=$(this)._point;this.quadraticCurveTo(K.add(J),K.add(U))},arcBy:function(){var Q=arguments,J=$(this)._point,U=J.add(y.read(Q)),K=C.pick(C.peek(Q),!0);if(typeof K==="boolean")this.arcTo(U,K);else this.arcTo(U,J.add(y.read(Q)))},closePath:function(Q){this.setClosed(!0),this.join(this,Q)}}},{_getBounds:function($,Q){var J=Q.handle?"getHandleBounds":Q.stroke?"getStrokeBounds":"getBounds";return X0[J](this._segments,this._closed,this,$,Q)},statics:{getBounds:function($,Q,J,U,K,Z){var H=$[0];if(!H)return new t;var W=new Array(6),Y=H._transformCoordinates(U,new Array(6)),X=Y.slice(0,2),A=X.slice(),q=new Array(2);function O(L){L._transformCoordinates(U,W);for(var B=0;B<2;B++)p._addBounds(Y[B],Y[B+4],W[B+2],W[B],B,Z?Z[B]:0,X,A,q);var D=Y;Y=W,W=D}for(var F=1,V=$.length;F<V;F++)O($[F]);if(Q)O(H);return new t(X[0],X[1],A[0]-X[0],A[1]-X[1])},getStrokeBounds:function($,Q,J,U,K){var Z=J.getStyle(),H=Z.hasStroke(),W=Z.getStrokeWidth(),Y=H&&J._getStrokeMatrix(U,K),X=H&&X0._getStrokePadding(W,Y),A=X0.getBounds($,Q,J,U,K,X);if(!H)return A;var q=W/2,O=Z.getStrokeJoin(),F=Z.getStrokeCap(),V=Z.getMiterLimit(),L=new t(new s(X));function B(z){A=A.include(z)}function D(z){A=A.unite(L.setCenter(z._point.transform(U)))}function _(z,G){if(G==="round"||z.isSmooth())D(z);else X0._addBevelJoin(z,G,q,V,U,Y,B)}function T(z,G){if(G==="round")D(z);else X0._addSquareCap(z,G,q,U,Y,B)}var E=$.length-(Q?0:1);if(E>0){for(var R=1;R<E;R++)_($[R],O);if(Q)_($[0],O);else T($[0],F),T($[$.length-1],F)}return A},_getStrokePadding:function($,Q){if(!Q)return[$,$];var J=new y($,0).transform(Q),U=new y(0,$).transform(Q),K=J.getAngleInRadians(),Z=J.getLength(),H=U.getLength(),W=Math.sin(K),Y=Math.cos(K),X=Math.tan(K),A=Math.atan2(H*X,Z),q=Math.atan2(H,X*Z);return[Math.abs(Z*Math.cos(A)*Y+H*Math.sin(A)*W),Math.abs(H*Math.sin(q)*Y+Z*Math.cos(q)*W)]},_addBevelJoin:function($,Q,J,U,K,Z,H,W){var Y=$.getCurve(),X=Y.getPrevious(),A=Y.getPoint1().transform(K),q=X.getNormalAtTime(1).multiply(J).transform(Z),O=Y.getNormalAtTime(0).multiply(J).transform(Z),F=q.getDirectedAngle(O);if(F<0||F>=180)q=q.negate(),O=O.negate();if(W)H(A);if(H(A.add(q)),Q==="miter"){var V=new G0(A.add(q),new y(-q.y,q.x),!0).intersect(new G0(A.add(O),new y(-O.y,O.x),!0),!0);if(V&&A.getDistance(V)<=U*J)H(V)}H(A.add(O))},_addSquareCap:function($,Q,J,U,K,Z,H){var W=$._point.transform(U),Y=$.getLocation(),X=Y.getNormal().multiply(Y.getTime()===0?J:-J).transform(K);if(Q==="square"){if(H)Z(W.subtract(X)),Z(W.add(X));W=W.add(X.rotate(-90))}Z(W.add(X)),Z(W.subtract(X))},getHandleBounds:function($,Q,J,U,K){var Z=J.getStyle(),H=K.stroke&&Z.hasStroke(),W,Y;if(H){var X=J._getStrokeMatrix(U,K),A=Z.getStrokeWidth()/2,q=A;if(Z.getStrokeJoin()==="miter")q=A*Z.getMiterLimit();if(Z.getStrokeCap()==="square")q=Math.max(q,A*Math.SQRT2);W=X0._getStrokePadding(A,X),Y=X0._getStrokePadding(q,X)}var O=new Array(6),F=Infinity,V=-F,L=F,B=V;for(var D=0,_=$.length;D<_;D++){var T=$[D];T._transformCoordinates(U,O);for(var E=0;E<6;E+=2){var R=!E?Y:W,z=R?R[0]:0,G=R?R[1]:0,S=O[E],P=O[E+1],w=S-z,k=S+z,x=P-G,b=P+G;if(w<F)F=w;if(k>V)V=k;if(x<L)L=x;if(b>B)B=b}}return new t(F,L,V-F,B-L)}}});X0.inject({statics:new function(){var $=0.5522847498307936,Q=[new i([-1,0],[0,$],[0,-$]),new i([0,-1],[-$,0],[$,0]),new i([1,0],[0,-$],[0,$]),new i([0,1],[$,0],[-$,0])];function J(K,Z,H){var W=C.getNamed(H),Y=new X0(W&&(W.insert==!0?Q0.INSERT:W.insert==!1?Q0.NO_INSERT:null));return Y._add(K),Y._closed=Z,Y.set(W,Q0.INSERT)}function U(K,Z,H){var W=new Array(4);for(var Y=0;Y<4;Y++){var X=Q[Y];W[Y]=new i(X._point.multiply(Z).add(K),X._handleIn.multiply(Z),X._handleOut.multiply(Z))}return J(W,!0,H)}return{Line:function(){var K=arguments;return J([new i(y.readNamed(K,"from")),new i(y.readNamed(K,"to"))],!1,K)},Circle:function(){var K=arguments,Z=y.readNamed(K,"center"),H=C.readNamed(K,"radius");return U(Z,new s(H),K)},Rectangle:function(){var K=arguments,Z=t.readNamed(K,"rectangle"),H=s.readNamed(K,"radius",0,{readNull:!0}),W=Z.getBottomLeft(!0),Y=Z.getTopLeft(!0),X=Z.getTopRight(!0),A=Z.getBottomRight(!0),q;if(!H||H.isZero())q=[new i(W),new i(Y),new i(X),new i(A)];else{H=s.min(H,Z.getSize(!0).divide(2));var{width:O,height:F}=H,V=O*$,L=F*$;q=[new i(W.add(O,0),null,[-V,0]),new i(W.subtract(0,F),[0,L]),new i(Y.add(0,F),null,[0,-L]),new i(Y.add(O,0),[-V,0],null),new i(X.subtract(O,0),null,[V,0]),new i(X.add(0,F),[0,-L],null),new i(A.subtract(0,F),null,[0,L]),new i(A.subtract(O,0),[V,0])]}return J(q,!0,K)},RoundRectangle:"#Rectangle",Ellipse:function(){var K=arguments,Z=k0._readEllipse(K);return U(Z.center,Z.radius,K)},Oval:"#Ellipse",Arc:function(){var K=arguments,Z=y.readNamed(K,"from"),H=y.readNamed(K,"through"),W=y.readNamed(K,"to"),Y=C.getNamed(K),X=new X0(Y&&Y.insert==!1&&Q0.NO_INSERT);return X.moveTo(Z),X.arcTo(H,W),X.set(Y)},RegularPolygon:function(){var K=arguments,Z=y.readNamed(K,"center"),H=C.readNamed(K,"sides"),W=C.readNamed(K,"radius"),Y=360/H,X=H%3===0,A=new y(0,X?-W:W),q=X?-1:0.5,O=new Array(H);for(var F=0;F<H;F++)O[F]=new i(Z.add(A.rotate((F+q)*Y)));return J(O,!0,K)},Star:function(){var K=arguments,Z=y.readNamed(K,"center"),H=C.readNamed(K,"points")*2,W=C.readNamed(K,"radius1"),Y=C.readNamed(K,"radius2"),X=360/H,A=new y(0,-1),q=new Array(H);for(var O=0;O<H;O++)q[O]=new i(Z.add(A.rotate(X*O).multiply(O%2?Y:W)));return J(q,!0,K)}}}});var g0=r0.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function $(Q){if(this._children=[],this._namedChildren={},!this._initialize(Q))if(typeof Q==="string")this.setPathData(Q);else this.addChildren(Array.isArray(Q)?Q:arguments)},insertChildren:function $(Q,J){var U=J,K=U[0];if(K&&typeof K[0]==="number")U=[U];for(var Z=J.length-1;Z>=0;Z--){var H=U[Z];if(U===J&&!(H instanceof X0))U=C.slice(U);if(Array.isArray(H))U[Z]=new X0({segments:H,insert:!1});else if(H instanceof g0)U.splice.apply(U,[Z,1].concat(H.removeChildren())),H.remove()}return $.base.call(this,Q,U)},reduce:function $(Q){var J=this._children;for(var U=J.length-1;U>=0;U--){var K=J[U].reduce(Q);if(K.isEmpty())K.remove()}if(!J.length){var K=new X0(Q0.NO_INSERT);return K.copyAttributes(this),K.insertAbove(this),this.remove(),K}return $.base.call(this)},isClosed:function(){var $=this._children;for(var Q=0,J=$.length;Q<J;Q++)if(!$[Q]._closed)return!1;return!0},setClosed:function($){var Q=this._children;for(var J=0,U=Q.length;J<U;J++)Q[J].setClosed($)},getFirstSegment:function(){var $=this.getFirstChild();return $&&$.getFirstSegment()},getLastSegment:function(){var $=this.getLastChild();return $&&$.getLastSegment()},getCurves:function(){var $=this._children,Q=[];for(var J=0,U=$.length;J<U;J++)C.push(Q,$[J].getCurves());return Q},getFirstCurve:function(){var $=this.getFirstChild();return $&&$.getFirstCurve()},getLastCurve:function(){var $=this.getLastChild();return $&&$.getLastCurve()},getArea:function(){var $=this._children,Q=0;for(var J=0,U=$.length;J<U;J++)Q+=$[J].getArea();return Q},getLength:function(){var $=this._children,Q=0;for(var J=0,U=$.length;J<U;J++)Q+=$[J].getLength();return Q},getPathData:function($,Q){var J=this._children,U=[];for(var K=0,Z=J.length;K<Z;K++){var H=J[K],W=H._matrix;U.push(H.getPathData($&&!W.isIdentity()?$.appended(W):$,Q))}return U.join("")},_hitTestChildren:function $(Q,J,U){return $.base.call(this,Q,J.class===X0||J.type==="path"?J:C.set({},J,{fill:!1}),U)},_draw:function($,Q,J,U){var K=this._children;if(!K.length)return;Q=Q.extend({dontStart:!0,dontFinish:!0}),$.beginPath();for(var Z=0,H=K.length;Z<H;Z++)K[Z].draw($,Q,U);if(!Q.clip){this._setStyles($,Q,J);var W=this._style;if(W.hasFill())$.fill(W.getFillRule()),$.shadowColor="rgba(0,0,0,0)";if(W.hasStroke())$.stroke()}},_drawSelected:function($,Q,J){var U=this._children;for(var K=0,Z=U.length;K<Z;K++){var H=U[K],W=H._matrix;if(!J[H._id])H._drawSelected($,W.isIdentity()?Q:Q.appended(W))}}},new function(){function $(Q,J){var U=Q._children;if(J&&!U.length)throw new Error("Use a moveTo() command first");return U[U.length-1]}return C.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(Q){this[Q]=function(){var J=$(this,!0);J[Q].apply(J,arguments)}},{moveTo:function(){var Q=$(this),J=Q&&Q.isEmpty()?Q:new X0(Q0.NO_INSERT);if(J!==Q)this.addChild(J);J.moveTo.apply(J,arguments)},moveBy:function(){var Q=$(this,!0),J=Q&&Q.getLastSegment(),U=y.read(arguments);this.moveTo(J?U.add(J._point):U)},closePath:function(Q){$(this,!0).closePath(Q)}})},C.each(["reverse","flatten","simplify","smooth"],function($){this[$]=function(Q){var J=this._children,U;for(var K=0,Z=J.length;K<Z;K++)U=J[K][$](Q)||U;return U}},{}));r0.inject(new function(){var{min:$,max:Q,abs:J}=Math,U={unite:{"1":!0,"2":!0},intersect:{"2":!0},subtract:{"1":!0},exclude:{"1":!0,"-1":!0}};function K(D){return D._children||[D]}function Z(D,_){var T=D.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(_){var E=K(T);for(var R=0,z=E.length;R<z;R++){var D=E[R];if(!D._closed&&!D.isEmpty())D.closePath(0.000000000001),D.getFirstSegment().setHandleIn(0,0),D.getLastSegment().setHandleOut(0,0)}T=T.resolveCrossings().reorient(T.getFillRule()==="nonzero",!0)}return T}function H(D,_,T,E,R){var z=new g0(Q0.NO_INSERT);if(z.addChildren(D,!0),z=z.reduce({simplify:_}),!(R&&R.insert==!1))z.insertAbove(E&&T.isSibling(E)&&T.getIndex()<E.getIndex()?E:T);return z.copyAttributes(T,!0),z}function W(D){return D.hasOverlap()||D.isCrossing()}function Y(D,_,T,E){if(E&&(E.trace==!1||E.stroke)&&/^(subtract|intersect)$/.test(T))return X(D,_,T);var R=Z(D,!0),z=_&&D!==_&&Z(_,!0),G=U[T];if(G[T]=!0,z&&(G.subtract||G.exclude)^(z.isClockwise()^R.isClockwise()))z.reverse();var S=F(u0.expand(R.getIntersections(z,W))),P=K(R),w=z&&K(z),k=[],x=[],b;function f(o){for(var F0=0,U0=o.length;F0<U0;F0++){var H0=o[F0];C.push(k,H0._segments),C.push(x,H0.getCurves()),H0._overlapsOnly=!0}}function h(o){var F0=[];for(var U0=0,H0=o&&o.length;U0<H0;U0++)F0.push(x[o[U0]]);return F0}if(S.length){if(f(P),w)f(w);var u=new Array(x.length);for(var v=0,m=x.length;v<m;v++)u[v]=x[v].getValues();var d=A0.findCurveBoundsCollisions(u,u,0,!0),l={};for(var v=0;v<x.length;v++){var r=x[v],n=r._path._id,e=l[n]=l[n]||{};e[r.getIndex()]={hor:h(d[v].hor),ver:h(d[v].ver)}}for(var v=0,m=S.length;v<m;v++)L(S[v]._segment,R,z,l,G);for(var v=0,m=k.length;v<m;v++){var c=k[v],J0=c._intersection;if(!c._winding)L(c,R,z,l,G);if(!(J0&&J0._overlap))c._path._overlapsOnly=!1}b=B(k,G)}else b=O(w?P.concat(w):P.slice(),function(o){return!!G[o]});return H(b,!0,D,_,E)}function X(D,_,T){var E=Z(D),R=Z(_),z=E.getIntersections(R,W),G=T==="subtract",S=T==="divide",P={},w=[];function k(f){if(!P[f._id]&&(S||R.contains(f.getPointAt(f.getLength()/2))^G))return w.unshift(f),P[f._id]=!0}for(var x=z.length-1;x>=0;x--){var b=z[x].split();if(b){if(k(b))b.getFirstSegment().setHandleIn(0,0);E.getLastSegment().setHandleOut(0,0)}}return k(E),H(w,!1,D,_)}function A(D,_){var T=D;while(T){if(T===_)return;T=T._previous}while(D._next&&D._next!==_)D=D._next;if(!D._next){while(_._previous)_=_._previous;D._next=_,_._previous=D}}function q(D){for(var _=D.length-1;_>=0;_--)D[_].clearHandles()}function O(D,_,T){var E=D&&D.length;if(E){var R=C.each(D,function(d,l){this[d._id]={container:null,winding:d.isClockwise()?1:-1,index:l}},{}),z=D.slice().sort(function(d,l){return J(l.getArea())-J(d.getArea())}),G=z[0],S=A0.findItemBoundsCollisions(z,null,Z0.GEOMETRIC_EPSILON);if(T==null)T=G.isClockwise();for(var P=0;P<E;P++){var w=z[P],k=R[w._id],x=0,b=S[P];if(b){var f=null;for(var h=b.length-1;h>=0;h--)if(b[h]<P){f=f||w.getInteriorPoint();var u=z[b[h]];if(u.contains(f)){var v=R[u._id];x=v.winding,k.winding+=x,k.container=v.exclude?v.container:u;break}}}if(_(k.winding)===_(x))k.exclude=!0,D[k.index]=null;else{var m=k.container;w.setClockwise(m?!m.isClockwise():T)}}}return D}function F(D,_,T){var E=_&&[],R=0.00000001,z=1-R,G=!1,S=T||[],P=T&&{},w,k,x;function b(F0){return F0._path._id+"."+F0._segment1._index}for(var f=(T&&T.length)-1;f>=0;f--){var h=T[f];if(h._path)P[b(h)]=!0}for(var f=D.length-1;f>=0;f--){var u=D[f],v=u._time,m=v,d=_&&!_(u),h=u._curve,l;if(h){if(h!==k)G=!h.hasHandles()||P&&P[b(h)],w=[],x=null,k=h;else if(x>=R)v/=x}if(d){if(w)w.push(u);continue}else if(_)E.unshift(u);if(x=m,v<R)l=h._segment1;else if(v>z)l=h._segment2;else{var r=h.divideAtTime(v,!0);if(G)S.push(h,r);l=r._segment1;for(var n=w.length-1;n>=0;n--){var e=w[n];e._time=(e._time-v)/(1-v)}}u._setSegment(l);var c=l._intersection,J0=u._intersection;if(c){A(c,J0);var o=c;while(o)A(o._intersection,c),o=o._next}else l._intersection=J0}if(!T)q(S);return E||D}function V(D,_,T,E,R){var z=Array.isArray(_)?_:_[T?"hor":"ver"],G=T?1:0,S=G^1,P=[D.x,D.y],w=P[G],k=P[S],x=0.000000001,b=0.000001,f=w-x,h=w+x,u=0,v=0,m=0,d=0,l=!1,r=!1,n=1,e=[],c,J0;function o(E0){var B0=E0[S+0],y0=E0[S+6];if(k<$(B0,y0)||k>Q(B0,y0))return;var P0=E0[G+0],c0=E0[G+2],$8=E0[G+4],s0=E0[G+6];if(B0===y0){if(P0<h&&s0>f||s0<h&&P0>f)l=!0;return}var n0=k===B0?0:k===y0?1:f>Q(P0,c0,$8,s0)||h<$(P0,c0,$8,s0)?1:p.solveCubic(E0,S,k,e,0,1)>0?e[0]:1,h0=n0===0?P0:n0===1?s0:p.getPoint(E0,n0)[T?"y":"x"],v0=B0>y0?1:-1,Z8=c[S]>c[S+6]?1:-1,o0=c[G+6];if(k!==B0){if(h0<f)m+=v0;else if(h0>h)d+=v0;else l=!0;if(h0>w-b&&h0<w+b)n/=2}else{if(v0!==Z8){if(P0<f)m+=v0;else if(P0>h)d+=v0}else if(P0!=o0){if(o0<h&&h0>h)d+=v0,l=!0;else if(o0>f&&h0<f)m+=v0,l=!0}n/=4}return c=E0,!R&&h0>f&&h0<h&&p.getTangent(E0,n0)[T?"x":"y"]===0&&V(D,_,!T,E,!0)}function F0(E0){var B0=E0[S+0],y0=E0[S+2],P0=E0[S+4],c0=E0[S+6];if(k<=Q(B0,y0,P0,c0)&&k>=$(B0,y0,P0,c0)){var $8=E0[G+0],s0=E0[G+2],n0=E0[G+4],h0=E0[G+6],v0=f>Q($8,s0,n0,h0)||h<$($8,s0,n0,h0)?[E0]:p.getMonoCurves(E0,T),Z8;for(var o0=0,p8=v0.length;o0<p8;o0++)if(Z8=o(v0[o0]))return Z8}}for(var U0=0,H0=z.length;U0<H0;U0++){var Y0=z[U0],K0=Y0._path,S0=Y0.getValues(),C0;if(!U0||z[U0-1]._path!==K0){if(c=null,!K0._closed){if(J0=p.getValues(K0.getLastCurve().getSegment2(),Y0.getSegment1(),null,!E),J0[S]!==J0[S+6])c=J0}if(!c){c=S0;var w0=K0.getLastCurve();while(w0&&w0!==Y0){var M0=w0.getValues();if(M0[S]!==M0[S+6]){c=M0;break}w0=w0.getPrevious()}}}if(C0=F0(S0))return C0;if(U0+1===H0||z[U0+1]._path!==K0){if(J0&&(C0=F0(J0)))return C0;if(l&&!m&&!d)m=d=K0.isClockwise(E)^T?1:-1;if(u+=m,v+=d,m=d=0,l)r=!0,l=!1;J0=null}}return u=J(u),v=J(v),{winding:Q(u,v),windingL:u,windingR:v,quality:n,onPath:r}}function L(D,_,T,E,R){var z=[],G=D,S=0,x;do{var P=D.getCurve();if(P){var w=P.getLength();z.push({segment:D,curve:P,length:w}),S+=w}D=D.getNext()}while(D&&!D._intersection&&D!==G);var k=[0.5,0.25,0.75],x={winding:0,quality:-1},b=0.001,f=1-b;for(var h=0;h<k.length&&x.quality<0.5;h++){var w=S*k[h];for(var u=0,v=z.length;u<v;u++){var m=z[u],d=m.length;if(w<=d){var P=m.curve,l=P._path,r=l._parent,n=r instanceof g0?r:l,e=Z0.clamp(P.getTimeAt(w),b,f),c=P.getPointAtTime(e),J0=J(P.getTangentAtTime(e).y)<Math.SQRT1_2,o=null;if(R.subtract&&T){var F0=n===_?T:_,U0=F0._getWinding(c,J0,!0);if(n===_&&U0.winding||n===T&&!U0.winding)if(U0.quality<1)continue;else o={winding:0,quality:1}}if(o=o||V(c,E[l._id][P.getIndex()],J0,!0),o.quality>x.quality)x=o;break}w-=d}}for(var u=z.length-1;u>=0;u--)z[u].segment._winding=x}function B(D,_){var T=[],E;function R(H0){var Y0;return!!(H0&&!H0._visited&&(!_||_[(Y0=H0._winding||{}).winding]&&!(_.unite&&Y0.winding===2&&Y0.windingL&&Y0.windingR)))}function z(H0){if(H0){for(var Y0=0,K0=E.length;Y0<K0;Y0++)if(H0===E[Y0])return!0}return!1}function G(H0){var Y0=H0._segments;for(var K0=0,S0=Y0.length;K0<S0;K0++)Y0[K0]._visited=!0}function S(H0,Y0){var K0=H0._intersection,S0=K0,C0=[];if(Y0)E=[H0];function w0(M0,E0){while(M0&&M0!==E0){var B0=M0._segment,y0=B0&&B0._path;if(y0){var P0=B0.getNext()||y0.getFirstSegment(),c0=P0._intersection;if(B0!==H0&&(z(B0)||z(P0)||P0&&(R(B0)&&(R(P0)||c0&&R(c0._segment)))))C0.push(B0);if(Y0)E.push(B0)}M0=M0._next}}if(K0){w0(K0);while(K0&&K0._previous)K0=K0._previous;w0(K0,S0)}return C0}D.sort(function(H0,Y0){var K0=H0._intersection,S0=Y0._intersection,C0=!!(K0&&K0._overlap),w0=!!(S0&&S0._overlap),M0=H0._path,E0=Y0._path;return C0^w0?C0?1:-1:!K0^!S0?K0?1:-1:M0!==E0?M0._id-E0._id:H0._index-Y0._index});for(var P=0,w=D.length;P<w;P++){var k=D[P],x=R(k),b=null,f=!1,h=!0,u=[],v,m,d;if(x&&k._path._overlapsOnly){var l=k._path,r=k._intersection._segment._path;if(l.compare(r)){if(l.getArea())T.push(l.clone(!1));G(l),G(r),x=!1}}while(x){var n=!b,e=S(k,n),c=e.shift(),f=!n&&(z(k)||z(c)),J0=!f&&c;if(n)b=new X0(Q0.NO_INSERT),v=null;if(f){if(k.isFirst()||k.isLast())h=k._path._closed;k._visited=!0;break}if(J0&&v)u.push(v),v=null;if(!v){if(J0)e.push(k);v={start:b._segments.length,crossings:e,visited:m=[],handleIn:d}}if(J0)k=c;if(!R(k)){b.removeSegments(v.start);for(var o=0,F0=m.length;o<F0;o++)m[o]._visited=!1;m.length=0;do if(k=v&&v.crossings.shift(),!k||!k._path){if(k=null,v=u.pop(),v)m=v.visited,d=v.handleIn}while(v&&!R(k));if(!k)break}var U0=k.getNext();b.add(new i(k._point,d,U0&&k._handleOut)),k._visited=!0,m.push(k),k=U0||k._path.getFirstSegment(),d=U0&&U0._handleIn}if(f){if(h)b.getFirstSegment().setHandleIn(d),b.setClosed(h);if(b.getArea()!==0)T.push(b)}}return T}return{_getWinding:function(D,_,T){return V(D,this.getCurves(),_,T)},unite:function(D,_){return Y(this,D,"unite",_)},intersect:function(D,_){return Y(this,D,"intersect",_)},subtract:function(D,_){return Y(this,D,"subtract",_)},exclude:function(D,_){return Y(this,D,"exclude",_)},divide:function(D,_){return _&&(_.trace==!1||_.stroke)?X(this,D,"divide"):H([this.subtract(D,_),this.intersect(D,_)],!0,this,D,_)},resolveCrossings:function(){var D=this._children,_=D||[this];function T(v,m){var d=v&&v._intersection;return d&&d._overlap&&d._path===m}var E=!1,R=!1,z=this.getIntersections(null,function(v){return v.hasOverlap()&&(E=!0)||v.isCrossing()&&(R=!0)}),G=E&&R&&[];if(z=u0.expand(z),E){var S=F(z,function(v){return v.hasOverlap()},G);for(var P=S.length-1;P>=0;P--){var w=S[P],k=w._path,x=w._segment,b=x.getPrevious(),f=x.getNext();if(T(b,k)&&T(f,k)){if(x.remove(),b._handleOut._set(0,0),f._handleIn._set(0,0),b!==x&&!b.getCurve().hasLength())f._handleIn.set(b._handleIn),b.remove()}}}if(R){if(F(z,E&&function(v){var m=v.getCurve(),d=v.getSegment(),l=v._intersection,r=l._curve,n=l._segment;if(m&&r&&m._path&&r._path)return!0;if(d)d._intersection=null;if(n)n._intersection=null},G),G)q(G);_=B(C.each(_,function(v){C.push(this,v._segments)},[]))}var h=_.length,u;if(h>1&&D){if(_!==D)this.setChildren(_);u=this}else if(h===1&&!D){if(_[0]!==this)this.setSegments(_[0].removeSegments());u=this}if(!u)u=new g0(Q0.NO_INSERT),u.addChildren(_),u=u.reduce(),u.copyAttributes(this),this.replaceWith(u);return u},reorient:function(D,_){var T=this._children;if(T&&T.length)this.setChildren(O(this.removeChildren(),function(E){return!!(D?E:E&1)},_));else if(_!==I)this.setClockwise(_);return this},getInteriorPoint:function(){var D=this.getBounds(),_=D.getCenter(!0);if(!this.contains(_)){var T=this.getCurves(),E=_.y,R=[],z=[];for(var G=0,S=T.length;G<S;G++){var P=T[G].getValues(),w=P[1],k=P[3],x=P[5],b=P[7];if(E>=$(w,k,x,b)&&E<=Q(w,k,x,b)){var f=p.getMonoCurves(P);for(var h=0,u=f.length;h<u;h++){var v=f[h],m=v[1],d=v[7];if(m!==d&&(E>=m&&E<=d||E>=d&&E<=m)){var l=E===m?v[0]:E===d?v[6]:p.solveCubic(v,1,E,z,0,1)===1?p.getPoint(v,z[0]).x:(v[0]+v[6])/2;R.push(l)}}}}if(R.length>1)R.sort(function(r,n){return r-n}),_.x=(R[0]+R[1])/2}return _}}});var D8=C.extend({_class:"PathFlattener",initialize:function($,Q,J,U,K){var Z=[],H=[],W=0,Y=1/(J||32),X=$._segments,A=X[0],q;function O(B,D){var _=p.getValues(B,D,K);Z.push(_),F(_,B._index,0,1)}function F(B,D,_,T){if(T-_>Y&&!(U&&p.isStraight(B))&&!p.isFlatEnough(B,Q||0.25)){var E=p.subdivide(B,0.5),R=(_+T)/2;F(E[0],D,_,R),F(E[1],D,R,T)}else{var z=B[6]-B[0],G=B[7]-B[1],S=Math.sqrt(z*z+G*G);if(S>0)W+=S,H.push({offset:W,curve:B,index:D,time:T})}}for(var V=1,L=X.length;V<L;V++)q=X[V],O(A,q),A=q;if($._closed)O(q||A,X[0]);this.curves=Z,this.parts=H,this.length=W,this.index=0},_get:function($){var Q=this.parts,J=Q.length,U,K,Z=this.index;for(;;)if(K=Z,!Z||Q[--Z].offset<$)break;for(;K<J;K++){var H=Q[K];if(H.offset>=$){this.index=K;var W=Q[K-1],Y=W&&W.index===H.index?W.time:0,X=W?W.offset:0;return{index:H.index,time:Y+(H.time-Y)*($-X)/(H.offset-X)}}}return{index:Q[J-1].index,time:1}},drawPart:function($,Q,J){var U=this._get(Q),K=this._get(J);for(var Z=U.index,H=K.index;Z<=H;Z++){var W=p.getPart(this.curves[Z],Z===U.index?U.time:0,Z===K.index?K.time:1);if(Z===U.index)$.moveTo(W[0],W[1]);$.bezierCurveTo.apply($,W.slice(2))}}},C.each(p._evaluateMethods,function($){this[$+"At"]=function(Q){var J=this._get(Q);return p[$](this.curves[J.index],J.time)}},{})),y8=C.extend({initialize:function($){var Q=this.points=[],J=$._segments,U=$._closed;for(var K=0,Z,H=J.length;K<H;K++){var W=J[K].point;if(!Z||!Z.equals(W))Q.push(Z=W.clone())}if(U)Q.unshift(Q[Q.length-1]),Q.push(Q[1]);this.closed=U},fit:function($){var Q=this.points,J=Q.length,U=null;if(J>0){if(U=[new i(Q[0])],J>1){if(this.fitCubic(U,$,0,J-1,Q[1].subtract(Q[0]),Q[J-2].subtract(Q[J-1])),this.closed)U.shift(),U.pop()}}return U},fitCubic:function($,Q,J,U,K,Z){var H=this.points;if(U-J===1){var W=H[J],Y=H[U],X=W.getDistance(Y)/3;this.addCurve($,[W,W.add(K.normalize(X)),Y.add(Z.normalize(X)),Y]);return}var A=this.chordLengthParameterize(J,U),q=Math.max(Q,Q*Q),O,F=!0;for(var V=0;V<=4;V++){var L=this.generateBezier(J,U,A,K,Z),B=this.findMaxError(J,U,L,A);if(B.error<Q&&F){this.addCurve($,L);return}if(O=B.index,B.error>=q)break;F=this.reparameterize(J,U,A,L),q=B.error}var D=H[O-1].subtract(H[O+1]);this.fitCubic($,Q,J,O,K,D),this.fitCubic($,Q,O,U,D.negate(),Z)},addCurve:function($,Q){var J=$[$.length-1];J.setHandleOut(Q[1].subtract(Q[0])),$.push(new i(Q[3],Q[2].subtract(Q[3])))},generateBezier:function($,Q,J,U,K){var Z=0.000000000001,H=Math.abs,W=this.points,Y=W[$],X=W[Q],A=[[0,0],[0,0]],q=[0,0];for(var O=0,F=Q-$+1;O<F;O++){var V=J[O],L=1-V,B=3*V*L,D=L*L*L,_=B*L,T=B*V,E=V*V*V,R=U.normalize(_),z=K.normalize(T),G=W[$+O].subtract(Y.multiply(D+_)).subtract(X.multiply(T+E));A[0][0]+=R.dot(R),A[0][1]+=R.dot(z),A[1][0]=A[0][1],A[1][1]+=z.dot(z),q[0]+=R.dot(G),q[1]+=z.dot(G)}var S=A[0][0]*A[1][1]-A[1][0]*A[0][1],P,w;if(H(S)>Z){var k=A[0][0]*q[1]-A[1][0]*q[0],x=q[0]*A[1][1]-q[1]*A[0][1];P=x/S,w=k/S}else{var b=A[0][0]+A[0][1],f=A[1][0]+A[1][1];P=w=H(b)>Z?q[0]/b:H(f)>Z?q[1]/f:0}var h=X.getDistance(Y),u=Z*h,v,m;if(P<u||w<u)P=w=h/3;else{var d=X.subtract(Y);if(v=U.normalize(P),m=K.normalize(w),v.dot(d)-m.dot(d)>h*h)P=w=h/3,v=m=null}return[Y,Y.add(v||U.normalize(P)),X.add(m||K.normalize(w)),X]},reparameterize:function($,Q,J,U){for(var K=$;K<=Q;K++)J[K-$]=this.findRoot(U,this.points[K],J[K-$]);for(var K=1,Z=J.length;K<Z;K++)if(J[K]<=J[K-1])return!1;return!0},findRoot:function($,Q,J){var U=[],K=[];for(var Z=0;Z<=2;Z++)U[Z]=$[Z+1].subtract($[Z]).multiply(3);for(var Z=0;Z<=1;Z++)K[Z]=U[Z+1].subtract(U[Z]).multiply(2);var H=this.evaluate(3,$,J),W=this.evaluate(2,U,J),Y=this.evaluate(1,K,J),X=H.subtract(Q),A=W.dot(W)+X.dot(Y);return Z0.isMachineZero(A)?J:J-X.dot(W)/A},evaluate:function($,Q,J){var U=Q.slice();for(var K=1;K<=$;K++)for(var Z=0;Z<=$-K;Z++)U[Z]=U[Z].multiply(1-J).add(U[Z+1].multiply(J));return U[0]},chordLengthParameterize:function($,Q){var J=[0];for(var U=$+1;U<=Q;U++)J[U-$]=J[U-$-1]+this.points[U].getDistance(this.points[U-1]);for(var U=1,K=Q-$;U<=K;U++)J[U]/=J[K];return J},findMaxError:function($,Q,J,U){var K=Math.floor((Q-$+1)/2),Z=0;for(var H=$+1;H<Q;H++){var W=this.evaluate(3,J,U[H-$]),Y=W.subtract(this.points[H]),X=Y.x*Y.x+Y.y*Y.y;if(X>=Z)Z=X,K=H}return{error:Z,index:K}}}),J8=Q0.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function $(Q){this._content="",this._lines=[];var J=Q&&C.isPlainObject(Q)&&Q.x===I&&Q.y===I;this._initialize(J&&Q,!J&&y.read(arguments))},_equals:function($){return this._content===$._content},copyContent:function($){this.setContent($._content)},getContent:function(){return this._content},setContent:function($){this._content=""+$,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),h8=J8.extend({_class:"PointText",initialize:function $(){J8.apply(this,arguments)},getPoint:function(){var $=this._matrix.getTranslation();return new x0($.x,$.y,this,"setPoint")},setPoint:function(){var $=y.read(arguments);this.translate($.subtract(this._matrix.getTranslation()))},_draw:function($,Q,J){if(!this._content)return;this._setStyles($,Q,J);var U=this._lines,K=this._style,Z=K.hasFill(),H=K.hasStroke(),W=K.getLeading(),Y=$.shadowColor;$.font=K.getFontStyle(),$.textAlign=K.getJustification();for(var X=0,A=U.length;X<A;X++){$.shadowColor=Y;var q=U[X];if(Z)$.fillText(q,0,0),$.shadowColor="rgba(0,0,0,0)";if(H)$.strokeText(q,0,0);$.translate(0,W)}},_getBounds:function($,Q){var J=this._style,U=this._lines,K=U.length,Z=J.getJustification(),H=J.getLeading(),W=this.getView().getTextWidth(J.getFontStyle(),U),Y=0;if(Z!=="left")Y-=W/(Z==="center"?2:1);var X=new t(Y,K?-0.75*H:0,W,K*H);return $?$._transformBounds(X,X):X}}),z0=C.extend(new function(){var $={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},Q={},J={transparent:[0,0,0,0]},U;function K(W){var Y=W.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||W.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),X="rgb",A;if(Y){var q=Y[4]?4:3;A=new Array(q);for(var O=0;O<q;O++){var F=Y[O+1];A[O]=parseInt(F.length==1?F+F:F,16)/255}}else if(Y=W.match(/^(rgb|hsl)a?\((.*)\)$/)){X=Y[1],A=Y[2].trim().split(/[,\s]+/g);var V=X==="hsl";for(var O=0,L=Math.min(A.length,4);O<L;O++){var B=A[O],F=parseFloat(B);if(V){if(O===0){var D=B.match(/([a-z]*)$/)[1];F*={turn:360,rad:180/Math.PI,grad:0.9}[D]||1}else if(O<3)F/=100}else if(O<3)F/=/%$/.test(B)?100:255;A[O]=F}}else{var _=J[W];if(!_)if(j){if(!U)U=L0.getContext(1,1,{willReadFrequently:!0}),U.globalCompositeOperation="copy";U.fillStyle="rgba(0,0,0,0)",U.fillStyle=W,U.fillRect(0,0,1,1);var T=U.getImageData(0,0,1,1).data;_=J[W]=[T[0]/255,T[1]/255,T[2]/255]}else _=[0,0,0];A=_.slice()}return[X,A]}var Z=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],H={"rgb-hsb":function(W,Y,X){var A=Math.max(W,Y,X),q=Math.min(W,Y,X),O=A-q,F=O===0?0:(A==W?(Y-X)/O+(Y<X?6:0):A==Y?(X-W)/O+2:(W-Y)/O+4)*60;return[F,A===0?0:O/A,A]},"hsb-rgb":function(W,Y,X){W=(W/60%6+6)%6;var q=Math.floor(W),A=W-q,q=Z[q],O=[X,X*(1-Y),X*(1-Y*A),X*(1-Y*(1-A))];return[O[q[0]],O[q[1]],O[q[2]]]},"rgb-hsl":function(W,Y,X){var A=Math.max(W,Y,X),q=Math.min(W,Y,X),O=A-q,F=O===0,V=F?0:(A==W?(Y-X)/O+(Y<X?6:0):A==Y?(X-W)/O+2:(W-Y)/O+4)*60,L=(A+q)/2,B=F?0:L<0.5?O/(A+q):O/(2-A-q);return[V,B,L]},"hsl-rgb":function(W,Y,X){if(W=(W/360%1+1)%1,Y===0)return[X,X,X];var A=[W+0.3333333333333333,W,W-0.3333333333333333],q=X<0.5?X*(1+Y):X+Y-X*Y,O=2*X-q,F=[];for(var V=0;V<3;V++){var L=A[V];if(L<0)L+=1;if(L>1)L-=1;F[V]=6*L<1?O+(q-O)*6*L:2*L<1?q:3*L<2?O+(q-O)*(0.6666666666666666-L)*6:O}return F},"rgb-gray":function(W,Y,X){return[W*0.2989+Y*0.587+X*0.114]},"gray-rgb":function(W){return[W,W,W]},"gray-hsb":function(W){return[0,0,W]},"gray-hsl":function(W){return[0,0,W]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return C.each($,function(W,Y){Q[Y]=[],C.each(W,function(X,A){var q=C.capitalize(X),O=/^(hue|saturation)$/.test(X),F=Q[Y][A]=Y==="gradient"?X==="gradient"?function(V){var L=this._components[0];if(V=U8.read(Array.isArray(V)?V:arguments,0,{readNull:!0}),L!==V){if(L)L._removeOwner(this);if(V)V._addOwner(this)}return V}:function(){return y.read(arguments,0,{readNull:X==="highlight",clone:!0})}:function(V){return V==null||isNaN(V)?0:+V};this["get"+q]=function(){return this._type===Y||O&&/^hs[bl]$/.test(this._type)?this._components[A]:this._convert(Y)[A]},this["set"+q]=function(V){if(this._type!==Y&&!(O&&/^hs[bl]$/.test(this._type)))this._components=this._convert(Y),this._properties=$[Y],this._type=Y;this._components[A]=F.call(this,V),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function W(Y){var X=arguments,A=this.__read,q=0,O,F,V,L;if(Array.isArray(Y))X=Y,Y=X[0];var B=Y!=null&&typeof Y;if(B==="string"&&Y in $)if(O=Y,Y=X[1],Array.isArray(Y))F=Y,V=X[2];else{if(A)q=1;X=C.slice(X,1),B=typeof Y}if(!F){if(L=B==="number"?X:B==="object"&&Y.length!=null?Y:null,L){if(!O)O=L.length>=3?"rgb":"gray";var D=$[O].length;if(V=L[D],A)q+=L===arguments?D+(V!=null?1:0):1;if(L.length>D)L=C.slice(L,0,D)}else if(B==="string"){var _=K(Y);if(O=_[0],F=_[1],F.length===4)V=F[3],F.length--}else if(B==="object")if(Y.constructor===W){if(O=Y._type,F=Y._components.slice(),V=Y._alpha,O==="gradient")for(var T=1,E=F.length;T<E;T++){var R=F[T];if(R)F[T]=R.clone()}}else if(Y.constructor===U8)O="gradient",L=X;else{O="hue"in Y?"lightness"in Y?"hsl":"hsb":("gradient"in Y)||("stops"in Y)||("radial"in Y)?"gradient":("gray"in Y)?"gray":"rgb";var z=$[O],G=Q[O];this._components=F=[];for(var T=0,E=z.length;T<E;T++){var S=Y[z[T]];if(S==null&&!T&&O==="gradient"&&"stops"in Y)S={stops:Y.stops,radial:Y.radial};if(S=G[T].call(this,S),S!=null)F[T]=S}V=Y.alpha}if(A&&O)q=1}if(this._type=O||"rgb",!F){this._components=F=[];var G=Q[this._type];for(var T=0,E=G.length;T<E;T++){var S=G[T].call(this,L&&L[T]);if(S!=null)F[T]=S}}if(this._components=F,this._properties=$[this._type],this._alpha=V,A)this.__read=q;return this},set:"#initialize",_serialize:function(W,Y){var X=this.getComponents();return C.serialize(/^(gray|rgb)$/.test(this._type)?X:[this._type].concat(X),W,!0,Y)},_changed:function(){if(this._canvasStyle=null,this._owner)if(this._setter)this._owner[this._setter](this);else this._owner._changed(129)},_convert:function(W){var Y;return this._type===W?this._components.slice():(Y=H[this._type+"-"+W])?Y.apply(this,this._components):H["rgb-"+W].apply(this,H[this._type+"-rgb"].apply(this,this._components))},convert:function(W){return new z0(W,this._convert(W),this._alpha)},getType:function(){return this._type},setType:function(W){this._components=this._convert(W),this._properties=$[W],this._type=W},getComponents:function(){var W=this._components.slice();if(this._alpha!=null)W.push(this._alpha);return W},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(W){this._alpha=W==null?null:Math.min(Math.max(W,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(W){var Y=C.isPlainValue(W,!0)?z0.read(arguments):W;return Y===this||Y&&this._class===Y._class&&this._type===Y._type&&this.getAlpha()===Y.getAlpha()&&C.equals(this._components,Y._components)||!1},toString:function(){var W=this._properties,Y=[],X=this._type==="gradient",A=D0.instance;for(var q=0,O=W.length;q<O;q++){var F=this._components[q];if(F!=null)Y.push(W[q]+": "+(X?F:A.number(F)))}if(this._alpha!=null)Y.push("alpha: "+A.number(this._alpha));return"{ "+Y.join(", ")+" }"},toCSS:function(W){var Y=this._convert("rgb"),X=W||this._alpha==null?1:this._alpha;function A(q){return Math.round((q<0?0:q>1?1:q)*255)}if(Y=[A(Y[0]),A(Y[1]),A(Y[2])],X<1)Y.push(X<0?0:X);return W?"#"+((1<<24)+(Y[0]<<16)+(Y[1]<<8)+Y[2]).toString(16).slice(1):(Y.length==4?"rgba(":"rgb(")+Y.join(",")+")"},toCanvasStyle:function(W,Y){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var X=this._components,A=X[0],q=A._stops,O=X[1],F=X[2],V=X[3],L=Y&&Y.inverted(),B;if(L){if(O=L._transformPoint(O),F=L._transformPoint(F),V)V=L._transformPoint(V)}if(A._radial){var D=F.getDistance(O);if(V){var _=V.subtract(O);if(_.getLength()>D)V=O.add(_.normalize(D-0.1))}var T=V||O;B=W.createRadialGradient(T.x,T.y,0,O.x,O.y,D)}else B=W.createLinearGradient(O.x,O.y,F.x,F.y);for(var E=0,R=q.length;E<R;E++){var z=q[E],G=z._offset;B.addColorStop(G==null?E/(R-1):G,z._color.toCanvasStyle())}return this._canvasStyle=B},transform:function(W){if(this._type==="gradient"){var Y=this._components;for(var X=1,A=Y.length;X<A;X++){var q=Y[X];W._transformPoint(q,q,!0)}this._changed()}},statics:{_types:$,random:function(){var W=Math.random;return new z0(W(),W(),W())},_setOwner:function(W,Y,X){if(W){if(W._owner&&Y&&W._owner!==Y)W=W.clone();if(!W._owner^!Y)W._owner=Y||null,W._setter=X||null}return W}}})},new function(){var $={add:function(Q,J){return Q+J},subtract:function(Q,J){return Q-J},multiply:function(Q,J){return Q*J},divide:function(Q,J){return Q/J}};return C.each($,function(Q,J){this[J]=function(U){U=z0.read(arguments);var K=this._type,Z=this._components,H=U._convert(K);for(var W=0,Y=Z.length;W<Y;W++)H[W]=Q(Z[W],H[W]);return new z0(K,H,this._alpha!=null?Q(this._alpha,U.getAlpha()):null)}},{})}),U8=C.extend({_class:"Gradient",initialize:function $(Q,J){if(this._id=b0.get(),Q&&C.isPlainObject(Q))this.set(Q),Q=J=null;if(this._stops==null)this.setStops(Q||["white","black"]);if(this._radial==null)this.setRadial(typeof J==="string"&&J==="radial"||J||!1)},_serialize:function($,Q){return Q.add(this,function(){return C.serialize([this._stops,this._radial],$,!0,Q)})},_changed:function(){for(var $=0,Q=this._owners&&this._owners.length;$<Q;$++)this._owners[$]._changed()},_addOwner:function($){if(!this._owners)this._owners=[];this._owners.push($)},_removeOwner:function($){var Q=this._owners?this._owners.indexOf($):-1;if(Q!=-1){if(this._owners.splice(Q,1),!this._owners.length)this._owners=I}},clone:function(){var $=[];for(var Q=0,J=this._stops.length;Q<J;Q++)$[Q]=this._stops[Q].clone();return new U8($,this._radial)},getStops:function(){return this._stops},setStops:function($){if($.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var Q=this._stops;if(Q)for(var J=0,U=Q.length;J<U;J++)Q[J]._owner=I;Q=this._stops=O8.readList($,0,{clone:!0});for(var J=0,U=Q.length;J<U;J++)Q[J]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function($){this._radial=$,this._changed()},equals:function($){if($===this)return!0;if($&&this._class===$._class){var Q=this._stops,J=$._stops,U=Q.length;if(U===J.length){for(var K=0;K<U;K++)if(!Q[K].equals(J[K]))return!1;return!0}}return!1}}),O8=C.extend({_class:"GradientStop",initialize:function $(Q,J){var U=Q,K=J;if(typeof Q==="object"&&J===I){if(Array.isArray(Q)&&typeof Q[0]!=="number")U=Q[0],K=Q[1];else if("color"in Q||"offset"in Q||"rampPoint"in Q)U=Q.color,K=Q.offset||Q.rampPoint||0}this.setColor(U),this.setOffset(K)},clone:function(){return new O8(this._color.clone(),this._offset)},_serialize:function($,Q){var J=this._color,U=this._offset;return C.serialize(U==null?[J]:[J,U],$,!0,Q)},_changed:function(){if(this._owner)this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function($){this._offset=$,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){z0._setOwner(this._color,null),this._color=z0._setOwner(z0.read(arguments,0),this,"setColor"),this._changed()},equals:function($){return $===this||$&&this._class===$._class&&this._color.equals($._color)&&this._offset==$._offset||!1}}),A8=C.extend(new function(){var $={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new y,selectedColor:null},Q=C.set({},$,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),J=C.set({},Q,{fillColor:new z0}),U={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},K={beans:!0},Z={_class:"Style",beans:!0,initialize:function H(W,Y,X){if(this._values={},this._owner=Y,this._project=Y&&Y._project||X||W0.project,this._defaults=!Y||Y instanceof d0?Q:Y instanceof J8?J:$,W)this.set(W)}};return C.each(Q,function(H,W){var Y=/Color$/.test(W),X=W==="shadowOffset",A=C.capitalize(W),q=U[W],O="set"+A,F="get"+A;Z[O]=function(V){var L=this._owner,B=L&&L._children,D=B&&B.length>0&&!(L instanceof g0);if(D)for(var _=0,T=B.length;_<T;_++)B[_]._style[O](V);if((W==="selectedColor"||!D)&&W in this._defaults){var E=this._values[W];if(E!==V){if(Y){if(E)z0._setOwner(E,null),E._canvasStyle=null;if(V&&V.constructor===z0)V=z0._setOwner(V,L,D&&O)}if(this._values[W]=V,L)L._changed(q||129)}}},Z[F]=function(V){var L=this._owner,B=L&&L._children,D=B&&B.length>0&&!(L instanceof g0),_;if(D&&!V)for(var T=0,E=B.length;T<E;T++){var R=B[T]._style[F]();if(!T)_=R;else if(!C.equals(_,R))return I}else if(W in this._defaults){var _=this._values[W];if(_===I){if(_=this._defaults[W],_&&_.clone)_=_.clone()}else{var z=Y?z0:X?y:null;if(z&&!(_&&_.constructor===z))this._values[W]=_=z.read([_],0,{readNull:!0,clone:!0})}}if(_&&Y)_=z0._setOwner(_,L,D&&O);return _},K[F]=function(V){return this._style[F](V)},K[O]=function(V){this._style[O](V)}}),C.each({Font:"FontFamily",WindingRule:"FillRule"},function(H,W){var Y="get"+W,X="set"+W;Z[Y]=K[Y]="#get"+H,Z[X]=K[X]="#set"+H}),Q0.inject(K),Z},{set:function($){var Q=$ instanceof A8,J=Q?$._values:$;if(J){for(var U in J)if(U in this._defaults){var K=J[U];this[U]=K&&Q&&K.clone?K.clone():K}}},equals:function($){function Q(J,U,K){var Z=J._values,H=U._values,W=U._defaults;for(var Y in Z){var X=Z[Y],A=H[Y];if(!(K&&(Y in H))&&!C.equals(X,A===I?W[Y]:A))return!1}return!0}return $===this||$&&this._class===$._class&&Q(this,$)&&Q($,this,!0)||!1},_dispose:function(){var $=this.getFillColor();if($)$._canvasStyle=null;if($=this.getStrokeColor(),$)$._canvasStyle=null;if($=this.getShadowColor(),$)$._canvasStyle=null},hasFill:function(){var $=this.getFillColor();return!!$&&$.alpha>0},hasStroke:function(){var $=this.getStrokeColor();return!!$&&$.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var $=this.getShadowColor();return!!$&&$.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var $=this.getFontSize();return this.getFontWeight()+" "+$+(/[a-z]/i.test($+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function $(){var Q=$.base.call(this),J=this.getFontSize();if(/pt|em|%|px/.test(J))J=this.getView().getPixelSize(J);return Q!=null?Q:J*1.2}}),V0=new function(){function $(Q,J,U,K){var Z=["","webkit","moz","Moz","ms","o"],H=J[0].toUpperCase()+J.substring(1);for(var W=0;W<6;W++){var Y=Z[W],X=Y?Y+H:J;if(X in Q){if(U)Q[X]=K;else return Q[X];break}}}return{getStyles:function(Q){var J=Q&&Q.nodeType!==9?Q.ownerDocument:Q,U=J&&J.defaultView;return U&&U.getComputedStyle(Q,"")},getBounds:function(Q,J){var U=Q.ownerDocument,K=U.body,Z=U.documentElement,H;try{H=Q.getBoundingClientRect()}catch(A){H={left:0,top:0,width:0,height:0}}var W=H.left-(Z.clientLeft||K.clientLeft||0),Y=H.top-(Z.clientTop||K.clientTop||0);if(!J){var X=U.defaultView;W+=X.pageXOffset||Z.scrollLeft||K.scrollLeft,Y+=X.pageYOffset||Z.scrollTop||K.scrollTop}return new t(W,Y,H.width,H.height)},getViewportBounds:function(Q){var J=Q.ownerDocument,U=J.defaultView,K=J.documentElement;return new t(0,0,U.innerWidth||K.clientWidth,U.innerHeight||K.clientHeight)},getOffset:function(Q,J){return V0.getBounds(Q,J).getPoint()},getSize:function(Q){return V0.getBounds(Q,!0).getSize()},isInvisible:function(Q){return V0.getSize(Q).equals(new s(0,0))},isInView:function(Q){return!V0.isInvisible(Q)&&V0.getViewportBounds(Q).intersects(V0.getBounds(Q,!0))},isInserted:function(Q){return g.body.contains(Q)},getPrefixed:function(Q,J){return Q&&$(Q,J)},setPrefixed:function(Q,J,U){if(typeof J==="object")for(var K in J)$(Q,K,!0,J[K]);else $(Q,J,!0,U)}}},I0={add:function($,Q){if($)for(var J in Q){var U=Q[J],K=J.split(/[\s,]+/g);for(var Z=0,H=K.length;Z<H;Z++){var W=K[Z],Y=$===g&&(W==="touchstart"||W==="touchmove")?{passive:!1}:!1;$.addEventListener(W,U,Y)}}},remove:function($,Q){if($)for(var J in Q){var U=Q[J],K=J.split(/[\s,]+/g);for(var Z=0,H=K.length;Z<H;Z++)$.removeEventListener(K[Z],U,!1)}},getPoint:function($){var Q=$.targetTouches?$.targetTouches.length?$.targetTouches[0]:$.changedTouches[0]:$;return new y(Q.pageX||Q.clientX+g.documentElement.scrollLeft,Q.pageY||Q.clientY+g.documentElement.scrollTop)},getTarget:function($){return $.target||$.srcElement},getRelatedTarget:function($){return $.relatedTarget||$.toElement},getOffset:function($,Q){return I0.getPoint($).subtract(V0.getOffset(Q||I0.getTarget($)))}};I0.requestAnimationFrame=new function(){var $=V0.getPrefixed(j,"requestAnimationFrame"),Q=!1,J=[],U;function K(){var Z=J;J=[];for(var H=0,W=Z.length;H<W;H++)Z[H]();if(Q=$&&J.length,Q)$(K)}return function(Z){if(J.push(Z),$){if(!Q)$(K),Q=!0}else if(!U)U=setInterval(K,16.666666666666668)}};var _0=C.extend(a,{_class:"View",initialize:function $(Q,J){function U(q){return J[q]||parseInt(J.getAttribute(q),10)}function K(){var q=V0.getSize(J);return q.isNaN()||q.isZero()?new s(U("width"),U("height")):q}var Z;if(j&&J){if(this._id=J.getAttribute("id"),this._id==null)J.setAttribute("id",this._id="paper-view-"+$._id++);I0.add(J,this._viewEvents);var H="none";if(V0.setPrefixed(J.style,{userDrag:H,userSelect:H,touchCallout:H,contentZooming:H,tapHighlightColor:"rgba(0,0,0,0)"}),$0.hasAttribute(J,"resize")){var W=this;I0.add(j,this._windowEvents={resize:function(){W.setViewSize(K())}})}if(Z=K(),$0.hasAttribute(J,"stats")&&typeof Stats!=="undefined"){this._stats=new Stats;var Y=this._stats.domElement,X=Y.style,A=V0.getOffset(J);X.position="absolute",X.left=A.x+"px",X.top=A.y+"px",g.body.appendChild(Y)}}else Z=new s(J),J=null;if(this._project=Q,this._scope=Q._scope,this._element=J,!this._pixelRatio)this._pixelRatio=j&&j.devicePixelRatio||1;if(this._setElementSize(Z.width,Z.height),this._viewSize=Z,$._views.push(this),$._viewsById[this._id]=this,(this._matrix=new q0)._owner=this,!$._focused)$._focused=this;this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!W0.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;if(_0._focused===this)_0._focused=null;_0._views.splice(_0._views.indexOf(this),1),delete _0._viewsById[this._id];var $=this._project;if($._view===this)$._view=null;return I0.remove(this._element,this._viewEvents),I0.remove(j,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:C.each(Q0._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function($){this[$]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function($){if(this._autoUpdate=$,$)this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var $=this;I0.requestAnimationFrame(function(){if($._requested=!1,$._animate){$.requestUpdate();var Q=$._element;if((!V0.getPrefixed(g,"hidden")||$0.getAttribute(Q,"keepalive")==="true")&&V0.isInView(Q))$._handleFrame()}if($._autoUpdate)$.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){W0=this._scope;var $=Date.now()/1000,Q=this._last?$-this._last:0;if(this._last=$,this.emit("frame",new C({delta:Q,time:this._time+=Q,count:this._count++})),this._stats)this._stats.update()},_animateItem:function($,Q){var J=this._frameItems;if(Q){if(J[$._id]={item:$,time:0,count:0},++this._frameItemCount===1)this.on("frame",this._handleFrameItems)}else if(delete J[$._id],--this._frameItemCount===0)this.off("frame",this._handleFrameItems)},_handleFrameItems:function($){for(var Q in this._frameItems){var J=this._frameItems[Q];J.item.emit("frame",new C($,{time:J.time+=$.delta,count:J.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=I},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return this._pixelRatio*72},getViewSize:function(){var $=this._viewSize;return new m0($.width,$.height,this,"setViewSize")},setViewSize:function(){var $=s.read(arguments),Q=$.subtract(this._viewSize);if(Q.isZero())return;if(this._setElementSize($.width,$.height),this._viewSize.set($),this._changed(),this.emit("resize",{size:$,delta:Q}),this._autoUpdate)this.update()},_setElementSize:function($,Q){var J=this._element;if(J){if(J.width!==$)J.width=$;if(J.height!==Q)J.height=Q}},getBounds:function(){if(!this._bounds)this._bounds=this._matrix.inverted()._transformBounds(new t(new y,this._viewSize));return this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return V0.isInView(this._element)},isInserted:function(){return V0.isInserted(this._element)},getPixelSize:function($){var Q=this._element,J;if(Q){var U=Q.parentNode,K=g.createElement("div");K.style.fontSize=$,U.appendChild(K),J=parseFloat(V0.getStyles(K).fontSize),U.removeChild(K)}else J=parseFloat(J);return J},getTextWidth:function($,Q){return 0}},C.each(["rotate","scale","shear","skew"],function($){var Q=$==="rotate";this[$]=function(){var J=arguments,U=(Q?C:y).read(J),K=y.read(J,0,{readNull:!0});return this.transform(new q0()[$](U,K||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var $=new q0;return this.transform($.translate.apply($,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var $=y.read(arguments);this.translate(this.getCenter().subtract($))},getZoom:function(){var $=this._decompose().scaling;return($.x+$.y)/2},setZoom:function($){this.transform(new q0().scale($/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function($){var Q=this.getRotation();if(Q!=null&&$!=null)this.rotate($-Q)},getScaling:function(){var $=this._decompose().scaling;return new x0($.x,$.y,this,"setScaling")},setScaling:function(){var $=this.getScaling(),Q=y.read(arguments,0,{clone:!0,readNull:!0});if($&&Q)this.scale(Q.x/$.x,Q.y/$.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var $=this._matrix;$.set.apply($,arguments)},transform:function($){this._matrix.append($)},scrollBy:function(){this.translate(y.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(y.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(y.read(arguments))},getEventPoint:function($){return this.viewToProject(I0.getOffset($,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function($,Q){if(g&&typeof Q==="string")Q=g.getElementById(Q);var J=j?x8:_0;return new J($,Q)}}},new function(){if(!j)return;var $,Q,J=!1,U=!1;function K(b){var f=I0.getTarget(b);return f.getAttribute&&_0._viewsById[f.getAttribute("id")]}function Z(){var b=_0._focused;if(!b||!b.isVisible()){for(var f=0,h=_0._views.length;f<h;f++)if((b=_0._views[f]).isVisible()){_0._focused=Q=b;break}}}function H(b,f,h){b._handleMouseEvent("mousemove",f,h)}var W=j.navigator,Y,X,A;if(W.pointerEnabled||W.msPointerEnabled)Y="pointerdown MSPointerDown",X="pointermove MSPointerMove",A="pointerup pointercancel MSPointerUp MSPointerCancel";else if(Y="touchstart",X="touchmove",A="touchend touchcancel",!(("ontouchstart"in j)&&W.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)))Y+=" mousedown",X+=" mousemove",A+=" mouseup";var q={},O={mouseout:function(b){var f=_0._focused,h=I0.getRelatedTarget(b);if(f&&(!h||h.nodeName==="HTML")){var u=I0.getOffset(b,f._element),v=u.x,m=Math.abs,d=m(v),l=1<<25,r=d-l;u.x=m(r)<d?r*(v<0?-1:1):v,H(f,b,f.viewToProject(u))}},scroll:Z};q[Y]=function(b){var f=_0._focused=K(b);if(!J)J=!0,f._handleMouseEvent("mousedown",b)},O[X]=function(b){var f=_0._focused;if(!U){var h=K(b);if(h){if(f!==h){if(f)H(f,b);if(!$)$=f;f=_0._focused=Q=h}}else if(Q&&Q===f){if($&&!$.isInserted())$=null;f=_0._focused=$,$=null,Z()}}if(f)H(f,b)},O[Y]=function(){U=!0},O[A]=function(b){var f=_0._focused;if(f&&J)f._handleMouseEvent("mouseup",b);U=J=!1},I0.add(g,O),I0.add(j,{load:Z});var F=!1,V=!1,L={doubleclick:"click",mousedrag:"mousemove"},B=!1,D,_,T,E,R,z,G,S,P;function w(b,f,h,u,v,m,d){var l=!1,r;function n(e,c){if(e.responds(c)){if(!r)r=new g8(c,u,v,f||e,m?v.subtract(m):null);if(e.emit(c,r)){if(F=!0,r.prevented)V=!0;if(r.stopped)return l=!0}}else{var J0=L[c];if(J0)return n(e,J0)}}while(b&&b!==d){if(n(b,h))break;b=b._parent}return l}function k(b,f,h,u,v,m){return b._project.removeOn(h),V=F=!1,z&&w(z,null,h,u,v,m)||f&&f!==z&&!f.isDescendant(z)&&w(f,null,h==="mousedrag"?"mousemove":h,u,v,m,z)||w(b,z||f||b,h,u,v,m)}var x={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:q,_handleMouseEvent:function(b,f,h){var u=this._itemEvents,v=u.native[b],m=b==="mousemove",d=this._scope.tool,l=this;function r(U0){return u.virtual[U0]||l.responds(U0)||d&&d.responds(U0)}if(m&&J&&r("mousedrag"))b="mousedrag";if(!h)h=this.getEventPoint(f);var n=this.getBounds().contains(h),e=v&&n&&l._project.hitTest(h,{tolerance:0,fill:!0,stroke:!0}),c=e&&e.item||null,J0=!1,o={};if(o[b.substr(5)]=!0,v&&c!==R){if(R)w(R,null,"mouseleave",f,h);if(c)w(c,null,"mouseenter",f,h);R=c}if(B^n)w(this,null,n?"mouseenter":"mouseleave",f,h),D=n?this:null,J0=!0;if((n||o.drag)&&!h.equals(T))k(this,c,m?b:"mousemove",f,h,T),J0=!0;if(B=n,o.down&&n||o.up&&_){if(k(this,c,b,f,h,_),o.down){if(P=c===G&&Date.now()-S<300,E=G=c,!V&&c){var F0=c;while(F0&&!F0.responds("mousedrag"))F0=F0._parent;if(F0)z=c}_=h}else if(o.up){if(!V&&c===E)S=Date.now(),k(this,c,P?"doubleclick":"click",f,h,_),P=!1;E=z=null}B=!1,J0=!0}if(T=h,J0&&d)F=d._handleMouseEvent(b,f,h,o)||F;if(f.cancelable!==!1&&(F&&!o.move||o.down&&r("mouseup")))f.preventDefault()},_handleKeyEvent:function(b,f,h,u){var v=this._scope,m=v.tool,d;function l(r){if(r.responds(b))W0=v,r.emit(b,d=d||new u8(b,f,h,u))}if(this.isVisible()){if(l(this),m&&m.responds(b))l(m)}},_countItemEvent:function(b,f){var h=this._itemEvents,u=h.native,v=h.virtual;for(var m in x)u[m]=(u[m]||0)+(x[m][b]||0)*f;v[b]=(v[b]||0)+f},statics:{updateFocus:Z,_resetState:function(){J=U=F=B=!1,$=Q=D=_=T=E=R=z=G=S=P=null}}}}),x8=_0.extend({_class:"CanvasView",initialize:function $(Q,J){if(!(J instanceof j.HTMLCanvasElement)){var U=s.read(arguments,1);if(U.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+C.slice(arguments,1));J=L0.getCanvas(U)}var K=this._context=J.getContext("2d");if(K.save(),this._pixelRatio=1,!/^off|false$/.test($0.getAttribute(J,"hidpi"))){var Z=j.devicePixelRatio||1,H=V0.getPrefixed(K,"backingStorePixelRatio")||1;this._pixelRatio=Z/H}_0.call(this,Q,J),this._needsUpdate=!0},remove:function $(){return this._context.restore(),$.base.call(this)},_setElementSize:function $(Q,J){var U=this._pixelRatio;if($.base.call(this,Q*U,J*U),U!==1){var K=this._element,Z=this._context;if(!$0.hasAttribute(K,"resize")){var H=K.style;H.width=Q+"px",H.height=J+"px"}Z.restore(),Z.save(),Z.scale(U,U)}},getContext:function(){return this._context},getPixelSize:function $(Q){var J=W0.agent,U;if(J&&J.firefox)U=$.base.call(this,Q);else{var K=this._context,Z=K.font;K.font=Q+" serif",U=parseFloat(K.font),K.font=Z}return U},getTextWidth:function($,Q){var J=this._context,U=J.font,K=0;J.font=$;for(var Z=0,H=Q.length;Z<H;Z++)K=Math.max(K,J.measureText(Q[Z]).width);return J.font=U,K},update:function(){if(!this._needsUpdate)return!1;var $=this._project,Q=this._context,J=this._viewSize;if(Q.clearRect(0,0,J.width+1,J.height+1),$)$.draw(Q,this._matrix,this._pixelRatio);return this._needsUpdate=!1,!0}}),K8=C.extend({_class:"Event",initialize:function $(Q){this.event=Q,this.type=Q&&Q.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return N8.modifiers}}),u8=K8.extend({_class:"KeyEvent",initialize:function $(Q,J,U,K){this.type=Q,this.event=J,this.key=U,this.character=K},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),N8=new function(){var $={"\t":"tab"," ":"space","\b":"backspace","\x7F":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},Q={tab:"\t",space:" ",enter:"\r"},J={},U={},K,Z,H=new C({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var X=W0&&W0.agent;return X&&X.mac?this.meta:this.control}}});function W(X){var A=X.key||X.keyIdentifier;return A=/^U\+/.test(A)?String.fromCharCode(parseInt(A.substr(2),16)):/^Arrow[A-Z]/.test(A)?A.substr(5):A==="Unidentified"||A===I?String.fromCharCode(X.keyCode):A,$[A]||(A.length>1?C.hyphenate(A):A.toLowerCase())}function Y(X,A,q,O){var F=X?"keydown":"keyup",V=_0._focused,L;if(J[A]=X,X)U[A]=q;else delete U[A];if(A.length>1&&(L=C.camelize(A))in H){H[L]=X;var B=W0&&W0.agent;if(L==="meta"&&B&&B.mac)if(X)K={};else{for(var D in K)if(D in U)Y(!1,D,K[D],O);K=null}}else if(X&&K)K[A]=q;if(V)V._handleKeyEvent(X?"keydown":"keyup",O,A,q)}return I0.add(g,{keydown:function(X){var A=W(X),q=W0&&W0.agent;if(A.length>1||q&&(q.chrome&&(X.altKey||q.mac&&X.metaKey||!q.mac&&X.ctrlKey)))Y(!0,A,Q[A]||(A.length>1?"":A),X);else Z=A},keypress:function(X){if(Z){var A=W(X),q=X.charCode,O=q>=32?String.fromCharCode(q):A.length>1?"":A;if(A!==Z)A=O.toLowerCase();Y(!0,A,O,X),Z=null}},keyup:function(X){var A=W(X);if(A in U)Y(!1,A,U[A],X)}}),I0.add(j,{blur:function(X){for(var A in U)Y(!1,A,U[A],X)}}),{modifiers:H,isDown:function(X){return!!J[X]}}},g8=K8.extend({_class:"MouseEvent",initialize:function $(Q,J,U,K,Z){this.type=Q,this.event=J,this.point=U,this.target=K,this.delta=Z},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),v8=K8.extend({_class:"ToolEvent",_item:null,initialize:function $(Q,J,U){this.tool=Q,this.type=J,this.event=U},_choosePoint:function($,Q){return $?$:Q?Q.clone():null},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function($){this._point=$},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function($){this._lastPoint=$},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function($){this._downPoint=$},getMiddlePoint:function(){if(!this._middlePoint&&this.tool._lastPoint)return this.tool._point.add(this.tool._lastPoint).divide(2);return this._middlePoint},setMiddlePoint:function($){this._middlePoint=$},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function($){this._delta=$},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function($){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=$},getItem:function(){if(!this._item){var $=this.tool._scope.project.hitTest(this.getPoint());if($){var Q=$.item,J=Q._parent;while(/^(Group|CompoundPath)$/.test(J._class))Q=J,J=J._parent;this._item=Q}}return this._item},setItem:function($){this._item=$},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),W6=T0.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function $(Q){T0.call(this),this._moveCount=-1,this._downCount=-1,this.set(Q)},getMinDistance:function(){return this._minDistance},setMinDistance:function($){if(this._minDistance=$,$!=null&&this._maxDistance!=null&&$>this._maxDistance)this._maxDistance=$},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function($){if(this._maxDistance=$,this._minDistance!=null&&$!=null&&$<this._minDistance)this._minDistance=$},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function($){this._minDistance=this._maxDistance=$},_handleMouseEvent:function($,Q,J,U){if(W0=this._scope,U.drag&&!this.responds($))$="mousemove";var K=U.move||U.drag,Z=this.responds($),H=this.minDistance,W=this.maxDistance,Y=!1,X=this;function A(O,F){var V=J,L=K?X._point:X._downPoint||V;if(K){if(X._moveCount>=0&&V.equals(L))return!1;if(L&&(O!=null||F!=null)){var B=V.subtract(L),D=B.getLength();if(D<(O||0))return!1;if(F)V=L.add(B.normalize(Math.min(D,F)))}X._moveCount++}if(X._point=V,X._lastPoint=L||V,U.down)X._moveCount=-1,X._downPoint=V,X._downCount++;return!0}function q(){if(Z)Y=X.emit($,new v8(X,$,Q))||Y}if(U.down)A(),q();else if(U.up)A(null,W),q();else if(Z)while(A(H,W))q();return Y}}),m8=C.extend(a,{_class:"Tween",statics:{easings:new C({linear:function($){return $},easeInQuad:function($){return $*$},easeOutQuad:function($){return $*(2-$)},easeInOutQuad:function($){return $<0.5?2*$*$:-1+2*(2-$)*$},easeInCubic:function($){return $*$*$},easeOutCubic:function($){return--$*$*$+1},easeInOutCubic:function($){return $<0.5?4*$*$*$:($-1)*(2*$-2)*(2*$-2)+1},easeInQuart:function($){return $*$*$*$},easeOutQuart:function($){return 1- --$*$*$*$},easeInOutQuart:function($){return $<0.5?8*$*$*$*$:1-8*--$*$*$*$},easeInQuint:function($){return $*$*$*$*$},easeOutQuint:function($){return 1+--$*$*$*$*$},easeInOutQuint:function($){return $<0.5?16*$*$*$*$*$:1+16*--$*$*$*$*$}})},initialize:function $(Q,J,U,K,Z,H){this.object=Q;var W=typeof Z,Y=W==="function";this.type=Y?W:W==="string"?Z:"linear",this.easing=Y?Z:$.easings[this.type],this.duration=K,this.running=!1,this._then=null,this._startTime=null;var X=J||U;if(this._keys=X?Object.keys(X):[],this._parsedKeys=this._parseKeys(this._keys),this._from=X&&this._getState(J),this._to=X&&this._getState(U),H!==!1)this.start()},then:function($){return this._then=$,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function($){if(this.running){if($>=1)$=1,this.running=!1;var Q=this.easing($),J=this._keys,U=function(A){return typeof A==="function"?A(Q,$):A};for(var K=0,Z=J&&J.length;K<Z;K++){var H=J[K],W=U(this._from[H]),Y=U(this._to[H]),X=W&&Y&&W.__add&&Y.__add?Y.__subtract(W).__multiply(Q).__add(W):(Y-W)*Q+W;this._setProperty(this._parsedKeys[H],X)}if(this.responds("update"))this.emit("update",new C({progress:$,factor:Q}));if(!this.running&&this._then)this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function($){var Q=this._startTime,J=Q?($-Q)/this.duration:0;if(!Q)this._startTime=$;this.update(J)},_getState:function($){var Q=this._keys,J={};for(var U=0,K=Q.length;U<K;U++){var Z=Q[U],H=this._parsedKeys[Z],W=this._getProperty(H),Y;if($){var X=this._resolveValue(W,$[Z]);this._setProperty(H,X),Y=this._getProperty(H),Y=Y&&Y.clone?Y.clone():Y,this._setProperty(H,W)}else Y=W&&W.clone?W.clone():W;J[Z]=Y}return J},_resolveValue:function($,Q){if(Q){if(Array.isArray(Q)&&Q.length===2){var J=Q[0];return J&&J.match&&J.match(/^[+\-\*\/]=/)?this._calculate($,J[0],Q[1]):Q}else if(typeof Q==="string"){var U=Q.match(/^[+\-*/]=(.*)/);if(U){var K=JSON.parse(U[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate($,Q[0],K)}}}return Q},_calculate:function($,Q,J){return W0.PaperScript.calculateBinary($,Q,J)},_parseKeys:function($){var Q={};for(var J=0,U=$.length;J<U;J++){var K=$[J],Z=K.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");Q[K]=Z.split("/")}return Q},_getProperty:function($,Q){var J=this.object;for(var U=0,K=$.length-(Q||0);U<K&&J;U++)J=J[$[U]];return J},_setProperty:function($,Q){var J=this._getProperty($,1);if(J)J[$[$.length-1]]=Q}}),d8={request:function($){var Q=new M.XMLHttpRequest;if(Q.open(($.method||"get").toUpperCase(),$.url,C.pick($.async,!0)),$.mimeType)Q.overrideMimeType($.mimeType);return Q.onload=function(){var J=Q.status;if(J===0||J===200){if($.onLoad)$.onLoad.call(Q,Q.responseText)}else Q.onerror()},Q.onerror=function(){var J=Q.status,U='Could not load "'+$.url+'" (Status: '+J+")";if($.onError)$.onError(U,J);else throw new Error(U)},Q.send(null)}},L0=C.exports.CanvasProvider={canvases:[],getCanvas:function($,Q,J){if(!j)return null;var U,K=!0;if(typeof $==="object")Q=$.height,$=$.width;if(this.canvases.length)U=this.canvases.pop();else U=g.createElement("canvas"),K=!1;var Z=U.getContext("2d",J||{});if(!Z)throw new Error("Canvas "+U+" is unable to provide a 2D context.");if(U.width===$&&U.height===Q){if(K)Z.clearRect(0,0,$+1,Q+1)}else U.width=$,U.height=Q;return Z.save(),U},getContext:function($,Q,J){var U=this.getCanvas($,Q,J);return U?U.getContext("2d",J||{}):null},release:function($){var Q=$&&$.canvas?$.canvas:$;if(Q&&Q.getContext)Q.getContext("2d").restore(),this.canvases.push(Q)}},q8=new function(){var{min:$,max:Q,abs:J}=Math,U,K,Z,H,W,Y,X,A,q,O,F;function V(R,z,G){return 0.2989*R+0.587*z+0.114*G}function L(R,z,G,w){var P=w-V(R,z,G);q=R+P,O=z+P,F=G+P;var w=V(q,O,F),k=$(q,O,F),x=Q(q,O,F);if(k<0){var b=w-k;q=w+(q-w)*w/b,O=w+(O-w)*w/b,F=w+(F-w)*w/b}if(x>255){var f=255-w,h=x-w;q=w+(q-w)*f/h,O=w+(O-w)*f/h,F=w+(F-w)*f/h}}function B(R,z,G){return Q(R,z,G)-$(R,z,G)}function D(R,z,G,S){var P=[R,z,G],w=Q(R,z,G),k=$(R,z,G),x;if(k=k===R?0:k===z?1:2,w=w===R?0:w===z?1:2,x=$(k,w)===0?Q(k,w)===1?2:1:0,P[w]>P[k])P[x]=(P[x]-P[k])*S/(P[w]-P[k]),P[w]=S;else P[x]=P[w]=0;P[k]=0,q=P[0],O=P[1],F=P[2]}var _={multiply:function(){q=W*U/255,O=Y*K/255,F=X*Z/255},screen:function(){q=W+U-W*U/255,O=Y+K-Y*K/255,F=X+Z-X*Z/255},overlay:function(){q=W<128?2*W*U/255:255-2*(255-W)*(255-U)/255,O=Y<128?2*Y*K/255:255-2*(255-Y)*(255-K)/255,F=X<128?2*X*Z/255:255-2*(255-X)*(255-Z)/255},"soft-light":function(){var R=U*W/255;q=R+W*(255-(255-W)*(255-U)/255-R)/255,R=K*Y/255,O=R+Y*(255-(255-Y)*(255-K)/255-R)/255,R=Z*X/255,F=R+X*(255-(255-X)*(255-Z)/255-R)/255},"hard-light":function(){q=U<128?2*U*W/255:255-2*(255-U)*(255-W)/255,O=K<128?2*K*Y/255:255-2*(255-K)*(255-Y)/255,F=Z<128?2*Z*X/255:255-2*(255-Z)*(255-X)/255},"color-dodge":function(){q=W===0?0:U===255?255:$(255,255*W/(255-U)),O=Y===0?0:K===255?255:$(255,255*Y/(255-K)),F=X===0?0:Z===255?255:$(255,255*X/(255-Z))},"color-burn":function(){q=W===255?255:U===0?0:Q(0,255-(255-W)*255/U),O=Y===255?255:K===0?0:Q(0,255-(255-Y)*255/K),F=X===255?255:Z===0?0:Q(0,255-(255-X)*255/Z)},darken:function(){q=W<U?W:U,O=Y<K?Y:K,F=X<Z?X:Z},lighten:function(){q=W>U?W:U,O=Y>K?Y:K,F=X>Z?X:Z},difference:function(){if(q=W-U,q<0)q=-q;if(O=Y-K,O<0)O=-O;if(F=X-Z,F<0)F=-F},exclusion:function(){q=W+U*(255-W-W)/255,O=Y+K*(255-Y-Y)/255,F=X+Z*(255-X-X)/255},hue:function(){D(U,K,Z,B(W,Y,X)),L(q,O,F,V(W,Y,X))},saturation:function(){D(W,Y,X,B(U,K,Z)),L(q,O,F,V(W,Y,X))},luminosity:function(){L(W,Y,X,V(U,K,Z))},color:function(){L(U,K,Z,V(W,Y,X))},add:function(){q=$(W+U,255),O=$(Y+K,255),F=$(X+Z,255)},subtract:function(){q=Q(W-U,0),O=Q(Y-K,0),F=Q(X-Z,0)},average:function(){q=(W+U)/2,O=(Y+K)/2,F=(X+Z)/2},negation:function(){q=255-J(255-U-W),O=255-J(255-K-Y),F=255-J(255-Z-X)}},T=this.nativeModes=C.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(R){this[R]=!0},{}),E=L0.getContext(1,1,{willReadFrequently:!0});if(E)C.each(_,function(R,z){var G=z==="darken",S=!1;E.save();try{if(E.fillStyle=G?"#300":"#a00",E.fillRect(0,0,1,1),E.globalCompositeOperation=z,E.globalCompositeOperation===z)E.fillStyle=G?"#a00":"#300",E.fillRect(0,0,1,1),S=E.getImageData(0,0,1,1).data[0]!==G?170:51}catch(P){}E.restore(),T[z]=S}),L0.release(E);this.process=function(R,z,G,S,P){var w=z.canvas,k=R==="normal";if(k||T[R]){if(G.save(),G.setTransform(1,0,0,1,0,0),G.globalAlpha=S,!k)G.globalCompositeOperation=R;G.drawImage(w,P.x,P.y),G.restore()}else{var x=_[R];if(!x)return;var b=G.getImageData(P.x,P.y,w.width,w.height),f=b.data,h=z.getImageData(0,0,w.width,w.height).data;for(var u=0,v=f.length;u<v;u+=4){U=h[u],W=f[u],K=h[u+1],Y=f[u+1],Z=h[u+2],X=f[u+2],H=h[u+3],A=f[u+3],x();var m=H*S/255,d=1-m;f[u]=m*q+d*W,f[u+1]=m*O+d*Y,f[u+2]=m*F+d*X,f[u+3]=H*S+d*A}G.putImageData(b,P.x,P.y)}}},R0=new function(){var $="http://www.w3.org/2000/svg",Q="http://www.w3.org/2000/xmlns",J="http://www.w3.org/1999/xlink",U={href:J,xlink:Q,xmlns:Q+"/","xmlns:xlink":Q+"/"};function K(W,Y,X){return H(g.createElementNS($,W),Y,X)}function Z(W,Y){var X=U[Y],A=X?W.getAttributeNS(X,Y):W.getAttribute(Y);return A==="null"?null:A}function H(W,Y,X){for(var A in Y){var q=Y[A],O=U[A];if(typeof q==="number"&&X)q=X.number(q);if(O)W.setAttributeNS(O,A,q);else W.setAttribute(A,q)}return W}return{svg:$,xmlns:Q,xlink:J,create:K,get:Z,set:H}},V8=C.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function($,Q){return!Q&&($ instanceof r0||$ instanceof k0||$ instanceof J8)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function($,Q){var J=C.capitalize(Q),U=$[2];this[Q]={type:$[1],property:Q,attribute:$[0],toSVG:U,fromSVG:U&&C.each(U,function(K,Z){this[K]=Z},{}),exportFilter:$[3],get:"get"+J,set:"set"+J}},{});new function(){var $;function Q(_,T,E){var R=new C,z=_.getTranslation();if(T){var G;if(_.isInvertible())_=_._shiftless(),G=_._inverseTransform(z),z=null;else G=new y;R[E?"cx":"x"]=G.x,R[E?"cy":"y"]=G.y}if(!_.isIdentity()){var S=_.decompose();if(S){var P=[],w=S.rotation,k=S.scaling,x=S.skewing;if(z&&!z.isZero())P.push("translate("+$.point(z)+")");if(w)P.push("rotate("+$.number(w)+")");if(!Z0.isZero(k.x-1)||!Z0.isZero(k.y-1))P.push("scale("+$.point(k)+")");if(x.x)P.push("skewX("+$.number(x.x)+")");if(x.y)P.push("skewY("+$.number(x.y)+")");R.transform=P.join(" ")}else R.transform="matrix("+_.getValues().join(",")+")"}return R}function J(_,T){var E=Q(_._matrix),R=_._children,z=R0.create("g",E,$);for(var G=0,S=R.length;G<S;G++){var P=R[G],w=B(P,T);if(w)if(P.isClipMask()){var k=R0.create("clipPath");k.appendChild(w),V(P,k,"clip"),R0.set(z,{"clip-path":"url(#"+k.id+")"})}else z.appendChild(w)}return z}function U(_,T){var E=Q(_._matrix,!0),R=_.getSize(),z=_.getImage();return E.x-=R.width/2,E.y-=R.height/2,E.width=R.width,E.height=R.height,E.href=T.embedImages==!1&&z&&z.src||_.toDataURL(),R0.create("image",E,$)}function K(_,T){var E=T.matchShapes;if(E){var R=_.toShape(!1);if(R)return Z(R,T)}var z=_._segments,G=z.length,S,P=Q(_._matrix);if(E&&G>=2&&!_.hasHandles())if(G>2){S=_._closed?"polygon":"polyline";var w=[];for(var k=0;k<G;k++)w.push($.point(z[k]._point));P.points=w.join(" ")}else{S="line";var x=z[0]._point,b=z[1]._point;P.set({x1:x.x,y1:x.y,x2:b.x,y2:b.y})}else S="path",P.d=_.getPathData(null,T.precision);return R0.create(S,P,$)}function Z(_){var{_type:T,_radius:E}=_,R=Q(_._matrix,!0,T!=="rectangle");if(T==="rectangle"){T="rect";var z=_._size,G=z.width,S=z.height;if(R.x-=G/2,R.y-=S/2,R.width=G,R.height=S,E.isZero())E=null}if(E)if(T==="circle")R.r=E;else R.rx=E.width,R.ry=E.height;return R0.create(T,R,$)}function H(_,T){var E=Q(_._matrix),R=_.getPathData(null,T.precision);if(R)E.d=R;return R0.create("path",E,$)}function W(_,T){var E=Q(_._matrix,!0),R=_._definition,z=F(R,"symbol"),G=R._item,S=G.getStrokeBounds();if(!z)z=R0.create("symbol",{viewBox:$.rectangle(S)}),z.appendChild(B(G,T)),V(R,z,"symbol");return E.href="#"+z.id,E.x+=S.x,E.y+=S.y,E.width=S.width,E.height=S.height,E.overflow="visible",R0.create("use",E,$)}function Y(_){var T=F(_,"color");if(!T){var E=_.getGradient(),R=E._radial,z=_.getOrigin(),G=_.getDestination(),S;if(R){S={cx:z.x,cy:z.y,r:z.getDistance(G)};var P=_.getHighlight();if(P)S.fx=P.x,S.fy=P.y}else S={x1:z.x,y1:z.y,x2:G.x,y2:G.y};S.gradientUnits="userSpaceOnUse",T=R0.create((R?"radial":"linear")+"Gradient",S,$);var w=E._stops;for(var k=0,x=w.length;k<x;k++){var b=w[k],f=b._color,h=f.getAlpha(),u=b._offset;if(S={offset:u==null?k/(x-1):u},f)S["stop-color"]=f.toCSS(!0);if(h<1)S["stop-opacity"]=h;T.appendChild(R0.create("stop",S,$))}V(_,T,"color")}return"url(#"+T.id+")"}function X(_){var T=R0.create("text",Q(_._matrix,!0),$);return T.textContent=_._content,T}var A={Group:J,Layer:J,Raster:U,Path:K,Shape:Z,CompoundPath:H,SymbolItem:W,PointText:X};function q(_,T,E){var R={},z=!E&&_.getParent(),G=[];if(_._name!=null)R.id=_._name;if(C.each(V8,function(S){var{get:P,type:w}=S,k=_[P]();if(S.exportFilter?S.exportFilter(_,k):!z||!C.equals(z[P](),k)){if(w==="color"&&k!=null){var x=k.getAlpha();if(x<1)R[S.attribute+"-opacity"]=x}if(w==="style")G.push(S.attribute+": "+k);else R[S.attribute]=k==null?"none":w==="color"?k.gradient?Y(k,_):k.toCSS(!0):w==="array"?k.join(","):w==="lookup"?S.toSVG[k]:k}}),G.length)R.style=G.join(";");if(R.opacity===1)delete R.opacity;if(!_._visible)R.visibility="hidden";return R0.set(T,R,$)}var O;function F(_,T){if(!O)O={ids:{},svgs:{}};return _&&O.svgs[T+"-"+(_._id||_.__id||(_.__id=b0.get("svg")))]}function V(_,T,E){if(!O)F();var R=O.ids[E]=(O.ids[E]||0)+1;T.id=E+"-"+R,O.svgs[E+"-"+(_._id||_.__id)]=T}function L(_,T){var E=_,R=null;if(O){E=_.nodeName.toLowerCase()==="svg"&&_;for(var z in O.svgs){if(!R){if(!E)E=R0.create("svg"),E.appendChild(_);R=E.insertBefore(R0.create("defs"),E.firstChild)}R.appendChild(O.svgs[z])}O=null}return T.asString?new M.XMLSerializer().serializeToString(E):E}function B(_,T,E){var R=A[_._class],z=R&&R(_,T);if(z){var G=T.onExport;if(G)z=G(_,z,T)||z;var S=JSON.stringify(_._data);if(S&&S!=="{}"&&S!=="null")z.setAttribute("data-paper-data",S)}return z&&q(_,z,E)}function D(_){if(!_)_={};return $=new D0(_.precision),_}Q0.inject({exportSVG:function(_){return _=D(_),L(B(this,_,!0),_)}}),Q8.inject({exportSVG:function(_){_=D(_);var T=this._children,E=this.getView(),R=C.pick(_.bounds,"view"),z=_.matrix||R==="view"&&E._matrix,G=z&&q0.read([z]),S=R==="view"?new t([0,0],E.getViewSize()):R==="content"?Q0._getBounds(T,G,{stroke:!0}).rect:t.read([R],0,{readNull:!0}),P={version:"1.1",xmlns:R0.svg,"xmlns:xlink":R0.xlink};if(S){if(P.width=S.width,P.height=S.height,S.x||S.x===0||S.y||S.y===0)P.viewBox=$.rectangle(S)}var w=R0.create("svg",P,$),k=w;if(G&&!G.isIdentity())k=w.appendChild(R0.create("g",Q(G),$));for(var x=0,b=T.length;x<b;x++)k.appendChild(B(T[x],_,!0));return L(w,_)}})},new function(){var $={},Q;function J(T,E,R,z,G,S){var P=R0.get(T,E)||S,w=P==null?z?null:R?"":0:R?P:parseFloat(P);return/%\s*$/.test(P)?w/100*(G?1:Q[/x|^width/.test(E)?"width":"height"]):w}function U(T,E,R,z,G,S,P){return E=J(T,E||"x",!1,z,G,S),R=J(T,R||"y",!1,z,G,P),z&&(E==null||R==null)?null:new y(E,R)}function K(T,E,R,z,G){return E=J(T,E||"width",!1,z,G),R=J(T,R||"height",!1,z,G),z&&(E==null||R==null)?null:new s(E,R)}function Z(T,E,R){return T==="none"?null:E==="number"?parseFloat(T):E==="array"?T?T.split(/[\s,]+/g).map(parseFloat):[]:E==="color"?B(T)||T:E==="lookup"?R[T]:T}function H(T,E,R,z){var G=T.childNodes,S=E==="clippath",P=E==="defs",w=new d0,k=w._project,x=k._currentStyle,b=[];if(!S&&!P)w=L(w,T,z),k._currentStyle=w._style.clone();if(z){var f=T.querySelectorAll("defs");for(var h=0,u=f.length;h<u;h++)D(f[h],R,!1)}for(var h=0,u=G.length;h<u;h++){var v=G[h],m;if(v.nodeType===1&&!/^defs$/i.test(v.nodeName)&&(m=D(v,R,!1))&&!(m instanceof l0))b.push(m)}if(w.addChildren(b),S)w=L(w.reduce(),T,z);if(k._currentStyle=x,S||P)w.remove(),w=null;return w}function W(T,E){var R=T.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),z=[];for(var G=0,S=R.length;G<S;G+=2)z.push(new y(parseFloat(R[G]),parseFloat(R[G+1])));var P=new X0(z);if(E==="polygon")P.closePath();return P}function Y(T){return r0.create(T.getAttribute("d"))}function X(T,E){var R=(J(T,"href",!0)||"").substring(1),z=E==="radialgradient",G;if(R){if(G=$[R].getGradient(),G._radial^z)G=G.clone(),G._radial=z}else{var S=T.childNodes,P=[];for(var w=0,k=S.length;w<k;w++){var x=S[w];if(x.nodeType===1)P.push(L(new O8,x))}G=new U8(P,z)}var b,f,h,u=J(T,"gradientUnits",!0)!=="userSpaceOnUse";if(z)b=U(T,"cx","cy",!1,u,"50%","50%"),f=b.add(J(T,"r",!1,!1,u,"50%"),0),h=U(T,"fx","fy",!0,u);else b=U(T,"x1","y1",!1,u,"0%","0%"),f=U(T,"x2","y2",!1,u,"100%","0%");var v=L(new z0(G,b,f,h),T);return v._scaleToBounds=u,null}var A={"#document":function(T,E,R,z){var G=T.childNodes;for(var S=0,P=G.length;S<P;S++){var w=G[S];if(w.nodeType===1)return D(w,R,z)}},g:H,svg:H,clippath:H,polygon:W,polyline:W,path:Y,lineargradient:X,radialgradient:X,image:function(T){var E=new e0(J(T,"href",!0));return E.on("load",function(){var R=K(T);this.setSize(R);var z=U(T).add(R.divide(2));this._matrix.append(new q0().translate(z))}),E},symbol:function(T,E,R,z){return new l0(H(T,E,R,z),!0)},defs:H,use:function(T){var E=(J(T,"href",!0)||"").substring(1),R=$[E],z=U(T);return R?R instanceof l0?R.place(z):R.clone().translate(z):null},circle:function(T){return new k0.Circle(U(T,"cx","cy"),J(T,"r"))},ellipse:function(T){return new k0.Ellipse({center:U(T,"cx","cy"),radius:K(T,"rx","ry")})},rect:function(T){return new k0.Rectangle(new t(U(T),K(T)),K(T,"rx","ry"))},line:function(T){return new X0.Line(U(T,"x1","y1"),U(T,"x2","y2"))},text:function(T){var E=new h8(U(T).add(U(T,"dx","dy")));return E.setContent(T.textContent.trim()||""),E},switch:H};function q(T,E,R,z){if(T.transform){var G=(z.getAttribute(R)||"").split(/\)\s*/g),S=new q0;for(var P=0,w=G.length;P<w;P++){var k=G[P];if(!k)break;var x=k.split(/\(\s*/),b=x[0],f=x[1].split(/[\s,]+/g);for(var h=0,u=f.length;h<u;h++)f[h]=parseFloat(f[h]);switch(b){case"matrix":S.append(new q0(f[0],f[1],f[2],f[3],f[4],f[5]));break;case"rotate":S.rotate(f[0],f[1]||0,f[2]||0);break;case"translate":S.translate(f[0],f[1]||0);break;case"scale":S.scale(f);break;case"skewX":S.skew(f[0],0);break;case"skewY":S.skew(0,f[0]);break}}T.transform(S)}}function O(T,E,R){var z=R==="fill-opacity"?"getFillColor":"getStrokeColor",G=T[z]&&T[z]();if(G)G.setAlpha(parseFloat(E))}var F=C.set(C.each(V8,function(T){this[T.attribute]=function(E,R){if(E[T.set]){if(E[T.set](Z(R,T.type,T.fromSVG)),T.type==="color"){var z=E[T.get]();if(z){if(z._scaleToBounds){var G=E.getBounds();z.transform(new q0().translate(G.getPoint()).scale(G.getSize()))}}}}}},{}),{id:function(T,E){if($[E]=T,T.setName)T.setName(E)},"clip-path":function(T,E){var R=B(E);if(R)if(R=R.clone(),R.setClipMask(!0),T instanceof d0)T.insertChild(0,R);else return new d0(R,T)},gradientTransform:q,transform:q,"fill-opacity":O,"stroke-opacity":O,visibility:function(T,E){if(T.setVisible)T.setVisible(E==="visible")},display:function(T,E){if(T.setVisible)T.setVisible(E!==null)},"stop-color":function(T,E){if(T.setColor)T.setColor(E)},"stop-opacity":function(T,E){if(T._color)T._color.setAlpha(parseFloat(E))},offset:function(T,E){if(T.setOffset){var R=E.match(/(.*)%$/);T.setOffset(R?R[1]/100:parseFloat(E))}},viewBox:function(T,E,R,z,G){var S=new t(Z(E,"array")),P=K(z,null,null,!0),w,k;if(T instanceof d0){var x=P?P.divide(S.getSize()):1,k=new q0().scale(x).translate(S.getPoint().negate());w=T}else if(T instanceof l0){if(P)S.setSize(P);w=T._item}if(w){if(V(z,"overflow",G)!=="visible"){var b=new k0.Rectangle(S);b.setClipMask(!0),w.addChild(b)}if(k)w.transform(k)}}});function V(T,E,R){var z=T.attributes[E],G=z&&z.value;if(!G&&T.style){var S=C.camelize(E);if(G=T.style[S],!G&&R.node[S]!==R.parent[S])G=R.node[S]}return!G?I:G==="none"?null:G}function L(T,E,R){var z=E.parentNode,G={node:V0.getStyles(E)||{},parent:!R&&!/^defs$/i.test(z.tagName)&&V0.getStyles(z)||{}};return C.each(F,function(S,P){var w=V(E,P,G);T=w!==I&&S(T,w,P,E,G)||T}),T}function B(T){var E=T&&T.match(/\((?:["'#]*)([^"')]+)/),R=E&&E[1],z=R&&$[j?R.replace(j.location.href.split("#")[0]+"#",""):R];if(z&&z._scaleToBounds)z=z.clone(),z._scaleToBounds=!0;return z}function D(T,E,R){var z=T.nodeName.toLowerCase(),G=z!=="#document",S=g.body,P,w,k;if(R&&G)Q=W0.getView().getSize(),Q=K(T,null,null,!0)||Q,P=R0.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),w=T.parentNode,k=T.nextSibling,P.appendChild(T),S.appendChild(P);var x=W0.settings,b=x.applyMatrix,f=x.insertItems;x.applyMatrix=!1,x.insertItems=!1;var h=A[z],u=h&&h(T,z,E,R)||null;if(x.insertItems=f,x.applyMatrix=b,u){if(G&&!(u instanceof d0))u=L(u,T,R);var v=E.onImport,m=G&&T.getAttribute("data-paper-data");if(v)u=v(T,u,E)||u;if(E.expandShapes&&u instanceof k0)u.remove(),u=u.toPath();if(m)u._data=JSON.parse(m)}if(P){if(S.removeChild(P),w)if(k)w.insertBefore(T,k);else w.appendChild(T)}if(R){if($={},u&&C.pick(E.applyMatrix,b))u.matrix.apply(!0,!0)}return u}function _(T,E,R){if(!T)return null;E=typeof E==="function"?{onLoad:E}:E||{};var z=W0,G=null;function S(x){try{var b=typeof x==="object"?x:new M.DOMParser().parseFromString(x.trim(),"image/svg+xml");if(!b.nodeName)throw b=null,new Error("Unsupported SVG source: "+T);if(W0=z,G=D(b,E,!0),!E||E.insert!==!1)R._insertItem(I,G);var f=E.onLoad;if(f)f(G,x)}catch(h){P(h)}}function P(x,b){var f=E.onError;if(f)f(x,b);else throw new Error(x)}if(typeof T==="string"&&!/^[\s\S]*</.test(T)){var w=g.getElementById(T);if(w)S(w);else d8.request({url:T,async:!0,onLoad:S,onError:P})}else if(typeof File!=="undefined"&&T instanceof File){var k=new FileReader;return k.onload=function(){S(k.result)},k.onerror=function(){P(k.error)},k.readAsText(T)}else S(T);return G}Q0.inject({importSVG:function(T,E){return _(T,E,this)}}),Q8.inject({importSVG:function(T,E){return this.activate(),_(T,E,this)}})};var W0=new($0.inject(C.exports,{Base:C,Numerical:Z0,Key:N8,DomEvent:I0,DomElement:V0,document:g,window:j,Symbol:l0,PlacedSymbol:F8}));if(W0.agent.node)(()=>({}))(W0);if(typeof define==="function"&&define.amd)define("paper",W0);else if(typeof a0==="object"&&a0)a0.exports=W0;return W0}.call(z8,typeof self==="object"?self:null)});var Z6=R8(E8(),1);var W8=R8(E8(),1);import{useRef as r8,useEffect as a8,useState as M8} from"preact/hooks";import{useEditor as i8} from"@blockcode/core";import{ScratchBlocks as j0} from"@blockcode/blocks-editor";import{ScratchBlocks as f0} from"@blockcode/blocks-editor";var N=new f0.Generator("JavaScript");N.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(globalThis).join(","));N.ORDER_ATOMIC=0;N.ORDER_NEW=1.1;N.ORDER_MEMBER=1.2;N.ORDER_FUNCTION_CALL=2;N.ORDER_INCREMENT=3;N.ORDER_DECREMENT=3;N.ORDER_BITWISE_NOT=4.1;N.ORDER_UNARY_PLUS=4.2;N.ORDER_UNARY_NEGATION=4.3;N.ORDER_LOGICAL_NOT=4.4;N.ORDER_TYPEOF=4.5;N.ORDER_VOID=4.6;N.ORDER_DELETE=4.7;N.ORDER_DIVISION=5.1;N.ORDER_MULTIPLICATION=5.2;N.ORDER_MODULUS=5.3;N.ORDER_SUBTRACTION=6.1;N.ORDER_ADDITION=6.2;N.ORDER_BITWISE_SHIFT=7;N.ORDER_RELATIONAL=8;N.ORDER_IN=8;N.ORDER_INSTANCEOF=8;N.ORDER_EQUALITY=9;N.ORDER_BITWISE_AND=10;N.ORDER_BITWISE_XOR=11;N.ORDER_BITWISE_OR=12;N.ORDER_LOGICAL_AND=13;N.ORDER_LOGICAL_OR=14;N.ORDER_CONDITIONAL=15;N.ORDER_ASSIGNMENT=16;N.ORDER_COMMA=17;N.ORDER_NONE=99;N.ORDER_OVERRIDES=[[N.ORDER_FUNCTION_CALL,N.ORDER_MEMBER],[N.ORDER_FUNCTION_CALL,N.ORDER_FUNCTION_CALL],[N.ORDER_MEMBER,N.ORDER_MEMBER],[N.ORDER_MEMBER,N.ORDER_FUNCTION_CALL],[N.ORDER_LOGICAL_NOT,N.ORDER_LOGICAL_NOT],[N.ORDER_MULTIPLICATION,N.ORDER_MULTIPLICATION],[N.ORDER_ADDITION,N.ORDER_ADDITION],[N.ORDER_LOGICAL_AND,N.ORDER_LOGICAL_AND],[N.ORDER_LOGICAL_OR,N.ORDER_LOGICAL_OR]];N.init=function(M){if(N.definitions_=Object.create(null),N.functionNames_=Object.create(null),!N.variableDB_)N.variableDB_=new f0.Names(N.RESERVED_WORDS_);else N.variableDB_.reset();N.variableDB_.setVariableMap(M.getVariableMap());var I=[],j=M.getAllVariables();for(var g=0;g<j.length;g++){if(j[g].type===f0.BROADCAST_MESSAGE_VARIABLE_TYPE)continue;const a=N.variableDB_.getName(j[g].getId(),f0.Variables.NAME_TYPE);if(j[g].type===f0.LIST_VARIABLE_TYPE)I.push(`let ${a}${f0.LIST_VARIABLE_TYPE} = [];`);else I.push(`let ${a} = 0;`)}var C=f0.Variables.allDeveloperVariables(M);for(var g=0;g<C.length;g++){const $0=N.variableDB_.getName(C[g],f0.Names.DEVELOPER_VARIABLE_TYPE);if(j[g].type===f0.LIST_VARIABLE_TYPE)I.push(`let ${$0}List = [];`);else I.push(`let ${$0} = 0;`)}if(I.length)N.definitions_.variables=I.join("\n")};N.finish=function(M){var I=[];for(var j in N.definitions_)I.push(N.definitions_[j]);return delete N.definitions_,delete N.functionNames_,N.variableDB_.reset(),I.join("\n\n")+"\n\n\n"+M};N.scrubNakedValue=function(M){return M+";\n"};N.quote_=function(M){return M=M.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"),"'"+M+"'"};N.scrub_=function(M,I){var j="";if(!M.outputConnection||!M.outputConnection.targetConnection){var g=M.getCommentText();if(g=f0.utils.wrap(g,N.COMMENT_WRAP-3),g)if(M.getProcedureDef)j+="/**\n"+N.prefixLines(g+"\n"," * ")+" */\n";else j+=N.prefixLines(g+"\n","// ");for(var C=0;C<M.inputList.length;C++)if(M.inputList[C].type==f0.INPUT_VALUE){var a=M.inputList[C].connection.targetBlock();if(a){var g=N.allNestedComments(a);if(g)j+=N.prefixLines(g,"// ")}}}if(M.startHat_){const $0=M.nextConnection&&M.nextConnection.targetBlock();let T0=N.blockToCode($0);if(T0)T0=N.prefixLines(T0,N.INDENT),I=I.replace("/* nextCode */",`\n${T0}`);return j+I}if(M.parentBlock_){const $0=M.nextConnection&&M.nextConnection.targetBlock(),T0=N.blockToCode($0);return j+I+T0}return""};N.getAdjusted=function(M,I,j,g,C){var a=j||0,$0=C||N.ORDER_NONE;if(M.workspace.options.oneBasedIndex)a--;var T0=M.workspace.options.oneBasedIndex?"1":"0";if(a>0)var A0=N.valueToCode(M,I,N.ORDER_ADDITION)||T0;else if(a<0)var A0=N.valueToCode(M,I,N.ORDER_SUBTRACTION)||T0;else if(g)var A0=N.valueToCode(M,I,N.ORDER_UNARY_NEGATION)||T0;else var A0=N.valueToCode(M,I,$0)||T0;if(f0.isNumber(A0)){if(A0=parseFloat(A0)+a,g)A0=-A0}else{if(a>0){A0=A0+" + "+a;var D0=N.ORDER_ADDITION}else if(a<0){A0=A0+" - "+-a;var D0=N.ORDER_SUBTRACTION}if(g){if(a)A0="-("+A0+")";else A0="-"+A0;var D0=N.ORDER_UNARY_NEGATION}if(D0=Math.floor(D0),$0=Math.floor($0),D0&&$0>=D0)A0="("+A0+")"}return A0};N.control_wait=(M)=>{let I="";if(N.STATEMENT_PREFIX)I+=N.injectId(N.STATEMENT_PREFIX,M);const j=N.valueToCode(M,"DURATION",N.ORDER_NONE);return I+=`await runtime.sleep(${j});\n`,I};N.control_repeat=(M)=>{let I="",j,g;if(N.STATEMENT_PREFIX)I+=N.injectId(N.STATEMENT_PREFIX,M);if(j=N.valueToCode(M,"TIMES",N.ORDER_NONE)||"false",g=N.statementToCode(M,"SUBSTACK")||"",N.STATEMENT_SUFFIX)g=N.prefixLines(N.injectId(N.STATEMENT_SUFFIX,M),N.INDENT)+g;return I+=`for (let _ = 0; _ < ${j}; _++) {\n${g}  if (anonymous.aborted) return;\n  await runtime.nextFrame();\n}\n`,I};N.control_forever=(M)=>{let I="",j;if(N.STATEMENT_PREFIX)I+=N.injectId(N.STATEMENT_PREFIX,M);if(j=N.statementToCode(M,"SUBSTACK")||"",N.STATEMENT_SUFFIX)j=N.prefixLines(N.injectId(N.STATEMENT_SUFFIX,M),N.INDENT)+j;return I+=`while (true) {\n${j}  if (anonymous.aborted) return;\n  await runtime.nextFrame();\n}\n`,I};N.control_if=(M)=>{let I="",j,g;if(N.STATEMENT_PREFIX)I+=N.injectId(N.STATEMENT_PREFIX,M);if(g=N.valueToCode(M,"CONDITION",N.ORDER_NONE)||"false",j=N.statementToCode(M,"SUBSTACK")||"",N.STATEMENT_SUFFIX)j=N.prefixLines(N.injectId(N.STATEMENT_SUFFIX,M),N.INDENT)+j;if(I+=`if (${g}) {\n${j}}\n`,M.getInput("SUBSTACK2")){if(j=N.statementToCode(M,"SUBSTACK2")||"",N.STATEMENT_SUFFIX)j=N.prefixLines(N.injectId(N.STATEMENT_SUFFIX,M),N.INDENT)+j;I+=`else {\n${j}}\n`}return I};N.control_if_else=N.control_if;N.control_wait_until=(M)=>{let I="";if(N.STATEMENT_PREFIX)I+=N.injectId(N.STATEMENT_PREFIX,M);const j=N.valueToCode(M,"CONDITION",N.ORDER_NONE)||"false";return I+=`while (!(${j})) {\n  if (anonymous.aborted) return;\n  await runtime.nextFrame();\n}\n`,I};N.control_repeat_until=(M)=>{let I="",j,g;if(N.STATEMENT_PREFIX)I+=N.injectId(N.STATEMENT_PREFIX,M);if(g=N.valueToCode(M,"CONDITION",N.ORDER_NONE)||"false",j=N.statementToCode(M,"SUBSTACK")||"",N.STATEMENT_SUFFIX)j=N.prefixLines(N.injectId(N.STATEMENT_SUFFIX,M),N.INDENT)+j;return I+=`while (!(${g})) {\n${j}  if (anonymous.aborted) return;\n  await runtime.nextFrame();\n}\n`,I};N.control_while=(M)=>{let I="",j,g;if(N.STATEMENT_PREFIX)I+=N.injectId(N.STATEMENT_PREFIX,M);if(g=N.valueToCode(M,"CONDITION",N.ORDER_NONE)||"false",j=N.statementToCode(M,"SUBSTACK")||"",N.STATEMENT_SUFFIX)j=N.prefixLines(N.injectId(N.STATEMENT_SUFFIX,M),N.INDENT)+j;return I+=`while (${g}) {\n${j}  if (anonymous.aborted) return;\n  await runtime.nextFrame();\n}\n`,I};N.control_stop=(M)=>{let I="";if(N.STATEMENT_PREFIX)I+=N.injectId(N.STATEMENT_PREFIX,M);switch(M.getFieldValue("STOP_OPTION")){case"all":I+="runtime.stop();\n";break;case"this script":I+="return;\n";break;case"other scripts in sprite":I+="runtime.abort(anonymous.id);\n";break}return I};N.control_start_as_clone=(M)=>{};N.control_create_clone_of=(M)=>{};N.control_delete_this_clone=(M)=>{};import{ScratchBlocks as N0} from"@blockcode/blocks-editor";N.data_variable=(M)=>{return[`${N.variableDB_.getName(M.getFieldValue("VARIABLE"),N0.Variables.NAME_TYPE)}`,N.ORDER_CONDITIONAL]};N.data_setvariableto=(M)=>{let I="";if(N.STATEMENT_PREFIX)I+=N.injectId(N.STATEMENT_PREFIX,M);const j=N.variableDB_.getName(M.getFieldValue("VARIABLE"),N0.Variables.NAME_TYPE),g=N.valueToCode(M,"VALUE",N.ORDER_NONE)||0;return I+=`${j} = ${g};\n`,I};N.data_changevariableby=(M)=>{let I="";if(N.STATEMENT_PREFIX)I+=N.injectId(N.STATEMENT_PREFIX,M);const j=N.variableDB_.getName(M.getFieldValue("VARIABLE"),N0.Variables.NAME_TYPE),g=N.valueToCode(M,"VALUE",N.ORDER_NONE)||0;return I+=`${j} = (isNaN(${j}) ? 0 : +${j}) + +(${g});\n`,I};N.data_listcontents=(M)=>{return[N.variableDB_.getName(M.getFieldValue("LIST"),N0.Variables.NAME_TYPE)+N0.LIST_VARIABLE_TYPE,N.ORDER_ATOMIC]};N.data_addtolist=(M)=>{let I="";if(N.STATEMENT_PREFIX)I+=N.injectId(N.STATEMENT_PREFIX,M);const j=N.variableDB_.getName(M.getFieldValue("LIST"),N0.Variables.NAME_TYPE)+N0.LIST_VARIABLE_TYPE,g=N.valueToCode(M,"ITEM",N.ORDER_NONE)||0;return I+=`${j}.push(${g});\n`,I};N.data_deleteoflist=(M)=>{let I="";if(N.STATEMENT_PREFIX)I+=N.injectId(N.STATEMENT_PREFIX,M);const j=N.variableDB_.getName(M.getFieldValue("LIST"),N0.Variables.NAME_TYPE)+N0.LIST_VARIABLE_TYPE,g=(N.valueToCode(M,"INDEX",N.ORDER_NONE)||0)-1;return I+=`${g} > -1 && ${j}.splice(${g}, 1);\n`,I};N.data_deletealloflist=(M)=>{let I="";if(N.STATEMENT_PREFIX)I+=N.injectId(N.STATEMENT_PREFIX,M);const j=N.variableDB_.getName(M.getFieldValue("LIST"),N0.Variables.NAME_TYPE)+N0.LIST_VARIABLE_TYPE;return I+=`${j}.length = 0;\n`,I};N.data_insertatlist=(M)=>{let I="";if(N.STATEMENT_PREFIX)I+=N.injectId(N.STATEMENT_PREFIX,M);const j=N.variableDB_.getName(M.getFieldValue("LIST"),N0.Variables.NAME_TYPE)+N0.LIST_VARIABLE_TYPE,g=(N.valueToCode(M,"INDEX",N.ORDER_NONE)||0)-1,C=N.valueToCode(M,"ITEM",N.ORDER_NONE)||0;return I+=`${g} > -1 && ${j}.splice(${g}, 0, ${C});\n`,I};N.data_replaceitemoflist=(M)=>{let I="";if(N.STATEMENT_PREFIX)I+=N.injectId(N.STATEMENT_PREFIX,M);const j=N.variableDB_.getName(M.getFieldValue("LIST"),N0.Variables.NAME_TYPE)+N0.LIST_VARIABLE_TYPE,g=(N.valueToCode(M,"INDEX",N.ORDER_NONE)||0)-1,C=N.valueToCode(M,"ITEM",N.ORDER_NONE)||0;return I+=`${g} > -1 && ${j}.splice(${g}, 1, ${C});\n`,I};N.data_itemoflist=(M)=>{const I=N.variableDB_.getName(M.getFieldValue("LIST"),N0.Variables.NAME_TYPE)+N0.LIST_VARIABLE_TYPE,j=(N.valueToCode(M,"INDEX",N.ORDER_NONE)||0)-1;return[`${j} > -1 ? ${I}[${j}] : ''`,N.ORDER_CONDITIONAL]};N.data_itemnumoflist=(M)=>{const I=N.variableDB_.getName(M.getFieldValue("LIST"),N0.Variables.NAME_TYPE)+N0.LIST_VARIABLE_TYPE,j=N.valueToCode(M,"ITEM",N.ORDER_NONE)||0;return[`(${I}.indexOf(${j}) + 1)`,N.ORDER_NONE]};N.data_lengthoflist=(M)=>{return[`${N.variableDB_.getName(M.getFieldValue("LIST"),N0.Variables.NAME_TYPE)+N0.LIST_VARIABLE_TYPE}.length`,N.ORDER_MEMBER]};N.data_listcontainsitem=(M)=>{const I=N.variableDB_.getName(M.getFieldValue("LIST"),N0.Variables.NAME_TYPE)+N0.LIST_VARIABLE_TYPE,j=N.valueToCode(M,"ITEM",N.ORDER_NONE)||0;return[`${I}.includes(${j})`,N.ORDER_FUNCTION_CALL]};import{ScratchBlocks as I8} from"@blockcode/blocks-editor";N.event_whenflagclicked=(M)=>{return"runtime.on('start', async function anonymous() {/* nextCode */});\n"};N.event_whengreaterthan=(M)=>{};N.event_whenbroadcastreceived=(M)=>{return`runtime.on('${N.variableDB_.getName(M.getFieldValue("BROADCAST_OPTION"),I8.Variables.NAME_TYPE)}', async function anonymous(done) {/* nextCode */  done()\n});\n`};N.event_broadcast_menu=(M)=>{return[N.variableDB_.getName(M.getFieldValue("BROADCAST_OPTION"),I8.Variables.NAME_TYPE),N.ORDER_ATOMIC]};N.event_broadcast=(M)=>{let I="";if(N.STATEMENT_PREFIX)I+=N.injectId(N.STATEMENT_PREFIX,M);const j=N.valueToCode(M,"BROADCAST_INPUT",N.ORDER_NONE)||"None";return I+=`runtime.broadcast('${j}')\n`,I};N.event_broadcastandwait=(M)=>{let I="";if(N.STATEMENT_PREFIX)I+=N.injectId(N.STATEMENT_PREFIX,M);const j=N.valueToCode(M,"BROADCAST_INPUT",N.ORDER_NONE)||"None";return I+=`await runtime.broadcast('${j}')\n`,I};N.math_number=(M)=>{let I=parseFloat(M.getFieldValue("NUM")),j;if(I===Infinity)I="Infinity",j=N.ORDER_FUNCTION_CALL;else if(I===(-Infinity))I="-Infinity",j=N.ORDER_UNARY_SIGN;else if(Number.isNaN(I))I="NaN",j=N.ORDER_UNARY_SIGN;else j=I<0?N.ORDER_UNARY_SIGN:N.ORDER_ATOMIC;return[I,j]};N.math_integer=(M)=>{const I=parseInt(M.getFieldValue("NUM")),j=I<0?N.ORDER_UNARY_SIGN:N.ORDER_ATOMIC;return[I,j]};N.math_whole_number=(M)=>{return[Math.abs(parseInt(M.getFieldValue("NUM"))),N.ORDER_ATOMIC]};N.math_positive_number=(M)=>{let I=parseFloat(M.getFieldValue("NUM")),j;if(I===Infinity)I="Infinity",j=N.ORDER_FUNCTION_CALL;else if(I===(-Infinity))I="-Infinity",j=N.ORDER_FUNCTION_CALL;else if(Number.isNaN(I))I="NaN",j=N.ORDER_FUNCTION_CALL;else I=I<0?0:I,j=N.ORDER_ATOMIC;return[I,j]};N.math_angle=(M)=>{let I=parseFloat(M.getFieldValue("NUM")),j;if(I==Infinity)I="Infinity",j=N.ORDER_FUNCTION_CALL;else if(I==(-Infinity))I="-Infinity",j=N.ORDER_UNARY_SIGN;else I=I%360,I=I<0?I+360:I,j=N.ORDER_ATOMIC;return[I,j]};N.operator_add=(M)=>{const I=N.valueToCode(M,"NUM1",N.ORDER_NONE)||0,j=N.valueToCode(M,"NUM2",N.ORDER_NONE)||0;return[`(${I} + ${j})`,N.ORDER_SUBTRACTION]};N.operator_subtract=(M)=>{const I=N.valueToCode(M,"NUM1",N.ORDER_NONE)||0,j=N.valueToCode(M,"NUM2",N.ORDER_NONE)||0;return[`(${I} - ${j})`,N.ORDER_ADDITION]};N.operator_multiply=(M)=>{const I=N.valueToCode(M,"NUM1",N.ORDER_NONE)||0,j=N.valueToCode(M,"NUM2",N.ORDER_NONE)||0;return[`(${I} * ${j})`,N.ORDER_MULTIPLICATION]};N.operator_divide=(M)=>{const I=N.valueToCode(M,"NUM1",N.ORDER_NONE)||0,j=N.valueToCode(M,"NUM2",N.ORDER_NONE)||0;return[`(${I} / ${j})`,N.ORDER_DIVISION]};N.operator_random=(M)=>{const I=N.valueToCode(M,"FROM",N.ORDER_NONE)||0,j=N.valueToCode(M,"TO",N.ORDER_NONE)||0;return[`runtime.random(${I}, ${j})`,N.ORDER_FUNCTION_CALL]};N.operator_gt=(M)=>{const I=N.valueToCode(M,"OPERAND1",N.ORDER_NONE)||0,j=N.valueToCode(M,"OPERAND2",N.ORDER_NONE)||0;return[`(${I} > ${j})`,N.ORDER_RELATIONAL]};N.operator_lt=(M)=>{const I=N.valueToCode(M,"OPERAND1",N.ORDER_NONE)||0,j=N.valueToCode(M,"OPERAND2",N.ORDER_NONE)||0;return[`(${I} < ${j})`,N.ORDER_RELATIONAL]};N.operator_equals=(M)=>{const I=N.valueToCode(M,"OPERAND1",N.ORDER_NONE)||0,j=N.valueToCode(M,"OPERAND2",N.ORDER_NONE)||0;return[`(${I} == ${j})`,N.ORDER_RELATIONAL]};N.operator_and=(M)=>{const I=N.valueToCode(M,"OPERAND1",N.ORDER_NONE)||0,j=N.valueToCode(M,"OPERAND2",N.ORDER_NONE)||0;return[`(${I} && ${j})`,N.ORDER_LOGICAL_AND]};N.operator_or=(M)=>{const I=N.valueToCode(M,"OPERAND1",N.ORDER_NONE)||0,j=N.valueToCode(M,"OPERAND2",N.ORDER_NONE)||0;return[`(${I} || ${j})`,N.ORDER_LOGICAL_OR]};N.operator_not=(M)=>{return[`!(${N.valueToCode(M,"OPERAND",N.ORDER_NONE)||0})`,N.ORDER_LOGICAL_NOT]};N.operator_join=(M)=>{const I=N.valueToCode(M,"STRING1",N.ORDER_NONE)||"",j=N.valueToCode(M,"STRING2",N.ORDER_NONE)||""};N.operator_constter_of=(M)=>{const I=N.valueToCode(M,"LETTER",N.ORDER_NONE)||"",j=N.valueToCode(M,"STRING",N.ORDER_NONE)||""};N.operator_length=(M)=>{const I=N.valueToCode(M,"STRING",N.ORDER_NONE)||""};N.operator_contains=(M)=>{const I=N.valueToCode(M,"STRING1",N.ORDER_NONE)||"",j=N.valueToCode(M,"STRING2",N.ORDER_NONE)||""};N.operator_mod=(M)=>{const I=N.valueToCode(M,"NUM1",N.ORDER_NONE)||0,j=N.valueToCode(M,"NUM2",N.ORDER_NONE)||0;return[`(${I} % ${j})`,N.ORDER_MODULUS]};N.operator_round=(M)=>{return[`Math.round(${N.valueToCode(M,"NUM",N.ORDER_NONE)||0})`,N.ORDER_FUNCTION_CALL]};N.operator_mathop=(M)=>{const I=N.valueToCode(M,"NUM",N.ORDER_NONE)||0,j=M.getFieldValue("OPERATOR");let g="";if(j==="ceiling")g+=`Math.ceil(${I})`;else if(j==="sin"||j==="cos"||j==="tan")g+=`Math.${j}((Math.PI * ${I}) / 180)`;else if(j==="asin"||j==="acos"||j==="atan")g+=`((Math.${j}(${I}) * 180) / Math.PI)`;else if(j==="ln")g+=`(Math.log(${I})`;else if(j==="log")g+=`(Math.log(${I}) / Math.LN10)`;else if(j==="e ^")g+=`Math.exp(${I})`;else if(j==="10 ^")g+=`Math.pow(10, ${I})`;else g+=`Math.${j}(${I})`;return[g,N.ORDER_FUNCTION_CALL]};N.procedures_definition=(M)=>{};N.procedures_call=(M)=>{};N.procedures_prototype=(M)=>{};N.procedures_declaration=(M)=>{};N.argument_reporter_boolean=(M)=>{};N.argument_reporter_string_number=(M)=>{};N.argument_editor_boolean=(M)=>{};N.argument_editor_string_number=(M)=>{};N.sensing_timer=(M)=>{return["runtime.getTimer()",N.ORDER_FUNCTION_CALL]};N.sensing_resettimer=(M)=>{return"runtime.resetTimer()\n"};N.text=(M)=>{return[N.quote_(M.getFieldValue("TEXT")),N.ORDER_ATOMIC]};function e8({width:M,height:I,onSetup:j,...g}){const C=r8(null),[a,$0]=M8(null),[T0,A0]=M8(null),{selectedIndex:D0,modifyFile:Z0}=i8();return a8(()=>{if(C.current){if(W8.default.setup(C.current),j)j(C.current);let b0;const y=()=>{if(b0=j0.getMainWorkspace(),b0){b0.addChangeListener((x0)=>{if(b0.isDragging())return;if(!t8.has(x0.type))return;const s=j0.Xml.workspaceToDom(b0),m0=j0.Xml.domToText(s).replace(/<variable type="broadcast_msg"[^>]+>[^<]+<\/variable>/gi,"");if(m0!==a||D0!==T0){if(Z0({script:N.workspaceToCode(b0)}),m0!==a)$0(m0);if(D0!==T0)A0(D0)}});return}setTimeout(y)};y()}return()=>{W8.default.project.clear(),W8.default.project.remove()}},[C]),$6("canvas",{ref:C,style:{width:M,height:I},...g})}import{jsx as $6} from"preact/jsx-runtime";var t8=new Set([j0.Events.BLOCK_CHANGE,j0.Events.BLOCK_CREATE,j0.Events.BLOCK_DELETE,j0.Events.BLOCK_MOVE,j0.Events.COMMENT_CHANGE,j0.Events.COMMENT_CREATE,j0.Events.COMMENT_DELETE,j0.Events.COMMENT_MOVE,j0.Events.VAR_CREATE,j0.Events.VAR_DELETE,j0.Events.VAR_RENAME]);var Q6=function(M){console&&console.warn&&console.warn(M)},O0=function(){O0.init.call(this)},Y8=function(M){if(typeof M!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof M)},C8=function(M){return M._maxListeners===void 0?O0.defaultMaxListeners:M._maxListeners},P8=function(M,I,j,g){var C,a,$0;if(Y8(j),a=M._events,a===void 0?(a=M._events=Object.create(null),M._eventsCount=0):(a.newListener!==void 0&&(M.emit("newListener",I,j.listener?j.listener:j),a=M._events),$0=a[I]),$0===void 0)$0=a[I]=j,++M._eventsCount;else if(typeof $0=="function"?$0=a[I]=g?[j,$0]:[$0,j]:g?$0.unshift(j):$0.push(j),C=C8(M),C>0&&$0.length>C&&!$0.warned){$0.warned=!0;var T0=new Error("Possible EventEmitter memory leak detected. "+$0.length+" "+String(I)+" listeners added. Use emitter.setMaxListeners() to increase limit");T0.name="MaxListenersExceededWarning",T0.emitter=M,T0.type=I,T0.count=$0.length,Q6(T0)}return M},J6=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)},w8=function(M,I,j){var g={fired:!1,wrapFn:void 0,target:M,type:I,listener:j},C=J6.bind(g);return C.listener=j,g.wrapFn=C,C},j8=function(M,I,j){var g=M._events;if(g===void 0)return[];var C=g[I];return C===void 0?[]:typeof C=="function"?j?[C.listener||C]:[C]:j?K6(C):f8(C,C.length)},k8=function(M){var I=this._events;if(I!==void 0){var j=I[M];if(typeof j=="function")return 1;if(j!==void 0)return j.length}return 0},f8=function(M,I){for(var j=new Array(I),g=0;g<I;++g)j[g]=M[g];return j},U6=function(M,I){for(;I+1<M.length;I++)M[I]=M[I+1];M.pop()},K6=function(M){for(var I=new Array(M.length),j=0;j<I.length;++j)I[j]=M[j].listener||M[j];return I};var i0=typeof Reflect=="object"?Reflect:null,B8=i0&&typeof i0.apply=="function"?i0.apply:function(M,I,j){return Function.prototype.apply.call(M,I,j)},H8;i0&&typeof i0.ownKeys=="function"?H8=i0.ownKeys:Object.getOwnPropertySymbols?H8=function(M){return Object.getOwnPropertyNames(M).concat(Object.getOwnPropertySymbols(M))}:H8=function(M){return Object.getOwnPropertyNames(M)};var S8=Number.isNaN||function(M){return M!==M};O0.EventEmitter=O0;O0.prototype._events=void 0;O0.prototype._eventsCount=0;O0.prototype._maxListeners=void 0;var G8=10;Object.defineProperty(O0,"defaultMaxListeners",{enumerable:!0,get:function(){return G8},set:function(M){if(typeof M!="number"||M<0||S8(M))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+M+".");G8=M}});O0.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};O0.prototype.setMaxListeners=function(M){if(typeof M!="number"||M<0||S8(M))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+M+".");return this._maxListeners=M,this};O0.prototype.getMaxListeners=function(){return C8(this)};O0.prototype.emit=function(M){for(var I=[],j=1;j<arguments.length;j++)I.push(arguments[j]);var g=M==="error",C=this._events;if(C!==void 0)g=g&&C.error===void 0;else if(!g)return!1;if(g){var a;if(I.length>0&&(a=I[0]),a instanceof Error)throw a;var $0=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw $0.context=a,$0}var T0=C[M];if(T0===void 0)return!1;if(typeof T0=="function")B8(T0,this,I);else for(var A0=T0.length,D0=f8(T0,A0),j=0;j<A0;++j)B8(D0[j],this,I);return!0};O0.prototype.addListener=function(M,I){return P8(this,M,I,!1)};O0.prototype.on=O0.prototype.addListener;O0.prototype.prependListener=function(M,I){return P8(this,M,I,!0)};O0.prototype.once=function(M,I){return Y8(I),this.on(M,w8(this,M,I)),this};O0.prototype.prependOnceListener=function(M,I){return Y8(I),this.prependListener(M,w8(this,M,I)),this};O0.prototype.removeListener=function(M,I){var j,g,C,a,$0;if(Y8(I),g=this._events,g===void 0)return this;if(j=g[M],j===void 0)return this;if(j===I||j.listener===I)--this._eventsCount===0?this._events=Object.create(null):(delete g[M],g.removeListener&&this.emit("removeListener",M,j.listener||I));else if(typeof j!="function"){for(C=-1,a=j.length-1;a>=0;a--)if(j[a]===I||j[a].listener===I){$0=j[a].listener,C=a;break}if(C<0)return this;C===0?j.shift():U6(j,C),j.length===1&&(g[M]=j[0]),g.removeListener!==void 0&&this.emit("removeListener",M,$0||I)}return this};O0.prototype.off=O0.prototype.removeListener;O0.prototype.removeAllListeners=function(M){var I,j,g;if(j=this._events,j===void 0)return this;if(j.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):j[M]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete j[M]),this;if(arguments.length===0){var C=Object.keys(j),a;for(g=0;g<C.length;++g)a=C[g],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(I=j[M],typeof I=="function")this.removeListener(M,I);else if(I!==void 0)for(g=I.length-1;g>=0;g--)this.removeListener(M,I[g]);return this};O0.prototype.listeners=function(M){return j8(this,M,!0)};O0.prototype.rawListeners=function(M){return j8(this,M,!1)};O0.listenerCount=function(M,I){return typeof M.listenerCount=="function"?M.listenerCount(I):k8.call(M,I)};O0.prototype.listenerCount=k8;O0.prototype.eventNames=function(){return this._eventsCount>0?H8(this._events):[]};var x6=O0.prototype;class X8 extends O0{static DEFAULT_FPS=24;constructor(M,I,j=X8.DEFAULT_FPS){super();this._fps=j,this._spf=1/j,this._running=!1,this._requestStop=I,this._timer=0,this._timers=[],this._idCounter=0,this._eventsGroups={},this.openEventsGroup("global"),new Function("runtime",M)(this),console.log(M)}get running(){return this._running}get timer(){return Date.now()-this._timer}openEventsGroup(M){this._currentGroupName=M,this._eventsGroups[M]=this._eventsGroups[M]||[]}closeEventsGroup(){this._currentGroupName="global"}abort(M){const I=M.split(":")[0],j=[];this._eventsGroups[I].forEach((g)=>{if(g.id===M)j.push(g);else g._aborted=!0}),this._eventsGroups[I]=j}on(M,I){const j=this._currentGroupName;Object.defineProperties(I,{id:{get:()=>I._id},aborted:{get:()=>I._aborted||!this.running}}),super.on(M,(...g)=>{I._id=`${j}:${++this._idCounter}`,I._aborted=!1,this._eventsGroups[j].push(I),I(...g)})}emit(...M){if(this.running)super.emit(...M)}broadcast(M){return new Promise((I)=>{this.emit(M,I)})}start(){this._running=!0,this.emit("beforeStart"),this.on("start",async()=>{while(this.running)this.emit("frame"),await this.nextFrame()}),this._timer=Date.now(),this.emit("start")}async stop(){this._running=!1,await this.nextFrame(),this._timers.forEach(clearTimeout),this._timers.length=0,this._requestStop()}sleep(M){return new Promise((I)=>this._timers.push(setTimeout(I,M*1000)))}nextFrame(){return this.sleep(this._spf)}random(M=1,I=10){return M=Math.ceil(Math.min(M,I)),I=Math.floor(Math.max(M,I)),Math.floor(Math.random()*(I-M+1))+M}resetTimer(){this._timer=Date.now()}}var export_paperCore=Z6.default;export{export_paperCore as paperCore,N as javascriptGenerator,X8 as Runtime,e8 as BlocksPlayer};
