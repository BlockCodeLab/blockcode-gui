var n8=Object.create;var{defineProperty:z8,getPrototypeOf:o8,getOwnPropertyNames:r8}=Object;var a8=Object.prototype.hasOwnProperty;var E8=(M,I,w)=>{w=M!=null?n8(o8(M)):{};const g=I||!M||!M.__esModule?z8(w,"default",{value:M,enumerable:!0}):w;for(let S of r8(M))if(!a8.call(g,S))z8(g,S,{get:()=>M[S],enumerable:!0});return g};var i8=(M,I)=>()=>(I||M((I={exports:{}}).exports,I),I.exports);var I8=((M)=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy(M,{get:(I,w)=>(typeof require!=="undefined"?require:I)[w]}):M)(function(M){if(typeof require!=="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+M+'" is not supported')});var H8=i8((M8,r0)=>{/*!
 * Paper.js v0.12.17 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, Jürg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Thu Nov 3 21:15:36 2022 +0100
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 Jürg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */var O6=function(M,I){M=M||(()=>({}));var{window:w,document:g}=M,S=new function(){var $=/^(statics|enumerable|beans|preserve)$/,Q=[],J=Q.slice,U=Object.create,Z=Object.getOwnPropertyDescriptor,K=Object.defineProperty,H=Q.forEach||function(O,X){for(var N=0,L=this.length;N<L;N++)O.call(X,this[N],N,this)},W=function(O,X){for(var N in this)if(this.hasOwnProperty(N))O.call(X,this[N],N,this)},Y=Object.assign||function(O){for(var X=1,N=arguments.length;X<N;X++){var L=arguments[X];for(var B in L)if(L.hasOwnProperty(B))O[B]=L[B]}return O},F=function(O,X,N){if(O){var L=Z(O,"length");(L&&typeof L.value==="number"?H:W).call(O,X,N=N||O)}return N};function A(O,X,N,L,B){var E={};function R(G,C){if(C=C||(C=Z(X,G))&&(C.get?C:C.value),typeof C==="string"&&C[0]==="#")C=O[C.substring(1)]||C;var P=typeof C==="function",j=C,k=B||P&&!C.base?C&&C.get?G in O:O[G]:null,x;if(!B||!k){if(P&&k)C.base=k;if(P&&L!==!1&&(x=G.match(/^([gs]et|is)(([A-Z])(.*))$/)))E[x[3].toLowerCase()+x[4]]=x[2];if(!j||P||!j.get||typeof j.get!=="function"||!V.isPlainObject(j))j={value:j,writable:!0};if((Z(O,G)||{configurable:!0}).configurable)j.configurable=!0,j.enumerable=N!=null?N:!x;K(O,G,j)}}if(X){for(var T in X)if(X.hasOwnProperty(T)&&!$.test(T))R(T);for(var T in E){var q=E[T],_=O["set"+q],z=O["get"+q]||_&&O["is"+q];if(z&&(L===!0||z.length===0))R(T,{get:z,set:_})}}return O}function V(){for(var O=0,X=arguments.length;O<X;O++){var N=arguments[O];if(N)Y(this,N)}return this}return A(V,{inject:function(O){if(O){var X=O.statics===!0?O:O.statics,N=O.beans,L=O.preserve;if(X!==O)A(this.prototype,O,O.enumerable,N,L);A(this,X,null,N,L)}for(var B=1,E=arguments.length;B<E;B++)this.inject(arguments[B]);return this},extend:function(){var O=this,X,N;for(var L=0,B,E=arguments.length;L<E&&!(X&&N);L++)B=arguments[L],X=X||B.initialize,N=N||B.prototype;if(X=X||function(){O.apply(this,arguments)},N=X.prototype=N||U(this.prototype),K(N,"constructor",{value:X,writable:!0,configurable:!0}),A(X,this),arguments.length)this.inject.apply(X,arguments);return X.base=O,X}}).inject({enumerable:!1,initialize:V,set:V,inject:function(){for(var O=0,X=arguments.length;O<X;O++){var N=arguments[O];if(N)A(this,N,N.enumerable,N.beans,N.preserve)}return this},extend:function(){var O=U(this);return O.inject.apply(O,arguments)},each:function(O,X){return F(this,O,X)},clone:function(){return new this.constructor(this)},statics:{set:Y,each:F,create:U,define:K,describe:Z,clone:function(O){return Y(new O.constructor,O)},isPlainObject:function(O){var X=O!=null&&O.constructor;return X&&(X===Object||X===V||X.name==="Object")},pick:function(O,X){return O!==I?O:X},slice:function(O,X,N){return J.call(O,X,N)}}})};if(typeof r0!=="undefined")r0.exports=S;S.inject({enumerable:!1,toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+S.each(this,function($,Q){if(!/^_/.test(Q)){var J=typeof $;this.push(Q+": "+(J==="number"?D0.instance.number($):J==="string"?"'"+$+"'":$))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function($){return S.importJSON($,this)},exportJSON:function($){return S.exportJSON(this,$)},toJSON:function(){return S.serialize(this)},set:function($,Q){if($)S.filter(this,$,Q,this._prioritize);return this}},{beans:!1,statics:{exports:{},extend:function $(){var Q=$.base.apply(this,arguments),J=Q.prototype._class;if(J&&!S.exports[J])S.exports[J]=Q;return Q},equals:function($,Q){if($===Q)return!0;if($&&$.equals)return $.equals(Q);if(Q&&Q.equals)return Q.equals($);if($&&Q&&typeof $==="object"&&typeof Q==="object"){if(Array.isArray($)&&Array.isArray(Q)){var J=$.length;if(J!==Q.length)return!1;while(J--)if(!S.equals($[J],Q[J]))return!1}else{var U=Object.keys($),J=U.length;if(J!==Object.keys(Q).length)return!1;while(J--){var Z=U[J];if(!(Q.hasOwnProperty(Z)&&S.equals($[Z],Q[Z])))return!1}}return!0}return!1},read:function($,Q,J,U){if(this===S){var Z=this.peek($,Q);return $.__index++,Z}var K=this.prototype,H=K._readIndex,W=Q||H&&$.__index||0,Y=$.length,F=$[W];if(U=U||Y-W,F instanceof this||J&&J.readNull&&F==null&&U<=1){if(H)$.__index=W+1;return F&&J&&J.clone?F.clone():F}if(F=S.create(K),H)F.__read=!0;if(F=F.initialize.apply(F,W>0||W+U<Y?S.slice($,W,W+U):$)||F,H){$.__index=W+F.__read;var A=F.__filtered;if(A)$.__filtered=A,F.__filtered=I;F.__read=I}return F},peek:function($,Q){return $[$.__index=Q||$.__index||0]},remain:function($){return $.length-($.__index||0)},readList:function($,Q,J,U){var Z=[],K,H=Q||0,W=U?H+U:$.length;for(var Y=H;Y<W;Y++)Z.push(Array.isArray(K=$[Y])?this.read(K,0,J):this.read($,Y,J,1));return Z},readNamed:function($,Q,J,U,Z){var K=this.getNamed($,Q),H=K!==I;if(H){var W=$.__filtered;if(!W){var Y=this.getSource($);W=$.__filtered=S.create(Y),W.__unfiltered=Y}W[Q]=I}return this.read(H?[K]:$,J,U,Z)},readSupported:function($,Q){var J=this.getSource($),U=this,Z=!1;if(J)Object.keys(J).forEach(function(K){if(K in Q){var H=U.readNamed($,K);if(H!==I)Q[K]=H;Z=!0}});return Z},getSource:function($){var Q=$.__source;if(Q===I){var J=$.length===1&&$[0];Q=$.__source=J&&S.isPlainObject(J)?J:null}return Q},getNamed:function($,Q){var J=this.getSource($);if(J)return Q?J[Q]:$.__filtered||J},hasNamed:function($,Q){return!!this.getNamed($,Q)},filter:function($,Q,J,U){var Z;function K(A){if(!(J&&(A in J))&&!(Z&&(A in Z))){var V=Q[A];if(V!==I)$[A]=V}}if(U){var H={};for(var W=0,Y,F=U.length;W<F;W++)if((Y=U[W])in Q)K(Y),H[Y]=!0;Z=H}return Object.keys(Q.__unfiltered||Q).forEach(K),$},isPlainValue:function($,Q){return S.isPlainObject($)||Array.isArray($)||Q&&typeof $==="string"},serialize:function($,Q,J,U){Q=Q||{};var Z=!U,K;if(Z)Q.formatter=new D0(Q.precision),U={length:0,definitions:{},references:{},add:function(V,O){var X="#"+V._id,N=this.references[X];if(!N){this.length++;var L=O.call(V),B=V._class;if(B&&L[0]!==B)L.unshift(B);this.definitions[X]=L,N=this.references[X]=[X]}return N}};if($&&$._serialize){K=$._serialize(Q,U);var H=$._class;if(H&&!$._compactSerialize&&(Z||!J)&&K[0]!==H)K.unshift(H)}else if(Array.isArray($)){K=[];for(var W=0,Y=$.length;W<Y;W++)K[W]=S.serialize($[W],Q,J,U)}else if(S.isPlainObject($)){K={};var F=Object.keys($);for(var W=0,Y=F.length;W<Y;W++){var A=F[W];K[A]=S.serialize($[A],Q,J,U)}}else if(typeof $==="number")K=Q.formatter.number($,Q.precision);else K=$;return Z&&U.length>0?[["dictionary",U.definitions],K]:K},deserialize:function($,Q,J,U,Z){var K=$,H=!J,W=H&&$&&$.length&&$[0][0]==="dictionary";if(J=J||{},Array.isArray($)){var Y=$[0],F=Y==="dictionary";if($.length==1&&/^#/.test(Y))return J.dictionary[Y];Y=S.exports[Y],K=[];for(var A=Y?1:0,V=$.length;A<V;A++)K.push(S.deserialize($[A],Q,J,F,W));if(Y){var O=K;if(Q)K=Q(Y,O,H||Z);else K=new Y(O)}}else if(S.isPlainObject($)){if(K={},U)J.dictionary=K;for(var X in $)K[X]=S.deserialize($[X],Q,J)}return W?K[1]:K},exportJSON:function($,Q){var J=S.serialize($,Q);return Q&&Q.asString==!1?J:JSON.stringify(J)},importJSON:function($,Q){return S.deserialize(typeof $==="string"?JSON.parse($):$,function(J,U,Z){var K=Z&&Q&&Q.constructor===J,H=K?Q:S.create(J.prototype);if(U.length===1&&H instanceof Q0&&(K||!(H instanceof t0))){var W=U[0];if(S.isPlainObject(W)){if(W.insert=!1,K)U=U.concat([Q0.INSERT])}}if((K?H.set:J).apply(H,U),K)Q=null;return H})},push:function($,Q){var J=Q.length;if(J<4096)$.push.apply($,Q);else{var U=$.length;$.length+=J;for(var Z=0;Z<J;Z++)$[U+Z]=Q[Z]}return $},splice:function($,Q,J,U){var Z=Q&&Q.length,K=J===I;if(J=K?$.length:J,J>$.length)J=$.length;for(var H=0;H<Z;H++)Q[H]._index=J+H;if(K)return S.push($,Q),[];else{var W=[J,U];if(Q)S.push(W,Q);var Y=$.splice.apply($,W);for(var H=0,F=Y.length;H<F;H++)Y[H]._index=I;for(var H=J+Z,F=$.length;H<F;H++)$[H]._index=H;return Y}},capitalize:function($){return $.replace(/\b[a-z]/g,function(Q){return Q.toUpperCase()})},camelize:function($){return $.replace(/-(.)/g,function(Q,J){return J.toUpperCase()})},hyphenate:function($){return $.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var a={on:function($,Q){if(typeof $!=="string")S.each($,function(K,H){this.on(H,K)},this);else{var J=this._eventTypes,U=J&&J[$],Z=this._callbacks=this._callbacks||{};if(Z=Z[$]=Z[$]||[],Z.indexOf(Q)===-1){if(Z.push(Q),U&&U.install&&Z.length===1)U.install.call(this,$)}}return this},off:function($,Q){if(typeof $!=="string"){S.each($,function(H,W){this.off(W,H)},this);return}var J=this._eventTypes,U=J&&J[$],Z=this._callbacks&&this._callbacks[$],K;if(Z){if(!Q||(K=Z.indexOf(Q))!==-1&&Z.length===1){if(U&&U.uninstall)U.uninstall.call(this,$);delete this._callbacks[$]}else if(K!==-1)Z.splice(K,1)}return this},once:function($,Q){return this.on($,function J(){Q.apply(this,arguments),this.off($,J)})},emit:function($,Q){var J=this._callbacks&&this._callbacks[$];if(!J)return!1;var U=S.slice(arguments,1),Z=Q&&Q.target&&!Q.currentTarget;if(J=J.slice(),Z)Q.currentTarget=this;for(var K=0,H=J.length;K<H;K++)if(J[K].apply(this,U)==!1){if(Q&&Q.stop)Q.stop();break}if(Z)delete Q.currentTarget;return!0},responds:function($){return!!(this._callbacks&&this._callbacks[$])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function($){var Q=this._eventTypes,J=this._callbacks,U=$?"install":"uninstall";if(Q){for(var Z in J)if(J[Z].length>0){var K=Q[Z],H=K&&K[U];if(H)H.call(this,Z)}}},statics:{inject:function $(Q){var J=Q._events;if(J){var U={};S.each(J,function(Z,K){var H=typeof Z==="string",W=H?Z:K,Y=S.capitalize(W),F=W.substring(2).toLowerCase();U[F]=H?{}:Z,W="_"+W,Q["get"+Y]=function(){return this[W]},Q["set"+Y]=function(A){var V=this[W];if(V)this.off(F,V);if(A)this.on(F,A);this[W]=A}}),Q._eventTypes=U}return $.base.apply(this,arguments)}}},$0=S.extend({_class:"PaperScope",initialize:function $(){W0=this,this.settings=new S({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=$._id++,$._scopes[this._id]=this;var Q=$.prototype;if(!this.support){var J=L0.getContext(1,1)||{};Q.support={nativeDash:"setLineDash"in J||"mozDash"in J,nativeBlendModes:D8.nativeModes},L0.release(J)}if(!this.agent){var U=M.navigator.userAgent.toLowerCase(),Z=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(U)||[])[0],K=Z==="darwin"?"mac":Z,H=Q.agent=Q.browser={platform:K};if(K)H[K]=!0;if(U.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(W,Y,F,A,V){if(!H.chrome){var O=Y==="opera"?A:/^(node|trident)$/.test(Y)?V:F;H.version=O,H.versionNumber=parseFloat(O),Y={trident:"msie",jsdom:"node"}[Y]||Y,H.name=Y,H[Y]=!0}}),H.chrome)delete H.webkit;if(H.atom)delete H.chrome}},version:"0.12.17",getView:function(){var $=this.project;return $&&$._view},getPaper:function(){return this},execute:function($,Q){},install:function($){var Q=this;S.each(["project","view","tool"],function(U){S.define($,U,{configurable:!0,get:function(){return Q[U]}})});for(var J in this)if(!/^_/.test(J)&&this[J])$[J]=this[J]},setup:function($){return W0=this,this.project=new J8($),this},createCanvas:function($,Q){return L0.getCanvas($,Q)},activate:function(){W0=this},clear:function(){var $=this.projects,Q=this.tools;for(var J=$.length-1;J>=0;J--)$[J].remove();for(var J=Q.length-1;J>=0;J--)Q[J].remove()},remove:function(){this.clear(),delete $0._scopes[this._id]},statics:new function(){function $(Q){return Q+="Attribute",function(J,U){return J[Q](U)||J[Q]("data-paper-"+U)}}return{_scopes:{},_id:0,get:function(Q){return this._scopes[Q]||null},getAttribute:$("get"),hasAttribute:$("has")}}}),T0=S.extend(a,{initialize:function($){if(this._scope=W0,this._index=this._scope[this._list].push(this)-1,$||!this._scope[this._reference])this.activate()},activate:function(){if(!this._scope)return!1;var $=this._scope[this._reference];if($&&$!==this)$.emit("deactivate");return this._scope[this._reference]=this,this.emit("activate",$),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){if(this._index==null)return!1;if(S.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this)this._scope[this._reference]=null;return this._scope=null,!0},getView:function(){return this._scope.getView()}}),O0={findItemBoundsCollisions:function($,Q,J){function U(H){var W=new Array(H.length);for(var Y=0;Y<H.length;Y++){var F=H[Y].getBounds();W[Y]=[F.left,F.top,F.right,F.bottom]}return W}var Z=U($),K=!Q||Q===$?Z:U(Q);return this.findBoundsCollisions(Z,K,J||0)},findCurveBoundsCollisions:function($,Q,J,U){function Z(O){var{min:X,max:N}=Math,L=new Array(O.length);for(var B=0;B<O.length;B++){var E=O[B];L[B]=[X(E[0],E[2],E[4],E[6]),X(E[1],E[3],E[5],E[7]),N(E[0],E[2],E[4],E[6]),N(E[1],E[3],E[5],E[7])]}return L}var K=Z($),H=!Q||Q===$?K:Z(Q);if(U){var W=this.findBoundsCollisions(K,H,J||0,!1,!0),Y=this.findBoundsCollisions(K,H,J||0,!0,!0),F=[];for(var A=0,V=W.length;A<V;A++)F[A]={hor:W[A],ver:Y[A]};return F}return this.findBoundsCollisions(K,H,J||0)},findBoundsCollisions:function($,Q,J,U,Z){var K=!Q||$===Q,H=K?$:$.concat(Q),W=$.length,Y=H.length;function F(d,l,r){var n=0,e=d.length;while(n<e){var c=e+n>>>1;if(H[d[c]][l]<r)n=c+1;else e=c}return n-1}var A=U?1:0,V=A+2,O=U?0:1,X=O+2,N=new Array(Y);for(var L=0;L<Y;L++)N[L]=L;N.sort(function(d,l){return H[d][A]-H[l][A]});var B=[],E=new Array(W);for(var L=0;L<Y;L++){var R=N[L],T=H[R],q=K?R:R-W,_=R<W,z=K||!_,G=_?[]:null;if(B.length){var C=F(B,V,T[A]-J)+1;if(B.splice(0,C),K&&Z){G=G.concat(B);for(var P=0;P<B.length;P++){var j=B[P];E[j].push(q)}}else{var k=T[X],x=T[O];for(var P=0;P<B.length;P++){var j=B[P],b=H[j],f=j<W,h=K||j>=W;if(Z||(_&&h||z&&f)&&(k>=b[O]-J&&x<=b[X]+J)){if(_&&h)G.push(K?j:j-W);if(z&&f)E[j].push(q)}}}}if(_){if($===Q)G.push(R);E[R]=G}if(B.length){var u=T[V],v=F(B,V,u);B.splice(v+1,0,R)}else B.push(R)}for(var L=0;L<E.length;L++){var m=E[L];if(m)m.sort(function(l,r){return l-r})}return E}},D0=S.extend({initialize:function($){this.precision=S.pick($,5),this.multiplier=Math.pow(10,this.precision)},number:function($){return this.precision<16?Math.round($*this.multiplier)/this.multiplier:$},pair:function($,Q,J){return this.number($)+(J||",")+this.number(Q)},point:function($,Q){return this.number($.x)+(Q||",")+this.number($.y)},size:function($,Q){return this.number($.width)+(Q||",")+this.number($.height)},rectangle:function($,Q){return this.point($,Q)+(Q||",")+this.size($,Q)}});D0.instance=new D0;var Z0=new function(){var $=[[0.5773502691896257],[0,0.7745966692414834],[0.33998104358485626,0.8611363115940526],[0,0.5384693101056831,0.906179845938664],[0.2386191860831969,0.6612093864662645,0.932469514203152],[0,0.4058451513773972,0.7415311855993945,0.9491079123427585],[0.1834346424956498,0.525532409916329,0.7966664774136267,0.9602898564975363],[0,0.3242534234038089,0.6133714327005904,0.8360311073266358,0.9681602395076261],[0.14887433898163122,0.4333953941292472,0.6794095682990244,0.8650633666889845,0.9739065285171717],[0,0.26954315595234496,0.5190961292068118,0.7301520055740494,0.8870625997680953,0.978228658146057],[0.1252334085114689,0.3678314989981802,0.5873179542866175,0.7699026741943047,0.9041172563704749,0.9815606342467192],[0,0.2304583159551348,0.44849275103644687,0.6423493394403402,0.8015780907333099,0.9175983992229779,0.9841830547185881],[0.10805494870734367,0.31911236892788974,0.5152486363581541,0.6872929048116855,0.827201315069765,0.9284348836635735,0.9862838086968123],[0,0.20119409399743451,0.3941513470775634,0.5709721726085388,0.7244177313601701,0.8482065834104272,0.937273392400706,0.9879925180204854],[0.09501250983763744,0.2816035507792589,0.45801677765722737,0.6178762444026438,0.755404408355003,0.8656312023878318,0.9445750230732326,0.9894009349916499]],Q=[[1],[0.8888888888888888,0.5555555555555556],[0.6521451548625461,0.34785484513745385],[0.5688888888888889,0.47862867049936647,0.23692688505618908],[0.46791393457269104,0.3607615730481386,0.17132449237917036],[0.4179591836734694,0.3818300505051189,0.27970539148927664,0.1294849661688697],[0.362683783378362,0.31370664587788727,0.22238103445337448,0.10122853629037626],[0.3302393550012598,0.31234707704000286,0.26061069640293544,0.1806481606948574,0.08127438836157441],[0.29552422471475287,0.26926671930999635,0.21908636251598204,0.1494513491505806,0.06667134430868814],[0.2729250867779006,0.26280454451024665,0.23319376459199048,0.18629021092773426,0.1255803694649046,0.05566856711617366],[0.24914704581340277,0.2334925365383548,0.20316742672306592,0.16007832854334622,0.10693932599531843,0.04717533638651183],[0.2325515532308739,0.22628318026289723,0.2078160475368885,0.17814598076194574,0.13887351021978725,0.09212149983772845,0.04048400476531588],[0.2152638534631578,0.2051984637212956,0.18553839747793782,0.15720316715819355,0.12151857068790319,0.08015808715976021,0.03511946033175186],[0.2025782419255613,0.19843148532711158,0.1861610000155622,0.16626920581699392,0.13957067792615432,0.10715922046717194,0.07036604748810812,0.03075324199611727],[0.1894506104550685,0.18260341504492358,0.16915651939500254,0.14959598881657674,0.12462897125553388,0.09515851168249279,0.062253523938647894,0.027152459411754096]],J=Math.abs,U=Math.sqrt,Z=Math.pow,K=Math.log2||function(V){return Math.log(V)*Math.LOG2E},H=0.000000000001,W=0.000000000000000112;function Y(V,O,X){return V<O?O:V>X?X:V}function F(V,O,X){function N(C){var P=C*134217729,j=C-P,k=j+P,x=C-k;return[k,x]}var L=O*O-V*X,B=O*O+V*X;if(J(L)*3<B){var E=N(V),R=N(O),T=N(X),q=O*O,_=R[0]*R[0]-q+2*R[0]*R[1]+R[1]*R[1],z=V*X,G=E[0]*T[0]-z+E[0]*T[1]+E[1]*T[0]+E[1]*T[1];L=q-z+(_-G)}return L}function A(){var V=Math.max.apply(Math,arguments);return V&&(V<0.00000001||V>1e8)?Z(2,-Math.round(K(V))):0}return{EPSILON:H,MACHINE_EPSILON:W,CURVETIME_EPSILON:0.00000001,GEOMETRIC_EPSILON:0.0000001,TRIGONOMETRIC_EPSILON:0.00000001,ANGULAR_EPSILON:0.00001,KAPPA:4*(U(2)-1)/3,isZero:function(V){return V>=-H&&V<=H},isMachineZero:function(V){return V>=-W&&V<=W},clamp:Y,integrate:function(V,O,X,N){var L=$[N-2],B=Q[N-2],E=(X-O)*0.5,R=E+O,T=0,q=N+1>>1,_=N&1?B[T++]*V(R):0;while(T<q){var z=E*L[T];_+=B[T++]*(V(R+z)+V(R-z))}return E*_},findRoot:function(V,O,X,N,L,B,E){for(var R=0;R<B;R++){var T=V(X),q=T/O(X),_=X-q;if(J(q)<E){X=_;break}if(T>0)L=X,X=_<=N?(N+L)*0.5:_;else N=X,X=_>=L?(N+L)*0.5:_}return Y(X,N,L)},solveQuadratic:function(V,O,X,N,L,B){var E,R=Infinity;if(J(V)<H){if(J(O)<H)return J(X)<H?-1:0;E=-X/O}else{O*=-0.5;var T=F(V,O,X);if(T&&J(T)<W){var q=A(J(V),J(O),J(X));if(q)V*=q,O*=q,X*=q,T=F(V,O,X)}if(T>=-W){var _=T<0?0:U(T),z=O+(O<0?-_:_);if(z===0)E=X/V,R=-E;else E=z/V,R=X/z}}var G=0,C=L==null,P=L-H,j=B+H;if(isFinite(E)&&(C||E>P&&E<j))N[G++]=C?E:Y(E,L,B);if(R!==E&&isFinite(R)&&(C||R>P&&R<j))N[G++]=C?R:Y(R,L,B);return G},solveCubic:function(V,O,X,N,L,B,E){var R=A(J(V),J(O),J(X),J(N)),T,q,_,z,G;if(R)V*=R,O*=R,X*=R,N*=R;function C(v){T=v;var m=V*T;q=m+O,_=q*T+X,z=(m+q)*T+_,G=_*T+N}if(J(V)<H)V=O,q=X,_=N,T=Infinity;else if(J(N)<H)q=O,_=X,T=0;else{C(-(O/V)/3);var P=G/V,j=Z(J(P),0.3333333333333333),k=P<0?-1:1,x=-z/V,b=x>0?1.324717957244746*Math.max(j,U(x)):j,f=T-k*b;if(f!==T){do C(f),f=z===0?T:T-G/z/(1+W);while(k*f>k*T);if(J(V)*T*T>J(N/T))_=-N/T,q=(_-X)/T}}var h=Z0.solveQuadratic(V,q,_,L,B,E),u=B==null;if(isFinite(T)&&(h===0||h>0&&T!==L[0]&&T!==L[1])&&(u||T>B-H&&T<E+H))L[h++]=u?T:Y(T,B,E);return h}}},n0={_id:1,_pools:{},get:function($){if($){var Q=this._pools[$];if(!Q)Q=this._pools[$]={_id:1};return Q._id++}else return this._id++}},y=S.extend({_class:"Point",_readIndex:!0,initialize:function $(Q,J){var U=typeof Q,Z=this.__read,K=0;if(U==="number"){var H=typeof J==="number";if(this._set(Q,H?J:Q),Z)K=H?2:1}else if(U==="undefined"||Q===null){if(this._set(0,0),Z)K=Q===null?1:0}else{var W=U==="string"?Q.split(/[\s,]+/)||[]:Q;if(K=1,Array.isArray(W))this._set(+W[0],+(W.length>1?W[1]:W[0]));else if("x"in W)this._set(W.x||0,W.y||0);else if("width"in W)this._set(W.width||0,W.height||0);else if("angle"in W)this._set(W.length||0,0),this.setAngle(W.angle||0);else this._set(0,0),K=0}if(Z)this.__read=K;return this},set:"#initialize",_set:function($,Q){return this.x=$,this.y=Q,this},equals:function($){return this===$||$&&(this.x===$.x&&this.y===$.y||Array.isArray($)&&this.x===$[0]&&this.y===$[1])||!1},clone:function(){return new y(this.x,this.y)},toString:function(){var $=D0.instance;return"{ x: "+$.number(this.x)+", y: "+$.number(this.y)+" }"},_serialize:function($){var Q=$.formatter;return[Q.number(this.x),Q.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function($){if(this.isZero()){var Q=this._angle||0;this._set(Math.cos(Q)*$,Math.sin(Q)*$)}else{var J=$/this.getLength();if(Z0.isZero(J))this.getAngle();this._set(this.x*J,this.y*J)}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180/Math.PI},setAngle:function($){this.setAngleInRadians.call(this,$*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(!arguments.length)return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x);else{var $=y.read(arguments),Q=this.getLength()*$.getLength();if(Z0.isZero(Q))return NaN;else{var J=this.dot($)/Q;return Math.acos(J<-1?-1:J>1?1:J)}}},setAngleInRadians:function($){if(this._angle=$,!this.isZero()){var Q=this.getLength();this._set(Math.cos($)*Q,Math.sin($)*Q)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var $=y.read(arguments);return Math.atan2(this.cross($),this.dot($))*180/Math.PI},getDistance:function(){var $=arguments,Q=y.read($),J=Q.x-this.x,U=Q.y-this.y,Z=J*J+U*U,K=S.read($);return K?Z:Math.sqrt(Z)},normalize:function($){if($===I)$=1;var Q=this.getLength(),J=Q!==0?$/Q:0,U=new y(this.x*J,this.y*J);if(J>=0)U._angle=this._angle;return U},rotate:function($,Q){if($===0)return this.clone();$=$*Math.PI/180;var J=Q?this.subtract(Q):this,U=Math.sin($),Z=Math.cos($);return J=new y(J.x*Z-J.y*U,J.x*U+J.y*Z),Q?J.add(Q):J},transform:function($){return $?$._transformPoint(this):this},add:function(){var $=y.read(arguments);return new y(this.x+$.x,this.y+$.y)},subtract:function(){var $=y.read(arguments);return new y(this.x-$.x,this.y-$.y)},multiply:function(){var $=y.read(arguments);return new y(this.x*$.x,this.y*$.y)},divide:function(){var $=y.read(arguments);return new y(this.x/$.x,this.y/$.y)},modulo:function(){var $=y.read(arguments);return new y(this.x%$.x,this.y%$.y)},negate:function(){return new y(-this.x,-this.y)},isInside:function(){return t.read(arguments).contains(this)},isClose:function(){var $=arguments,Q=y.read($),J=S.read($);return this.getDistance(Q)<=J},isCollinear:function(){var $=y.read(arguments);return y.isCollinear(this.x,this.y,$.x,$.y)},isColinear:"#isCollinear",isOrthogonal:function(){var $=y.read(arguments);return y.isOrthogonal(this.x,this.y,$.x,$.y)},isZero:function(){var $=Z0.isZero;return $(this.x)&&$(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function($){return this.x*($>1&&$<4?-1:1)>=0&&this.y*($>2?-1:1)>=0},dot:function(){var $=y.read(arguments);return this.x*$.x+this.y*$.y},cross:function(){var $=y.read(arguments);return this.x*$.y-this.y*$.x},project:function(){var $=y.read(arguments),Q=$.isZero()?0:this.dot($)/$.dot($);return new y($.x*Q,$.y*Q)},statics:{min:function(){var $=arguments,Q=y.read($),J=y.read($);return new y(Math.min(Q.x,J.x),Math.min(Q.y,J.y))},max:function(){var $=arguments,Q=y.read($),J=y.read($);return new y(Math.max(Q.x,J.x),Math.max(Q.y,J.y))},random:function(){return new y(Math.random(),Math.random())},isCollinear:function($,Q,J,U){return Math.abs($*U-Q*J)<=Math.sqrt(($*$+Q*Q)*(J*J+U*U))*0.00000001},isOrthogonal:function($,Q,J,U){return Math.abs($*J+Q*U)<=Math.sqrt(($*$+Q*Q)*(J*J+U*U))*0.00000001}}},S.each(["round","ceil","floor","abs"],function($){var Q=Math[$];this[$]=function(){return new y(Q(this.x),Q(this.y))}},{})),h0=y.extend({initialize:function $(Q,J,U,Z){this._x=Q,this._y=J,this._owner=U,this._setter=Z},_set:function($,Q,J){if(this._x=$,this._y=Q,!J)this._owner[this._setter](this);return this},getX:function(){return this._x},setX:function($){this._x=$,this._owner[this._setter](this)},getY:function(){return this._y},setY:function($){this._y=$,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function($){this._owner._changeSelection(this._getSelection(),$)},_getSelection:function(){return this._setter==="setPosition"?4:0}}),s=S.extend({_class:"Size",_readIndex:!0,initialize:function $(Q,J){var U=typeof Q,Z=this.__read,K=0;if(U==="number"){var H=typeof J==="number";if(this._set(Q,H?J:Q),Z)K=H?2:1}else if(U==="undefined"||Q===null){if(this._set(0,0),Z)K=Q===null?1:0}else{var W=U==="string"?Q.split(/[\s,]+/)||[]:Q;if(K=1,Array.isArray(W))this._set(+W[0],+(W.length>1?W[1]:W[0]));else if("width"in W)this._set(W.width||0,W.height||0);else if("x"in W)this._set(W.x||0,W.y||0);else this._set(0,0),K=0}if(Z)this.__read=K;return this},set:"#initialize",_set:function($,Q){return this.width=$,this.height=Q,this},equals:function($){return $===this||$&&(this.width===$.width&&this.height===$.height||Array.isArray($)&&this.width===$[0]&&this.height===$[1])||!1},clone:function(){return new s(this.width,this.height)},toString:function(){var $=D0.instance;return"{ width: "+$.number(this.width)+", height: "+$.number(this.height)+" }"},_serialize:function($){var Q=$.formatter;return[Q.number(this.width),Q.number(this.height)]},add:function(){var $=s.read(arguments);return new s(this.width+$.width,this.height+$.height)},subtract:function(){var $=s.read(arguments);return new s(this.width-$.width,this.height-$.height)},multiply:function(){var $=s.read(arguments);return new s(this.width*$.width,this.height*$.height)},divide:function(){var $=s.read(arguments);return new s(this.width/$.width,this.height/$.height)},modulo:function(){var $=s.read(arguments);return new s(this.width%$.width,this.height%$.height)},negate:function(){return new s(-this.width,-this.height)},isZero:function(){var $=Z0.isZero;return $(this.width)&&$(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function($,Q){return new s(Math.min($.width,Q.width),Math.min($.height,Q.height))},max:function($,Q){return new s(Math.max($.width,Q.width),Math.max($.height,Q.height))},random:function(){return new s(Math.random(),Math.random())}}},S.each(["round","ceil","floor","abs"],function($){var Q=Math[$];this[$]=function(){return new s(Q(this.width),Q(this.height))}},{})),i0=s.extend({initialize:function $(Q,J,U,Z){this._width=Q,this._height=J,this._owner=U,this._setter=Z},_set:function($,Q,J){if(this._width=$,this._height=Q,!J)this._owner[this._setter](this);return this},getWidth:function(){return this._width},setWidth:function($){this._width=$,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function($){this._height=$,this._owner[this._setter](this)}}),t=S.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function $(Q,J,U,Z){var K=arguments,H=typeof Q,W;if(H==="number")this._set(Q,J,U,Z),W=4;else if(H==="undefined"||Q===null)this._set(0,0,0,0),W=Q===null?1:0;else if(K.length===1){if(Array.isArray(Q))this._set.apply(this,Q),W=1;else if(Q.x!==I||Q.width!==I)this._set(Q.x||0,Q.y||0,Q.width||0,Q.height||0),W=1;else if(Q.from===I&&Q.to===I){if(this._set(0,0,0,0),S.readSupported(K,this))W=1}}if(W===I){var Y=y.readNamed(K,"from"),F=S.peek(K),A=Y.x,V=Y.y,O,X;if(F&&F.x!==I||S.hasNamed(K,"to")){var N=y.readNamed(K,"to");if(O=N.x-A,X=N.y-V,O<0)A=N.x,O=-O;if(X<0)V=N.y,X=-X}else{var L=s.read(K);O=L.width,X=L.height}this._set(A,V,O,X),W=K.__index}var B=K.__filtered;if(B)this.__filtered=B;if(this.__read)this.__read=W;return this},set:"#initialize",_set:function($,Q,J,U){return this.x=$,this.y=Q,this.width=J,this.height=U,this},clone:function(){return new t(this.x,this.y,this.width,this.height)},equals:function($){var Q=S.isPlainValue($)?t.read(arguments):$;return Q===this||Q&&this.x===Q.x&&this.y===Q.y&&this.width===Q.width&&this.height===Q.height||!1},toString:function(){var $=D0.instance;return"{ x: "+$.number(this.x)+", y: "+$.number(this.y)+", width: "+$.number(this.width)+", height: "+$.number(this.height)+" }"},_serialize:function($){var Q=$.formatter;return[Q.number(this.x),Q.number(this.y),Q.number(this.width),Q.number(this.height)]},getPoint:function($){var Q=$?y:h0;return new Q(this.x,this.y,this,"setPoint")},setPoint:function(){var $=y.read(arguments);this.x=$.x,this.y=$.y},getSize:function($){var Q=$?s:i0;return new Q(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var $=s.read(arguments),Q=this._sx,J=this._sy,U=$.width,Z=$.height;if(Q)this.x+=(this.width-U)*Q;if(J)this.y+=(this.height-Z)*J;this.width=U,this.height=Z,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function($){if(!this._fw){var Q=$-this.x;this.width-=this._sx===0.5?Q*2:Q}this.x=$,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function($){if(!this._fh){var Q=$-this.y;this.height-=this._sy===0.5?Q*2:Q}this.y=$,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function($){if(!this._fw){var Q=$-this.x;this.width=this._sx===0.5?Q*2:Q}this.x=$-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function($){if(!this._fh){var Q=$-this.y;this.height=this._sy===0.5?Q*2:Q}this.y=$-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function($){if(this._fw||this._sx===0.5)this.x=$-this.width/2;else{if(this._sx)this.x+=($-this.x)*2*this._sx;this.width=($-this.x)*2}this._sx=0.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function($){if(this._fh||this._sy===0.5)this.y=$-this.height/2;else{if(this._sy)this.y+=($-this.y)*2*this._sy;this.height=($-this.y)*2}this._sy=0.5,this._fh=0},getCenter:function($){var Q=$?y:h0;return new Q(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var $=y.read(arguments);return this.setCenterX($.x),this.setCenterY($.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return this.width===0||this.height===0},contains:function($){return $&&$.width!==I||(Array.isArray($)?$:arguments).length===4?this._containsRectangle(t.read(arguments)):this._containsPoint(y.read(arguments))},_containsPoint:function($){var{x:Q,y:J}=$;return Q>=this.x&&J>=this.y&&Q<=this.x+this.width&&J<=this.y+this.height},_containsRectangle:function($){var{x:Q,y:J}=$;return Q>=this.x&&J>=this.y&&Q+$.width<=this.x+this.width&&J+$.height<=this.y+this.height},intersects:function(){var $=t.read(arguments),Q=S.read(arguments)||0;return $.x+$.width>this.x-Q&&$.y+$.height>this.y-Q&&$.x<this.x+this.width+Q&&$.y<this.y+this.height+Q},intersect:function(){var $=t.read(arguments),Q=Math.max(this.x,$.x),J=Math.max(this.y,$.y),U=Math.min(this.x+this.width,$.x+$.width),Z=Math.min(this.y+this.height,$.y+$.height);return new t(Q,J,U-Q,Z-J)},unite:function(){var $=t.read(arguments),Q=Math.min(this.x,$.x),J=Math.min(this.y,$.y),U=Math.max(this.x+this.width,$.x+$.width),Z=Math.max(this.y+this.height,$.y+$.height);return new t(Q,J,U-Q,Z-J)},include:function(){var $=y.read(arguments),Q=Math.min(this.x,$.x),J=Math.min(this.y,$.y),U=Math.max(this.x+this.width,$.x),Z=Math.max(this.y+this.height,$.y);return new t(Q,J,U-Q,Z-J)},expand:function(){var $=s.read(arguments),Q=$.width,J=$.height;return new t(this.x-Q/2,this.y-J/2,this.width+Q,this.height+J)},scale:function($,Q){return this.expand(this.width*$-this.width,this.height*(Q===I?$:Q)-this.height)}},S.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function($,Q){var J=$.join(""),U=/^[RL]/.test(J);if(Q>=4)$[1]+=U?"Y":"X";var Z=$[U?0:1],K=$[U?1:0],H="get"+Z,W="get"+K,Y="set"+Z,F="set"+K,A="get"+J,V="set"+J;this[A]=function(O){var X=O?y:h0;return new X(this[H](),this[W](),this,V)},this[V]=function(){var O=y.read(arguments);this[Y](O.x),this[F](O.y)}},{beans:!0})),x8=t.extend({initialize:function $(Q,J,U,Z,K,H){this._set(Q,J,U,Z,!0),this._owner=K,this._setter=H},_set:function($,Q,J,U,Z){if(this._x=$,this._y=Q,this._width=J,this._height=U,!Z)this._owner[this._setter](this);return this}},new function(){var $=t.prototype;return S.each(["x","y","width","height"],function(Q){var J=S.capitalize(Q),U="_"+Q;this["get"+J]=function(){return this[U]},this["set"+J]=function(Z){if(this[U]=Z,!this._dontNotify)this._owner[this._setter](this)}},S.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(Q){var J="set"+Q;this[J]=function(){this._dontNotify=!0,$[J].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(Q){var J=this._owner;if(J._changeSelection)J._changeSelection(2,Q)}}))}),V0=S.extend({_class:"Matrix",initialize:function $(Q,J){var U=arguments,Z=U.length,K=!0;if(Z>=6)this._set.apply(this,U);else if(Z===1||Z===2)if(Q instanceof $)this._set(Q._a,Q._b,Q._c,Q._d,Q._tx,Q._ty,J);else if(Array.isArray(Q))this._set.apply(this,J?Q.concat([J]):Q);else K=!1;else if(!Z)this.reset();else K=!1;if(!K)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function($,Q,J,U,Z,K,H){if(this._a=$,this._b=Q,this._c=J,this._d=U,this._tx=Z,this._ty=K,!H)this._changed();return this},_serialize:function($,Q){return S.serialize(this.getValues(),$,!0,Q)},_changed:function(){var $=this._owner;if($)if($._applyMatrix)$.transform(null,!0);else $._changed(25)},clone:function(){return new V0(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function($){return $===this||$&&this._a===$._a&&this._b===$._b&&this._c===$._c&&this._d===$._d&&this._tx===$._tx&&this._ty===$._ty},toString:function(){var $=D0.instance;return"[["+[$.number(this._a),$.number(this._c),$.number(this._tx)].join(", ")+"], ["+[$.number(this._b),$.number(this._d),$.number(this._ty)].join(", ")+"]]"},reset:function($){if(this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,!$)this._changed();return this},apply:function($,Q){var J=this._owner;if(J)return J.transform(null,S.pick($,!0),Q),this.isIdentity();return!1},translate:function(){var $=y.read(arguments),Q=$.x,J=$.y;return this._tx+=Q*this._a+J*this._c,this._ty+=Q*this._b+J*this._d,this._changed(),this},scale:function(){var $=arguments,Q=y.read($),J=y.read($,0,{readNull:!0});if(J)this.translate(J);if(this._a*=Q.x,this._b*=Q.x,this._c*=Q.y,this._d*=Q.y,J)this.translate(J.negate());return this._changed(),this},rotate:function($){$*=Math.PI/180;var Q=y.read(arguments,1),J=Q.x,U=Q.y,Z=Math.cos($),K=Math.sin($),H=J-J*Z+U*K,W=U-J*K-U*Z,Y=this._a,F=this._b,A=this._c,V=this._d;return this._a=Z*Y+K*A,this._b=Z*F+K*V,this._c=-K*Y+Z*A,this._d=-K*F+Z*V,this._tx+=H*Y+W*A,this._ty+=H*F+W*V,this._changed(),this},shear:function(){var $=arguments,Q=y.read($),J=y.read($,0,{readNull:!0});if(J)this.translate(J);var U=this._a,Z=this._b;if(this._a+=Q.y*this._c,this._b+=Q.y*this._d,this._c+=Q.x*U,this._d+=Q.x*Z,J)this.translate(J.negate());return this._changed(),this},skew:function(){var $=arguments,Q=y.read($),J=y.read($,0,{readNull:!0}),U=Math.PI/180,Z=new y(Math.tan(Q.x*U),Math.tan(Q.y*U));return this.shear(Z,J)},append:function($,Q){if($){var J=this._a,U=this._b,Z=this._c,K=this._d,H=$._a,W=$._c,Y=$._b,F=$._d,A=$._tx,V=$._ty;if(this._a=H*J+Y*Z,this._c=W*J+F*Z,this._b=H*U+Y*K,this._d=W*U+F*K,this._tx+=A*J+V*Z,this._ty+=A*U+V*K,!Q)this._changed()}return this},prepend:function($,Q){if($){var J=this._a,U=this._b,Z=this._c,K=this._d,H=this._tx,W=this._ty,Y=$._a,F=$._c,A=$._b,V=$._d,O=$._tx,X=$._ty;if(this._a=Y*J+F*U,this._c=Y*Z+F*K,this._b=A*J+V*U,this._d=A*Z+V*K,this._tx=Y*H+F*W+O,this._ty=A*H+V*W+X,!Q)this._changed()}return this},appended:function($){return this.clone().append($)},prepended:function($){return this.clone().prepend($)},invert:function(){var $=this._a,Q=this._b,J=this._c,U=this._d,Z=this._tx,K=this._ty,H=$*U-Q*J,W=null;if(H&&!isNaN(H)&&isFinite(Z)&&isFinite(K))this._a=U/H,this._b=-Q/H,this._c=-J/H,this._d=$/H,this._tx=(J*K-U*Z)/H,this._ty=(Q*Z-$*K)/H,W=this;return W},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new V0(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0},isInvertible:function(){var $=this._a*this._d-this._c*this._b;return $&&!isNaN($)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function($,Q,J){return arguments.length<3?this._transformPoint(y.read(arguments)):this._transformCoordinates($,Q,J)},_transformPoint:function($,Q,J){var{x:U,y:Z}=$;if(!Q)Q=new y;return Q._set(U*this._a+Z*this._c+this._tx,U*this._b+Z*this._d+this._ty,J)},_transformCoordinates:function($,Q,J){for(var U=0,Z=2*J;U<Z;U+=2){var K=$[U],H=$[U+1];Q[U]=K*this._a+H*this._c+this._tx,Q[U+1]=K*this._b+H*this._d+this._ty}return Q},_transformCorners:function($){var{x:Q,y:J}=$,U=Q+$.width,Z=J+$.height,K=[Q,J,U,J,U,Z,Q,Z];return this._transformCoordinates(K,K,4)},_transformBounds:function($,Q,J){var U=this._transformCorners($),Z=U.slice(0,2),K=Z.slice();for(var H=2;H<8;H++){var W=U[H],Y=H&1;if(W<Z[Y])Z[Y]=W;else if(W>K[Y])K[Y]=W}if(!Q)Q=new t;return Q._set(Z[0],Z[1],K[0]-Z[0],K[1]-Z[1],J)},inverseTransform:function(){return this._inverseTransform(y.read(arguments))},_inverseTransform:function($,Q,J){var U=this._a,Z=this._b,K=this._c,H=this._d,W=this._tx,Y=this._ty,F=U*H-Z*K,A=null;if(F&&!isNaN(F)&&isFinite(W)&&isFinite(Y)){var V=$.x-this._tx,O=$.y-this._ty;if(!Q)Q=new y;A=Q._set((V*H-O*K)/F,(O*U-V*Z)/F,J)}return A},decompose:function(){var $=this._a,Q=this._b,J=this._c,U=this._d,Z=$*U-Q*J,K=Math.sqrt,H=Math.atan2,W=180/Math.PI,Y,F,A;if($!==0||Q!==0){var V=K($*$+Q*Q);Y=Math.acos($/V)*(Q>0?1:-1),F=[V,Z/V],A=[H($*J+Q*U,V*V),0]}else if(J!==0||U!==0){var O=K(J*J+U*U);Y=Math.asin(J/O)*(U>0?1:-1),F=[Z/O,O],A=[0,H($*J+Q*U,O*O)]}else Y=0,A=F=[0,0];return{translation:this.getTranslation(),rotation:Y*W,scaling:new y(F),skewing:new y(A[0]*W,A[1]*W)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new y(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function($){if(!this.isIdentity())$.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},S.each(["a","b","c","d","tx","ty"],function($){var Q=S.capitalize($),J="_"+$;this["get"+Q]=function(){return this[J]},this["set"+Q]=function(U){this[J]=U,this._changed()}},{})),G0=S.extend({_class:"Line",initialize:function $(Q,J,U,Z,K){var H=!1;if(arguments.length>=4)this._px=Q,this._py=J,this._vx=U,this._vy=Z,H=K;else this._px=Q.x,this._py=Q.y,this._vx=J.x,this._vy=J.y,H=U;if(!H)this._vx-=this._px,this._vy-=this._py},getPoint:function(){return new y(this._px,this._py)},getVector:function(){return new y(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function($,Q){return G0.intersect(this._px,this._py,this._vx,this._vy,$._px,$._py,$._vx,$._vy,!0,Q)},getSide:function($,Q){return G0.getSide(this._px,this._py,this._vx,this._vy,$.x,$.y,!0,Q)},getDistance:function($){return Math.abs(this.getSignedDistance($))},getSignedDistance:function($){return G0.getSignedDistance(this._px,this._py,this._vx,this._vy,$.x,$.y,!0)},isCollinear:function($){return y.isCollinear(this._vx,this._vy,$._vx,$._vy)},isOrthogonal:function($){return y.isOrthogonal(this._vx,this._vy,$._vx,$._vy)},statics:{intersect:function($,Q,J,U,Z,K,H,W,Y,F){if(!Y)J-=$,U-=Q,H-=Z,W-=K;var A=J*W-U*H;if(!Z0.isMachineZero(A)){var V=$-Z,O=Q-K,X=(H*O-W*V)/A,N=(J*O-U*V)/A,L=0.000000000001,B=-L,E=1+L;if(F||B<X&&X<E&&B<N&&N<E){if(!F)X=X<=0?0:X>=1?1:X;return new y($+X*J,Q+X*U)}}},getSide:function($,Q,J,U,Z,K,H,W){if(!H)J-=$,U-=Q;var Y=Z-$,F=K-Q,A=Y*U-F*J;if(!W&&Z0.isMachineZero(A)){if(A=(Y*J+Y*J)/(J*J+U*U),A>=0&&A<=1)A=0}return A<0?-1:A>0?1:0},getSignedDistance:function($,Q,J,U,Z,K,H){if(!H)J-=$,U-=Q;return J===0?U>0?Z-$:$-Z:U===0?J<0?K-Q:Q-K:((Z-$)*U-(K-Q)*J)/(U>J?U*Math.sqrt(1+J*J/(U*U)):J*Math.sqrt(1+U*U/(J*J)))},getDistance:function($,Q,J,U,Z,K,H){return Math.abs(G0.getSignedDistance($,Q,J,U,Z,K,H))}}}),J8=T0.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function $(Q){T0.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new q8(null,null,this),this._view=R0.create(this,Q||L0.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function($,Q){return S.serialize(this._children,$,!0,Q)},_changed:function($,Q){if($&1){var J=this._view;if(J){if(J._needsUpdate=!0,!J._requested&&J._autoUpdate)J.requestUpdate()}}var U=this._changes;if(U&&Q){var Z=this._changesById,K=Q._id,H=Z[K];if(H)H.flags|=$;else U.push(Z[K]={item:Q,flags:$})}},clear:function(){var $=this._children;for(var Q=$.length-1;Q>=0;Q--)$[Q].remove()},isEmpty:function(){return!this._children.length},remove:function $(){if(!$.base.call(this))return!1;if(this._view)this._view.remove();return!0},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function($){this._currentStyle.set($)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new t0({project:this,insert:!0})},getSymbolDefinitions:function(){var $=[],Q={};return this.getItems({class:O8,match:function(J){var U=J._definition,Z=U._id;if(!Q[Z])Q[Z]=!0,$.push(U);return!1}}),$},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var $=this._selectionItems,Q=[];for(var J in $){var U=$[J],Z=U._selection;if(Z&1&&U.isInserted())Q.push(U);else if(!Z)this._updateSelection(U)}return Q},_updateSelection:function($){var Q=$._id,J=this._selectionItems;if($._selection){if(J[Q]!==$)this._selectionCount++,J[Q]=$}else if(J[Q]===$)this._selectionCount--,delete J[Q]},selectAll:function(){var $=this._children;for(var Q=0,J=$.length;Q<J;Q++)$[Q].setFullySelected(!0)},deselectAll:function(){var $=this._selectionItems;for(var Q in $)$[Q].setFullySelected(!1)},addLayer:function($){return this.insertLayer(I,$)},insertLayer:function($,Q){if(Q instanceof t0){Q._remove(!1,!0),S.splice(this._children,[Q],$,0),Q._setProject(this,!0);var J=Q._name;if(J)Q.setName(J);if(this._changes)Q._changed(5);if(!this._activeLayer)this._activeLayer=Q}else Q=null;return Q},_insertItem:function($,Q,J){if(Q=this.insertLayer($,Q)||(this._activeLayer||this._insertItem(I,new t0(Q0.NO_INSERT),!0)).insertChild($,Q),J&&Q.activate)Q.activate();return Q},getItems:function($){return Q0._getItems(this,$)},getItem:function($){return Q0._getItems(this,$,null,null,!0)[0]||null},importJSON:function($){this.activate();var Q=this._activeLayer;return S.importJSON($,Q&&Q.isEmpty()&&Q)},removeOn:function($){var Q=this._removeSets;if(Q){if($==="mouseup")Q.mousedrag=null;var J=Q[$];if(J){for(var U in J){var Z=J[U];for(var K in Q){var H=Q[K];if(H&&H!=J)delete H[Z._id]}Z.remove()}Q[$]=null}}},draw:function($,Q,J){this._updateVersion++,$.save(),Q.applyToContext($);var U=this._children,Z=new S({offset:new y(0,0),pixelRatio:J,viewMatrix:Q.isIdentity()?null:Q,matrices:[new V0],updateMatrix:!0});for(var K=0,H=U.length;K<H;K++)U[K].draw($,Z);if($.restore(),this._selectionCount>0){$.save(),$.strokeWidth=1;var W=this._selectionItems,Y=this._scope.settings.handleSize,F=this._updateVersion;for(var A in W)W[A]._drawSelection($,Q,Y,W,F);$.restore()}}}),Q0=S.extend(a,{statics:{extend:function $(Q){if(Q._serializeFields)Q._serializeFields=S.set({},this.prototype._serializeFields,Q._serializeFields);return $.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new V0,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var $=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return S.each($,function(Q){this._events[Q]={install:function(J){this.getView()._countItemEvent(J,1)},uninstall:function(J){this.getView()._countItemEvent(J,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:$}})},{initialize:function $(){},_initialize:function($,Q){var J=$&&S.isPlainObject($),U=J&&$.internal===!0,Z=this._matrix=new V0,K=J&&$.project||W0.project,H=W0.settings;if(this._id=U?null:n0.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&H.applyMatrix,Q)Z.translate(Q);if(Z._owner=this,this._style=new q8(K._currentStyle,this,K),U||J&&$.insert==!1||!H.insertItems&&!(J&&$.insert==!0))this._setProject(K);else(J&&$.parent||K)._insertItem(I,this,!0);if(J&&$!==Q0.NO_INSERT&&$!==Q0.INSERT)this.set($,{internal:!0,insert:!0,project:!0,parent:!0});return J},_serialize:function($,Q){var J={},U=this;function Z(K){for(var H in K){var W=U[H];if(!S.equals(W,H==="leading"?K.fontSize*1.2:K[H]))J[H]=S.serialize(W,$,H!=="data",Q)}}if(Z(this._serializeFields),!(this instanceof v0))Z(this._style._defaults);return[this._class,J]},_changed:function($){var Q=this._symbol,J=this._parent||Q,U=this._project;if($&8)this._bounds=this._position=this._decomposed=I;if($&16)this._globalMatrix=I;if(J&&$&72)Q0._clearBoundsCache(J);if($&2)Q0._clearBoundsCache(this);if(U)U._changed($,this);if(Q)Q._changed($)},getId:function(){return this._id},getName:function(){return this._name},setName:function($){if(this._name)this._removeNamed();if($===+$+"")throw new Error("Names consisting only of numbers are not supported.");var Q=this._getOwner();if($&&Q){var{_children:J,_namedChildren:U}=Q;if((U[$]=U[$]||[]).push(this),!($ in J))J[$]=this}this._name=$||I,this._changed(256)},getStyle:function(){return this._style},setStyle:function($){this.getStyle().set($)}},S.each(["locked","visible","blendMode","opacity","guide"],function($){var Q=S.capitalize($),J="_"+$,U={locked:256,visible:265};this["get"+Q]=function(){return this[J]},this["set"+Q]=function(Z){if(Z!=this[J])this[J]=Z,this._changed(U[$]||257)}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function($){if($!==this._selection){this._selection=$;var Q=this._project;if(Q)Q._updateSelection(this),this._changed(257)}},_changeSelection:function($,Q){var J=this._selection;this.setSelection(Q?J|$:J&~$)},isSelected:function(){if(this._selectChildren){var $=this._children;for(var Q=0,J=$.length;Q<J;Q++)if($[Q].isSelected())return!0}return!!(this._selection&1)},setSelected:function($){if(this._selectChildren){var Q=this._children;for(var J=0,U=Q.length;J<U;J++)Q[J].setSelected($)}this._changeSelection(1,$)},isFullySelected:function(){var $=this._children,Q=!!(this._selection&1);if($&&Q){for(var J=0,U=$.length;J<U;J++)if(!$[J].isFullySelected())return!1;return!0}return Q},setFullySelected:function($){var Q=this._children;if(Q)for(var J=0,U=Q.length;J<U;J++)Q[J].setFullySelected($);this._changeSelection(1,$)},isClipMask:function(){return this._clipMask},setClipMask:function($){if(this._clipMask!=($=!!$)){if(this._clipMask=$,$)this.setFillColor(null),this.setStrokeColor(null);if(this._changed(257),this._parent)this._parent._changed(2048)}},getData:function(){if(!this._data)this._data={};return this._data},setData:function($){this._data=$},getPosition:function($){var Q=$?y:h0,J=this._position||(this._position=this._getPositionFromBounds());return new Q(J.x,J.y,this,"setPosition")},setPosition:function(){this.translate(y.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function($){return this._pivot?this._matrix._transformPoint(this._pivot):($||this.getBounds()).getCenter(!0)},getPivot:function(){var $=this._pivot;return $?new h0($.x,$.y,this,"setPivot"):null},setPivot:function(){this._pivot=y.read(arguments,0,{clone:!0,readNull:!0}),this._position=I}},S.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function($,Q){this[Q]=function(J){return this.getBounds(J,$)}},{beans:!0,getBounds:function($,Q){var J=Q||$ instanceof V0,U=S.set({},J?Q:$,this._boundsOptions);if(!U.stroke||this.getStrokeScaling())U.cacheItem=this;var Z=this._getCachedBounds(J&&$,U).rect;return!arguments.length?new x8(Z.x,Z.y,Z.width,Z.height,this,"setBounds"):Z},setBounds:function(){var $=t.read(arguments),Q=this.getBounds(),J=this._matrix,U=new V0,Z=$.getCenter();if(U.translate(Z),$.width!=Q.width||$.height!=Q.height){if(!J.isInvertible())J.set(J._backup||new V0().translate(J.getTranslation())),Q=this.getBounds();U.scale(Q.width!==0?$.width/Q.width:0,Q.height!==0?$.height/Q.height:0)}Z=Q.getCenter(),U.translate(-Z.x,-Z.y),this.transform(U)},_getBounds:function($,Q){var J=this._children;if(!J||!J.length)return new t;return Q0._updateBoundsCache(this,Q.cacheItem),Q0._getBounds(J,$,Q)},_getBoundsCacheKey:function($,Q){return[$.stroke?1:0,$.handle?1:0,Q?1:0].join("")},_getCachedBounds:function($,Q,J){$=$&&$._orNullIfIdentity();var U=Q.internal&&!J,Z=Q.cacheItem,K=U?null:this._matrix._orNullIfIdentity(),H=Z&&(!$||$.equals(K))&&this._getBoundsCacheKey(Q,U),W=this._bounds;if(Q0._updateBoundsCache(this._parent||this._symbol,Z),H&&W&&H in W){var Y=W[H];return{rect:Y.rect.clone(),nonscaling:Y.nonscaling}}var F=this._getBounds($||K,Q),A=F.rect||F,V=this._style,O=F.nonscaling||V.hasStroke()&&!V.getStrokeScaling();if(H){if(!W)this._bounds=W={};var Y=W[H]={rect:A.clone(),nonscaling:O,internal:U}}return{rect:A,nonscaling:O}},_getStrokeMatrix:function($,Q){var J=this.getStrokeScaling()?null:Q&&Q.internal?this:this._parent||this._symbol&&this._symbol._item,U=J?J.getViewMatrix().invert():$;return U&&U._shiftless()},statics:{_updateBoundsCache:function($,Q){if($&&Q){var J=Q._id,U=$._boundsCache=$._boundsCache||{ids:{},list:[]};if(!U.ids[J])U.list.push(Q),U.ids[J]=Q}},_clearBoundsCache:function($){var Q=$._boundsCache;if(Q){$._bounds=$._position=$._boundsCache=I;for(var J=0,U=Q.list,Z=U.length;J<Z;J++){var K=U[J];if(K!==$){if(K._bounds=K._position=I,K._boundsCache)Q0._clearBoundsCache(K)}}}},_getBounds:function($,Q,J){var U=Infinity,Z=-U,K=U,H=Z,W=!1;J=J||{};for(var Y=0,F=$.length;Y<F;Y++){var A=$[Y];if(A._visible&&!A.isEmpty(!0)){var V=A._getCachedBounds(Q&&Q.appended(A._matrix),J,!0),O=V.rect;if(U=Math.min(O.x,U),K=Math.min(O.y,K),Z=Math.max(O.x+O.width,Z),H=Math.max(O.y+O.height,H),V.nonscaling)W=!0}}return{rect:isFinite(U)?new t(U,K,Z-U,H-K):new t,nonscaling:W}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var $=this._decompose();return $?$.rotation:0},setRotation:function($){var Q=this.getRotation();if(Q!=null&&$!=null){var J=this._decomposed;if(this.rotate($-Q),J)J.rotation=$,this._decomposed=J}},getScaling:function(){var $=this._decompose(),Q=$&&$.scaling;return new h0(Q?Q.x:1,Q?Q.y:1,this,"setScaling")},setScaling:function(){var $=this.getScaling(),Q=y.read(arguments,0,{clone:!0,readNull:!0});if($&&Q&&!$.equals(Q)){var J=this.getRotation(),U=this._decomposed,Z=new V0,K=Z0.isZero;if(K($.x)||K($.y)){if(Z.translate(U.translation),J)Z.rotate(J);Z.scale(Q.x,Q.y),this._matrix.set(Z)}else{var H=this.getPosition(!0);if(Z.translate(H),J)Z.rotate(J);if(Z.scale(Q.x/$.x,Q.y/$.y),J)Z.rotate(-J);Z.translate(H.negate()),this.transform(Z)}if(U)U.scaling=Q,this._decomposed=U}},getMatrix:function(){return this._matrix},setMatrix:function(){var $=this._matrix;$.set.apply($,arguments)},getGlobalMatrix:function($){var Q=this._globalMatrix;if(Q){var J=this._parent,U=[];while(J){if(!J._globalMatrix){Q=null;for(var Z=0,K=U.length;Z<K;Z++)U[Z]._globalMatrix=null;break}U.push(J),J=J._parent}}if(!Q){Q=this._globalMatrix=this._matrix.clone();var J=this._parent;if(J)Q.prepend(J.getGlobalMatrix(!0))}return $?Q:Q.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function($){if(this._applyMatrix=this._canApplyMatrix&&!!$)this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function($,Q){if(this._project!==$){if(this._project)this._installEvents(!1);this._project=$;var J=this._children;for(var U=0,Z=J&&J.length;U<Z;U++)J[U]._setProject($);Q=!0}if(Q)this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function $(Q){$.base.call(this,Q);var J=this._children;for(var U=0,Z=J&&J.length;U<Z;U++)J[U]._installEvents(Q)},getLayer:function(){var $=this;while($=$._parent)if($ instanceof t0)return $;return null},getParent:function(){return this._parent},setParent:function($){return $.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function($){this.removeChildren(),this.addChildren($)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var $=this._getOwner();return $&&$._children[this._index+1]||null},getPreviousSibling:function(){var $=this._getOwner();return $&&$._children[this._index-1]||null},getIndex:function(){return this._index},equals:function($){return $===this||$&&this._class===$._class&&this._style.equals($._style)&&this._matrix.equals($._matrix)&&this._locked===$._locked&&this._visible===$._visible&&this._blendMode===$._blendMode&&this._opacity===$._opacity&&this._clipMask===$._clipMask&&this._guide===$._guide&&this._equals($)||!1},_equals:function($){return S.equals(this._children,$._children)},clone:function($){var Q=new this.constructor(Q0.NO_INSERT),J=this._children,U=S.pick($?$.insert:I,$===I||$===!0),Z=S.pick($?$.deep:I,!0);if(J)Q.copyAttributes(this);if(!J||Z)Q.copyContent(this);if(!J)Q.copyAttributes(this);if(U)Q.insertAbove(this);var K=this._name,H=this._parent;if(K&&H){var J=H._children,W=K,Y=1;while(J[K])K=W+" "+Y++;if(K!==W)Q.setName(K)}return Q},copyContent:function($){var Q=$._children;for(var J=0,U=Q&&Q.length;J<U;J++)this.addChild(Q[J].clone(!1),!0)},copyAttributes:function($,Q){this.setStyle($._style);var J=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"];for(var U=0,Z=J.length;U<Z;U++){var K=J[U];if($.hasOwnProperty(K))this[K]=$[K]}if(!Q)this._matrix.set($._matrix,!0);this.setApplyMatrix($._applyMatrix),this.setPivot($._pivot),this.setSelection($._selection);var{_data:H,_name:W}=$;if(this._data=H?S.clone(H):null,W)this.setName(W)},rasterize:function($,Q){var J,U,Z;if(S.isPlainObject($))J=$.resolution,U=$.insert,Z=$.raster;else J=$,U=Q;if(!Z)Z=new e0(Q0.NO_INSERT);var K=this.getStrokeBounds(),H=(J||this.getView().getResolution())/72,W=K.getTopLeft().floor(),Y=K.getBottomRight().ceil(),F=new s(Y.subtract(W)),A=F.multiply(H);if(Z.setSize(A,!0),!A.isZero()){var V=Z.getContext(!0),O=new V0().scale(H).translate(W.negate());V.save(),O.applyToContext(V),this.draw(V,new S({matrices:[O]})),V.restore()}if(Z._matrix.set(new V0().translate(W.add(F.divide(2))).scale(1/H)),U===I||U)Z.insertAbove(this);return Z},contains:function(){var $=this._matrix;return $.isInvertible()&&!!this._contains($._inverseTransform(y.read(arguments)))},_contains:function($){var Q=this._children;if(Q){for(var J=Q.length-1;J>=0;J--)if(Q[J].contains($))return!0;return!1}return $.isInside(this.getInternalBounds())},isInside:function(){return t.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new F0.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function($,Q){if(!($ instanceof Q0))return!1;return this._asPathItem().getIntersections($._asPathItem(),null,Q,!0).length>0}},new function(){function $(){var U=arguments;return this._hitTest(y.read(U),m0.getOptions(U))}function Q(){var U=arguments,Z=y.read(U),K=m0.getOptions(U),H=[];return this._hitTest(Z,new S({all:H},K)),H}function J(U,Z,K,H){var W=this._children;if(W)for(var Y=W.length-1;Y>=0;Y--){var F=W[Y],A=F!==H&&F._hitTest(U,Z,K);if(A&&!Z.all)return A}return null}return J8.inject({hitTest:$,hitTestAll:Q,_hitTest:J}),{hitTest:$,hitTestAll:Q,_hitTestChildren:J}},{_hitTest:function($,Q,J){if(this._locked||!this._visible||this._guide&&!Q.guides||this.isEmpty())return null;var U=this._matrix,Z=J?J.appended(U):this.getGlobalMatrix().prepend(this.getView()._matrix),K=Math.max(Q.tolerance,0.000000000001),H=Q._tolerancePadding=new s(F0._getStrokePadding(K,U._shiftless().invert()));if($=U._inverseTransform($),!$||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(H.multiply(2))._containsPoint($))return null;var W=!(Q.guides&&!this._guide||Q.selected&&!this.isSelected()||Q.type&&Q.type!==S.hyphenate(this._class)||Q.class&&!(this instanceof Q.class)),Y=Q.match,F=this,A,V;function O(T){if(T&&Y&&!Y(T))T=null;if(T&&Q.all)Q.all.push(T);return T}function X(T,q){var _=q?A["get"+q]():F.getPosition();if($.subtract(_).divide(H).length<=1)return new m0(T,F,{name:q?S.hyphenate(q):T,point:_})}var{position:N,center:L,bounds:B}=Q;if(W&&this._parent&&(N||L||B)){if(L||B)A=this.getInternalBounds();if(V=N&&X("position")||L&&X("center","Center"),!V&&B){var E=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"];for(var R=0;R<8&&!V;R++)V=X("bounds",E[R])}V=O(V)}if(!V)V=this._hitTestChildren($,Q,Z)||W&&O(this._hitTestSelf($,Q,Z,this.getStrokeScaling()?null:Z._shiftless().invert()))||null;if(V&&V.point)V.point=U.transform(V.point);return V},_hitTestSelf:function($,Q){if(Q.fill&&this.hasFill()&&this._contains($))return new m0("fill",this)},matches:function($,Q){function J(H,W){for(var Y in H)if(H.hasOwnProperty(Y)){var F=H[Y],A=W[Y];if(S.isPlainObject(F)&&S.isPlainObject(A)){if(!J(F,A))return!1}else if(!S.equals(F,A))return!1}return!0}var U=typeof $;if(U==="object"){for(var Z in $)if($.hasOwnProperty(Z)&&!this.matches(Z,$[Z]))return!1;return!0}else if(U==="function")return $(this);else if($==="match")return Q(this);else{var K=/^(empty|editable)$/.test($)?this["is"+S.capitalize($)]():$==="type"?S.hyphenate(this._class):this[$];if($==="class"){if(typeof Q==="function")return this instanceof Q;K=this._class}if(typeof Q==="function")return!!Q(K);else if(Q){if(Q.test)return Q.test(K);else if(S.isPlainObject(Q))return J(Q,K)}return S.equals(K,Q)}},getItems:function($){return Q0._getItems(this,$,this._matrix)},getItem:function($){return Q0._getItems(this,$,this._matrix,null,!0)[0]||null},statics:{_getItems:function $(Q,J,U,Z,K){if(!Z){var H=typeof J==="object"&&J,W=H&&H.overlapping,Y=H&&H.inside,F=W||Y,O=F&&t.read([F]);if(Z={items:[],recursive:H&&H.recursive!==!1,inside:!!Y,overlapping:!!W,rect:O,path:W&&new F0.Rectangle({rectangle:O,insert:!1})},H)J=S.filter({},J,{recursive:!0,inside:!0,overlapping:!0})}var A=Q._children,V=Z.items,O=Z.rect;U=O&&(U||new V0);for(var X=0,N=A&&A.length;X<N;X++){var L=A[X],B=U&&U.appended(L._matrix),E=!0;if(O){var F=L.getBounds(B);if(!O.intersects(F))continue;if(!(O.contains(F)||Z.overlapping&&(F.contains(O)||Z.path.intersects(L,B))))E=!1}if(E&&L.matches(J)){if(V.push(L),K)break}if(Z.recursive!==!1)$(L,J,B,Z,K);if(K&&V.length>0)break}return V}}},{importJSON:function($){var Q=S.importJSON($,this);return Q!==this?this.addChild(Q):Q},addChild:function($){return this.insertChild(I,$)},insertChild:function($,Q){var J=Q?this.insertChildren($,[Q]):null;return J&&J[0]},addChildren:function($){return this.insertChildren(this._children.length,$)},insertChildren:function($,Q){var J=this._children;if(J&&Q&&Q.length>0){Q=S.slice(Q);var U={};for(var Z=Q.length-1;Z>=0;Z--){var K=Q[Z],H=K&&K._id;if(!K||U[H])Q.splice(Z,1);else K._remove(!1,!0),U[H]=!0}S.splice(J,Q,$,0);var W=this._project,Y=W._changes;for(var Z=0,F=Q.length;Z<F;Z++){var K=Q[Z],A=K._name;if(K._parent=this,K._setProject(W,!0),A)K.setName(A);if(Y)K._changed(5)}this._changed(11)}else Q=null;return Q},_insertItem:"#insertChild",_insertAt:function($,Q){var J=$&&$._getOwner(),U=$!==this&&J?this:null;if(U)U._remove(!1,!0),J._insertItem($._index+Q,U);return U},insertAbove:function($){return this._insertAt($,1)},insertBelow:function($){return this._insertAt($,0)},sendToBack:function(){var $=this._getOwner();return $?$._insertItem(0,this):null},bringToFront:function(){var $=this._getOwner();return $?$._insertItem(I,this):null},appendTop:"#addChild",appendBottom:function($){return this.insertChild(0,$)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function($){return $._insertItem(I,this)},copyTo:function($){return this.clone(!1).addTo($)},reduce:function($){var Q=this._children;if(Q&&Q.length===1){var J=Q[0].reduce($);if(this._parent)J.insertAbove(this),this.remove();else J.remove();return J}return this},_removeNamed:function(){var $=this._getOwner();if($){var{_children:Q,_namedChildren:J}=$,U=this._name,Z=J[U],K=Z?Z.indexOf(this):-1;if(K!==-1){if(Q[U]==this)delete Q[U];if(Z.splice(K,1),Z.length)Q[U]=Z[0];else delete J[U]}}},_remove:function($,Q){var J=this._getOwner(),U=this._project,Z=this._index;if(this._style)this._style._dispose();if(J){if(this._name)this._removeNamed();if(Z!=null){if(U._activeLayer===this)U._activeLayer=this.getNextSibling()||this.getPreviousSibling();S.splice(J._children,null,Z,1)}if(this._installEvents(!1),$&&U._changes)this._changed(5);if(Q)J._changed(11,this);return this._parent=null,!0}return!1},remove:function(){return this._remove(!0,!0)},replaceWith:function($){var Q=$&&$.insertBelow(this);if(Q)this.remove();return Q},removeChildren:function($,Q){if(!this._children)return null;$=$||0,Q=S.pick(Q,this._children.length);var J=S.splice(this._children,null,$,Q-$);for(var U=J.length-1;U>=0;U--)J[U]._remove(!0,!1);if(J.length>0)this._changed(11);return J},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var $=0,Q=this._children.length;$<Q;$++)this._children[$]._index=$;this._changed(11)}},isEmpty:function($){var Q=this._children,J=Q?Q.length:0;if($){for(var U=0;U<J;U++)if(!Q[U].isEmpty($))return!1;return!0}return!J},isEditable:function(){var $=this;while($){if(!$._visible||$._locked)return!1;$=$._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function($){function Q(H){var W=[];do W.unshift(H);while(H=H._parent);return W}var J=Q(this),U=Q($);for(var Z=0,K=Math.min(J.length,U.length);Z<K;Z++)if(J[Z]!=U[Z])return J[Z]._index<U[Z]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return this._parent?this._parent.isInserted():!1},isAbove:function($){return this._getOrder($)===-1},isBelow:function($){return this._getOrder($)===1},isParent:function($){return this._parent===$},isChild:function($){return $&&$._parent===this},isDescendant:function($){var Q=this;while(Q=Q._parent)if(Q===$)return!0;return!1},isAncestor:function($){return $?$.isDescendant(this):!1},isSibling:function($){return this._parent===$._parent},isGroupedWith:function($){var Q=this._parent;while(Q){if(Q._parent&&/^(Group|Layer|CompoundPath)$/.test(Q._class)&&$.isDescendant(Q))return!0;Q=Q._parent}return!1}},S.each(["rotate","scale","shear","skew"],function($){var Q=$==="rotate";this[$]=function(){var J=arguments,U=(Q?S:y).read(J),Z=y.read(J,0,{readNull:!0});return this.transform(new V0()[$](U,Z||this.getPosition(!0)))}},{translate:function(){var $=new V0;return this.transform($.translate.apply($,arguments))},transform:function($,Q,J){var U=this._matrix,Z=$&&!$.isIdentity(),K=J&&this._canApplyMatrix||this._applyMatrix&&(Z||!U.isIdentity()||Q&&this._children);if(!Z&&!K)return this;if(Z){if(!$.isInvertible()&&U.isInvertible())U._backup=U.getValues();U.prepend($,!0);var H=this._style,W=H.getFillColor(!0),Y=H.getStrokeColor(!0);if(W)W.transform($);if(Y)Y.transform($)}if(K&&(K=this._transformContent(U,Q,J))){var F=this._pivot;if(F)U._transformPoint(F,F,!0);if(U.reset(!0),J&&this._canApplyMatrix)this._applyMatrix=!0}var A=this._bounds,V=this._position;if(Z||K)this._changed(25);var O=Z&&A&&$.decompose();if(O&&O.skewing.isZero()&&O.rotation%90===0){for(var X in A){var N=A[X];if(N.nonscaling)delete A[X];else if(K||!N.internal){var L=N.rect;$._transformBounds(L,L)}}this._bounds=A;var B=A[this._getBoundsCacheKey(this._boundsOptions||{})];if(B)this._position=this._getPositionFromBounds(B.rect)}else if(Z&&V&&this._pivot)this._position=$._transformPoint(V,V);return this},_transformContent:function($,Q,J){var U=this._children;if(U){for(var Z=0,K=U.length;Z<K;Z++)U[Z].transform($,Q,J);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(y.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(y.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(y.read(arguments))},localToParent:function(){return this._matrix._transformPoint(y.read(arguments))},fitBounds:function($,Q){$=t.read(arguments);var J=this.getBounds(),U=J.height/J.width,Z=$.height/$.width,K=(Q?U>Z:U<Z)?$.width/J.width:$.height/J.height,H=new t(new y,new s(J.width*K,J.height*K));H.setCenter($.getCenter()),this.setBounds(H)}}),{_setStyles:function($,Q,J){var U=this._style,Z=this._matrix;if(U.hasFill())$.fillStyle=U.getFillColor().toCanvasStyle($,Z);if(U.hasStroke()){$.strokeStyle=U.getStrokeColor().toCanvasStyle($,Z),$.lineWidth=U.getStrokeWidth();var K=U.getStrokeJoin(),H=U.getStrokeCap(),W=U.getMiterLimit();if(K)$.lineJoin=K;if(H)$.lineCap=H;if(W)$.miterLimit=W;if(W0.support.nativeDash){var Y=U.getDashArray(),F=U.getDashOffset();if(Y&&Y.length)if("setLineDash"in $)$.setLineDash(Y),$.lineDashOffset=F;else $.mozDash=Y,$.mozDashOffset=F}}if(U.hasShadow()){var A=Q.pixelRatio||1,V=J._shiftless().prepend(new V0().scale(A,A)),O=V.transform(new y(U.getShadowBlur(),0)),X=V.transform(this.getShadowOffset());$.shadowColor=U.getShadowColor().toCanvasStyle($),$.shadowBlur=O.getLength(),$.shadowOffsetX=X.x,$.shadowOffsetY=X.y}},draw:function($,Q,J){var U=this._updateVersion=this._project._updateVersion;if(!this._visible||this._opacity===0)return;var{matrices:Z,viewMatrix:K}=Q,H=this._matrix,W=Z[Z.length-1].appended(H);if(!W.isInvertible())return;if(K=K?K.appended(W):W,Z.push(W),Q.updateMatrix)this._globalMatrix=W;var Y=this._blendMode,F=Z0.clamp(this._opacity,0,1),A=Y==="normal",V=D8.nativeModes[Y],O=A&&F===1||Q.dontStart||Q.clip||(V||A&&F<1)&&this._canComposite(),X=Q.pixelRatio||1,N,L,B;if(!O){var E=this.getStrokeBounds(K);if(!E.width||!E.height){Z.pop();return}if(B=Q.offset,L=Q.offset=E.getTopLeft().floor(),N=$,$=L0.getContext(E.getSize().ceil().add(1).multiply(X)),X!==1)$.scale(X,X)}$.save();var R=J?J.appended(H):this._canScaleStroke&&!this.getStrokeScaling(!0)&&K,T=!O&&Q.clipItem,q=!R||T;if(O){if($.globalAlpha=F,V)$.globalCompositeOperation=Y}else if(q)$.translate(-L.x,-L.y);if(q)(O?H:K).applyToContext($);if(T)Q.clipItem.draw($,Q.extend({clip:!0}));if(R){$.setTransform(X,0,0,X,0,0);var _=Q.offset;if(_)$.translate(-_.x,-_.y)}if(this._draw($,Q,K,R),$.restore(),Z.pop(),Q.clip&&!Q.dontFinish)$.clip(this.getFillRule());if(!O)D8.process(Y,$,N,F,L.subtract(B).multiply(X)),L0.release($),Q.offset=B},_isUpdated:function($){var Q=this._parent;if(Q instanceof u0)return Q._isUpdated($);var J=this._updateVersion===$;if(!J&&Q&&Q._visible&&Q._isUpdated($))this._updateVersion=$,J=!0;return J},_drawSelection:function($,Q,J,U,Z){var K=this._selection,H=K&1,W=K&2||H&&this._selectBounds,Y=K&4;if(!this._drawSelected)H=!1;if((H||W||Y)&&this._isUpdated(Z)){var F,A=this.getSelectedColor(!0)||(F=this.getLayer())&&F.getSelectedColor(!0),V=Q.appended(this.getGlobalMatrix(!0)),O=J/2;if($.strokeStyle=$.fillStyle=A?A.toCanvasStyle($):"#009dec",H)this._drawSelected($,V,U);if(Y){var X=this.getPosition(!0),N=this._parent,L=N?N.localToGlobal(X):X,B=L.x,E=L.y;$.beginPath(),$.arc(B,E,O,0,Math.PI*2,!0),$.stroke();var R=[[0,-1],[1,0],[0,1],[-1,0]],T=O,q=J+1;for(var _=0;_<4;_++){var z=R[_],G=z[0],C=z[1];$.moveTo(B+G*T,E+C*T),$.lineTo(B+G*q,E+C*q),$.stroke()}}if(W){var P=V._transformCorners(this.getInternalBounds());$.beginPath();for(var _=0;_<8;_++)$[!_?"moveTo":"lineTo"](P[_],P[++_]);$.closePath(),$.stroke();for(var _=0;_<8;_++)$.fillRect(P[_]-O,P[++_]-O,J,J)}}},_canComposite:function(){return!1}},S.each(["down","drag","up","move"],function($){this["removeOn"+S.capitalize($)]=function(){var Q={};return Q[$]=!0,this.removeOn(Q)}},{removeOn:function($){for(var Q in $)if($[Q]){var J="mouse"+Q,U=this._project,Z=U._removeSets=U._removeSets||{};Z[J]=Z[J]||{},Z[J][this._id]=this}return this}}),{tween:function($,Q,J){if(!J){if(J=Q,Q=$,$=null,!J)J=Q,Q=null}var U=J&&J.easing,Z=J&&J.start,K=J!=null&&(typeof J==="number"?J:J.duration),H=new l8(this,$,Q,K,U,Z);function W(Y){if(H._handleFrame(Y.time*1000),!H.running)this.off("frame",W)}if(K)this.on("frame",W);return H},tweenTo:function($,Q){return this.tween(null,$,Q)},tweenFrom:function($,Q){return this.tween($,null,Q)}}),v0=Q0.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function $(Q){if(this._children=[],this._namedChildren={},!this._initialize(Q))this.addChildren(Array.isArray(Q)?Q:arguments)},_changed:function $(Q){if($.base.call(this,Q),Q&2050)this._clipItem=I},_getClipItem:function(){var $=this._clipItem;if($===I){$=null;var Q=this._children;for(var J=0,U=Q.length;J<U;J++)if(Q[J]._clipMask){$=Q[J];break}this._clipItem=$}return $},isClipped:function(){return!!this._getClipItem()},setClipped:function($){var Q=this.getFirstChild();if(Q)Q.setClipMask($)},_getBounds:function $(Q,J){var U=this._getClipItem();return U?U._getCachedBounds(U._matrix.prepended(Q),S.set({},J,{stroke:!1})):$.base.call(this,Q,J)},_hitTestChildren:function $(Q,J,U){var Z=this._getClipItem();return(!Z||Z.contains(Q))&&$.base.call(this,Q,J,U,Z)},_draw:function($,Q){var J=Q.clip,U=!J&&this._getClipItem();if(Q=Q.extend({clipItem:U,clip:!1}),J)$.beginPath(),Q.dontStart=Q.dontFinish=!0;else if(U)U.draw($,Q.extend({clip:!0}));var Z=this._children;for(var K=0,H=Z.length;K<H;K++){var W=Z[K];if(W!==U)W.draw($,Q)}}}),t0=v0.extend({_class:"Layer",initialize:function $(){v0.apply(this,arguments)},_getOwner:function(){return this._parent||this._index!=null&&this._project},isInserted:function $(){return this._parent?$.base.call(this):this._index!=null},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),k0=Q0.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function $(Q,J){this._initialize(Q,J)},_equals:function($){return this._type===$._type&&this._size.equals($._size)&&S.equals(this._radius,$._radius)},copyContent:function($){this.setType($._type),this.setSize($._size),this.setRadius($._radius)},getType:function(){return this._type},setType:function($){this._type=$},getShape:"#getType",setShape:"#setType",getSize:function(){var $=this._size;return new i0($.width,$.height,this,"setSize")},setSize:function(){var $=s.read(arguments);if(!this._size)this._size=$.clone();else if(!this._size.equals($)){var Q=this._type,J=$.width,U=$.height;if(Q==="rectangle")this._radius.set(s.min(this._radius,$.divide(2).abs()));else if(Q==="circle")J=U=(J+U)/2,this._radius=J/2;else if(Q==="ellipse")this._radius._set(J/2,U/2);this._size._set(J,U),this._changed(9)}},getRadius:function(){var $=this._radius;return this._type==="circle"?$:new i0($.width,$.height,this,"setRadius")},setRadius:function($){var Q=this._type;if(Q==="circle"){if($===this._radius)return;var J=$*2;this._radius=$,this._size._set(J,J)}else if($=s.read(arguments),!this._radius)this._radius=$.clone();else{if(this._radius.equals($))return;if(this._radius.set($),Q==="rectangle"){var J=s.max(this._size,$.multiply(2));this._size.set(J)}else if(Q==="ellipse")this._size._set($.width*2,$.height*2)}this._changed(9)},isEmpty:function(){return!1},toPath:function($){var Q=new F0[S.capitalize(this._type)]({center:new y,size:this._size,radius:this._radius,insert:!1});if(Q.copyAttributes(this),W0.settings.applyMatrix)Q.setApplyMatrix(!0);if($===I||$)Q.insertAbove(this);return Q},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function($,Q,J,U){var Z=this._style,K=Z.hasFill(),H=Z.hasStroke(),W=Q.dontFinish||Q.clip,Y=!U;if(K||H||W){var F=this._type,A=this._radius,V=F==="circle";if(!Q.dontStart)$.beginPath();if(Y&&V)$.arc(0,0,A,0,Math.PI*2,!0);else{var O=V?A:A.width,X=V?A:A.height,N=this._size,L=N.width,B=N.height;if(Y&&F==="rectangle"&&O===0&&X===0)$.rect(-L/2,-B/2,L,B);else{var E=L/2,R=B/2,T=0.44771525016920644,q=O*T,_=X*T,z=[-E,-R+X,-E,-R+_,-E+q,-R,-E+O,-R,E-O,-R,E-q,-R,E,-R+_,E,-R+X,E,R-X,E,R-_,E-q,R,E-O,R,-E+O,R,-E+q,R,-E,R-_,-E,R-X];if(U)U.transform(z,z,32);if($.moveTo(z[0],z[1]),$.bezierCurveTo(z[2],z[3],z[4],z[5],z[6],z[7]),E!==O)$.lineTo(z[8],z[9]);if($.bezierCurveTo(z[10],z[11],z[12],z[13],z[14],z[15]),R!==X)$.lineTo(z[16],z[17]);if($.bezierCurveTo(z[18],z[19],z[20],z[21],z[22],z[23]),E!==O)$.lineTo(z[24],z[25]);$.bezierCurveTo(z[26],z[27],z[28],z[29],z[30],z[31])}}$.closePath()}if(!W&&(K||H)){if(this._setStyles($,Q,J),K)$.fill(Z.getFillRule()),$.shadowColor="rgba(0,0,0,0)";if(H)$.stroke()}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function($,Q){var J=new t(this._size).setCenter(0,0),U=this._style,Z=Q.stroke&&U.hasStroke()&&U.getStrokeWidth();if($)J=$._transformBounds(J);return Z?J.expand(F0._getStrokePadding(Z,this._getStrokeMatrix($,Q))):J}},new function(){function $(J,U,Z){var K=J._radius;if(!K.isZero()){var H=J._size.divide(2);for(var W=1;W<=4;W++){var Y=new y(W>1&&W<4?-1:1,W>2?-1:1),F=Y.multiply(H),A=F.subtract(Y.multiply(K)),V=new t(Z?F.add(Y.multiply(Z)):F,A);if(V.contains(U))return{point:A,quadrant:W}}}}function Q(J,U,Z,K){var H=J.divide(U);return(!K||H.isInQuadrant(K))&&H.subtract(H.normalize()).multiply(U).divide(Z).length<=1}return{_contains:function J(U){if(this._type==="rectangle"){var Z=$(this,U);return Z?U.subtract(Z.point).divide(this._radius).getLength()<=1:J.base.call(this,U)}else return U.divide(this.size).getLength()<=0.5},_hitTestSelf:function J(U,Z,K,H){var W=!1,Y=this._style,F=Z.stroke&&Y.hasStroke(),A=Z.fill&&Y.hasFill();if(F||A){var V=this._type,O=this._radius,X=F?Y.getStrokeWidth()/2:0,N=Z._tolerancePadding.add(F0._getStrokePadding(X,!Y.getStrokeScaling()&&H));if(V==="rectangle"){var L=N.multiply(2),B=$(this,U,L);if(B)W=Q(U.subtract(B.point),O,N,B.quadrant);else{var E=new t(this._size).setCenter(0,0),R=E.expand(L),T=E.expand(L.negate());W=R._containsPoint(U)&&!T._containsPoint(U)}}else W=Q(U,O,N)}return W?new m0(F?"stroke":"fill",this):J.base.apply(this,arguments)}}},{statics:new function(){function $(Q,J,U,Z,K){var H=S.create(k0.prototype);return H._type=Q,H._size=U,H._radius=Z,H._initialize(S.getNamed(K),J),H}return{Circle:function(){var Q=arguments,J=y.readNamed(Q,"center"),U=S.readNamed(Q,"radius");return $("circle",J,new s(U*2),U,Q)},Rectangle:function(){var Q=arguments,J=t.readNamed(Q,"rectangle"),U=s.min(s.readNamed(Q,"radius"),J.getSize(!0).divide(2));return $("rectangle",J.getCenter(!0),J.getSize(!0),U,Q)},Ellipse:function(){var Q=arguments,J=k0._readEllipse(Q),U=J.radius;return $("ellipse",J.center,U.multiply(2),U,Q)},_readEllipse:function(Q){var J,U;if(S.hasNamed(Q,"radius"))J=y.readNamed(Q,"center"),U=s.readNamed(Q,"radius");else{var Z=t.readNamed(Q,"rectangle");J=Z.getCenter(!0),U=Z.getSize(!0).divide(2)}return{center:J,radius:U}}}}}),e0=Q0.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function $(Q,J){if(!this._initialize(Q,J!==I&&y.read(arguments))){var U,Z=typeof Q,K=Z==="string"?g.getElementById(Q):Z==="object"?Q:null;if(K&&K!==Q0.NO_INSERT){if(K.getContext||K.naturalHeight!=null)U=K;else if(K){var H=s.read(arguments);if(!H.isZero())U=L0.getCanvas(H)}}if(U)this.setImage(U);else this.setSource(Q)}if(!this._size)this._size=new s,this._loaded=!1},_equals:function($){return this.getSource()===$.getSource()},copyContent:function($){var{_image:Q,_canvas:J}=$;if(Q)this._setImage(Q);else if(J){var U=L0.getCanvas($._size);U.getContext("2d").drawImage(J,0,0),this._setImage(U)}this._crossOrigin=$._crossOrigin},getSize:function(){var $=this._size;return new i0($?$.width:0,$?$.height:0,this,"setSize")},setSize:function($,Q){var J=s.read(arguments);if(!J.equals(this._size))if(J.width>0&&J.height>0){var U=!Q&&this.getElement();if(this._setImage(L0.getCanvas(J)),U)this.getContext(!0).drawImage(U,0,0,J.width,J.height)}else{if(this._canvas)L0.release(this._canvas);this._size=J.clone()}else if(Q)this.clear()},getWidth:function(){return this._size?this._size.width:0},setWidth:function($){this.setSize($,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function($){this.setSize(this.getWidth(),$)},getLoaded:function(){return this._loaded},isEmpty:function(){var $=this._size;return!$||$.width===0&&$.height===0},getResolution:function(){var $=this._matrix,Q=new y(0,0).transform($),J=new y(1,0).transform($).subtract(Q),U=new y(0,1).transform($).subtract(Q);return new s(72/J.getLength(),72/U.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function($){var Q=this;function J(U){var Z=Q.getView(),K=U&&U.type||"load";if(Z&&Q.responds(K))W0=Z._scope,Q.emit(K,new K8(U))}if(this._setImage($),this._loaded)setTimeout(J,0);else if($)I0.add($,{load:function(U){Q._setImage($),J(U)},error:J})},_setImage:function($){if(this._canvas)L0.release(this._canvas);if($&&$.getContext)this._image=null,this._canvas=$,this._loaded=!0;else this._image=$,this._canvas=null,this._loaded=!!($&&$.src&&$.complete);this._size=new s($?$.naturalWidth||$.width:0,$?$.naturalHeight||$.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var $=L0.getContext(this._size);try{if(this._image)$.drawImage(this._image,0,0);this._canvas=$.canvas}catch(Q){L0.release($)}}return this._canvas},setCanvas:"#setImage",getContext:function($){if(!this._context)this._context=this.getCanvas().getContext("2d");if($)this._image=null,this._changed(1025);return this._context},setContext:function($){this._context=$},getSource:function(){var $=this._image;return $&&$.src||this.toDataURL()},setSource:function($){var Q=new M.Image,J=this._crossOrigin;if(J)Q.crossOrigin=J;if($)Q.src=$;this.setImage(Q)},getCrossOrigin:function(){var $=this._image;return $&&$.crossOrigin||this._crossOrigin||""},setCrossOrigin:function($){this._crossOrigin=$;var Q=this._image;if(Q)Q.crossOrigin=$},getSmoothing:function(){return this._smoothing},setSmoothing:function($){this._smoothing=typeof $==="string"?$:$?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var $=t.read(arguments),Q=L0.getContext($.getSize());return Q.drawImage(this.getCanvas(),$.x,$.y,$.width,$.height,0,0,$.width,$.height),Q.canvas},getSubRaster:function(){var $=t.read(arguments),Q=new e0(Q0.NO_INSERT);return Q._setImage(this.getSubCanvas($)),Q.translate($.getCenter().subtract(this.getSize().divide(2))),Q._matrix.prepend(this._matrix),Q.insertAbove(this),Q},toDataURL:function(){var $=this._image,Q=$&&$.src;if(/^data:/.test(Q))return Q;var J=this.getCanvas();return J?J.toDataURL.apply(J,arguments):null},drawImage:function($){var Q=y.read(arguments,1);this.getContext(!0).drawImage($,Q.x,Q.y)},getAverageColor:function($){var Q,J;if(!$)Q=this.getBounds();else if($ instanceof o0)J=$,Q=$.getBounds();else if(typeof $==="object"){if("width"in $)Q=new t($);else if("x"in $)Q=new t($.x-0.5,$.y-0.5,1,1)}if(!Q)return null;var U=32,Z=Math.min(Q.width,U),K=Math.min(Q.height,U),H=e0._sampleContext;if(!H)H=e0._sampleContext=L0.getContext(new s(U));else H.clearRect(0,0,U+1,U+1);H.save();var W=new V0().scale(Z/Q.width,K/Q.height).translate(-Q.x,-Q.y);if(W.applyToContext(H),J)J.draw(H,new S({clip:!0,matrices:[W]}));this._matrix.applyToContext(H);var Y=this.getElement(),F=this._size;if(Y)H.drawImage(Y,-F.width/2,-F.height/2);H.restore();var A=H.getImageData(0.5,0.5,Math.ceil(Z),Math.ceil(K)).data,V=[0,0,0],O=0;for(var X=0,N=A.length;X<N;X+=4){var L=A[X+3];O+=L,L/=255,V[0]+=A[X]*L,V[1]+=A[X+1]*L,V[2]+=A[X+2]*L}for(var X=0;X<3;X++)V[X]/=O;return O?z0.read(V):null},getPixel:function(){var $=y.read(arguments),Q=this.getContext().getImageData($.x,$.y,1,1).data;return new z0("rgb",[Q[0]/255,Q[1]/255,Q[2]/255],Q[3]/255)},setPixel:function(){var $=arguments,Q=y.read($),J=z0.read($),U=J._convert("rgb"),Z=J._alpha,K=this.getContext(!0),H=K.createImageData(1,1),W=H.data;W[0]=U[0]*255,W[1]=U[1]*255,W[2]=U[2]*255,W[3]=Z!=null?Z*255:255,K.putImageData(H,Q.x,Q.y)},clear:function(){var $=this._size;this.getContext(!0).clearRect(0,0,$.width+1,$.height+1)},createImageData:function(){var $=s.read(arguments);return this.getContext().createImageData($.width,$.height)},getImageData:function(){var $=t.read(arguments);if($.isEmpty())$=new t(this._size);return this.getContext().getImageData($.x,$.y,$.width,$.height)},putImageData:function($){var Q=y.read(arguments,1);this.getContext(!0).putImageData($,Q.x,Q.y)},setImageData:function($){this.setSize($),this.getContext(!0).putImageData($,0,0)},_getBounds:function($,Q){var J=new t(this._size).setCenter(0,0);return $?$._transformBounds(J):J},_hitTestSelf:function($){if(this._contains($)){var Q=this;return new m0("pixel",Q,{offset:$.add(Q._size.divide(2)).round(),color:{get:function(){return Q.getPixel(this.offset)}}})}},_draw:function($,Q,J){var U=this.getElement();if(U&&U.width>0&&U.height>0){$.globalAlpha=Z0.clamp(this._opacity,0,1),this._setStyles($,Q,J);var Z=this._smoothing,K=Z==="off";N0.setPrefixed($,K?"imageSmoothingEnabled":"imageSmoothingQuality",K?!1:Z),$.drawImage(U,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),O8=Q0.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function $(Q,J){if(!this._initialize(Q,J!==I&&y.read(arguments,1)))this.setDefinition(Q instanceof d0?Q:new d0(Q))},_equals:function($){return this._definition===$._definition},copyContent:function($){this.setDefinition($._definition)},getDefinition:function(){return this._definition},setDefinition:function($){this._definition=$,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function($,Q){var J=this._definition._item;return J._getCachedBounds(J._matrix.prepended($),Q)},_hitTestSelf:function($,Q,J){var U=Q.extend({all:!1}),Z=this._definition._item._hitTest($,U,J);if(Z)Z.item=this;return Z},_draw:function($,Q){this._definition._item.draw($,Q)}}),d0=S.extend({_class:"SymbolDefinition",initialize:function $(Q,J){if(this._id=n0.get(),this.project=W0.project,Q)this.setItem(Q,J)},_serialize:function($,Q){return Q.add(this,function(){return S.serialize([this._class,this._item],$,!1,Q)})},_changed:function($){if($&8)Q0._clearBoundsCache(this);if($&1)this.project._changed($)},getItem:function(){return this._item},setItem:function($,Q){if($._symbol)$=$.clone();if(this._item)this._item._symbol=null;if(this._item=$,$.remove(),$.setSelected(!1),!Q)$.setPosition(new y);$._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function($){return new O8(this,$)},clone:function(){return new d0(this._item.clone(!1))},equals:function($){return $===this||$&&this._item.equals($._item)||!1}}),m0=S.extend({_class:"HitResult",initialize:function $(Q,J,U){if(this.type=Q,this.item=J,U)this.inject(U)},statics:{getOptions:function($){var Q=$&&S.read($);return new S({type:null,tolerance:W0.settings.hitTolerance,fill:!Q,stroke:!Q,segments:!Q,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},Q)}}}),i=S.extend({_class:"Segment",beans:!0,_selection:0,initialize:function $(Q,J,U,Z,K,H){var W=arguments.length,Y,F,A,V;if(W>0)if(Q==null||typeof Q==="object")if(W===1&&Q&&"point"in Q)Y=Q.point,F=Q.handleIn,A=Q.handleOut,V=Q.selection;else Y=Q,F=J,A=U,V=Z;else Y=[Q,J],F=U!==I?[U,Z]:null,A=K!==I?[K,H]:null;if(new A8(Y,this,"_point"),new A8(F,this,"_handleIn"),new A8(A,this,"_handleOut"),V)this.setSelection(V)},_serialize:function($,Q){var J=this._point,U=this._selection,Z=U||this.hasHandles()?[J,this._handleIn,this._handleOut]:J;if(U)Z.push(U);return S.serialize(Z,$,!0,Q)},_changed:function($){var Q=this._path;if(!Q)return;var J=Q._curves,U=this._index,Z;if(J){if((!$||$===this._point||$===this._handleIn)&&(Z=U>0?J[U-1]:Q._closed?J[J.length-1]:null))Z._changed();if((!$||$===this._point||$===this._handleOut)&&(Z=J[U]))Z._changed()}Q._changed(41)},getPoint:function(){return this._point},setPoint:function(){this._point.set(y.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(y.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(y.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var $=this._handleIn,Q=this._handleOut;return!$.isZero()&&!Q.isZero()&&$.isCollinear(Q)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function($){var Q=this._selection,J=this._path;if(this._selection=$=$||0,J&&$!==Q)J._updateSelection(this,Q,$),J._changed(257)},_changeSelection:function($,Q){var J=this._selection;this.setSelection(Q?J|$:J&~$)},isSelected:function(){return!!(this._selection&7)},setSelected:function($){this._changeSelection(7,$)},getIndex:function(){return this._index!==I?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var $=this._path,Q=this._index;if($){if(Q>0&&!$._closed&&Q===$._segments.length-1)Q--;return $.getCurves()[Q]||null}return null},getLocation:function(){var $=this.getCurve();return $?new x0($,this===$._segment1?0:1):null},getNext:function(){var $=this._path&&this._path._segments;return $&&($[this._index+1]||this._path._closed&&$[0])||null},smooth:function($,Q,J){var U=$||{},Z=U.type,K=U.factor,H=this.getPrevious(),W=this.getNext(),Y=(H||this)._point,F=this._point,A=(W||this)._point,V=Y.getDistance(F),O=F.getDistance(A);if(!Z||Z==="catmull-rom"){var X=K===I?0.5:K,N=Math.pow(V,X),L=N*N,B=Math.pow(O,X),E=B*B;if(!Q&&H){var R=2*E+3*B*N+L,T=3*B*(B+N);this.setHandleIn(T!==0?new y((E*Y._x+R*F._x-L*A._x)/T-F._x,(E*Y._y+R*F._y-L*A._y)/T-F._y):new y)}if(!J&&W){var R=2*L+3*N*B+E,T=3*N*(N+B);this.setHandleOut(T!==0?new y((L*A._x+R*F._x-E*Y._x)/T-F._x,(L*A._y+R*F._y-E*Y._y)/T-F._y):new y)}}else if(Z==="geometric"){if(H&&W){var q=Y.subtract(A),_=K===I?0.4:K,z=_*V/(V+O);if(!Q)this.setHandleIn(q.multiply(z));if(!J)this.setHandleOut(q.multiply(z-_))}}else throw new Error("Smoothing method \'"+Z+"\' not supported.")},getPrevious:function(){var $=this._path&&this._path._segments;return $&&($[this._index-1]||this._path._closed&&$[$.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var $=this._path;return $&&this._index===$._segments.length-1||!1},reverse:function(){var $=this._handleIn,Q=this._handleOut,J=$.clone();$.set(Q),Q.set(J)},reversed:function(){return new i(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new i(this._point,this._handleIn,this._handleOut)},equals:function($){return $===this||$&&this._class===$._class&&this._point.equals($._point)&&this._handleIn.equals($._handleIn)&&this._handleOut.equals($._handleOut)||!1},toString:function(){var $=["point: "+this._point];if(!this._handleIn.isZero())$.push("handleIn: "+this._handleIn);if(!this._handleOut.isZero())$.push("handleOut: "+this._handleOut);return"{ "+$.join(", ")+" }"},transform:function($){this._transformCoordinates($,new Array(6),!0),this._changed()},interpolate:function($,Q,J){var U=1-J,Z=J,K=$._point,H=Q._point,W=$._handleIn,Y=Q._handleIn,F=Q._handleOut,A=$._handleOut;this._point._set(U*K._x+Z*H._x,U*K._y+Z*H._y,!0),this._handleIn._set(U*W._x+Z*Y._x,U*W._y+Z*Y._y,!0),this._handleOut._set(U*A._x+Z*F._x,U*A._y+Z*F._y,!0),this._changed()},_transformCoordinates:function($,Q,J){var U=this._point,Z=!J||!this._handleIn.isZero()?this._handleIn:null,K=!J||!this._handleOut.isZero()?this._handleOut:null,H=U._x,W=U._y,Y=2;if(Q[0]=H,Q[1]=W,Z)Q[Y++]=Z._x+H,Q[Y++]=Z._y+W;if(K)Q[Y++]=K._x+H,Q[Y++]=K._y+W;if($)if($._transformCoordinates(Q,Q,Y/2),H=Q[0],W=Q[1],J){if(U._x=H,U._y=W,Y=2,Z)Z._x=Q[Y++]-H,Z._y=Q[Y++]-W;if(K)K._x=Q[Y++]-H,K._y=Q[Y++]-W}else{if(!Z)Q[Y++]=H,Q[Y++]=W;if(!K)Q[Y++]=H,Q[Y++]=W}return Q}}),A8=y.extend({initialize:function $(Q,J,U){var Z,K,H;if(!Q)Z=K=0;else if((Z=Q[0])!==I)K=Q[1];else{var W=Q;if((Z=W.x)===I)W=y.read(arguments),Z=W.x;K=W.y,H=W.selected}if(this._x=Z,this._y=K,this._owner=J,J[U]=this,H)this.setSelected(!0)},_set:function($,Q){return this._x=$,this._y=Q,this._owner._changed(this),this},getX:function(){return this._x},setX:function($){this._x=$,this._owner._changed(this)},getY:function(){return this._y},setY:function($){this._y=$,this._owner._changed(this)},isZero:function(){var $=Z0.isZero;return $(this._x)&&$(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function($){this._owner._changeSelection(this._getSelection(),$)},_getSelection:function(){var $=this._owner;return this===$._point?1:this===$._handleIn?2:this===$._handleOut?4:0}}),p=S.extend({_class:"Curve",beans:!0,initialize:function $(Q,J,U,Z,K,H,W,Y){var F=arguments.length,A,V,O,X,N,L;if(F===3)this._path=Q,A=J,V=U;else if(!F)A=new i,V=new i;else if(F===1){if("segment1"in Q)A=new i(Q.segment1),V=new i(Q.segment2);else if("point1"in Q)O=Q.point1,N=Q.handle1,L=Q.handle2,X=Q.point2;else if(Array.isArray(Q))O=[Q[0],Q[1]],X=[Q[6],Q[7]],N=[Q[2]-Q[0],Q[3]-Q[1]],L=[Q[4]-Q[6],Q[5]-Q[7]]}else if(F===2)A=new i(Q),V=new i(J);else if(F===4)O=Q,N=J,L=U,X=Z;else if(F===8)O=[Q,J],X=[W,Y],N=[U-Q,Z-J],L=[K-W,H-Y];this._segment1=A||new i(O,null,N),this._segment2=V||new i(X,L,null)},_serialize:function($,Q){return S.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],$,!0,Q)},_changed:function(){this._length=this._bounds=I},clone:function(){return new p(this._segment1,this._segment2)},toString:function(){var $=["point1: "+this._segment1._point];if(!this._segment1._handleOut.isZero())$.push("handle1: "+this._segment1._handleOut);if(!this._segment2._handleIn.isZero())$.push("handle2: "+this._segment2._handleIn);return $.push("point2: "+this._segment2._point),"{ "+$.join(", ")+" }"},classify:function(){return p.classify(this.getValues())},remove:function(){var $=!1;if(this._path){var Q=this._segment2,J=Q._handleOut;if($=Q.remove(),$)this._segment1._handleOut.set(J)}return $},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(y.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(y.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(y.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(y.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var $=this._path&&this._path._curves;return $&&($[this._segment1._index+1]||this._path._closed&&$[0])||null},getPrevious:function(){var $=this._path&&this._path._curves;return $&&($[this._segment1._index-1]||this._path._closed&&$[$.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var $=this._path;return $&&this._segment1._index===$._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function($){this.getPoint1().setSelected($),this.getHandle1().setSelected($),this.getHandle2().setSelected($),this.getPoint2().setSelected($)},getValues:function($){return p.getValues(this._segment1,this._segment2,$)},getPoints:function(){var $=this.getValues(),Q=[];for(var J=0;J<8;J+=2)Q.push(new y($[J],$[J+1]));return Q}},{getLength:function(){if(this._length==null)this._length=p.getLength(this.getValues(),0,1);return this._length},getArea:function(){return p.getArea(this.getValues())},getLine:function(){return new G0(this._segment1._point,this._segment2._point)},getPart:function($,Q){return new p(p.getPart(this.getValues(),$,Q))},getPartLength:function($,Q){return p.getLength(this.getValues(),$,Q)},divideAt:function($){return this.divideAtTime($&&$.curve===this?$.time:this.getTimeAt($))},divideAtTime:function($,Q){var J=0.00000001,U=1-J,Z=null;if($>=J&&$<=U){var K=p.subdivide(this.getValues(),$),H=K[0],W=K[1],Y=Q||this.hasHandles(),F=this._segment1,A=this._segment2,V=this._path;if(Y)F._handleOut._set(H[2]-H[0],H[3]-H[1]),A._handleIn._set(W[4]-W[6],W[5]-W[7]);var O=H[6],X=H[7],N=new i(new y(O,X),Y&&new y(H[4]-O,H[5]-X),Y&&new y(W[2]-O,W[3]-X));if(V)V.insert(F._index+1,N),Z=this.getNext();else this._segment2=N,this._changed(),Z=new p(N,A)}return Z},splitAt:function($){var Q=this._path;return Q?Q.splitAt($):null},splitAtTime:function($){return this.splitAt(this.getLocationAtTime($))},divide:function($,Q){return this.divideAtTime($===I?0.5:Q?$:this.getTimeAt($))},split:function($,Q){return this.splitAtTime($===I?0.5:Q?$:this.getTimeAt($))},reversed:function(){return new p(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function($,Q,J,U){var{_point:Z,_handleOut:K}=$,H=Q._handleIn,W=Q._point,Y=Z.x,F=Z.y,A=W.x,V=W.y,O=U?[Y,F,Y,F,A,V,A,V]:[Y,F,Y+K._x,F+K._y,A+H._x,V+H._y,A,V];if(J)J._transformCoordinates(O,O,4);return O},subdivide:function($,Q){var J=$[0],U=$[1],Z=$[2],K=$[3],H=$[4],W=$[5],Y=$[6],F=$[7];if(Q===I)Q=0.5;var A=1-Q,V=A*J+Q*Z,O=A*U+Q*K,X=A*Z+Q*H,N=A*K+Q*W,L=A*H+Q*Y,B=A*W+Q*F,E=A*V+Q*X,R=A*O+Q*N,T=A*X+Q*L,q=A*N+Q*B,_=A*E+Q*T,z=A*R+Q*q;return[[J,U,V,O,E,R,_,z],[_,z,T,q,L,B,Y,F]]},getMonoCurves:function($,Q){var J=[],U=Q?0:1,Z=$[U+0],K=$[U+2],H=$[U+4],W=$[U+6];if(Z>=K===K>=H&&K>=H===H>=W||p.isStraight($))J.push($);else{var Y=3*(K-H)-Z+W,F=2*(Z+H)-4*K,A=K-Z,V=0.00000001,O=1-V,X=[],N=Z0.solveQuadratic(Y,F,A,X,V,O);if(!N)J.push($);else{X.sort();var L=X[0],B=p.subdivide($,L);if(J.push(B[0]),N>1)L=(X[1]-L)/(1-L),B=p.subdivide(B[1],L),J.push(B[0]);J.push(B[1])}}return J},solveCubic:function($,Q,J,U,Z,K){var H=$[Q],W=$[Q+2],Y=$[Q+4],F=$[Q+6],A=0;if(!(H<J&&F<J&&W<J&&Y<J||H>J&&F>J&&W>J&&Y>J)){var V=3*(W-H),O=3*(Y-W)-V,X=F-H-V-O;A=Z0.solveCubic(X,O,V,H-J,U,Z,K)}return A},getTimeOf:function($,Q){var J=new y($[0],$[1]),U=new y($[6],$[7]),Z=0.000000000001,K=0.0000001,H=Q.isClose(J,Z)?0:Q.isClose(U,Z)?1:null;if(H===null){var W=[Q.x,Q.y],Y=[];for(var F=0;F<2;F++){var A=p.solveCubic($,F,W[F],Y,0,1);for(var V=0;V<A;V++){var O=Y[V];if(Q.isClose(p.getPoint($,O),K))return O}}}return Q.isClose(J,K)?0:Q.isClose(U,K)?1:null},getNearestTime:function($,Q){if(p.isStraight($)){var J=$[0],U=$[1],Z=$[6],K=$[7],H=Z-J,W=K-U,Y=H*H+W*W;if(Y===0)return 0;var F=((Q.x-J)*H+(Q.y-U)*W)/Y;return F<0.000000000001?0:F>0.999999999999?1:p.getTimeOf($,new y(J+F*H,U+F*W))}var A=100,V=Infinity,O=0;function X(B){if(B>=0&&B<=1){var E=Q.getDistance(p.getPoint($,B),!0);if(E<V)return V=E,O=B,!0}}for(var N=0;N<=A;N++)X(N/A);var L=1/(A*2);while(L>0.00000001)if(!X(O-L)&&!X(O+L))L/=2;return O},getPart:function($,Q,J){var U=Q>J;if(U){var Z=Q;Q=J,J=Z}if(Q>0)$=p.subdivide($,Q)[1];if(J<1)$=p.subdivide($,(J-Q)/(1-Q))[0];return U?[$[6],$[7],$[4],$[5],$[2],$[3],$[0],$[1]]:$},isFlatEnough:function($,Q){var J=$[0],U=$[1],Z=$[2],K=$[3],H=$[4],W=$[5],Y=$[6],F=$[7],A=3*Z-2*J-Y,V=3*K-2*U-F,O=3*H-2*Y-J,X=3*W-2*F-U;return Math.max(A*A,O*O)+Math.max(V*V,X*X)<=16*Q*Q},getArea:function($){var Q=$[0],J=$[1],U=$[2],Z=$[3],K=$[4],H=$[5],W=$[6],Y=$[7];return 3*((Y-J)*(U+K)-(W-Q)*(Z+H)+Z*(Q-K)-U*(J-H)+Y*(K+Q/3)-W*(H+J/3))/20},getBounds:function($){var Q=$.slice(0,2),J=Q.slice(),U=[0,0];for(var Z=0;Z<2;Z++)p._addBounds($[Z],$[Z+2],$[Z+4],$[Z+6],Z,0,Q,J,U);return new t(Q[0],Q[1],J[0]-Q[0],J[1]-Q[1])},_addBounds:function($,Q,J,U,Z,K,H,W,Y){function F(_,z){var G=_-z,C=_+z;if(G<H[Z])H[Z]=G;if(C>W[Z])W[Z]=C}K/=2;var A=H[Z]+K,V=W[Z]-K;if($<A||Q<A||J<A||U<A||$>V||Q>V||J>V||U>V)if(Q<$!=Q<U&&J<$!=J<U)F($,0),F(U,0);else{var O=3*(Q-J)-$+U,X=2*($+J)-4*Q,N=Q-$,L=Z0.solveQuadratic(O,X,N,Y),B=0.00000001,E=1-B;F(U,0);for(var R=0;R<L;R++){var T=Y[R],q=1-T;if(B<=T&&T<=E)F(q*q*q*$+3*q*q*T*Q+3*q*T*T*J+T*T*T*U,K)}}}}},S.each(["getBounds","getStrokeBounds","getHandleBounds"],function($){this[$]=function(){if(!this._bounds)this._bounds={};var Q=this._bounds[$];if(!Q)Q=this._bounds[$]=F0[$]([this._segment1,this._segment2],!1,this._path);return Q.clone()}},{}),S.each({isStraight:function($,Q,J,U){if(Q.isZero()&&J.isZero())return!0;else{var Z=U.subtract($);if(Z.isZero())return!1;else if(Z.isCollinear(Q)&&Z.isCollinear(J)){var K=new G0($,U),H=0.0000001;if(K.getDistance($.add(Q))<H&&K.getDistance(U.add(J))<H){var W=Z.dot(Z),Y=Z.dot(Q)/W,F=Z.dot(J)/W;return Y>=0&&Y<=1&&F<=0&&F>=-1}}}return!1},isLinear:function($,Q,J,U){var Z=U.subtract($).divide(3);return Q.equals(Z)&&J.negate().equals(Z)}},function($,Q){this[Q]=function(J){var U=this._segment1,Z=this._segment2;return $(U._point,U._handleOut,Z._handleIn,Z._point,J)},this.statics[Q]=function(J,U){var Z=J[0],K=J[1],H=J[6],W=J[7];return $(new y(Z,K),new y(J[2]-Z,J[3]-K),new y(J[4]-H,J[5]-W),new y(H,W),U)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function($){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>($||0)},isCollinear:function($){return $&&this.isStraight()&&$.isStraight()&&this.getLine().isCollinear($.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(0.5).y)<0.00000001},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(0.5).x)<0.00000001}}),{beans:!1,getLocationAt:function($,Q){return this.getLocationAtTime(Q?$:this.getTimeAt($))},getLocationAtTime:function($){return $!=null&&$>=0&&$<=1?new x0(this,$):null},getTimeAt:function($,Q){return p.getTimeAt(this.getValues(),$,Q)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var $=y.read(arguments);return $.isZero()?[]:p.getTimesWithTangent(this.getValues(),$)},getOffsetAtTime:function($){return this.getPartLength(0,$)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(y.read(arguments)))},getOffsetOf:function(){var $=this.getLocationOf.apply(this,arguments);return $?$.getOffset():null},getTimeOf:function(){return p.getTimeOf(this.getValues(),y.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var $=y.read(arguments),Q=this.getValues(),J=p.getNearestTime(Q,$),U=p.getPoint(Q,J);return new x0(this,J,U,null,$.getDistance(U))},getNearestPoint:function(){var $=this.getNearestLocation.apply(this,arguments);return $?$.getPoint():$}},new function(){var $=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return S.each($,function(Q){this[Q+"At"]=function(J,U){var Z=this.getValues();return p[Q](Z,U?J:p.getTimeAt(Z,J))},this[Q+"AtTime"]=function(J){return p[Q](this.getValues(),J)}},{statics:{_evaluateMethods:$}})},new function(){function $(U){var Z=U[0],K=U[1],H=U[2],W=U[3],Y=U[4],F=U[5],A=U[6],V=U[7],O=9*(H-Y)+3*(A-Z),X=6*(Z+Y)-12*H,N=3*(H-Z),L=9*(W-F)+3*(V-K),B=6*(K+F)-12*W,E=3*(W-K);return function(R){var T=(O*R+X)*R+N,q=(L*R+B)*R+E;return Math.sqrt(T*T+q*q)}}function Q(U,Z){return Math.max(2,Math.min(16,Math.ceil(Math.abs(Z-U)*32)))}function J(U,Z,K,H){if(Z==null||Z<0||Z>1)return null;var W=U[0],Y=U[1],F=U[2],A=U[3],V=U[4],O=U[5],X=U[6],N=U[7],L=Z0.isZero;if(L(F-W)&&L(A-Y))F=W,A=Y;if(L(V-X)&&L(O-N))V=X,O=N;var B=3*(F-W),E=3*(V-F)-B,R=X-W-B-E,T=3*(A-Y),q=3*(O-A)-T,_=N-Y-T-q,z,G;if(K===0)z=Z===0?W:Z===1?X:((R*Z+E)*Z+B)*Z+W,G=Z===0?Y:Z===1?N:((_*Z+q)*Z+T)*Z+Y;else{var C=0.00000001,P=1-C;if(Z<C)z=B,G=T;else if(Z>P)z=3*(X-V),G=3*(N-O);else z=(3*R*Z+2*E)*Z+B,G=(3*_*Z+2*q)*Z+T;if(H){if(z===0&&G===0&&(Z<C||Z>P))z=V-F,G=O-A;var j=Math.sqrt(z*z+G*G);if(j)z/=j,G/=j}if(K===3){var V=6*R*Z+2*E,O=6*_*Z+2*q,k=Math.pow(z*z+G*G,1.5);z=k!==0?(z*O-G*V)/k:0,G=0}}return K===2?new y(G,-z):new y(z,G)}return{statics:{classify:function(U){var Z=U[0],K=U[1],H=U[2],W=U[3],Y=U[4],F=U[5],A=U[6],V=U[7],O=Z*(V-F)+K*(Y-A)+A*F-V*Y,X=H*(K-V)+W*(A-Z)+Z*V-K*A,N=Y*(W-K)+F*(Z-H)+H*K-W*Z,L=3*N,B=L-X,E=B-X+O,R=Math.sqrt(E*E+B*B+L*L),T=R!==0?1/R:0,q=Z0.isZero,_="serpentine";E*=T,B*=T,L*=T;function z(j,k,x){var b=k!==I,f=b&&k>0&&k<1,h=b&&x>0&&x<1;if(b&&(!(f||h)||j==="loop"&&!(f&&h)))j="arch",f=h=!1;return{type:j,roots:f||h?f&&h?k<x?[k,x]:[x,k]:[f?k:x]:null}}if(q(E))return q(B)?z(q(L)?"line":"quadratic"):z(_,L/(3*B));var G=3*B*B-4*E*L;if(q(G))return z("cusp",B/(2*E));var C=G>0?Math.sqrt(G/3):Math.sqrt(-G),P=2*E;return z(G>0?_:"loop",(B+C)/P,(B-C)/P)},getLength:function(U,Z,K,H){if(Z===I)Z=0;if(K===I)K=1;if(p.isStraight(U)){var W=U;if(K<1)W=p.subdivide(W,K)[0],Z/=K;if(Z>0)W=p.subdivide(W,Z)[1];var Y=W[6]-W[0],F=W[7]-W[1];return Math.sqrt(Y*Y+F*F)}return Z0.integrate(H||$(U),Z,K,Q(Z,K))},getTimeAt:function(U,Z,K){if(K===I)K=Z<0?1:0;if(Z===0)return K;var H=Math.abs,W=0.000000000001,Y=Z>0,F=Y?K:0,A=Y?1:K,V=$(U),O=p.getLength(U,F,A,V),X=H(Z)-O;if(H(X)<W)return Y?A:F;else if(X>W)return null;var N=Z/O,L=0;function B(E){return L+=Z0.integrate(V,K,E,Q(K,E)),K=E,L-Z}return Z0.findRoot(B,V,K+N,F,A,32,0.000000000001)},getPoint:function(U,Z){return J(U,Z,0,!1)},getTangent:function(U,Z){return J(U,Z,1,!0)},getWeightedTangent:function(U,Z){return J(U,Z,1,!1)},getNormal:function(U,Z){return J(U,Z,2,!0)},getWeightedNormal:function(U,Z){return J(U,Z,2,!1)},getCurvature:function(U,Z){return J(U,Z,3,!1).x},getPeaks:function(U){var Z=U[0],K=U[1],H=U[2],W=U[3],Y=U[4],F=U[5],A=U[6],V=U[7],O=-Z+3*H-3*Y+A,X=3*Z-6*H+3*Y,N=-3*Z+3*H,L=-K+3*W-3*F+V,B=3*K-6*W+3*F,E=-3*K+3*W,R=0.00000001,T=1-R,q=[];return Z0.solveCubic(9*(O*O+L*L),9*(O*X+B*L),2*(X*X+B*B)+3*(N*O+E*L),N*X+B*E,q,R,T),q.sort()}}}},new function(){function $(X,N,L,B,E,R,T){var q=!T&&L.getPrevious()===E,_=!T&&L!==E&&L.getNext()===E,z=0.00000001,G=1-z;if(B!==null&&B>=(q?z:0)&&B<=(_?G:1)){if(R!==null&&R>=(_?z:0)&&R<=(q?G:1)){var C=new x0(L,B,null,T),P=new x0(E,R,null,T);if(C._intersection=P,P._intersection=C,!N||N(C))x0.insert(X,C,!0)}}}function Q(X,N,L,B,E,R,T,q,_,z,G,C,P){if(++_>=4096||++q>=40)return _;var j=0.000000001,k=N[0],x=N[1],b=N[6],f=N[7],h=G0.getSignedDistance,u=h(k,x,b,f,N[2],N[3]),v=h(k,x,b,f,N[4],N[5]),m=u*v>0?0.75:0.4444444444444444,d=m*Math.min(0,u,v),l=m*Math.max(0,u,v),r=h(k,x,b,f,X[0],X[1]),n=h(k,x,b,f,X[2],X[3]),e=h(k,x,b,f,X[4],X[5]),c=h(k,x,b,f,X[6],X[7]),J0=J(r,n,e,c),o=J0[0],X0=J0[1],U0,H0;if(u===0&&v===0&&r===0&&n===0&&e===0&&c===0||(U0=U(o,X0,d,l))==null||(H0=U(o.reverse(),X0.reverse(),d,l))==null)return _;var Y0=z+(G-z)*U0,K0=z+(G-z)*H0;if(Math.max(P-C,K0-Y0)<j){var S0=(Y0+K0)/2,C0=(C+P)/2;$(E,R,T?B:L,T?C0:S0,T?L:B,T?S0:C0)}else{X=p.getPart(X,U0,H0);var w0=P-C;if(H0-U0>0.8)if(K0-Y0>w0){var M0=p.subdivide(X,0.5),S0=(Y0+K0)/2;_=Q(N,M0[0],B,L,E,R,!T,q,_,C,P,Y0,S0),_=Q(N,M0[1],B,L,E,R,!T,q,_,C,P,S0,K0)}else{var M0=p.subdivide(N,0.5),C0=(C+P)/2;_=Q(M0[0],X,B,L,E,R,!T,q,_,C,C0,Y0,K0),_=Q(M0[1],X,B,L,E,R,!T,q,_,C0,P,Y0,K0)}else if(w0===0||w0>=j)_=Q(N,X,B,L,E,R,!T,q,_,C,P,Y0,K0);else _=Q(X,N,L,B,E,R,T,q,_,Y0,K0,C,P)}return _}function J(X,N,L,B){var E=[0,X],R=[0.3333333333333333,N],T=[0.6666666666666666,L],q=[1,B],_=N-(2*X+B)/3,z=L-(X+2*B)/3,G;if(_*z<0)G=[[E,R,q],[E,T,q]];else{var C=_/z;G=[C>=2?[E,R,q]:C<=0.5?[E,T,q]:[E,R,T,q],[E,q]]}return(_||z)<0?G.reverse():G}function U(X,N,L,B){if(X[0][1]<L)return Z(X,!0,L);else if(N[0][1]>B)return Z(N,!1,B);else return X[0][0]}function Z(X,N,L){var B=X[0][0],E=X[0][1];for(var R=1,T=X.length;R<T;R++){var q=X[R][0],_=X[R][1];if(N?_>=L:_<=L)return _===L?q:B+(L-E)*(q-B)/(_-E);B=q,E=_}return null}function K(X,N,L,B,E){var R=Z0.isZero;if(R(B)&&R(E)){var T=p.getTimeOf(X,new y(N,L));return T===null?[]:[T]}var q=Math.atan2(-E,B),_=Math.sin(q),z=Math.cos(q),G=[],C=[];for(var P=0;P<8;P+=2){var j=X[P]-N,k=X[P+1]-L;G.push(j*z-k*_,j*_+k*z)}return p.solveCubic(G,1,0,C,0,1),C}function H(X,N,L,B,E,R,T){var q=N[0],_=N[1],z=N[6],G=N[7],C=K(X,q,_,z-q,G-_);for(var P=0,j=C.length;P<j;P++){var k=C[P],x=p.getPoint(X,k),b=p.getTimeOf(N,x);if(b!==null)$(E,R,T?B:L,T?b:k,T?L:B,T?k:b)}}function W(X,N,L,B,E,R){var T=G0.intersect(X[0],X[1],X[6],X[7],N[0],N[1],N[6],N[7]);if(T)$(E,R,L,p.getTimeOf(X,T),B,p.getTimeOf(N,T))}function Y(X,N,L,B,E,R){var T=0.000000000001,q=Math.min,_=Math.max;if(_(X[0],X[2],X[4],X[6])+T>q(N[0],N[2],N[4],N[6])&&q(X[0],X[2],X[4],X[6])-T<_(N[0],N[2],N[4],N[6])&&_(X[1],X[3],X[5],X[7])+T>q(N[1],N[3],N[5],N[7])&&q(X[1],X[3],X[5],X[7])-T<_(N[1],N[3],N[5],N[7])){var z=V(X,N);if(z)for(var G=0;G<2;G++){var C=z[G];$(E,R,L,C[0],B,C[1],!0)}else{var P=p.isStraight(X),j=p.isStraight(N),k=P&&j,x=P&&!j,b=E.length;if((k?W:P||j?H:Q)(x?N:X,x?X:N,x?B:L,x?L:B,E,R,x,0,0,0,1,0,1),!k||E.length===b)for(var G=0;G<4;G++){var f=G>>1,h=G&1,u=f*6,v=h*6,m=new y(X[u],X[u+1]),d=new y(N[v],N[v+1]);if(m.isClose(d,T))$(E,R,L,f,B,h)}}}return E}function F(X,N,L,B){var E=p.classify(X);if(E.type==="loop"){var R=E.roots;$(L,B,N,R[0],N,R[1])}return L}function A(X,N,L,B,E,R){var T=0.0000001,q=!N;if(q)N=X;var _=X.length,z=N.length,G=new Array(_),C=q?G:new Array(z),P=[];for(var j=0;j<_;j++)G[j]=X[j].getValues(B);if(!q)for(var j=0;j<z;j++)C[j]=N[j].getValues(E);var k=O0.findCurveBoundsCollisions(G,C,T);for(var x=0;x<_;x++){var b=X[x],f=G[x];if(q)F(f,b,P,L);var h=k[x];if(h)for(var u=0;u<h.length;u++){if(R&&P.length)return P;var v=h[u];if(!q||v>x){var m=N[v],d=C[v];Y(f,d,b,m,P,L)}}}return P}function V(X,N){function L(c){var J0=c[6]-c[0],o=c[7]-c[1];return J0*J0+o*o}var B=Math.abs,E=G0.getDistance,R=0.00000001,T=0.0000001,q=p.isStraight(X),_=p.isStraight(N),z=q&&_,G=L(X)<L(N),C=G?N:X,P=G?X:N,j=C[0],k=C[1],x=C[6]-j,b=C[7]-k;if(E(j,k,x,b,P[0],P[1],!0)<T&&E(j,k,x,b,P[6],P[7],!0)<T){if(!z&&E(j,k,x,b,C[2],C[3],!0)<T&&E(j,k,x,b,C[4],C[5],!0)<T&&E(j,k,x,b,P[2],P[3],!0)<T&&E(j,k,x,b,P[4],P[5],!0)<T)q=_=z=!0}else if(z)return null;if(q^_)return null;var f=[X,N],h=[];for(var u=0;u<4&&h.length<2;u++){var v=u&1,m=v^1,d=u>>1,l=p.getTimeOf(f[v],new y(f[m][d?6:0],f[m][d?7:1]));if(l!=null){var r=v?[d,l]:[l,d];if(!h.length||B(r[0]-h[0][0])>R&&B(r[1]-h[0][1])>R)h.push(r)}if(u>2&&!h.length)break}if(h.length!==2)h=null;else if(!z){var n=p.getPart(X,h[0][0],h[1][0]),e=p.getPart(N,h[0][1],h[1][1]);if(B(e[2]-n[2])>T||B(e[3]-n[3])>T||B(e[4]-n[4])>T||B(e[5]-n[5])>T)h=null}return h}function O(X,N){var L=X[0],B=X[1],E=X[2],R=X[3],T=X[4],q=X[5],_=X[6],z=X[7],G=N.normalize(),C=G.x,P=G.y,j=3*_-9*T+9*E-3*L,k=3*z-9*q+9*R-3*B,x=6*T-12*E+6*L,b=6*q-12*R+6*B,f=3*E-3*L,h=3*R-3*B,u=2*j*P-2*k*C,v=[];if(Math.abs(u)<Z0.CURVETIME_EPSILON){var m=j*h-k*f,u=j*b-k*x;if(u!=0){var d=-m/u;if(d>=0&&d<=1)v.push(d)}}else{var l=(x*x-4*j*f)*P*P+(-2*x*b+4*k*f+4*j*h)*C*P+(b*b-4*k*h)*C*C,r=x*P-b*C;if(l>=0&&u!=0){var n=Math.sqrt(l),e=-(r+n)/u,c=(-r+n)/u;if(e>=0&&e<=1)v.push(e);if(c>=0&&c<=1)v.push(c)}}return v}return{getIntersections:function(X){var N=this.getValues(),L=X&&X!==this&&X.getValues();return L?Y(N,L,this,X,[]):F(N,this,[])},statics:{getOverlaps:V,getIntersections:A,getCurveLineIntersections:K,getTimesWithTangent:O}}}),x0=S.extend({_class:"CurveLocation",initialize:function $(Q,J,U,Z,K){if(J>=0.99999999){var H=Q.getNext();if(H)J=0,Q=H}this._setCurve(Q),this._time=J,this._point=U||Q.getPointAtTime(J),this._overlap=Z,this._distance=K,this._intersection=this._next=this._previous=null},_setPath:function($){this._path=$,this._version=$?$._version:0},_setCurve:function($){this._setPath($._path),this._curve=$,this._segment=null,this._segment1=$._segment1,this._segment2=$._segment2},_setSegment:function($){var Q=$.getCurve();if(Q)this._setCurve(Q);else this._setPath($._path),this._segment1=$,this._segment2=null;this._segment=$,this._time=$===this._segment1?0:1,this._point=$._point.clone()},getSegment:function(){var $=this._segment;if(!$){var Q=this.getCurve(),J=this.getTime();if(J===0)$=Q._segment1;else if(J===1)$=Q._segment2;else if(J!=null)$=Q.getPartLength(0,J)<Q.getPartLength(J,1)?Q._segment1:Q._segment2;this._segment=$}return $},getCurve:function(){var $=this._path,Q=this;if($&&$._version!==this._version)this._time=this._offset=this._curveOffset=this._curve=null;function J(U){var Z=U&&U.getCurve();if(Z&&(Q._time=Z.getTimeOf(Q._point))!=null)return Q._setCurve(Z),Z}return this._curve||J(this._segment)||J(this._segment1)||J(this._segment2.getPrevious())},getPath:function(){var $=this.getCurve();return $&&$._path},getIndex:function(){var $=this.getCurve();return $&&$.getIndex()},getTime:function(){var $=this.getCurve(),Q=this._time;return $&&Q==null?this._time=$.getTimeOf(this._point):Q},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var $=this._offset;if($==null){$=0;var Q=this.getPath(),J=this.getIndex();if(Q&&J!=null){var U=Q.getCurves();for(var Z=0;Z<J;Z++)$+=U[Z].getLength()}this._offset=$+=this.getCurveOffset()}return $},getCurveOffset:function(){var $=this._curveOffset;if($==null){var Q=this.getCurve(),J=this.getTime();this._curveOffset=$=J!=null&&Q&&Q.getPartLength(0,J)}return $},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var $=this.getCurve(),Q=$&&$.divideAtTime(this.getTime());if(Q)this._setSegment(Q._segment1);return Q},split:function(){var $=this.getCurve(),Q=$._path,J=$&&$.splitAtTime(this.getTime());if(J)this._setSegment(Q.getLastSegment());return J},equals:function($,Q){var J=this===$;if(!J&&$ instanceof x0){var U=this.getCurve(),Z=$.getCurve(),K=U._path,H=Z._path;if(K===H){var W=Math.abs,Y=0.0000001,F=W(this.getOffset()-$.getOffset()),A=!Q&&this._intersection,V=!Q&&$._intersection;J=(F<Y||K&&W(K.getLength()-F)<Y)&&(!A&&!V||A&&V&&A.equals(V,!0))}}return J},toString:function(){var $=[],Q=this.getPoint(),J=D0.instance;if(Q)$.push("point: "+Q);var U=this.getIndex();if(U!=null)$.push("index: "+U);var Z=this.getTime();if(Z!=null)$.push("time: "+J.number(Z));if(this._distance!=null)$.push("distance: "+J.number(this._distance));return"{ "+$.join(", ")+" }"},isTouching:function(){var $=this._intersection;if($&&this.getTangent().isCollinear($.getTangent())){var Q=this.getCurve(),J=$.getCurve();return!(Q.isStraight()&&J.isStraight()&&Q.getLine().intersect(J.getLine()))}return!1},isCrossing:function(){var $=this._intersection;if(!$)return!1;var Q=this.getTime(),J=$.getTime(),U=0.00000001,Z=1-U,K=Q>=U&&Q<=Z,H=J>=U&&J<=Z;if(K&&H)return!this.isTouching();var W=this.getCurve(),Y=W&&Q<U?W.getPrevious():W,F=$.getCurve(),A=F&&J<U?F.getPrevious():F;if(Q>Z)W=W.getNext();if(J>Z)F=F.getNext();if(!Y||!W||!A||!F)return!1;var V=[];function O(C,P){var j=C.getValues(),k=p.classify(j).roots||p.getPeaks(j),x=k.length,b=p.getLength(j,P&&x?k[x-1]:0,!P&&x?k[0]:1);V.push(x?b:b/32)}function X(C,P,j){return P<j?C>P&&C<j:C>P||C<j}if(!K)O(Y,!0),O(W,!1);if(!H)O(A,!0),O(F,!1);var N=this.getPoint(),L=Math.min.apply(Math,V),B=K?W.getTangentAtTime(Q):W.getPointAt(L).subtract(N),E=K?B.negate():Y.getPointAt(-L).subtract(N),R=H?F.getTangentAtTime(J):F.getPointAt(L).subtract(N),T=H?R.negate():A.getPointAt(-L).subtract(N),q=E.getAngle(),_=B.getAngle(),z=T.getAngle(),G=R.getAngle();return!!(K?X(q,z,G)^X(_,z,G)&&X(q,G,z)^X(_,G,z):X(z,q,_)^X(G,q,_)&&X(z,_,q)^X(G,_,q))},hasOverlap:function(){return!!this._overlap}},S.each(p._evaluateMethods,function($){var Q=$+"At";this[$]=function(){var J=this.getCurve(),U=this.getTime();return U!=null&&J&&J[Q](U,!0)}},{preserve:!0}),new function(){function $(Q,J,U){var Z=Q.length,K=0,H=Z-1;function W(N,L){for(var B=N+L;B>=-1&&B<=Z;B+=L){var E=Q[(B%Z+Z)%Z];if(!J.getPoint().isClose(E.getPoint(),0.0000001))break;if(J.equals(E))return E}return null}while(K<=H){var Y=K+H>>>1,F=Q[Y],A;if(U&&(A=J.equals(F)?F:W(Y,-1)||W(Y,1))){if(J._overlap)A._overlap=A._intersection._overlap=!0;return A}var V=J.getPath(),O=F.getPath(),X=V!==O?V._id-O._id:J.getIndex()+J.getTime()-(F.getIndex()+F.getTime());if(X<0)H=Y-1;else K=Y+1}return Q.splice(K,0,J),J}return{statics:{insert:$,expand:function(Q){var J=Q.slice();for(var U=Q.length-1;U>=0;U--)$(J,Q[U]._intersection,!1);return J}}}}),o0=Q0.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function $(){},statics:{create:function($){var Q,J,U;if(S.isPlainObject($))J=$.segments,Q=$.pathData;else if(Array.isArray($))J=$;else if(typeof $==="string")Q=$;if(J){var Z=J[0];U=Z&&Array.isArray(Z[0])}else if(Q)U=(Q.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(Q);var K=U?u0:F0;return new K($)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function($){if(this.isClockwise()!=($=!!$))this.reverse()},setPathData:function($){var Q=$&&$.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),J,U=!1,Z,K,H=new y,W=new y;function Y(T,q){var _=+J[T];if(U)_+=H[q];return _}function F(T){return new y(Y(T,"x"),Y(T+1,"y"))}this.clear();for(var A=0,V=Q&&Q.length;A<V;A++){var O=Q[A],X=O[0],N=X.toLowerCase();J=O.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var L=J&&J.length;if(U=X===N,Z==="z"&&!/[mz]/.test(N))this.moveTo(H);switch(N){case"m":case"l":var B=N==="m";for(var E=0;E<L;E+=2)if(this[B?"moveTo":"lineTo"](H=F(E)),B)W=H,B=!1;K=H;break;case"h":case"v":var R=N==="h"?"x":"y";H=H.clone();for(var E=0;E<L;E++)H[R]=Y(E,R),this.lineTo(H);K=H;break;case"c":for(var E=0;E<L;E+=6)this.cubicCurveTo(F(E),K=F(E+2),H=F(E+4));break;case"s":for(var E=0;E<L;E+=4)this.cubicCurveTo(/[cs]/.test(Z)?H.multiply(2).subtract(K):H,K=F(E),H=F(E+2)),Z=N;break;case"q":for(var E=0;E<L;E+=4)this.quadraticCurveTo(K=F(E),H=F(E+2));break;case"t":for(var E=0;E<L;E+=2)this.quadraticCurveTo(K=/[qt]/.test(Z)?H.multiply(2).subtract(K):H,H=F(E)),Z=N;break;case"a":for(var E=0;E<L;E+=7)this.arcTo(H=F(E+5),new s(+J[E],+J[E+1]),+J[E+2],+J[E+4],+J[E+3]);break;case"z":this.closePath(0.000000000001),H=W;break}Z=N}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function($){var Q=$.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding($):{};return Q.onPath||!!(this.getFillRule()==="evenodd"?Q.windingL&1||Q.windingR&1:Q.winding)},getIntersections:function($,Q,J,U){var Z=this===$||!$,K=this._matrix._orNullIfIdentity(),H=Z?K:(J||$._matrix)._orNullIfIdentity();return Z||this.getBounds(K).intersects($.getBounds(H),0.000000000001)?p.getIntersections(this.getCurves(),!Z&&$.getCurves(),Q,K,H,U):[]},getCrossings:function($){return this.getIntersections($,function(Q){return Q.isCrossing()})},getNearestLocation:function(){var $=y.read(arguments),Q=this.getCurves(),J=Infinity,U=null;for(var Z=0,K=Q.length;Z<K;Z++){var H=Q[Z].getNearestLocation($);if(H._distance<J)J=H._distance,U=H}return U},getNearestPoint:function(){var $=this.getNearestLocation.apply(this,arguments);return $?$.getPoint():$},interpolate:function($,Q,J){var U=!this._children,Z=U?"_segments":"_children",K=$[Z],H=Q[Z],W=this[Z];if(!K||!H||K.length!==H.length)throw new Error("Invalid operands in interpolate() call: "+$+", "+Q);var Y=W.length,F=H.length;if(Y<F){var A=U?i:F0;for(var V=Y;V<F;V++)this.add(new A)}else if(Y>F)this[U?"removeSegments":"removeChildren"](F,Y);for(var V=0;V<F;V++)W[V].interpolate(K[V],H[V],J);if(U)this.setClosed($._closed),this._changed(9)},compare:function($){var Q=!1;if($){var J=this._children||[this],U=$._children?$._children.slice():[$],Z=J.length,K=U.length,H=[],W=0;Q=!0;var Y=O0.findItemBoundsCollisions(J,U,Z0.GEOMETRIC_EPSILON);for(var F=Z-1;F>=0&&Q;F--){var A=J[F];Q=!1;var V=Y[F];if(V){for(var O=V.length-1;O>=0&&!Q;O--)if(A.compare(U[V[O]])){if(!H[V[O]])H[V[O]]=!0,W++;Q=!0}}}Q=Q&&W===K}return Q}}),F0=o0.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function $(Q){this._closed=!1,this._segments=[],this._version=0;var J=arguments,U=Array.isArray(Q)?typeof Q[0]==="object"?Q:J:Q&&(Q.size===I&&(Q.x!==I||Q.point!==I))?J:null;if(U&&U.length>0)this.setSegments(U);else if(this._curves=I,this._segmentSelection=0,!U&&typeof Q==="string")this.setPathData(Q),Q=null;this._initialize(!U&&Q)},_equals:function($){return this._closed===$._closed&&S.equals(this._segments,$._segments)},copyContent:function($){this.setSegments($._segments),this._closed=$._closed},_changed:function $(Q){if($.base.call(this,Q),Q&8){if(this._length=this._area=I,Q&32)this._version++;else if(this._curves)for(var J=0,U=this._curves.length;J<U;J++)this._curves[J]._changed()}else if(Q&64)this._bounds=I},getStyle:function(){var $=this._parent;return($ instanceof u0?$:this)._style},getSegments:function(){return this._segments},setSegments:function($){var Q=this.isFullySelected(),J=$&&$.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=I,J){var U=$[J-1];if(typeof U==="boolean")this.setClosed(U),J--;this._add(i.readList($,0,{},J))}if(Q)this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var $=this._curves,Q=this._segments;if(!$){var J=this._countCurves();$=this._curves=new Array(J);for(var U=0;U<J;U++)$[U]=new p(this,Q[U],Q[U+1]||Q[0])}return $},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var $=this.getCurves();return $[$.length-1]},isClosed:function(){return this._closed},setClosed:function($){if(this._closed!=($=!!$)){if(this._closed=$,this._curves){var Q=this._curves.length=this._countCurves();if($)this._curves[Q-1]=new p(this,this._segments[Q-1],this._segments[0])}this._changed(41)}}},{beans:!0,getPathData:function($,Q){var J=this._segments,U=J.length,Z=new D0(Q),K=new Array(6),H=!0,W,Y,F,A,V,O,X,N,L=[];function B(R,T){if(R._transformCoordinates($,K),W=K[0],Y=K[1],H)L.push("M"+Z.pair(W,Y)),H=!1;else if(V=K[2],O=K[3],V===W&&O===Y&&X===F&&N===A){if(!T){var q=W-F,_=Y-A;L.push(q===0?"v"+Z.number(_):_===0?"h"+Z.number(q):"l"+Z.pair(q,_))}}else L.push("c"+Z.pair(X-F,N-A)+" "+Z.pair(V-F,O-A)+" "+Z.pair(W-F,Y-A));F=W,A=Y,X=K[4],N=K[5]}if(!U)return"";for(var E=0;E<U;E++)B(J[E]);if(this._closed&&U>0)B(J[0],!0),L.push("z");return L.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function($){var Q=this._segments,J=new Array(6);for(var U=0,Z=Q.length;U<Z;U++)Q[U]._transformCoordinates($,J,!0);return!0},_add:function($,H){var J=this._segments,U=this._curves,Z=$.length,K=H==null,H=K?J.length:H;for(var W=0;W<Z;W++){var Y=$[W];if(Y._path)Y=$[W]=Y.clone();if(Y._path=this,Y._index=H+W,Y._selection)this._updateSelection(Y,0,Y._selection)}if(K)S.push(J,$);else{J.splice.apply(J,[H,0].concat($));for(var W=H+Z,F=J.length;W<F;W++)J[W]._index=W}if(U){var A=this._countCurves(),V=H>0&&H+Z-1===A?H-1:H,O=V,X=Math.min(V+Z,A);if($._curves)U.splice.apply(U,[V,0].concat($._curves)),O+=$._curves.length;for(var W=O;W<X;W++)U.splice(W,0,new p(this,null,null));this._adjustCurves(V,X)}return this._changed(41),$},_adjustCurves:function($,Q){var J=this._segments,U=this._curves,Z;for(var K=$;K<Q;K++)Z=U[K],Z._path=this,Z._segment1=J[K],Z._segment2=J[K+1]||J[0],Z._changed();if(Z=U[this._closed&&!$?J.length-1:$-1])Z._segment2=J[$]||J[0],Z._changed();if(Z=U[Q])Z._segment1=J[Q],Z._changed()},_countCurves:function(){var $=this._segments.length;return!this._closed&&$>0?$-1:$},add:function($){var Q=arguments;return Q.length>1&&typeof $!=="number"?this._add(i.readList(Q)):this._add([i.read(Q)])[0]},insert:function($,Q){var J=arguments;return J.length>2&&typeof Q!=="number"?this._add(i.readList(J,1),$):this._add([i.read(J,1)],$)[0]},addSegment:function(){return this._add([i.read(arguments)])[0]},insertSegment:function($){return this._add([i.read(arguments,1)],$)[0]},addSegments:function($){return this._add(i.readList($))},insertSegments:function($,Q){return this._add(i.readList(Q),$)},removeSegment:function($){return this.removeSegments($,$+1)[0]||null},removeSegments:function($,Q,J){$=$||0,Q=S.pick(Q,this._segments.length);var U=this._segments,Z=this._curves,K=U.length,H=U.splice($,Q-$),W=H.length;if(!W)return H;for(var Y=0;Y<W;Y++){var F=H[Y];if(F._selection)this._updateSelection(F,F._selection,0);F._index=F._path=null}for(var Y=$,A=U.length;Y<A;Y++)U[Y]._index=Y;if(Z){var V=$>0&&Q===K+(this._closed?1:0)?$-1:$,Z=Z.splice(V,W);for(var Y=Z.length-1;Y>=0;Y--)Z[Y]._path=null;if(J)H._curves=Z.slice(1);this._adjustCurves(V,V)}return this._changed(41),H},clear:"#removeSegments",hasHandles:function(){var $=this._segments;for(var Q=0,J=$.length;Q<J;Q++)if($[Q].hasHandles())return!0;return!1},clearHandles:function(){var $=this._segments;for(var Q=0,J=$.length;Q<J;Q++)$[Q].clearHandles()},getLength:function(){if(this._length==null){var $=this.getCurves(),Q=0;for(var J=0,U=$.length;J<U;J++)Q+=$[J].getLength();this._length=Q}return this._length},getArea:function(){var $=this._area;if($==null){var Q=this._segments,J=this._closed;$=0;for(var U=0,Z=Q.length;U<Z;U++){var K=U+1===Z;$+=p.getArea(p.getValues(Q[U],Q[K?0:U+1],null,K&&!J))}this._area=$}return $},isFullySelected:function(){var $=this._segments.length;return this.isSelected()&&$>0&&this._segmentSelection===$*7},setFullySelected:function($){if($)this._selectSegments(!0);this.setSelected($)},setSelection:function $(Q){if(!(Q&1))this._selectSegments(!1);$.base.call(this,Q)},_selectSegments:function($){var Q=this._segments,J=Q.length,U=$?7:0;this._segmentSelection=U*J;for(var Z=0;Z<J;Z++)Q[Z]._selection=U},_updateSelection:function($,Q,J){$._selection=J;var U=this._segmentSelection+=J-Q;if(U>0)this.setSelected(!0)},divideAt:function($){var Q=this.getLocationAt($),J;return Q&&(J=Q.getCurve().divideAt(Q.getCurveOffset()))?J._segment1:null},splitAt:function($){var Q=this.getLocationAt($),J=Q&&Q.index,U=Q&&Q.time,Z=0.00000001,K=1-Z;if(U>K)J++,U=0;var H=this.getCurves();if(J>=0&&J<H.length){if(U>=Z)H[J++].divideAtTime(U);var W=this.removeSegments(J,this._segments.length,!0),Y;if(this._closed)this.setClosed(!1),Y=this;else Y=new F0(Q0.NO_INSERT),Y.insertAbove(this),Y.copyAttributes(this);return Y._add(W,0),this.addSegment(W[0]),Y}return null},split:function($,Q){var J,U=Q===I?$:(J=this.getCurves()[$])&&J.getLocationAtTime(Q);return U!=null?this.splitAt(U):null},join:function($,Q){var J=Q||0;if($&&$!==this){var U=$._segments,Z=this.getLastSegment(),K=$.getLastSegment();if(!K)return this;if(Z&&Z._point.isClose(K._point,J))$.reverse();var H=$.getFirstSegment();if(Z&&Z._point.isClose(H._point,J))Z.setHandleOut(H._handleOut),this._add(U.slice(1));else{var W=this.getFirstSegment();if(W&&W._point.isClose(H._point,J))$.reverse();if(K=$.getLastSegment(),W&&W._point.isClose(K._point,J))W.setHandleIn(K._handleIn),this._add(U.slice(0,U.length-1),0);else this._add(U.slice())}if($._closed)this._add([U[0]]);$.remove()}var Y=this.getFirstSegment(),F=this.getLastSegment();if(Y!==F&&Y._point.isClose(F._point,J))Y.setHandleIn(F._handleIn),F.remove(),this.setClosed(!0);return this},reduce:function($){var Q=this.getCurves(),J=$&&$.simplify,U=J?0.0000001:0;for(var Z=Q.length-1;Z>=0;Z--){var K=Q[Z];if(!K.hasHandles()&&(!K.hasLength(U)||J&&K.isCollinear(K.getNext())))K.remove()}return this},reverse:function(){this._segments.reverse();for(var $=0,Q=this._segments.length;$<Q;$++){var J=this._segments[$],U=J._handleIn;J._handleIn=J._handleOut,J._handleOut=U,J._index=$}this._curves=null,this._changed(9)},flatten:function($){var Q=new R8(this,$||0.25,256,!0),J=Q.parts,U=J.length,Z=[];for(var K=0;K<U;K++)Z.push(new i(J[K].curve.slice(0,2)));if(!this._closed&&U>0)Z.push(new i(J[U-1].curve.slice(6)));this.setSegments(Z)},simplify:function($){var Q=new u8(this).fit($||2.5);if(Q)this.setSegments(Q);return!!Q},smooth:function($){var Q=this,J=$||{},U=J.type||"asymmetric",Z=this._segments,K=Z.length,H=this._closed;function W(o,X0){var U0=o&&o.index;if(U0!=null){var H0=o.path;if(H0&&H0!==Q)throw new Error(o._class+" "+U0+" of "+H0+" is not part of "+Q);if(X0&&o instanceof p)U0++}else U0=typeof o==="number"?o:X0;return Math.min(U0<0&&H?U0%K:U0<0?U0+K:U0,K-1)}var Y=H&&J.from===I&&J.to===I,F=W(J.from,0),A=W(J.to,K-1);if(F>A)if(H)F-=K;else{var V=F;F=A,A=V}if(/^(?:asymmetric|continuous)$/.test(U)){var O=U==="asymmetric",X=Math.min,N=A-F+1,L=N-1,B=Y?X(N,4):1,E=B,R=B,T=[];if(!H)E=X(1,F),R=X(1,K-A-1);if(L+=E+R,L<=1)return;for(var q=0,_=F-E;q<=L;q++,_++)T[q]=Z[(_<0?_+K:_)%K]._point;var z=T[0]._x+2*T[1]._x,G=T[0]._y+2*T[1]._y,C=2,P=L-1,j=[z],k=[G],x=[C],b=[],f=[];for(var q=1;q<L;q++){var h=q<P,u=h?1:O?1:2,v=h?4:O?2:7,m=h?4:O?3:8,d=h?2:O?0:1,l=u/C;C=x[q]=v-l,z=j[q]=m*T[q]._x+d*T[q+1]._x-l*z,G=k[q]=m*T[q]._y+d*T[q+1]._y-l*G}b[P]=j[P]/x[P],f[P]=k[P]/x[P];for(var q=L-2;q>=0;q--)b[q]=(j[q]-b[q+1])/x[q],f[q]=(k[q]-f[q+1])/x[q];b[L]=(3*T[L]._x-b[P])/2,f[L]=(3*T[L]._y-f[P])/2;for(var q=E,r=L-R,_=F;q<=r;q++,_++){var n=Z[_<0?_+K:_],e=n._point,c=b[q]-e._x,J0=f[q]-e._y;if(Y||q<r)n.setHandleOut(c,J0);if(Y||q>E)n.setHandleIn(-c,-J0)}}else for(var q=F;q<=A;q++)Z[q<0?q+K:q].smooth(J,!Y&&q===F,!Y&&q===A)},toShape:function($){if(!this._closed)return null;var Q=this._segments,J,U,Z,K;function H(O,X){var N=Q[O],L=N.getNext(),B=Q[X],E=B.getNext();return N._handleOut.isZero()&&L._handleIn.isZero()&&B._handleOut.isZero()&&E._handleIn.isZero()&&L._point.subtract(N._point).isCollinear(E._point.subtract(B._point))}function W(O){var X=Q[O],N=X.getPrevious(),L=X.getNext();return N._handleOut.isZero()&&X._handleIn.isZero()&&X._handleOut.isZero()&&L._handleIn.isZero()&&X._point.subtract(N._point).isOrthogonal(L._point.subtract(X._point))}function Y(O){var X=Q[O],N=X.getNext(),L=X._handleOut,B=N._handleIn,E=0.5522847498307936;if(L.isOrthogonal(B)){var R=X._point,T=N._point,q=new G0(R,L,!0).intersect(new G0(T,B,!0),!0);return q&&Z0.isZero(L.getLength()/q.subtract(R).getLength()-E)&&Z0.isZero(B.getLength()/q.subtract(T).getLength()-E)}return!1}function F(O,X){return Q[O]._point.getDistance(Q[X]._point)}if(!this.hasHandles()&&Q.length===4&&H(0,2)&&H(1,3)&&W(1))J=k0.Rectangle,U=new s(F(0,3),F(0,1)),K=Q[1]._point.add(Q[2]._point).divide(2);else if(Q.length===8&&Y(0)&&Y(2)&&Y(4)&&Y(6)&&H(1,5)&&H(3,7))J=k0.Rectangle,U=new s(F(1,6),F(0,3)),Z=U.subtract(new s(F(0,7),F(1,2))).divide(2),K=Q[3]._point.add(Q[4]._point).divide(2);else if(Q.length===4&&Y(0)&&Y(1)&&Y(2)&&Y(3)){if(Z0.isZero(F(0,2)-F(1,3)))J=k0.Circle,Z=F(0,2)/2;else J=k0.Ellipse,Z=new s(F(2,0)/2,F(3,1)/2);K=Q[1]._point}if(J){var A=this.getPosition(!0),V=new J({center:A,size:U,radius:Z,insert:!1});if(V.copyAttributes(this,!0),V._matrix.prepend(this._matrix),V.rotate(K.subtract(A).getAngle()+90),$===I||$)V.insertAbove(this);return V}return null},toPath:"#clone",compare:function $(Q){if(!Q||Q instanceof u0)return $.base.call(this,Q);var J=this.getCurves(),U=Q.getCurves(),Z=J.length,K=U.length;if(!Z||!K)return Z==K;var H=J[0].getValues(),W=[],Y=0,F,A=0,V;for(var O=0;O<K;O++){var B=U[O].getValues();W.push(B);var X=p.getOverlaps(H,B);if(X){F=!O&&X[0][0]>0?K-1:O,V=X[0][1];break}}var N=Math.abs,L=0.00000001,B=W[F],E;while(H&&B){var X=p.getOverlaps(H,B);if(X){var R=X[0][0];if(N(R-A)<L){if(A=X[1][0],A===1)H=++Y<Z?J[Y].getValues():null,A=0;var T=X[0][1];if(N(T-V)<L){if(!E)E=[F,T];if(V=X[1][1],V===1){if(++F>=K)F=0;B=W[F]||U[F].getValues(),V=0}if(!H)return E[0]===F&&E[1]===V;continue}}}break}return!1},_hitTestSelf:function($,Q,J,U){var Z=this,K=this.getStyle(),H=this._segments,W=H.length,Y=this._closed,F=Q._tolerancePadding,A=F,V,O,X,N,L,B,E=Q.stroke&&K.hasStroke(),R=Q.fill&&K.hasFill(),T=Q.curves,q=E?K.getStrokeWidth()/2:R&&Q.tolerance>0||T?0:null;if(q!==null)if(q>0)V=K.getStrokeJoin(),O=K.getStrokeCap(),X=K.getMiterLimit(),A=A.add(F0._getStrokePadding(q,U));else V=O="round";function _(b,f){return $.subtract(b).divide(f).length<=1}function z(b,f,h){if(!Q.selected||f.isSelected()){var u=b._point;if(f!==u)f=f.add(u);if(_(f,A))return new m0(h,Z,{segment:b,point:f})}}function G(b,f){return(f||Q.segments)&&z(b,b._point,"segment")||!f&&Q.handles&&(z(b,b._handleIn,"handle-in")||z(b,b._handleOut,"handle-out"))}function C(b){N.add(b)}function P(b){var f=Y||b._index>0&&b._index<W-1;if((f?V:O)==="round")return _(b._point,A);else{if(N=new F0({internal:!0,closed:!0}),f){if(!b.isSmooth())F0._addBevelJoin(b,V,q,X,null,U,C,!0)}else if(O==="square")F0._addSquareCap(b,O,q,null,U,C,!0);if(!N.isEmpty()){var h;return N.contains($)||(h=N.getNearestLocation($))&&_(h.getPoint(),F)}}}if(Q.ends&&!Q.segments&&!Y){if(B=G(H[0],!0)||G(H[W-1],!0))return B}else if(Q.segments||Q.handles){for(var j=0;j<W;j++)if(B=G(H[j]))return B}if(q!==null){if(L=this.getNearestLocation($),L){var k=L.getTime();if(k===0||k===1&&W>1){if(!P(L.getSegment()))L=null}else if(!_(L.getPoint(),A))L=null}if(!L&&V==="miter"&&W>1)for(var j=0;j<W;j++){var x=H[j];if($.getDistance(x._point)<=X*q&&P(x)){L=x.getLocation();break}}}return!L&&R&&this._contains($)||L&&!E&&!T?new m0("fill",this):L?new m0(E?"stroke":"curve",this,{location:L,point:L.getPoint()}):null}},S.each(p._evaluateMethods,function($){this[$+"At"]=function(Q){var J=this.getLocationAt(Q);return J&&J[$]()}},{beans:!1,getLocationOf:function(){var $=y.read(arguments),Q=this.getCurves();for(var J=0,U=Q.length;J<U;J++){var Z=Q[J].getLocationOf($);if(Z)return Z}return null},getOffsetOf:function(){var $=this.getLocationOf.apply(this,arguments);return $?$.getOffset():null},getLocationAt:function($){if(typeof $==="number"){var Q=this.getCurves(),J=0;for(var U=0,Z=Q.length;U<Z;U++){var K=J,H=Q[U];if(J+=H.getLength(),J>$)return H.getLocationAt($-K)}if(Q.length>0&&$<=this.getLength())return new x0(Q[Q.length-1],1)}else if($&&$.getPath&&$.getPath()===this)return $;return null},getOffsetsWithTangent:function(){var $=y.read(arguments);if($.isZero())return[];var Q=[],J=0,U=this.getCurves();for(var Z=0,K=U.length;Z<K;Z++){var H=U[Z],W=H.getTimesWithTangent($);for(var Y=0,F=W.length;Y<F;Y++){var A=J+H.getOffsetAtTime(W[Y]);if(Q.indexOf(A)<0)Q.push(A)}J+=H.length}return Q}}),new function(){function $(J,U,Z,K){if(K<=0)return;var H=K/2,W=K-2,Y=H-1,F=new Array(6),A,V;function O(R){var T=F[R],q=F[R+1];if(A!=T||V!=q)J.beginPath(),J.moveTo(A,V),J.lineTo(T,q),J.stroke(),J.beginPath(),J.arc(T,q,H,0,Math.PI*2,!0),J.fill()}for(var X=0,N=U.length;X<N;X++){var L=U[X],B=L._selection;if(L._transformCoordinates(Z,F),A=F[0],V=F[1],B&2)O(2);if(B&4)O(4);if(J.fillRect(A-H,V-H,K,K),W>0&&!(B&1)){var E=J.fillStyle;J.fillStyle="#ffffff",J.fillRect(A-Y,V-Y,W,W),J.fillStyle=E}}}function Q(J,U,Z){var K=U._segments,H=K.length,W=new Array(6),Y=!0,F,A,V,O,X,N,L,B;function E(T){if(Z)T._transformCoordinates(Z,W),F=W[0],A=W[1];else{var q=T._point;F=q._x,A=q._y}if(Y)J.moveTo(F,A),Y=!1;else{if(Z)X=W[2],N=W[3];else{var _=T._handleIn;X=F+_._x,N=A+_._y}if(X===F&&N===A&&L===V&&B===O)J.lineTo(F,A);else J.bezierCurveTo(L,B,X,N,F,A)}if(V=F,O=A,Z)L=W[4],B=W[5];else{var _=T._handleOut;L=V+_._x,B=O+_._y}}for(var R=0;R<H;R++)E(K[R]);if(U._closed&&H>0)E(K[0])}return{_draw:function(J,U,Z,K){var H=U.dontStart,W=U.dontFinish||U.clip,Y=this.getStyle(),F=Y.hasFill(),A=Y.hasStroke(),V=Y.getDashArray(),O=!W0.support.nativeDash&&A&&V&&V.length;if(!H)J.beginPath();if(F||A&&!O||W){if(Q(J,this,K),this._closed)J.closePath()}function X(T){return V[(T%O+O)%O]}if(!W&&(F||A)){if(this._setStyles(J,U,Z),F)J.fill(Y.getFillRule()),J.shadowColor="rgba(0,0,0,0)";if(A){if(O){if(!H)J.beginPath();var N=new R8(this,0.25,32,!1,K),L=N.length,B=-Y.getDashOffset(),E,R=0;while(B>0)B-=X(R--)+X(R--);while(B<L){if(E=B+X(R++),B>0||E>0)N.drawPart(J,Math.max(B,0),Math.max(E,0));B=E+X(R++)}}J.stroke()}}},_drawSelected:function(J,U){J.beginPath(),Q(J,this,U),J.stroke(),$(J,this._segments,U,W0.settings.handleSize)}}},new function(){function $(Q){var J=Q._segments;if(!J.length)throw new Error("Use a moveTo() command first");return J[J.length-1]}return{moveTo:function(){var Q=this._segments;if(Q.length===1)this.removeSegment(0);if(!Q.length)this._add([new i(y.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new i(y.read(arguments))])},cubicCurveTo:function(){var Q=arguments,J=y.read(Q),U=y.read(Q),Z=y.read(Q),K=$(this);K.setHandleOut(J.subtract(K._point)),this._add([new i(Z,U.subtract(Z))])},quadraticCurveTo:function(){var Q=arguments,J=y.read(Q),U=y.read(Q),Z=$(this)._point;this.cubicCurveTo(J.add(Z.subtract(J).multiply(0.3333333333333333)),J.add(U.subtract(J).multiply(0.3333333333333333)),U)},curveTo:function(){var Q=arguments,J=y.read(Q),U=y.read(Q),Z=S.pick(S.read(Q),0.5),K=1-Z,H=$(this)._point,W=J.subtract(H.multiply(K*K)).subtract(U.multiply(Z*Z)).divide(2*Z*K);if(W.isNaN())throw new Error("Cannot put a curve through points with parameter = "+Z);this.quadraticCurveTo(W,U)},arcTo:function(){var Q=arguments,J=Math.abs,U=Math.sqrt,Z=$(this),K=Z._point,H=y.read(Q),W,Y=S.peek(Q),F=S.pick(Y,!0),A,V,O,X;if(typeof F==="boolean")var N=K.add(H).divide(2),W=N.add(N.subtract(K).rotate(F?-90:90));else if(S.remain(Q)<=2)W=H,H=y.read(Q);else if(!K.equals(H)){var L=s.read(Q),B=Z0.isZero;if(B(L.width)||B(L.height))return this.lineTo(H);var E=S.read(Q),F=!!S.read(Q),R=!!S.read(Q),N=K.add(H).divide(2),T=K.subtract(N).rotate(-E),q=T.x,_=T.y,z=J(L.width),G=J(L.height),C=z*z,P=G*G,j=q*q,k=_*_,x=U(j/C+k/P);if(x>1)z*=x,G*=x,C=z*z,P=G*G;if(x=(C*P-C*k-P*j)/(C*k+P*j),J(x)<0.000000000001)x=0;if(x<0)throw new Error("Cannot create an arc with the given arguments");if(A=new y(z*_/G,-G*q/z).multiply((R===F?-1:1)*U(x)).rotate(E).add(N),X=new V0().translate(A).rotate(E).scale(z,G),O=X._inverseTransform(K),V=O.getDirectedAngle(X._inverseTransform(H)),!F&&V>0)V-=360;else if(F&&V<0)V+=360}if(W){var b=new G0(K.add(W).divide(2),W.subtract(K).rotate(90),!0),f=new G0(W.add(H).divide(2),H.subtract(W).rotate(90),!0),h=new G0(K,H),u=h.getSide(W);if(A=b.intersect(f,!0),!A){if(!u)return this.lineTo(H);throw new Error("Cannot create an arc with the given arguments")}O=K.subtract(A),V=O.getDirectedAngle(H.subtract(A));var v=h.getSide(A,!0);if(v===0)V=u*J(V);else if(u===v)V+=V<0?360:-360}if(V){var m=0.00001,d=J(V),l=d>=360?4:Math.ceil((d-m)/90),r=V/l,n=r*Math.PI/360,e=1.3333333333333333*Math.sin(n)/(1+Math.cos(n)),c=[];for(var J0=0;J0<=l;J0++){var T=H,o=null;if(J0<l)if(o=O.rotate(90).multiply(e),X)T=X._transformPoint(O),o=X._transformPoint(O.add(o)).subtract(T);else T=A.add(O);if(!J0)Z.setHandleOut(o);else{var X0=O.rotate(-90).multiply(e);if(X)X0=X._transformPoint(O.add(X0)).subtract(T);c.push(new i(T,X0,o))}O=O.rotate(r)}this._add(c)}},lineBy:function(){var Q=y.read(arguments),J=$(this)._point;this.lineTo(J.add(Q))},curveBy:function(){var Q=arguments,J=y.read(Q),U=y.read(Q),Z=S.read(Q),K=$(this)._point;this.curveTo(K.add(J),K.add(U),Z)},cubicCurveBy:function(){var Q=arguments,J=y.read(Q),U=y.read(Q),Z=y.read(Q),K=$(this)._point;this.cubicCurveTo(K.add(J),K.add(U),K.add(Z))},quadraticCurveBy:function(){var Q=arguments,J=y.read(Q),U=y.read(Q),Z=$(this)._point;this.quadraticCurveTo(Z.add(J),Z.add(U))},arcBy:function(){var Q=arguments,J=$(this)._point,U=J.add(y.read(Q)),Z=S.pick(S.peek(Q),!0);if(typeof Z==="boolean")this.arcTo(U,Z);else this.arcTo(U,J.add(y.read(Q)))},closePath:function(Q){this.setClosed(!0),this.join(this,Q)}}},{_getBounds:function($,Q){var J=Q.handle?"getHandleBounds":Q.stroke?"getStrokeBounds":"getBounds";return F0[J](this._segments,this._closed,this,$,Q)},statics:{getBounds:function($,Q,J,U,Z,K){var H=$[0];if(!H)return new t;var W=new Array(6),Y=H._transformCoordinates(U,new Array(6)),F=Y.slice(0,2),A=F.slice(),V=new Array(2);function O(L){L._transformCoordinates(U,W);for(var B=0;B<2;B++)p._addBounds(Y[B],Y[B+4],W[B+2],W[B],B,K?K[B]:0,F,A,V);var E=Y;Y=W,W=E}for(var X=1,N=$.length;X<N;X++)O($[X]);if(Q)O(H);return new t(F[0],F[1],A[0]-F[0],A[1]-F[1])},getStrokeBounds:function($,Q,J,U,Z){var K=J.getStyle(),H=K.hasStroke(),W=K.getStrokeWidth(),Y=H&&J._getStrokeMatrix(U,Z),F=H&&F0._getStrokePadding(W,Y),A=F0.getBounds($,Q,J,U,Z,F);if(!H)return A;var V=W/2,O=K.getStrokeJoin(),X=K.getStrokeCap(),N=K.getMiterLimit(),L=new t(new s(F));function B(z){A=A.include(z)}function E(z){A=A.unite(L.setCenter(z._point.transform(U)))}function R(z,G){if(G==="round"||z.isSmooth())E(z);else F0._addBevelJoin(z,G,V,N,U,Y,B)}function T(z,G){if(G==="round")E(z);else F0._addSquareCap(z,G,V,U,Y,B)}var q=$.length-(Q?0:1);if(q>0){for(var _=1;_<q;_++)R($[_],O);if(Q)R($[0],O);else T($[0],X),T($[$.length-1],X)}return A},_getStrokePadding:function($,Q){if(!Q)return[$,$];var J=new y($,0).transform(Q),U=new y(0,$).transform(Q),Z=J.getAngleInRadians(),K=J.getLength(),H=U.getLength(),W=Math.sin(Z),Y=Math.cos(Z),F=Math.tan(Z),A=Math.atan2(H*F,K),V=Math.atan2(H,F*K);return[Math.abs(K*Math.cos(A)*Y+H*Math.sin(A)*W),Math.abs(H*Math.sin(V)*Y+K*Math.cos(V)*W)]},_addBevelJoin:function($,Q,J,U,Z,K,H,W){var Y=$.getCurve(),F=Y.getPrevious(),A=Y.getPoint1().transform(Z),V=F.getNormalAtTime(1).multiply(J).transform(K),O=Y.getNormalAtTime(0).multiply(J).transform(K),X=V.getDirectedAngle(O);if(X<0||X>=180)V=V.negate(),O=O.negate();if(W)H(A);if(H(A.add(V)),Q==="miter"){var N=new G0(A.add(V),new y(-V.y,V.x),!0).intersect(new G0(A.add(O),new y(-O.y,O.x),!0),!0);if(N&&A.getDistance(N)<=U*J)H(N)}H(A.add(O))},_addSquareCap:function($,Q,J,U,Z,K,H){var W=$._point.transform(U),Y=$.getLocation(),F=Y.getNormal().multiply(Y.getTime()===0?J:-J).transform(Z);if(Q==="square"){if(H)K(W.subtract(F)),K(W.add(F));W=W.add(F.rotate(-90))}K(W.add(F)),K(W.subtract(F))},getHandleBounds:function($,Q,J,U,Z){var K=J.getStyle(),H=Z.stroke&&K.hasStroke(),W,Y;if(H){var F=J._getStrokeMatrix(U,Z),A=K.getStrokeWidth()/2,V=A;if(K.getStrokeJoin()==="miter")V=A*K.getMiterLimit();if(K.getStrokeCap()==="square")V=Math.max(V,A*Math.SQRT2);W=F0._getStrokePadding(A,F),Y=F0._getStrokePadding(V,F)}var O=new Array(6),X=Infinity,N=-X,L=X,B=N;for(var E=0,R=$.length;E<R;E++){var T=$[E];T._transformCoordinates(U,O);for(var q=0;q<6;q+=2){var _=!q?Y:W,z=_?_[0]:0,G=_?_[1]:0,C=O[q],P=O[q+1],j=C-z,k=C+z,x=P-G,b=P+G;if(j<X)X=j;if(k>N)N=k;if(x<L)L=x;if(b>B)B=b}}return new t(X,L,N-X,B-L)}}});F0.inject({statics:new function(){var $=0.5522847498307936,Q=[new i([-1,0],[0,$],[0,-$]),new i([0,-1],[-$,0],[$,0]),new i([1,0],[0,-$],[0,$]),new i([0,1],[$,0],[-$,0])];function J(Z,K,H){var W=S.getNamed(H),Y=new F0(W&&(W.insert==!0?Q0.INSERT:W.insert==!1?Q0.NO_INSERT:null));return Y._add(Z),Y._closed=K,Y.set(W,Q0.INSERT)}function U(Z,K,H){var W=new Array(4);for(var Y=0;Y<4;Y++){var F=Q[Y];W[Y]=new i(F._point.multiply(K).add(Z),F._handleIn.multiply(K),F._handleOut.multiply(K))}return J(W,!0,H)}return{Line:function(){var Z=arguments;return J([new i(y.readNamed(Z,"from")),new i(y.readNamed(Z,"to"))],!1,Z)},Circle:function(){var Z=arguments,K=y.readNamed(Z,"center"),H=S.readNamed(Z,"radius");return U(K,new s(H),Z)},Rectangle:function(){var Z=arguments,K=t.readNamed(Z,"rectangle"),H=s.readNamed(Z,"radius",0,{readNull:!0}),W=K.getBottomLeft(!0),Y=K.getTopLeft(!0),F=K.getTopRight(!0),A=K.getBottomRight(!0),V;if(!H||H.isZero())V=[new i(W),new i(Y),new i(F),new i(A)];else{H=s.min(H,K.getSize(!0).divide(2));var{width:O,height:X}=H,N=O*$,L=X*$;V=[new i(W.add(O,0),null,[-N,0]),new i(W.subtract(0,X),[0,L]),new i(Y.add(0,X),null,[0,-L]),new i(Y.add(O,0),[-N,0],null),new i(F.subtract(O,0),null,[N,0]),new i(F.add(0,X),[0,-L],null),new i(A.subtract(0,X),null,[0,L]),new i(A.subtract(O,0),[N,0])]}return J(V,!0,Z)},RoundRectangle:"#Rectangle",Ellipse:function(){var Z=arguments,K=k0._readEllipse(Z);return U(K.center,K.radius,Z)},Oval:"#Ellipse",Arc:function(){var Z=arguments,K=y.readNamed(Z,"from"),H=y.readNamed(Z,"through"),W=y.readNamed(Z,"to"),Y=S.getNamed(Z),F=new F0(Y&&Y.insert==!1&&Q0.NO_INSERT);return F.moveTo(K),F.arcTo(H,W),F.set(Y)},RegularPolygon:function(){var Z=arguments,K=y.readNamed(Z,"center"),H=S.readNamed(Z,"sides"),W=S.readNamed(Z,"radius"),Y=360/H,F=H%3===0,A=new y(0,F?-W:W),V=F?-1:0.5,O=new Array(H);for(var X=0;X<H;X++)O[X]=new i(K.add(A.rotate((X+V)*Y)));return J(O,!0,Z)},Star:function(){var Z=arguments,K=y.readNamed(Z,"center"),H=S.readNamed(Z,"points")*2,W=S.readNamed(Z,"radius1"),Y=S.readNamed(Z,"radius2"),F=360/H,A=new y(0,-1),V=new Array(H);for(var O=0;O<H;O++)V[O]=new i(K.add(A.rotate(F*O).multiply(O%2?Y:W)));return J(V,!0,Z)}}}});var u0=o0.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function $(Q){if(this._children=[],this._namedChildren={},!this._initialize(Q))if(typeof Q==="string")this.setPathData(Q);else this.addChildren(Array.isArray(Q)?Q:arguments)},insertChildren:function $(Q,J){var U=J,Z=U[0];if(Z&&typeof Z[0]==="number")U=[U];for(var K=J.length-1;K>=0;K--){var H=U[K];if(U===J&&!(H instanceof F0))U=S.slice(U);if(Array.isArray(H))U[K]=new F0({segments:H,insert:!1});else if(H instanceof u0)U.splice.apply(U,[K,1].concat(H.removeChildren())),H.remove()}return $.base.call(this,Q,U)},reduce:function $(Q){var J=this._children;for(var U=J.length-1;U>=0;U--){var Z=J[U].reduce(Q);if(Z.isEmpty())Z.remove()}if(!J.length){var Z=new F0(Q0.NO_INSERT);return Z.copyAttributes(this),Z.insertAbove(this),this.remove(),Z}return $.base.call(this)},isClosed:function(){var $=this._children;for(var Q=0,J=$.length;Q<J;Q++)if(!$[Q]._closed)return!1;return!0},setClosed:function($){var Q=this._children;for(var J=0,U=Q.length;J<U;J++)Q[J].setClosed($)},getFirstSegment:function(){var $=this.getFirstChild();return $&&$.getFirstSegment()},getLastSegment:function(){var $=this.getLastChild();return $&&$.getLastSegment()},getCurves:function(){var $=this._children,Q=[];for(var J=0,U=$.length;J<U;J++)S.push(Q,$[J].getCurves());return Q},getFirstCurve:function(){var $=this.getFirstChild();return $&&$.getFirstCurve()},getLastCurve:function(){var $=this.getLastChild();return $&&$.getLastCurve()},getArea:function(){var $=this._children,Q=0;for(var J=0,U=$.length;J<U;J++)Q+=$[J].getArea();return Q},getLength:function(){var $=this._children,Q=0;for(var J=0,U=$.length;J<U;J++)Q+=$[J].getLength();return Q},getPathData:function($,Q){var J=this._children,U=[];for(var Z=0,K=J.length;Z<K;Z++){var H=J[Z],W=H._matrix;U.push(H.getPathData($&&!W.isIdentity()?$.appended(W):$,Q))}return U.join("")},_hitTestChildren:function $(Q,J,U){return $.base.call(this,Q,J.class===F0||J.type==="path"?J:S.set({},J,{fill:!1}),U)},_draw:function($,Q,J,U){var Z=this._children;if(!Z.length)return;Q=Q.extend({dontStart:!0,dontFinish:!0}),$.beginPath();for(var K=0,H=Z.length;K<H;K++)Z[K].draw($,Q,U);if(!Q.clip){this._setStyles($,Q,J);var W=this._style;if(W.hasFill())$.fill(W.getFillRule()),$.shadowColor="rgba(0,0,0,0)";if(W.hasStroke())$.stroke()}},_drawSelected:function($,Q,J){var U=this._children;for(var Z=0,K=U.length;Z<K;Z++){var H=U[Z],W=H._matrix;if(!J[H._id])H._drawSelected($,W.isIdentity()?Q:Q.appended(W))}}},new function(){function $(Q,J){var U=Q._children;if(J&&!U.length)throw new Error("Use a moveTo() command first");return U[U.length-1]}return S.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(Q){this[Q]=function(){var J=$(this,!0);J[Q].apply(J,arguments)}},{moveTo:function(){var Q=$(this),J=Q&&Q.isEmpty()?Q:new F0(Q0.NO_INSERT);if(J!==Q)this.addChild(J);J.moveTo.apply(J,arguments)},moveBy:function(){var Q=$(this,!0),J=Q&&Q.getLastSegment(),U=y.read(arguments);this.moveTo(J?U.add(J._point):U)},closePath:function(Q){$(this,!0).closePath(Q)}})},S.each(["reverse","flatten","simplify","smooth"],function($){this[$]=function(Q){var J=this._children,U;for(var Z=0,K=J.length;Z<K;Z++)U=J[Z][$](Q)||U;return U}},{}));o0.inject(new function(){var{min:$,max:Q,abs:J}=Math,U={unite:{"1":!0,"2":!0},intersect:{"2":!0},subtract:{"1":!0},exclude:{"1":!0,"-1":!0}};function Z(E){return E._children||[E]}function K(E,R){var T=E.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(R){var q=Z(T);for(var _=0,z=q.length;_<z;_++){var E=q[_];if(!E._closed&&!E.isEmpty())E.closePath(0.000000000001),E.getFirstSegment().setHandleIn(0,0),E.getLastSegment().setHandleOut(0,0)}T=T.resolveCrossings().reorient(T.getFillRule()==="nonzero",!0)}return T}function H(E,R,T,q,_){var z=new u0(Q0.NO_INSERT);if(z.addChildren(E,!0),z=z.reduce({simplify:R}),!(_&&_.insert==!1))z.insertAbove(q&&T.isSibling(q)&&T.getIndex()<q.getIndex()?q:T);return z.copyAttributes(T,!0),z}function W(E){return E.hasOverlap()||E.isCrossing()}function Y(E,R,T,q){if(q&&(q.trace==!1||q.stroke)&&/^(subtract|intersect)$/.test(T))return F(E,R,T);var _=K(E,!0),z=R&&E!==R&&K(R,!0),G=U[T];if(G[T]=!0,z&&(G.subtract||G.exclude)^(z.isClockwise()^_.isClockwise()))z.reverse();var C=X(x0.expand(_.getIntersections(z,W))),P=Z(_),j=z&&Z(z),k=[],x=[],b;function f(o){for(var X0=0,U0=o.length;X0<U0;X0++){var H0=o[X0];S.push(k,H0._segments),S.push(x,H0.getCurves()),H0._overlapsOnly=!0}}function h(o){var X0=[];for(var U0=0,H0=o&&o.length;U0<H0;U0++)X0.push(x[o[U0]]);return X0}if(C.length){if(f(P),j)f(j);var u=new Array(x.length);for(var v=0,m=x.length;v<m;v++)u[v]=x[v].getValues();var d=O0.findCurveBoundsCollisions(u,u,0,!0),l={};for(var v=0;v<x.length;v++){var r=x[v],n=r._path._id,e=l[n]=l[n]||{};e[r.getIndex()]={hor:h(d[v].hor),ver:h(d[v].ver)}}for(var v=0,m=C.length;v<m;v++)L(C[v]._segment,_,z,l,G);for(var v=0,m=k.length;v<m;v++){var c=k[v],J0=c._intersection;if(!c._winding)L(c,_,z,l,G);if(!(J0&&J0._overlap))c._path._overlapsOnly=!1}b=B(k,G)}else b=O(j?P.concat(j):P.slice(),function(o){return!!G[o]});return H(b,!0,E,R,q)}function F(E,R,T){var q=K(E),_=K(R),z=q.getIntersections(_,W),G=T==="subtract",C=T==="divide",P={},j=[];function k(f){if(!P[f._id]&&(C||_.contains(f.getPointAt(f.getLength()/2))^G))return j.unshift(f),P[f._id]=!0}for(var x=z.length-1;x>=0;x--){var b=z[x].split();if(b){if(k(b))b.getFirstSegment().setHandleIn(0,0);q.getLastSegment().setHandleOut(0,0)}}return k(q),H(j,!1,E,R)}function A(E,R){var T=E;while(T){if(T===R)return;T=T._previous}while(E._next&&E._next!==R)E=E._next;if(!E._next){while(R._previous)R=R._previous;E._next=R,R._previous=E}}function V(E){for(var R=E.length-1;R>=0;R--)E[R].clearHandles()}function O(E,R,T){var q=E&&E.length;if(q){var _=S.each(E,function(d,l){this[d._id]={container:null,winding:d.isClockwise()?1:-1,index:l}},{}),z=E.slice().sort(function(d,l){return J(l.getArea())-J(d.getArea())}),G=z[0],C=O0.findItemBoundsCollisions(z,null,Z0.GEOMETRIC_EPSILON);if(T==null)T=G.isClockwise();for(var P=0;P<q;P++){var j=z[P],k=_[j._id],x=0,b=C[P];if(b){var f=null;for(var h=b.length-1;h>=0;h--)if(b[h]<P){f=f||j.getInteriorPoint();var u=z[b[h]];if(u.contains(f)){var v=_[u._id];x=v.winding,k.winding+=x,k.container=v.exclude?v.container:u;break}}}if(R(k.winding)===R(x))k.exclude=!0,E[k.index]=null;else{var m=k.container;j.setClockwise(m?!m.isClockwise():T)}}}return E}function X(E,R,T){var q=R&&[],_=0.00000001,z=1-_,G=!1,C=T||[],P=T&&{},j,k,x;function b(X0){return X0._path._id+"."+X0._segment1._index}for(var f=(T&&T.length)-1;f>=0;f--){var h=T[f];if(h._path)P[b(h)]=!0}for(var f=E.length-1;f>=0;f--){var u=E[f],v=u._time,m=v,d=R&&!R(u),h=u._curve,l;if(h){if(h!==k)G=!h.hasHandles()||P&&P[b(h)],j=[],x=null,k=h;else if(x>=_)v/=x}if(d){if(j)j.push(u);continue}else if(R)q.unshift(u);if(x=m,v<_)l=h._segment1;else if(v>z)l=h._segment2;else{var r=h.divideAtTime(v,!0);if(G)C.push(h,r);l=r._segment1;for(var n=j.length-1;n>=0;n--){var e=j[n];e._time=(e._time-v)/(1-v)}}u._setSegment(l);var c=l._intersection,J0=u._intersection;if(c){A(c,J0);var o=c;while(o)A(o._intersection,c),o=o._next}else l._intersection=J0}if(!T)V(C);return q||E}function N(E,R,T,q,_){var z=Array.isArray(R)?R:R[T?"hor":"ver"],G=T?1:0,C=G^1,P=[E.x,E.y],j=P[G],k=P[C],x=0.000000001,b=0.000001,f=j-x,h=j+x,u=0,v=0,m=0,d=0,l=!1,r=!1,n=1,e=[],c,J0;function o(q0){var B0=q0[C+0],b0=q0[C+6];if(k<$(B0,b0)||k>Q(B0,b0))return;var P0=q0[G+0],p0=q0[G+2],$8=q0[G+4],l0=q0[G+6];if(B0===b0){if(P0<h&&l0>f||l0<h&&P0>f)l=!0;return}var c0=k===B0?0:k===b0?1:f>Q(P0,p0,$8,l0)||h<$(P0,p0,$8,l0)?1:p.solveCubic(q0,C,k,e,0,1)>0?e[0]:1,y0=c0===0?P0:c0===1?l0:p.getPoint(q0,c0)[T?"y":"x"],g0=B0>b0?1:-1,W8=c[C]>c[C+6]?1:-1,s0=c[G+6];if(k!==B0){if(y0<f)m+=g0;else if(y0>h)d+=g0;else l=!0;if(y0>j-b&&y0<j+b)n/=2}else{if(g0!==W8){if(P0<f)m+=g0;else if(P0>h)d+=g0}else if(P0!=s0){if(s0<h&&y0>h)d+=g0,l=!0;else if(s0>f&&y0<f)m+=g0,l=!0}n/=4}return c=q0,!_&&y0>f&&y0<h&&p.getTangent(q0,c0)[T?"x":"y"]===0&&N(E,R,!T,q,!0)}function X0(q0){var B0=q0[C+0],b0=q0[C+2],P0=q0[C+4],p0=q0[C+6];if(k<=Q(B0,b0,P0,p0)&&k>=$(B0,b0,P0,p0)){var $8=q0[G+0],l0=q0[G+2],c0=q0[G+4],y0=q0[G+6],g0=f>Q($8,l0,c0,y0)||h<$($8,l0,c0,y0)?[q0]:p.getMonoCurves(q0,T),W8;for(var s0=0,s8=g0.length;s0<s8;s0++)if(W8=o(g0[s0]))return W8}}for(var U0=0,H0=z.length;U0<H0;U0++){var Y0=z[U0],K0=Y0._path,S0=Y0.getValues(),C0;if(!U0||z[U0-1]._path!==K0){if(c=null,!K0._closed){if(J0=p.getValues(K0.getLastCurve().getSegment2(),Y0.getSegment1(),null,!q),J0[C]!==J0[C+6])c=J0}if(!c){c=S0;var w0=K0.getLastCurve();while(w0&&w0!==Y0){var M0=w0.getValues();if(M0[C]!==M0[C+6]){c=M0;break}w0=w0.getPrevious()}}}if(C0=X0(S0))return C0;if(U0+1===H0||z[U0+1]._path!==K0){if(J0&&(C0=X0(J0)))return C0;if(l&&!m&&!d)m=d=K0.isClockwise(q)^T?1:-1;if(u+=m,v+=d,m=d=0,l)r=!0,l=!1;J0=null}}return u=J(u),v=J(v),{winding:Q(u,v),windingL:u,windingR:v,quality:n,onPath:r}}function L(E,R,T,q,_){var z=[],G=E,C=0,x;do{var P=E.getCurve();if(P){var j=P.getLength();z.push({segment:E,curve:P,length:j}),C+=j}E=E.getNext()}while(E&&!E._intersection&&E!==G);var k=[0.5,0.25,0.75],x={winding:0,quality:-1},b=0.001,f=1-b;for(var h=0;h<k.length&&x.quality<0.5;h++){var j=C*k[h];for(var u=0,v=z.length;u<v;u++){var m=z[u],d=m.length;if(j<=d){var P=m.curve,l=P._path,r=l._parent,n=r instanceof u0?r:l,e=Z0.clamp(P.getTimeAt(j),b,f),c=P.getPointAtTime(e),J0=J(P.getTangentAtTime(e).y)<Math.SQRT1_2,o=null;if(_.subtract&&T){var X0=n===R?T:R,U0=X0._getWinding(c,J0,!0);if(n===R&&U0.winding||n===T&&!U0.winding)if(U0.quality<1)continue;else o={winding:0,quality:1}}if(o=o||N(c,q[l._id][P.getIndex()],J0,!0),o.quality>x.quality)x=o;break}j-=d}}for(var u=z.length-1;u>=0;u--)z[u].segment._winding=x}function B(E,R){var T=[],q;function _(H0){var Y0;return!!(H0&&!H0._visited&&(!R||R[(Y0=H0._winding||{}).winding]&&!(R.unite&&Y0.winding===2&&Y0.windingL&&Y0.windingR)))}function z(H0){if(H0){for(var Y0=0,K0=q.length;Y0<K0;Y0++)if(H0===q[Y0])return!0}return!1}function G(H0){var Y0=H0._segments;for(var K0=0,S0=Y0.length;K0<S0;K0++)Y0[K0]._visited=!0}function C(H0,Y0){var K0=H0._intersection,S0=K0,C0=[];if(Y0)q=[H0];function w0(M0,q0){while(M0&&M0!==q0){var B0=M0._segment,b0=B0&&B0._path;if(b0){var P0=B0.getNext()||b0.getFirstSegment(),p0=P0._intersection;if(B0!==H0&&(z(B0)||z(P0)||P0&&(_(B0)&&(_(P0)||p0&&_(p0._segment)))))C0.push(B0);if(Y0)q.push(B0)}M0=M0._next}}if(K0){w0(K0);while(K0&&K0._previous)K0=K0._previous;w0(K0,S0)}return C0}E.sort(function(H0,Y0){var K0=H0._intersection,S0=Y0._intersection,C0=!!(K0&&K0._overlap),w0=!!(S0&&S0._overlap),M0=H0._path,q0=Y0._path;return C0^w0?C0?1:-1:!K0^!S0?K0?1:-1:M0!==q0?M0._id-q0._id:H0._index-Y0._index});for(var P=0,j=E.length;P<j;P++){var k=E[P],x=_(k),b=null,f=!1,h=!0,u=[],v,m,d;if(x&&k._path._overlapsOnly){var l=k._path,r=k._intersection._segment._path;if(l.compare(r)){if(l.getArea())T.push(l.clone(!1));G(l),G(r),x=!1}}while(x){var n=!b,e=C(k,n),c=e.shift(),f=!n&&(z(k)||z(c)),J0=!f&&c;if(n)b=new F0(Q0.NO_INSERT),v=null;if(f){if(k.isFirst()||k.isLast())h=k._path._closed;k._visited=!0;break}if(J0&&v)u.push(v),v=null;if(!v){if(J0)e.push(k);v={start:b._segments.length,crossings:e,visited:m=[],handleIn:d}}if(J0)k=c;if(!_(k)){b.removeSegments(v.start);for(var o=0,X0=m.length;o<X0;o++)m[o]._visited=!1;m.length=0;do if(k=v&&v.crossings.shift(),!k||!k._path){if(k=null,v=u.pop(),v)m=v.visited,d=v.handleIn}while(v&&!_(k));if(!k)break}var U0=k.getNext();b.add(new i(k._point,d,U0&&k._handleOut)),k._visited=!0,m.push(k),k=U0||k._path.getFirstSegment(),d=U0&&U0._handleIn}if(f){if(h)b.getFirstSegment().setHandleIn(d),b.setClosed(h);if(b.getArea()!==0)T.push(b)}}return T}return{_getWinding:function(E,R,T){return N(E,this.getCurves(),R,T)},unite:function(E,R){return Y(this,E,"unite",R)},intersect:function(E,R){return Y(this,E,"intersect",R)},subtract:function(E,R){return Y(this,E,"subtract",R)},exclude:function(E,R){return Y(this,E,"exclude",R)},divide:function(E,R){return R&&(R.trace==!1||R.stroke)?F(this,E,"divide"):H([this.subtract(E,R),this.intersect(E,R)],!0,this,E,R)},resolveCrossings:function(){var E=this._children,R=E||[this];function T(v,m){var d=v&&v._intersection;return d&&d._overlap&&d._path===m}var q=!1,_=!1,z=this.getIntersections(null,function(v){return v.hasOverlap()&&(q=!0)||v.isCrossing()&&(_=!0)}),G=q&&_&&[];if(z=x0.expand(z),q){var C=X(z,function(v){return v.hasOverlap()},G);for(var P=C.length-1;P>=0;P--){var j=C[P],k=j._path,x=j._segment,b=x.getPrevious(),f=x.getNext();if(T(b,k)&&T(f,k)){if(x.remove(),b._handleOut._set(0,0),f._handleIn._set(0,0),b!==x&&!b.getCurve().hasLength())f._handleIn.set(b._handleIn),b.remove()}}}if(_){if(X(z,q&&function(v){var m=v.getCurve(),d=v.getSegment(),l=v._intersection,r=l._curve,n=l._segment;if(m&&r&&m._path&&r._path)return!0;if(d)d._intersection=null;if(n)n._intersection=null},G),G)V(G);R=B(S.each(R,function(v){S.push(this,v._segments)},[]))}var h=R.length,u;if(h>1&&E){if(R!==E)this.setChildren(R);u=this}else if(h===1&&!E){if(R[0]!==this)this.setSegments(R[0].removeSegments());u=this}if(!u)u=new u0(Q0.NO_INSERT),u.addChildren(R),u=u.reduce(),u.copyAttributes(this),this.replaceWith(u);return u},reorient:function(E,R){var T=this._children;if(T&&T.length)this.setChildren(O(this.removeChildren(),function(q){return!!(E?q:q&1)},R));else if(R!==I)this.setClockwise(R);return this},getInteriorPoint:function(){var E=this.getBounds(),R=E.getCenter(!0);if(!this.contains(R)){var T=this.getCurves(),q=R.y,_=[],z=[];for(var G=0,C=T.length;G<C;G++){var P=T[G].getValues(),j=P[1],k=P[3],x=P[5],b=P[7];if(q>=$(j,k,x,b)&&q<=Q(j,k,x,b)){var f=p.getMonoCurves(P);for(var h=0,u=f.length;h<u;h++){var v=f[h],m=v[1],d=v[7];if(m!==d&&(q>=m&&q<=d||q>=d&&q<=m)){var l=q===m?v[0]:q===d?v[6]:p.solveCubic(v,1,q,z,0,1)===1?p.getPoint(v,z[0]).x:(v[0]+v[6])/2;_.push(l)}}}}if(_.length>1)_.sort(function(r,n){return r-n}),R.x=(_[0]+_[1])/2}return R}}});var R8=S.extend({_class:"PathFlattener",initialize:function($,Q,J,U,Z){var K=[],H=[],W=0,Y=1/(J||32),F=$._segments,A=F[0],V;function O(B,E){var R=p.getValues(B,E,Z);K.push(R),X(R,B._index,0,1)}function X(B,E,R,T){if(T-R>Y&&!(U&&p.isStraight(B))&&!p.isFlatEnough(B,Q||0.25)){var q=p.subdivide(B,0.5),_=(R+T)/2;X(q[0],E,R,_),X(q[1],E,_,T)}else{var z=B[6]-B[0],G=B[7]-B[1],C=Math.sqrt(z*z+G*G);if(C>0)W+=C,H.push({offset:W,curve:B,index:E,time:T})}}for(var N=1,L=F.length;N<L;N++)V=F[N],O(A,V),A=V;if($._closed)O(V||A,F[0]);this.curves=K,this.parts=H,this.length=W,this.index=0},_get:function($){var Q=this.parts,J=Q.length,U,Z,K=this.index;for(;;)if(Z=K,!K||Q[--K].offset<$)break;for(;Z<J;Z++){var H=Q[Z];if(H.offset>=$){this.index=Z;var W=Q[Z-1],Y=W&&W.index===H.index?W.time:0,F=W?W.offset:0;return{index:H.index,time:Y+(H.time-Y)*($-F)/(H.offset-F)}}}return{index:Q[J-1].index,time:1}},drawPart:function($,Q,J){var U=this._get(Q),Z=this._get(J);for(var K=U.index,H=Z.index;K<=H;K++){var W=p.getPart(this.curves[K],K===U.index?U.time:0,K===Z.index?Z.time:1);if(K===U.index)$.moveTo(W[0],W[1]);$.bezierCurveTo.apply($,W.slice(2))}}},S.each(p._evaluateMethods,function($){this[$+"At"]=function(Q){var J=this._get(Q);return p[$](this.curves[J.index],J.time)}},{})),u8=S.extend({initialize:function($){var Q=this.points=[],J=$._segments,U=$._closed;for(var Z=0,K,H=J.length;Z<H;Z++){var W=J[Z].point;if(!K||!K.equals(W))Q.push(K=W.clone())}if(U)Q.unshift(Q[Q.length-1]),Q.push(Q[1]);this.closed=U},fit:function($){var Q=this.points,J=Q.length,U=null;if(J>0){if(U=[new i(Q[0])],J>1){if(this.fitCubic(U,$,0,J-1,Q[1].subtract(Q[0]),Q[J-2].subtract(Q[J-1])),this.closed)U.shift(),U.pop()}}return U},fitCubic:function($,Q,J,U,Z,K){var H=this.points;if(U-J===1){var W=H[J],Y=H[U],F=W.getDistance(Y)/3;this.addCurve($,[W,W.add(Z.normalize(F)),Y.add(K.normalize(F)),Y]);return}var A=this.chordLengthParameterize(J,U),V=Math.max(Q,Q*Q),O,X=!0;for(var N=0;N<=4;N++){var L=this.generateBezier(J,U,A,Z,K),B=this.findMaxError(J,U,L,A);if(B.error<Q&&X){this.addCurve($,L);return}if(O=B.index,B.error>=V)break;X=this.reparameterize(J,U,A,L),V=B.error}var E=H[O-1].subtract(H[O+1]);this.fitCubic($,Q,J,O,Z,E),this.fitCubic($,Q,O,U,E.negate(),K)},addCurve:function($,Q){var J=$[$.length-1];J.setHandleOut(Q[1].subtract(Q[0])),$.push(new i(Q[3],Q[2].subtract(Q[3])))},generateBezier:function($,Q,J,U,Z){var K=0.000000000001,H=Math.abs,W=this.points,Y=W[$],F=W[Q],A=[[0,0],[0,0]],V=[0,0];for(var O=0,X=Q-$+1;O<X;O++){var N=J[O],L=1-N,B=3*N*L,E=L*L*L,R=B*L,T=B*N,q=N*N*N,_=U.normalize(R),z=Z.normalize(T),G=W[$+O].subtract(Y.multiply(E+R)).subtract(F.multiply(T+q));A[0][0]+=_.dot(_),A[0][1]+=_.dot(z),A[1][0]=A[0][1],A[1][1]+=z.dot(z),V[0]+=_.dot(G),V[1]+=z.dot(G)}var C=A[0][0]*A[1][1]-A[1][0]*A[0][1],P,j;if(H(C)>K){var k=A[0][0]*V[1]-A[1][0]*V[0],x=V[0]*A[1][1]-V[1]*A[0][1];P=x/C,j=k/C}else{var b=A[0][0]+A[0][1],f=A[1][0]+A[1][1];P=j=H(b)>K?V[0]/b:H(f)>K?V[1]/f:0}var h=F.getDistance(Y),u=K*h,v,m;if(P<u||j<u)P=j=h/3;else{var d=F.subtract(Y);if(v=U.normalize(P),m=Z.normalize(j),v.dot(d)-m.dot(d)>h*h)P=j=h/3,v=m=null}return[Y,Y.add(v||U.normalize(P)),F.add(m||Z.normalize(j)),F]},reparameterize:function($,Q,J,U){for(var Z=$;Z<=Q;Z++)J[Z-$]=this.findRoot(U,this.points[Z],J[Z-$]);for(var Z=1,K=J.length;Z<K;Z++)if(J[Z]<=J[Z-1])return!1;return!0},findRoot:function($,Q,J){var U=[],Z=[];for(var K=0;K<=2;K++)U[K]=$[K+1].subtract($[K]).multiply(3);for(var K=0;K<=1;K++)Z[K]=U[K+1].subtract(U[K]).multiply(2);var H=this.evaluate(3,$,J),W=this.evaluate(2,U,J),Y=this.evaluate(1,Z,J),F=H.subtract(Q),A=W.dot(W)+F.dot(Y);return Z0.isMachineZero(A)?J:J-F.dot(W)/A},evaluate:function($,Q,J){var U=Q.slice();for(var Z=1;Z<=$;Z++)for(var K=0;K<=$-Z;K++)U[K]=U[K].multiply(1-J).add(U[K+1].multiply(J));return U[0]},chordLengthParameterize:function($,Q){var J=[0];for(var U=$+1;U<=Q;U++)J[U-$]=J[U-$-1]+this.points[U].getDistance(this.points[U-1]);for(var U=1,Z=Q-$;U<=Z;U++)J[U]/=J[Z];return J},findMaxError:function($,Q,J,U){var Z=Math.floor((Q-$+1)/2),K=0;for(var H=$+1;H<Q;H++){var W=this.evaluate(3,J,U[H-$]),Y=W.subtract(this.points[H]),F=Y.x*Y.x+Y.y*Y.y;if(F>=K)K=F,Z=H}return{error:K,index:Z}}}),U8=Q0.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function $(Q){this._content="",this._lines=[];var J=Q&&S.isPlainObject(Q)&&Q.x===I&&Q.y===I;this._initialize(J&&Q,!J&&y.read(arguments))},_equals:function($){return this._content===$._content},copyContent:function($){this.setContent($._content)},getContent:function(){return this._content},setContent:function($){this._content=""+$,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),g8=U8.extend({_class:"PointText",initialize:function $(){U8.apply(this,arguments)},getPoint:function(){var $=this._matrix.getTranslation();return new h0($.x,$.y,this,"setPoint")},setPoint:function(){var $=y.read(arguments);this.translate($.subtract(this._matrix.getTranslation()))},_draw:function($,Q,J){if(!this._content)return;this._setStyles($,Q,J);var U=this._lines,Z=this._style,K=Z.hasFill(),H=Z.hasStroke(),W=Z.getLeading(),Y=$.shadowColor;$.font=Z.getFontStyle(),$.textAlign=Z.getJustification();for(var F=0,A=U.length;F<A;F++){$.shadowColor=Y;var V=U[F];if(K)$.fillText(V,0,0),$.shadowColor="rgba(0,0,0,0)";if(H)$.strokeText(V,0,0);$.translate(0,W)}},_getBounds:function($,Q){var J=this._style,U=this._lines,Z=U.length,K=J.getJustification(),H=J.getLeading(),W=this.getView().getTextWidth(J.getFontStyle(),U),Y=0;if(K!=="left")Y-=W/(K==="center"?2:1);var F=new t(Y,Z?-0.75*H:0,W,Z*H);return $?$._transformBounds(F,F):F}}),z0=S.extend(new function(){var $={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},Q={},J={transparent:[0,0,0,0]},U;function Z(W){var Y=W.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||W.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),F="rgb",A;if(Y){var V=Y[4]?4:3;A=new Array(V);for(var O=0;O<V;O++){var X=Y[O+1];A[O]=parseInt(X.length==1?X+X:X,16)/255}}else if(Y=W.match(/^(rgb|hsl)a?\((.*)\)$/)){F=Y[1],A=Y[2].trim().split(/[,\s]+/g);var N=F==="hsl";for(var O=0,L=Math.min(A.length,4);O<L;O++){var B=A[O],X=parseFloat(B);if(N){if(O===0){var E=B.match(/([a-z]*)$/)[1];X*={turn:360,rad:180/Math.PI,grad:0.9}[E]||1}else if(O<3)X/=100}else if(O<3)X/=/%$/.test(B)?100:255;A[O]=X}}else{var R=J[W];if(!R)if(w){if(!U)U=L0.getContext(1,1,{willReadFrequently:!0}),U.globalCompositeOperation="copy";U.fillStyle="rgba(0,0,0,0)",U.fillStyle=W,U.fillRect(0,0,1,1);var T=U.getImageData(0,0,1,1).data;R=J[W]=[T[0]/255,T[1]/255,T[2]/255]}else R=[0,0,0];A=R.slice()}return[F,A]}var K=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],H={"rgb-hsb":function(W,Y,F){var A=Math.max(W,Y,F),V=Math.min(W,Y,F),O=A-V,X=O===0?0:(A==W?(Y-F)/O+(Y<F?6:0):A==Y?(F-W)/O+2:(W-Y)/O+4)*60;return[X,A===0?0:O/A,A]},"hsb-rgb":function(W,Y,F){W=(W/60%6+6)%6;var V=Math.floor(W),A=W-V,V=K[V],O=[F,F*(1-Y),F*(1-Y*A),F*(1-Y*(1-A))];return[O[V[0]],O[V[1]],O[V[2]]]},"rgb-hsl":function(W,Y,F){var A=Math.max(W,Y,F),V=Math.min(W,Y,F),O=A-V,X=O===0,N=X?0:(A==W?(Y-F)/O+(Y<F?6:0):A==Y?(F-W)/O+2:(W-Y)/O+4)*60,L=(A+V)/2,B=X?0:L<0.5?O/(A+V):O/(2-A-V);return[N,B,L]},"hsl-rgb":function(W,Y,F){if(W=(W/360%1+1)%1,Y===0)return[F,F,F];var A=[W+0.3333333333333333,W,W-0.3333333333333333],V=F<0.5?F*(1+Y):F+Y-F*Y,O=2*F-V,X=[];for(var N=0;N<3;N++){var L=A[N];if(L<0)L+=1;if(L>1)L-=1;X[N]=6*L<1?O+(V-O)*6*L:2*L<1?V:3*L<2?O+(V-O)*(0.6666666666666666-L)*6:O}return X},"rgb-gray":function(W,Y,F){return[W*0.2989+Y*0.587+F*0.114]},"gray-rgb":function(W){return[W,W,W]},"gray-hsb":function(W){return[0,0,W]},"gray-hsl":function(W){return[0,0,W]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return S.each($,function(W,Y){Q[Y]=[],S.each(W,function(F,A){var V=S.capitalize(F),O=/^(hue|saturation)$/.test(F),X=Q[Y][A]=Y==="gradient"?F==="gradient"?function(N){var L=this._components[0];if(N=Z8.read(Array.isArray(N)?N:arguments,0,{readNull:!0}),L!==N){if(L)L._removeOwner(this);if(N)N._addOwner(this)}return N}:function(){return y.read(arguments,0,{readNull:F==="highlight",clone:!0})}:function(N){return N==null||isNaN(N)?0:+N};this["get"+V]=function(){return this._type===Y||O&&/^hs[bl]$/.test(this._type)?this._components[A]:this._convert(Y)[A]},this["set"+V]=function(N){if(this._type!==Y&&!(O&&/^hs[bl]$/.test(this._type)))this._components=this._convert(Y),this._properties=$[Y],this._type=Y;this._components[A]=X.call(this,N),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function W(Y){var F=arguments,A=this.__read,V=0,O,X,N,L;if(Array.isArray(Y))F=Y,Y=F[0];var B=Y!=null&&typeof Y;if(B==="string"&&Y in $)if(O=Y,Y=F[1],Array.isArray(Y))X=Y,N=F[2];else{if(A)V=1;F=S.slice(F,1),B=typeof Y}if(!X){if(L=B==="number"?F:B==="object"&&Y.length!=null?Y:null,L){if(!O)O=L.length>=3?"rgb":"gray";var E=$[O].length;if(N=L[E],A)V+=L===arguments?E+(N!=null?1:0):1;if(L.length>E)L=S.slice(L,0,E)}else if(B==="string"){var R=Z(Y);if(O=R[0],X=R[1],X.length===4)N=X[3],X.length--}else if(B==="object")if(Y.constructor===W){if(O=Y._type,X=Y._components.slice(),N=Y._alpha,O==="gradient")for(var T=1,q=X.length;T<q;T++){var _=X[T];if(_)X[T]=_.clone()}}else if(Y.constructor===Z8)O="gradient",L=F;else{O="hue"in Y?"lightness"in Y?"hsl":"hsb":("gradient"in Y)||("stops"in Y)||("radial"in Y)?"gradient":("gray"in Y)?"gray":"rgb";var z=$[O],G=Q[O];this._components=X=[];for(var T=0,q=z.length;T<q;T++){var C=Y[z[T]];if(C==null&&!T&&O==="gradient"&&"stops"in Y)C={stops:Y.stops,radial:Y.radial};if(C=G[T].call(this,C),C!=null)X[T]=C}N=Y.alpha}if(A&&O)V=1}if(this._type=O||"rgb",!X){this._components=X=[];var G=Q[this._type];for(var T=0,q=G.length;T<q;T++){var C=G[T].call(this,L&&L[T]);if(C!=null)X[T]=C}}if(this._components=X,this._properties=$[this._type],this._alpha=N,A)this.__read=V;return this},set:"#initialize",_serialize:function(W,Y){var F=this.getComponents();return S.serialize(/^(gray|rgb)$/.test(this._type)?F:[this._type].concat(F),W,!0,Y)},_changed:function(){if(this._canvasStyle=null,this._owner)if(this._setter)this._owner[this._setter](this);else this._owner._changed(129)},_convert:function(W){var Y;return this._type===W?this._components.slice():(Y=H[this._type+"-"+W])?Y.apply(this,this._components):H["rgb-"+W].apply(this,H[this._type+"-rgb"].apply(this,this._components))},convert:function(W){return new z0(W,this._convert(W),this._alpha)},getType:function(){return this._type},setType:function(W){this._components=this._convert(W),this._properties=$[W],this._type=W},getComponents:function(){var W=this._components.slice();if(this._alpha!=null)W.push(this._alpha);return W},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(W){this._alpha=W==null?null:Math.min(Math.max(W,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(W){var Y=S.isPlainValue(W,!0)?z0.read(arguments):W;return Y===this||Y&&this._class===Y._class&&this._type===Y._type&&this.getAlpha()===Y.getAlpha()&&S.equals(this._components,Y._components)||!1},toString:function(){var W=this._properties,Y=[],F=this._type==="gradient",A=D0.instance;for(var V=0,O=W.length;V<O;V++){var X=this._components[V];if(X!=null)Y.push(W[V]+": "+(F?X:A.number(X)))}if(this._alpha!=null)Y.push("alpha: "+A.number(this._alpha));return"{ "+Y.join(", ")+" }"},toCSS:function(W){var Y=this._convert("rgb"),F=W||this._alpha==null?1:this._alpha;function A(V){return Math.round((V<0?0:V>1?1:V)*255)}if(Y=[A(Y[0]),A(Y[1]),A(Y[2])],F<1)Y.push(F<0?0:F);return W?"#"+((1<<24)+(Y[0]<<16)+(Y[1]<<8)+Y[2]).toString(16).slice(1):(Y.length==4?"rgba(":"rgb(")+Y.join(",")+")"},toCanvasStyle:function(W,Y){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var F=this._components,A=F[0],V=A._stops,O=F[1],X=F[2],N=F[3],L=Y&&Y.inverted(),B;if(L){if(O=L._transformPoint(O),X=L._transformPoint(X),N)N=L._transformPoint(N)}if(A._radial){var E=X.getDistance(O);if(N){var R=N.subtract(O);if(R.getLength()>E)N=O.add(R.normalize(E-0.1))}var T=N||O;B=W.createRadialGradient(T.x,T.y,0,O.x,O.y,E)}else B=W.createLinearGradient(O.x,O.y,X.x,X.y);for(var q=0,_=V.length;q<_;q++){var z=V[q],G=z._offset;B.addColorStop(G==null?q/(_-1):G,z._color.toCanvasStyle())}return this._canvasStyle=B},transform:function(W){if(this._type==="gradient"){var Y=this._components;for(var F=1,A=Y.length;F<A;F++){var V=Y[F];W._transformPoint(V,V,!0)}this._changed()}},statics:{_types:$,random:function(){var W=Math.random;return new z0(W(),W(),W())},_setOwner:function(W,Y,F){if(W){if(W._owner&&Y&&W._owner!==Y)W=W.clone();if(!W._owner^!Y)W._owner=Y||null,W._setter=F||null}return W}}})},new function(){var $={add:function(Q,J){return Q+J},subtract:function(Q,J){return Q-J},multiply:function(Q,J){return Q*J},divide:function(Q,J){return Q/J}};return S.each($,function(Q,J){this[J]=function(U){U=z0.read(arguments);var Z=this._type,K=this._components,H=U._convert(Z);for(var W=0,Y=K.length;W<Y;W++)H[W]=Q(K[W],H[W]);return new z0(Z,H,this._alpha!=null?Q(this._alpha,U.getAlpha()):null)}},{})}),Z8=S.extend({_class:"Gradient",initialize:function $(Q,J){if(this._id=n0.get(),Q&&S.isPlainObject(Q))this.set(Q),Q=J=null;if(this._stops==null)this.setStops(Q||["white","black"]);if(this._radial==null)this.setRadial(typeof J==="string"&&J==="radial"||J||!1)},_serialize:function($,Q){return Q.add(this,function(){return S.serialize([this._stops,this._radial],$,!0,Q)})},_changed:function(){for(var $=0,Q=this._owners&&this._owners.length;$<Q;$++)this._owners[$]._changed()},_addOwner:function($){if(!this._owners)this._owners=[];this._owners.push($)},_removeOwner:function($){var Q=this._owners?this._owners.indexOf($):-1;if(Q!=-1){if(this._owners.splice(Q,1),!this._owners.length)this._owners=I}},clone:function(){var $=[];for(var Q=0,J=this._stops.length;Q<J;Q++)$[Q]=this._stops[Q].clone();return new Z8($,this._radial)},getStops:function(){return this._stops},setStops:function($){if($.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var Q=this._stops;if(Q)for(var J=0,U=Q.length;J<U;J++)Q[J]._owner=I;Q=this._stops=V8.readList($,0,{clone:!0});for(var J=0,U=Q.length;J<U;J++)Q[J]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function($){this._radial=$,this._changed()},equals:function($){if($===this)return!0;if($&&this._class===$._class){var Q=this._stops,J=$._stops,U=Q.length;if(U===J.length){for(var Z=0;Z<U;Z++)if(!Q[Z].equals(J[Z]))return!1;return!0}}return!1}}),V8=S.extend({_class:"GradientStop",initialize:function $(Q,J){var U=Q,Z=J;if(typeof Q==="object"&&J===I){if(Array.isArray(Q)&&typeof Q[0]!=="number")U=Q[0],Z=Q[1];else if("color"in Q||"offset"in Q||"rampPoint"in Q)U=Q.color,Z=Q.offset||Q.rampPoint||0}this.setColor(U),this.setOffset(Z)},clone:function(){return new V8(this._color.clone(),this._offset)},_serialize:function($,Q){var J=this._color,U=this._offset;return S.serialize(U==null?[J]:[J,U],$,!0,Q)},_changed:function(){if(this._owner)this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function($){this._offset=$,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){z0._setOwner(this._color,null),this._color=z0._setOwner(z0.read(arguments,0),this,"setColor"),this._changed()},equals:function($){return $===this||$&&this._class===$._class&&this._color.equals($._color)&&this._offset==$._offset||!1}}),q8=S.extend(new function(){var $={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new y,selectedColor:null},Q=S.set({},$,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),J=S.set({},Q,{fillColor:new z0}),U={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},Z={beans:!0},K={_class:"Style",beans:!0,initialize:function H(W,Y,F){if(this._values={},this._owner=Y,this._project=Y&&Y._project||F||W0.project,this._defaults=!Y||Y instanceof v0?Q:Y instanceof U8?J:$,W)this.set(W)}};return S.each(Q,function(H,W){var Y=/Color$/.test(W),F=W==="shadowOffset",A=S.capitalize(W),V=U[W],O="set"+A,X="get"+A;K[O]=function(N){var L=this._owner,B=L&&L._children,E=B&&B.length>0&&!(L instanceof u0);if(E)for(var R=0,T=B.length;R<T;R++)B[R]._style[O](N);if((W==="selectedColor"||!E)&&W in this._defaults){var q=this._values[W];if(q!==N){if(Y){if(q)z0._setOwner(q,null),q._canvasStyle=null;if(N&&N.constructor===z0)N=z0._setOwner(N,L,E&&O)}if(this._values[W]=N,L)L._changed(V||129)}}},K[X]=function(N){var L=this._owner,B=L&&L._children,E=B&&B.length>0&&!(L instanceof u0),R;if(E&&!N)for(var T=0,q=B.length;T<q;T++){var _=B[T]._style[X]();if(!T)R=_;else if(!S.equals(R,_))return I}else if(W in this._defaults){var R=this._values[W];if(R===I){if(R=this._defaults[W],R&&R.clone)R=R.clone()}else{var z=Y?z0:F?y:null;if(z&&!(R&&R.constructor===z))this._values[W]=R=z.read([R],0,{readNull:!0,clone:!0})}}if(R&&Y)R=z0._setOwner(R,L,E&&O);return R},Z[X]=function(N){return this._style[X](N)},Z[O]=function(N){this._style[O](N)}}),S.each({Font:"FontFamily",WindingRule:"FillRule"},function(H,W){var Y="get"+W,F="set"+W;K[Y]=Z[Y]="#get"+H,K[F]=Z[F]="#set"+H}),Q0.inject(Z),K},{set:function($){var Q=$ instanceof q8,J=Q?$._values:$;if(J){for(var U in J)if(U in this._defaults){var Z=J[U];this[U]=Z&&Q&&Z.clone?Z.clone():Z}}},equals:function($){function Q(J,U,Z){var K=J._values,H=U._values,W=U._defaults;for(var Y in K){var F=K[Y],A=H[Y];if(!(Z&&(Y in H))&&!S.equals(F,A===I?W[Y]:A))return!1}return!0}return $===this||$&&this._class===$._class&&Q(this,$)&&Q($,this,!0)||!1},_dispose:function(){var $=this.getFillColor();if($)$._canvasStyle=null;if($=this.getStrokeColor(),$)$._canvasStyle=null;if($=this.getShadowColor(),$)$._canvasStyle=null},hasFill:function(){var $=this.getFillColor();return!!$&&$.alpha>0},hasStroke:function(){var $=this.getStrokeColor();return!!$&&$.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var $=this.getShadowColor();return!!$&&$.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var $=this.getFontSize();return this.getFontWeight()+" "+$+(/[a-z]/i.test($+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function $(){var Q=$.base.call(this),J=this.getFontSize();if(/pt|em|%|px/.test(J))J=this.getView().getPixelSize(J);return Q!=null?Q:J*1.2}}),N0=new function(){function $(Q,J,U,Z){var K=["","webkit","moz","Moz","ms","o"],H=J[0].toUpperCase()+J.substring(1);for(var W=0;W<6;W++){var Y=K[W],F=Y?Y+H:J;if(F in Q){if(U)Q[F]=Z;else return Q[F];break}}}return{getStyles:function(Q){var J=Q&&Q.nodeType!==9?Q.ownerDocument:Q,U=J&&J.defaultView;return U&&U.getComputedStyle(Q,"")},getBounds:function(Q,J){var U=Q.ownerDocument,Z=U.body,K=U.documentElement,H;try{H=Q.getBoundingClientRect()}catch(A){H={left:0,top:0,width:0,height:0}}var W=H.left-(K.clientLeft||Z.clientLeft||0),Y=H.top-(K.clientTop||Z.clientTop||0);if(!J){var F=U.defaultView;W+=F.pageXOffset||K.scrollLeft||Z.scrollLeft,Y+=F.pageYOffset||K.scrollTop||Z.scrollTop}return new t(W,Y,H.width,H.height)},getViewportBounds:function(Q){var J=Q.ownerDocument,U=J.defaultView,Z=J.documentElement;return new t(0,0,U.innerWidth||Z.clientWidth,U.innerHeight||Z.clientHeight)},getOffset:function(Q,J){return N0.getBounds(Q,J).getPoint()},getSize:function(Q){return N0.getBounds(Q,!0).getSize()},isInvisible:function(Q){return N0.getSize(Q).equals(new s(0,0))},isInView:function(Q){return!N0.isInvisible(Q)&&N0.getViewportBounds(Q).intersects(N0.getBounds(Q,!0))},isInserted:function(Q){return g.body.contains(Q)},getPrefixed:function(Q,J){return Q&&$(Q,J)},setPrefixed:function(Q,J,U){if(typeof J==="object")for(var Z in J)$(Q,Z,!0,J[Z]);else $(Q,J,!0,U)}}},I0={add:function($,Q){if($)for(var J in Q){var U=Q[J],Z=J.split(/[\s,]+/g);for(var K=0,H=Z.length;K<H;K++){var W=Z[K],Y=$===g&&(W==="touchstart"||W==="touchmove")?{passive:!1}:!1;$.addEventListener(W,U,Y)}}},remove:function($,Q){if($)for(var J in Q){var U=Q[J],Z=J.split(/[\s,]+/g);for(var K=0,H=Z.length;K<H;K++)$.removeEventListener(Z[K],U,!1)}},getPoint:function($){var Q=$.targetTouches?$.targetTouches.length?$.targetTouches[0]:$.changedTouches[0]:$;return new y(Q.pageX||Q.clientX+g.documentElement.scrollLeft,Q.pageY||Q.clientY+g.documentElement.scrollTop)},getTarget:function($){return $.target||$.srcElement},getRelatedTarget:function($){return $.relatedTarget||$.toElement},getOffset:function($,Q){return I0.getPoint($).subtract(N0.getOffset(Q||I0.getTarget($)))}};I0.requestAnimationFrame=new function(){var $=N0.getPrefixed(w,"requestAnimationFrame"),Q=!1,J=[],U;function Z(){var K=J;J=[];for(var H=0,W=K.length;H<W;H++)K[H]();if(Q=$&&J.length,Q)$(Z)}return function(K){if(J.push(K),$){if(!Q)$(Z),Q=!0}else if(!U)U=setInterval(Z,16.666666666666668)}};var R0=S.extend(a,{_class:"View",initialize:function $(Q,J){function U(V){return J[V]||parseInt(J.getAttribute(V),10)}function Z(){var V=N0.getSize(J);return V.isNaN()||V.isZero()?new s(U("width"),U("height")):V}var K;if(w&&J){if(this._id=J.getAttribute("id"),this._id==null)J.setAttribute("id",this._id="paper-view-"+$._id++);I0.add(J,this._viewEvents);var H="none";if(N0.setPrefixed(J.style,{userDrag:H,userSelect:H,touchCallout:H,contentZooming:H,tapHighlightColor:"rgba(0,0,0,0)"}),$0.hasAttribute(J,"resize")){var W=this;I0.add(w,this._windowEvents={resize:function(){W.setViewSize(Z())}})}if(K=Z(),$0.hasAttribute(J,"stats")&&typeof Stats!=="undefined"){this._stats=new Stats;var Y=this._stats.domElement,F=Y.style,A=N0.getOffset(J);F.position="absolute",F.left=A.x+"px",F.top=A.y+"px",g.body.appendChild(Y)}}else K=new s(J),J=null;if(this._project=Q,this._scope=Q._scope,this._element=J,!this._pixelRatio)this._pixelRatio=w&&w.devicePixelRatio||1;if(this._setElementSize(K.width,K.height),this._viewSize=K,$._views.push(this),$._viewsById[this._id]=this,(this._matrix=new V0)._owner=this,!$._focused)$._focused=this;this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!W0.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;if(R0._focused===this)R0._focused=null;R0._views.splice(R0._views.indexOf(this),1),delete R0._viewsById[this._id];var $=this._project;if($._view===this)$._view=null;return I0.remove(this._element,this._viewEvents),I0.remove(w,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:S.each(Q0._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function($){this[$]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function($){if(this._autoUpdate=$,$)this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var $=this;I0.requestAnimationFrame(function(){if($._requested=!1,$._animate){$.requestUpdate();var Q=$._element;if((!N0.getPrefixed(g,"hidden")||$0.getAttribute(Q,"keepalive")==="true")&&N0.isInView(Q))$._handleFrame()}if($._autoUpdate)$.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){W0=this._scope;var $=Date.now()/1000,Q=this._last?$-this._last:0;if(this._last=$,this.emit("frame",new S({delta:Q,time:this._time+=Q,count:this._count++})),this._stats)this._stats.update()},_animateItem:function($,Q){var J=this._frameItems;if(Q){if(J[$._id]={item:$,time:0,count:0},++this._frameItemCount===1)this.on("frame",this._handleFrameItems)}else if(delete J[$._id],--this._frameItemCount===0)this.off("frame",this._handleFrameItems)},_handleFrameItems:function($){for(var Q in this._frameItems){var J=this._frameItems[Q];J.item.emit("frame",new S($,{time:J.time+=$.delta,count:J.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=I},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return this._pixelRatio*72},getViewSize:function(){var $=this._viewSize;return new i0($.width,$.height,this,"setViewSize")},setViewSize:function(){var $=s.read(arguments),Q=$.subtract(this._viewSize);if(Q.isZero())return;if(this._setElementSize($.width,$.height),this._viewSize.set($),this._changed(),this.emit("resize",{size:$,delta:Q}),this._autoUpdate)this.update()},_setElementSize:function($,Q){var J=this._element;if(J){if(J.width!==$)J.width=$;if(J.height!==Q)J.height=Q}},getBounds:function(){if(!this._bounds)this._bounds=this._matrix.inverted()._transformBounds(new t(new y,this._viewSize));return this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return N0.isInView(this._element)},isInserted:function(){return N0.isInserted(this._element)},getPixelSize:function($){var Q=this._element,J;if(Q){var U=Q.parentNode,Z=g.createElement("div");Z.style.fontSize=$,U.appendChild(Z),J=parseFloat(N0.getStyles(Z).fontSize),U.removeChild(Z)}else J=parseFloat(J);return J},getTextWidth:function($,Q){return 0}},S.each(["rotate","scale","shear","skew"],function($){var Q=$==="rotate";this[$]=function(){var J=arguments,U=(Q?S:y).read(J),Z=y.read(J,0,{readNull:!0});return this.transform(new V0()[$](U,Z||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var $=new V0;return this.transform($.translate.apply($,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var $=y.read(arguments);this.translate(this.getCenter().subtract($))},getZoom:function(){var $=this._decompose().scaling;return($.x+$.y)/2},setZoom:function($){this.transform(new V0().scale($/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function($){var Q=this.getRotation();if(Q!=null&&$!=null)this.rotate($-Q)},getScaling:function(){var $=this._decompose().scaling;return new h0($.x,$.y,this,"setScaling")},setScaling:function(){var $=this.getScaling(),Q=y.read(arguments,0,{clone:!0,readNull:!0});if($&&Q)this.scale(Q.x/$.x,Q.y/$.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var $=this._matrix;$.set.apply($,arguments)},transform:function($){this._matrix.append($)},scrollBy:function(){this.translate(y.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(y.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(y.read(arguments))},getEventPoint:function($){return this.viewToProject(I0.getOffset($,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function($,Q){if(g&&typeof Q==="string")Q=g.getElementById(Q);var J=w?v8:R0;return new J($,Q)}}},new function(){if(!w)return;var $,Q,J=!1,U=!1;function Z(b){var f=I0.getTarget(b);return f.getAttribute&&R0._viewsById[f.getAttribute("id")]}function K(){var b=R0._focused;if(!b||!b.isVisible()){for(var f=0,h=R0._views.length;f<h;f++)if((b=R0._views[f]).isVisible()){R0._focused=Q=b;break}}}function H(b,f,h){b._handleMouseEvent("mousemove",f,h)}var W=w.navigator,Y,F,A;if(W.pointerEnabled||W.msPointerEnabled)Y="pointerdown MSPointerDown",F="pointermove MSPointerMove",A="pointerup pointercancel MSPointerUp MSPointerCancel";else if(Y="touchstart",F="touchmove",A="touchend touchcancel",!(("ontouchstart"in w)&&W.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)))Y+=" mousedown",F+=" mousemove",A+=" mouseup";var V={},O={mouseout:function(b){var f=R0._focused,h=I0.getRelatedTarget(b);if(f&&(!h||h.nodeName==="HTML")){var u=I0.getOffset(b,f._element),v=u.x,m=Math.abs,d=m(v),l=1<<25,r=d-l;u.x=m(r)<d?r*(v<0?-1:1):v,H(f,b,f.viewToProject(u))}},scroll:K};V[Y]=function(b){var f=R0._focused=Z(b);if(!J)J=!0,f._handleMouseEvent("mousedown",b)},O[F]=function(b){var f=R0._focused;if(!U){var h=Z(b);if(h){if(f!==h){if(f)H(f,b);if(!$)$=f;f=R0._focused=Q=h}}else if(Q&&Q===f){if($&&!$.isInserted())$=null;f=R0._focused=$,$=null,K()}}if(f)H(f,b)},O[Y]=function(){U=!0},O[A]=function(b){var f=R0._focused;if(f&&J)f._handleMouseEvent("mouseup",b);U=J=!1},I0.add(g,O),I0.add(w,{load:K});var X=!1,N=!1,L={doubleclick:"click",mousedrag:"mousemove"},B=!1,E,R,T,q,_,z,G,C,P;function j(b,f,h,u,v,m,d){var l=!1,r;function n(e,c){if(e.responds(c)){if(!r)r=new d8(c,u,v,f||e,m?v.subtract(m):null);if(e.emit(c,r)){if(X=!0,r.prevented)N=!0;if(r.stopped)return l=!0}}else{var J0=L[c];if(J0)return n(e,J0)}}while(b&&b!==d){if(n(b,h))break;b=b._parent}return l}function k(b,f,h,u,v,m){return b._project.removeOn(h),N=X=!1,z&&j(z,null,h,u,v,m)||f&&f!==z&&!f.isDescendant(z)&&j(f,null,h==="mousedrag"?"mousemove":h,u,v,m,z)||j(b,z||f||b,h,u,v,m)}var x={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:V,_handleMouseEvent:function(b,f,h){var u=this._itemEvents,v=u.native[b],m=b==="mousemove",d=this._scope.tool,l=this;function r(U0){return u.virtual[U0]||l.responds(U0)||d&&d.responds(U0)}if(m&&J&&r("mousedrag"))b="mousedrag";if(!h)h=this.getEventPoint(f);var n=this.getBounds().contains(h),e=v&&n&&l._project.hitTest(h,{tolerance:0,fill:!0,stroke:!0}),c=e&&e.item||null,J0=!1,o={};if(o[b.substr(5)]=!0,v&&c!==_){if(_)j(_,null,"mouseleave",f,h);if(c)j(c,null,"mouseenter",f,h);_=c}if(B^n)j(this,null,n?"mouseenter":"mouseleave",f,h),E=n?this:null,J0=!0;if((n||o.drag)&&!h.equals(T))k(this,c,m?b:"mousemove",f,h,T),J0=!0;if(B=n,o.down&&n||o.up&&R){if(k(this,c,b,f,h,R),o.down){if(P=c===G&&Date.now()-C<300,q=G=c,!N&&c){var X0=c;while(X0&&!X0.responds("mousedrag"))X0=X0._parent;if(X0)z=c}R=h}else if(o.up){if(!N&&c===q)C=Date.now(),k(this,c,P?"doubleclick":"click",f,h,R),P=!1;q=z=null}B=!1,J0=!0}if(T=h,J0&&d)X=d._handleMouseEvent(b,f,h,o)||X;if(f.cancelable!==!1&&(X&&!o.move||o.down&&r("mouseup")))f.preventDefault()},_handleKeyEvent:function(b,f,h,u){var v=this._scope,m=v.tool,d;function l(r){if(r.responds(b))W0=v,r.emit(b,d=d||new m8(b,f,h,u))}if(this.isVisible()){if(l(this),m&&m.responds(b))l(m)}},_countItemEvent:function(b,f){var h=this._itemEvents,u=h.native,v=h.virtual;for(var m in x)u[m]=(u[m]||0)+(x[m][b]||0)*f;v[b]=(v[b]||0)+f},statics:{updateFocus:K,_resetState:function(){J=U=X=B=!1,$=Q=E=R=T=q=_=z=G=C=P=null}}}}),v8=R0.extend({_class:"CanvasView",initialize:function $(Q,J){if(!(J instanceof w.HTMLCanvasElement)){var U=s.read(arguments,1);if(U.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+S.slice(arguments,1));J=L0.getCanvas(U)}var Z=this._context=J.getContext("2d");if(Z.save(),this._pixelRatio=1,!/^off|false$/.test($0.getAttribute(J,"hidpi"))){var K=w.devicePixelRatio||1,H=N0.getPrefixed(Z,"backingStorePixelRatio")||1;this._pixelRatio=K/H}R0.call(this,Q,J),this._needsUpdate=!0},remove:function $(){return this._context.restore(),$.base.call(this)},_setElementSize:function $(Q,J){var U=this._pixelRatio;if($.base.call(this,Q*U,J*U),U!==1){var Z=this._element,K=this._context;if(!$0.hasAttribute(Z,"resize")){var H=Z.style;H.width=Q+"px",H.height=J+"px"}K.restore(),K.save(),K.scale(U,U)}},getContext:function(){return this._context},getPixelSize:function $(Q){var J=W0.agent,U;if(J&&J.firefox)U=$.base.call(this,Q);else{var Z=this._context,K=Z.font;Z.font=Q+" serif",U=parseFloat(Z.font),Z.font=K}return U},getTextWidth:function($,Q){var J=this._context,U=J.font,Z=0;J.font=$;for(var K=0,H=Q.length;K<H;K++)Z=Math.max(Z,J.measureText(Q[K]).width);return J.font=U,Z},update:function(){if(!this._needsUpdate)return!1;var $=this._project,Q=this._context,J=this._viewSize;if(Q.clearRect(0,0,J.width+1,J.height+1),$)$.draw(Q,this._matrix,this._pixelRatio);return this._needsUpdate=!1,!0}}),K8=S.extend({_class:"Event",initialize:function $(Q){this.event=Q,this.type=Q&&Q.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return _8.modifiers}}),m8=K8.extend({_class:"KeyEvent",initialize:function $(Q,J,U,Z){this.type=Q,this.event=J,this.key=U,this.character=Z},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),_8=new function(){var $={"\t":"tab"," ":"space","\b":"backspace","\x7F":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},Q={tab:"\t",space:" ",enter:"\r"},J={},U={},Z,K,H=new S({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var F=W0&&W0.agent;return F&&F.mac?this.meta:this.control}}});function W(F){var A=F.key||F.keyIdentifier;return A=/^U\+/.test(A)?String.fromCharCode(parseInt(A.substr(2),16)):/^Arrow[A-Z]/.test(A)?A.substr(5):A==="Unidentified"||A===I?String.fromCharCode(F.keyCode):A,$[A]||(A.length>1?S.hyphenate(A):A.toLowerCase())}function Y(F,A,V,O){var X=F?"keydown":"keyup",N=R0._focused,L;if(J[A]=F,F)U[A]=V;else delete U[A];if(A.length>1&&(L=S.camelize(A))in H){H[L]=F;var B=W0&&W0.agent;if(L==="meta"&&B&&B.mac)if(F)Z={};else{for(var E in Z)if(E in U)Y(!1,E,Z[E],O);Z=null}}else if(F&&Z)Z[A]=V;if(N)N._handleKeyEvent(F?"keydown":"keyup",O,A,V)}return I0.add(g,{keydown:function(F){var A=W(F),V=W0&&W0.agent;if(A.length>1||V&&(V.chrome&&(F.altKey||V.mac&&F.metaKey||!V.mac&&F.ctrlKey)))Y(!0,A,Q[A]||(A.length>1?"":A),F);else K=A},keypress:function(F){if(K){var A=W(F),V=F.charCode,O=V>=32?String.fromCharCode(V):A.length>1?"":A;if(A!==K)A=O.toLowerCase();Y(!0,A,O,F),K=null}},keyup:function(F){var A=W(F);if(A in U)Y(!1,A,U[A],F)}}),I0.add(w,{blur:function(F){for(var A in U)Y(!1,A,U[A],F)}}),{modifiers:H,isDown:function(F){return!!J[F]}}},d8=K8.extend({_class:"MouseEvent",initialize:function $(Q,J,U,Z,K){this.type=Q,this.event=J,this.point=U,this.target=Z,this.delta=K},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),p8=K8.extend({_class:"ToolEvent",_item:null,initialize:function $(Q,J,U){this.tool=Q,this.type=J,this.event=U},_choosePoint:function($,Q){return $?$:Q?Q.clone():null},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function($){this._point=$},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function($){this._lastPoint=$},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function($){this._downPoint=$},getMiddlePoint:function(){if(!this._middlePoint&&this.tool._lastPoint)return this.tool._point.add(this.tool._lastPoint).divide(2);return this._middlePoint},setMiddlePoint:function($){this._middlePoint=$},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function($){this._delta=$},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function($){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=$},getItem:function(){if(!this._item){var $=this.tool._scope.project.hitTest(this.getPoint());if($){var Q=$.item,J=Q._parent;while(/^(Group|CompoundPath)$/.test(J._class))Q=J,J=J._parent;this._item=Q}}return this._item},setItem:function($){this._item=$},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),X6=T0.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function $(Q){T0.call(this),this._moveCount=-1,this._downCount=-1,this.set(Q)},getMinDistance:function(){return this._minDistance},setMinDistance:function($){if(this._minDistance=$,$!=null&&this._maxDistance!=null&&$>this._maxDistance)this._maxDistance=$},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function($){if(this._maxDistance=$,this._minDistance!=null&&$!=null&&$<this._minDistance)this._minDistance=$},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function($){this._minDistance=this._maxDistance=$},_handleMouseEvent:function($,Q,J,U){if(W0=this._scope,U.drag&&!this.responds($))$="mousemove";var Z=U.move||U.drag,K=this.responds($),H=this.minDistance,W=this.maxDistance,Y=!1,F=this;function A(O,X){var N=J,L=Z?F._point:F._downPoint||N;if(Z){if(F._moveCount>=0&&N.equals(L))return!1;if(L&&(O!=null||X!=null)){var B=N.subtract(L),E=B.getLength();if(E<(O||0))return!1;if(X)N=L.add(B.normalize(Math.min(E,X)))}F._moveCount++}if(F._point=N,F._lastPoint=L||N,U.down)F._moveCount=-1,F._downPoint=N,F._downCount++;return!0}function V(){if(K)Y=F.emit($,new p8(F,$,Q))||Y}if(U.down)A(),V();else if(U.up)A(null,W),V();else if(K)while(A(H,W))V();return Y}}),l8=S.extend(a,{_class:"Tween",statics:{easings:new S({linear:function($){return $},easeInQuad:function($){return $*$},easeOutQuad:function($){return $*(2-$)},easeInOutQuad:function($){return $<0.5?2*$*$:-1+2*(2-$)*$},easeInCubic:function($){return $*$*$},easeOutCubic:function($){return--$*$*$+1},easeInOutCubic:function($){return $<0.5?4*$*$*$:($-1)*(2*$-2)*(2*$-2)+1},easeInQuart:function($){return $*$*$*$},easeOutQuart:function($){return 1- --$*$*$*$},easeInOutQuart:function($){return $<0.5?8*$*$*$*$:1-8*--$*$*$*$},easeInQuint:function($){return $*$*$*$*$},easeOutQuint:function($){return 1+--$*$*$*$*$},easeInOutQuint:function($){return $<0.5?16*$*$*$*$*$:1+16*--$*$*$*$*$}})},initialize:function $(Q,J,U,Z,K,H){this.object=Q;var W=typeof K,Y=W==="function";this.type=Y?W:W==="string"?K:"linear",this.easing=Y?K:$.easings[this.type],this.duration=Z,this.running=!1,this._then=null,this._startTime=null;var F=J||U;if(this._keys=F?Object.keys(F):[],this._parsedKeys=this._parseKeys(this._keys),this._from=F&&this._getState(J),this._to=F&&this._getState(U),H!==!1)this.start()},then:function($){return this._then=$,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function($){if(this.running){if($>=1)$=1,this.running=!1;var Q=this.easing($),J=this._keys,U=function(A){return typeof A==="function"?A(Q,$):A};for(var Z=0,K=J&&J.length;Z<K;Z++){var H=J[Z],W=U(this._from[H]),Y=U(this._to[H]),F=W&&Y&&W.__add&&Y.__add?Y.__subtract(W).__multiply(Q).__add(W):(Y-W)*Q+W;this._setProperty(this._parsedKeys[H],F)}if(this.responds("update"))this.emit("update",new S({progress:$,factor:Q}));if(!this.running&&this._then)this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function($){var Q=this._startTime,J=Q?($-Q)/this.duration:0;if(!Q)this._startTime=$;this.update(J)},_getState:function($){var Q=this._keys,J={};for(var U=0,Z=Q.length;U<Z;U++){var K=Q[U],H=this._parsedKeys[K],W=this._getProperty(H),Y;if($){var F=this._resolveValue(W,$[K]);this._setProperty(H,F),Y=this._getProperty(H),Y=Y&&Y.clone?Y.clone():Y,this._setProperty(H,W)}else Y=W&&W.clone?W.clone():W;J[K]=Y}return J},_resolveValue:function($,Q){if(Q){if(Array.isArray(Q)&&Q.length===2){var J=Q[0];return J&&J.match&&J.match(/^[+\-\*\/]=/)?this._calculate($,J[0],Q[1]):Q}else if(typeof Q==="string"){var U=Q.match(/^[+\-*/]=(.*)/);if(U){var Z=JSON.parse(U[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate($,Q[0],Z)}}}return Q},_calculate:function($,Q,J){return W0.PaperScript.calculateBinary($,Q,J)},_parseKeys:function($){var Q={};for(var J=0,U=$.length;J<U;J++){var Z=$[J],K=Z.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");Q[Z]=K.split("/")}return Q},_getProperty:function($,Q){var J=this.object;for(var U=0,Z=$.length-(Q||0);U<Z&&J;U++)J=J[$[U]];return J},_setProperty:function($,Q){var J=this._getProperty($,1);if(J)J[$[$.length-1]]=Q}}),c8={request:function($){var Q=new M.XMLHttpRequest;if(Q.open(($.method||"get").toUpperCase(),$.url,S.pick($.async,!0)),$.mimeType)Q.overrideMimeType($.mimeType);return Q.onload=function(){var J=Q.status;if(J===0||J===200){if($.onLoad)$.onLoad.call(Q,Q.responseText)}else Q.onerror()},Q.onerror=function(){var J=Q.status,U='Could not load "'+$.url+'" (Status: '+J+")";if($.onError)$.onError(U,J);else throw new Error(U)},Q.send(null)}},L0=S.exports.CanvasProvider={canvases:[],getCanvas:function($,Q,J){if(!w)return null;var U,Z=!0;if(typeof $==="object")Q=$.height,$=$.width;if(this.canvases.length)U=this.canvases.pop();else U=g.createElement("canvas"),Z=!1;var K=U.getContext("2d",J||{});if(!K)throw new Error("Canvas "+U+" is unable to provide a 2D context.");if(U.width===$&&U.height===Q){if(Z)K.clearRect(0,0,$+1,Q+1)}else U.width=$,U.height=Q;return K.save(),U},getContext:function($,Q,J){var U=this.getCanvas($,Q,J);return U?U.getContext("2d",J||{}):null},release:function($){var Q=$&&$.canvas?$.canvas:$;if(Q&&Q.getContext)Q.getContext("2d").restore(),this.canvases.push(Q)}},D8=new function(){var{min:$,max:Q,abs:J}=Math,U,Z,K,H,W,Y,F,A,V,O,X;function N(_,z,G){return 0.2989*_+0.587*z+0.114*G}function L(_,z,G,j){var P=j-N(_,z,G);V=_+P,O=z+P,X=G+P;var j=N(V,O,X),k=$(V,O,X),x=Q(V,O,X);if(k<0){var b=j-k;V=j+(V-j)*j/b,O=j+(O-j)*j/b,X=j+(X-j)*j/b}if(x>255){var f=255-j,h=x-j;V=j+(V-j)*f/h,O=j+(O-j)*f/h,X=j+(X-j)*f/h}}function B(_,z,G){return Q(_,z,G)-$(_,z,G)}function E(_,z,G,C){var P=[_,z,G],j=Q(_,z,G),k=$(_,z,G),x;if(k=k===_?0:k===z?1:2,j=j===_?0:j===z?1:2,x=$(k,j)===0?Q(k,j)===1?2:1:0,P[j]>P[k])P[x]=(P[x]-P[k])*C/(P[j]-P[k]),P[j]=C;else P[x]=P[j]=0;P[k]=0,V=P[0],O=P[1],X=P[2]}var R={multiply:function(){V=W*U/255,O=Y*Z/255,X=F*K/255},screen:function(){V=W+U-W*U/255,O=Y+Z-Y*Z/255,X=F+K-F*K/255},overlay:function(){V=W<128?2*W*U/255:255-2*(255-W)*(255-U)/255,O=Y<128?2*Y*Z/255:255-2*(255-Y)*(255-Z)/255,X=F<128?2*F*K/255:255-2*(255-F)*(255-K)/255},"soft-light":function(){var _=U*W/255;V=_+W*(255-(255-W)*(255-U)/255-_)/255,_=Z*Y/255,O=_+Y*(255-(255-Y)*(255-Z)/255-_)/255,_=K*F/255,X=_+F*(255-(255-F)*(255-K)/255-_)/255},"hard-light":function(){V=U<128?2*U*W/255:255-2*(255-U)*(255-W)/255,O=Z<128?2*Z*Y/255:255-2*(255-Z)*(255-Y)/255,X=K<128?2*K*F/255:255-2*(255-K)*(255-F)/255},"color-dodge":function(){V=W===0?0:U===255?255:$(255,255*W/(255-U)),O=Y===0?0:Z===255?255:$(255,255*Y/(255-Z)),X=F===0?0:K===255?255:$(255,255*F/(255-K))},"color-burn":function(){V=W===255?255:U===0?0:Q(0,255-(255-W)*255/U),O=Y===255?255:Z===0?0:Q(0,255-(255-Y)*255/Z),X=F===255?255:K===0?0:Q(0,255-(255-F)*255/K)},darken:function(){V=W<U?W:U,O=Y<Z?Y:Z,X=F<K?F:K},lighten:function(){V=W>U?W:U,O=Y>Z?Y:Z,X=F>K?F:K},difference:function(){if(V=W-U,V<0)V=-V;if(O=Y-Z,O<0)O=-O;if(X=F-K,X<0)X=-X},exclusion:function(){V=W+U*(255-W-W)/255,O=Y+Z*(255-Y-Y)/255,X=F+K*(255-F-F)/255},hue:function(){E(U,Z,K,B(W,Y,F)),L(V,O,X,N(W,Y,F))},saturation:function(){E(W,Y,F,B(U,Z,K)),L(V,O,X,N(W,Y,F))},luminosity:function(){L(W,Y,F,N(U,Z,K))},color:function(){L(U,Z,K,N(W,Y,F))},add:function(){V=$(W+U,255),O=$(Y+Z,255),X=$(F+K,255)},subtract:function(){V=Q(W-U,0),O=Q(Y-Z,0),X=Q(F-K,0)},average:function(){V=(W+U)/2,O=(Y+Z)/2,X=(F+K)/2},negation:function(){V=255-J(255-U-W),O=255-J(255-Z-Y),X=255-J(255-K-F)}},T=this.nativeModes=S.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(_){this[_]=!0},{}),q=L0.getContext(1,1,{willReadFrequently:!0});if(q)S.each(R,function(_,z){var G=z==="darken",C=!1;q.save();try{if(q.fillStyle=G?"#300":"#a00",q.fillRect(0,0,1,1),q.globalCompositeOperation=z,q.globalCompositeOperation===z)q.fillStyle=G?"#a00":"#300",q.fillRect(0,0,1,1),C=q.getImageData(0,0,1,1).data[0]!==G?170:51}catch(P){}q.restore(),T[z]=C}),L0.release(q);this.process=function(_,z,G,C,P){var j=z.canvas,k=_==="normal";if(k||T[_]){if(G.save(),G.setTransform(1,0,0,1,0,0),G.globalAlpha=C,!k)G.globalCompositeOperation=_;G.drawImage(j,P.x,P.y),G.restore()}else{var x=R[_];if(!x)return;var b=G.getImageData(P.x,P.y,j.width,j.height),f=b.data,h=z.getImageData(0,0,j.width,j.height).data;for(var u=0,v=f.length;u<v;u+=4){U=h[u],W=f[u],Z=h[u+1],Y=f[u+1],K=h[u+2],F=f[u+2],H=h[u+3],A=f[u+3],x();var m=H*C/255,d=1-m;f[u]=m*V+d*W,f[u+1]=m*O+d*Y,f[u+2]=m*X+d*F,f[u+3]=H*C+d*A}G.putImageData(b,P.x,P.y)}}},_0=new function(){var $="http://www.w3.org/2000/svg",Q="http://www.w3.org/2000/xmlns",J="http://www.w3.org/1999/xlink",U={href:J,xlink:Q,xmlns:Q+"/","xmlns:xlink":Q+"/"};function Z(W,Y,F){return H(g.createElementNS($,W),Y,F)}function K(W,Y){var F=U[Y],A=F?W.getAttributeNS(F,Y):W.getAttribute(Y);return A==="null"?null:A}function H(W,Y,F){for(var A in Y){var V=Y[A],O=U[A];if(typeof V==="number"&&F)V=F.number(V);if(O)W.setAttributeNS(O,A,V);else W.setAttribute(A,V)}return W}return{svg:$,xmlns:Q,xlink:J,create:Z,get:K,set:H}},L8=S.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function($,Q){return!Q&&($ instanceof o0||$ instanceof k0||$ instanceof U8)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function($,Q){var J=S.capitalize(Q),U=$[2];this[Q]={type:$[1],property:Q,attribute:$[0],toSVG:U,fromSVG:U&&S.each(U,function(Z,K){this[Z]=K},{}),exportFilter:$[3],get:"get"+J,set:"set"+J}},{});new function(){var $;function Q(R,T,q){var _=new S,z=R.getTranslation();if(T){var G;if(R.isInvertible())R=R._shiftless(),G=R._inverseTransform(z),z=null;else G=new y;_[q?"cx":"x"]=G.x,_[q?"cy":"y"]=G.y}if(!R.isIdentity()){var C=R.decompose();if(C){var P=[],j=C.rotation,k=C.scaling,x=C.skewing;if(z&&!z.isZero())P.push("translate("+$.point(z)+")");if(j)P.push("rotate("+$.number(j)+")");if(!Z0.isZero(k.x-1)||!Z0.isZero(k.y-1))P.push("scale("+$.point(k)+")");if(x.x)P.push("skewX("+$.number(x.x)+")");if(x.y)P.push("skewY("+$.number(x.y)+")");_.transform=P.join(" ")}else _.transform="matrix("+R.getValues().join(",")+")"}return _}function J(R,T){var q=Q(R._matrix),_=R._children,z=_0.create("g",q,$);for(var G=0,C=_.length;G<C;G++){var P=_[G],j=B(P,T);if(j)if(P.isClipMask()){var k=_0.create("clipPath");k.appendChild(j),N(P,k,"clip"),_0.set(z,{"clip-path":"url(#"+k.id+")"})}else z.appendChild(j)}return z}function U(R,T){var q=Q(R._matrix,!0),_=R.getSize(),z=R.getImage();return q.x-=_.width/2,q.y-=_.height/2,q.width=_.width,q.height=_.height,q.href=T.embedImages==!1&&z&&z.src||R.toDataURL(),_0.create("image",q,$)}function Z(R,T){var q=T.matchShapes;if(q){var _=R.toShape(!1);if(_)return K(_,T)}var z=R._segments,G=z.length,C,P=Q(R._matrix);if(q&&G>=2&&!R.hasHandles())if(G>2){C=R._closed?"polygon":"polyline";var j=[];for(var k=0;k<G;k++)j.push($.point(z[k]._point));P.points=j.join(" ")}else{C="line";var x=z[0]._point,b=z[1]._point;P.set({x1:x.x,y1:x.y,x2:b.x,y2:b.y})}else C="path",P.d=R.getPathData(null,T.precision);return _0.create(C,P,$)}function K(R){var{_type:T,_radius:q}=R,_=Q(R._matrix,!0,T!=="rectangle");if(T==="rectangle"){T="rect";var z=R._size,G=z.width,C=z.height;if(_.x-=G/2,_.y-=C/2,_.width=G,_.height=C,q.isZero())q=null}if(q)if(T==="circle")_.r=q;else _.rx=q.width,_.ry=q.height;return _0.create(T,_,$)}function H(R,T){var q=Q(R._matrix),_=R.getPathData(null,T.precision);if(_)q.d=_;return _0.create("path",q,$)}function W(R,T){var q=Q(R._matrix,!0),_=R._definition,z=X(_,"symbol"),G=_._item,C=G.getStrokeBounds();if(!z)z=_0.create("symbol",{viewBox:$.rectangle(C)}),z.appendChild(B(G,T)),N(_,z,"symbol");return q.href="#"+z.id,q.x+=C.x,q.y+=C.y,q.width=C.width,q.height=C.height,q.overflow="visible",_0.create("use",q,$)}function Y(R){var T=X(R,"color");if(!T){var q=R.getGradient(),_=q._radial,z=R.getOrigin(),G=R.getDestination(),C;if(_){C={cx:z.x,cy:z.y,r:z.getDistance(G)};var P=R.getHighlight();if(P)C.fx=P.x,C.fy=P.y}else C={x1:z.x,y1:z.y,x2:G.x,y2:G.y};C.gradientUnits="userSpaceOnUse",T=_0.create((_?"radial":"linear")+"Gradient",C,$);var j=q._stops;for(var k=0,x=j.length;k<x;k++){var b=j[k],f=b._color,h=f.getAlpha(),u=b._offset;if(C={offset:u==null?k/(x-1):u},f)C["stop-color"]=f.toCSS(!0);if(h<1)C["stop-opacity"]=h;T.appendChild(_0.create("stop",C,$))}N(R,T,"color")}return"url(#"+T.id+")"}function F(R){var T=_0.create("text",Q(R._matrix,!0),$);return T.textContent=R._content,T}var A={Group:J,Layer:J,Raster:U,Path:Z,Shape:K,CompoundPath:H,SymbolItem:W,PointText:F};function V(R,T,q){var _={},z=!q&&R.getParent(),G=[];if(R._name!=null)_.id=R._name;if(S.each(L8,function(C){var{get:P,type:j}=C,k=R[P]();if(C.exportFilter?C.exportFilter(R,k):!z||!S.equals(z[P](),k)){if(j==="color"&&k!=null){var x=k.getAlpha();if(x<1)_[C.attribute+"-opacity"]=x}if(j==="style")G.push(C.attribute+": "+k);else _[C.attribute]=k==null?"none":j==="color"?k.gradient?Y(k,R):k.toCSS(!0):j==="array"?k.join(","):j==="lookup"?C.toSVG[k]:k}}),G.length)_.style=G.join(";");if(_.opacity===1)delete _.opacity;if(!R._visible)_.visibility="hidden";return _0.set(T,_,$)}var O;function X(R,T){if(!O)O={ids:{},svgs:{}};return R&&O.svgs[T+"-"+(R._id||R.__id||(R.__id=n0.get("svg")))]}function N(R,T,q){if(!O)X();var _=O.ids[q]=(O.ids[q]||0)+1;T.id=q+"-"+_,O.svgs[q+"-"+(R._id||R.__id)]=T}function L(R,T){var q=R,_=null;if(O){q=R.nodeName.toLowerCase()==="svg"&&R;for(var z in O.svgs){if(!_){if(!q)q=_0.create("svg"),q.appendChild(R);_=q.insertBefore(_0.create("defs"),q.firstChild)}_.appendChild(O.svgs[z])}O=null}return T.asString?new M.XMLSerializer().serializeToString(q):q}function B(R,T,q){var _=A[R._class],z=_&&_(R,T);if(z){var G=T.onExport;if(G)z=G(R,z,T)||z;var C=JSON.stringify(R._data);if(C&&C!=="{}"&&C!=="null")z.setAttribute("data-paper-data",C)}return z&&V(R,z,q)}function E(R){if(!R)R={};return $=new D0(R.precision),R}Q0.inject({exportSVG:function(R){return R=E(R),L(B(this,R,!0),R)}}),J8.inject({exportSVG:function(R){R=E(R);var T=this._children,q=this.getView(),_=S.pick(R.bounds,"view"),z=R.matrix||_==="view"&&q._matrix,G=z&&V0.read([z]),C=_==="view"?new t([0,0],q.getViewSize()):_==="content"?Q0._getBounds(T,G,{stroke:!0}).rect:t.read([_],0,{readNull:!0}),P={version:"1.1",xmlns:_0.svg,"xmlns:xlink":_0.xlink};if(C){if(P.width=C.width,P.height=C.height,C.x||C.x===0||C.y||C.y===0)P.viewBox=$.rectangle(C)}var j=_0.create("svg",P,$),k=j;if(G&&!G.isIdentity())k=j.appendChild(_0.create("g",Q(G),$));for(var x=0,b=T.length;x<b;x++)k.appendChild(B(T[x],R,!0));return L(j,R)}})},new function(){var $={},Q;function J(T,q,_,z,G,C){var P=_0.get(T,q)||C,j=P==null?z?null:_?"":0:_?P:parseFloat(P);return/%\s*$/.test(P)?j/100*(G?1:Q[/x|^width/.test(q)?"width":"height"]):j}function U(T,q,_,z,G,C,P){return q=J(T,q||"x",!1,z,G,C),_=J(T,_||"y",!1,z,G,P),z&&(q==null||_==null)?null:new y(q,_)}function Z(T,q,_,z,G){return q=J(T,q||"width",!1,z,G),_=J(T,_||"height",!1,z,G),z&&(q==null||_==null)?null:new s(q,_)}function K(T,q,_){return T==="none"?null:q==="number"?parseFloat(T):q==="array"?T?T.split(/[\s,]+/g).map(parseFloat):[]:q==="color"?B(T)||T:q==="lookup"?_[T]:T}function H(T,q,_,z){var G=T.childNodes,C=q==="clippath",P=q==="defs",j=new v0,k=j._project,x=k._currentStyle,b=[];if(!C&&!P)j=L(j,T,z),k._currentStyle=j._style.clone();if(z){var f=T.querySelectorAll("defs");for(var h=0,u=f.length;h<u;h++)E(f[h],_,!1)}for(var h=0,u=G.length;h<u;h++){var v=G[h],m;if(v.nodeType===1&&!/^defs$/i.test(v.nodeName)&&(m=E(v,_,!1))&&!(m instanceof d0))b.push(m)}if(j.addChildren(b),C)j=L(j.reduce(),T,z);if(k._currentStyle=x,C||P)j.remove(),j=null;return j}function W(T,q){var _=T.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),z=[];for(var G=0,C=_.length;G<C;G+=2)z.push(new y(parseFloat(_[G]),parseFloat(_[G+1])));var P=new F0(z);if(q==="polygon")P.closePath();return P}function Y(T){return o0.create(T.getAttribute("d"))}function F(T,q){var _=(J(T,"href",!0)||"").substring(1),z=q==="radialgradient",G;if(_){if(G=$[_].getGradient(),G._radial^z)G=G.clone(),G._radial=z}else{var C=T.childNodes,P=[];for(var j=0,k=C.length;j<k;j++){var x=C[j];if(x.nodeType===1)P.push(L(new V8,x))}G=new Z8(P,z)}var b,f,h,u=J(T,"gradientUnits",!0)!=="userSpaceOnUse";if(z)b=U(T,"cx","cy",!1,u,"50%","50%"),f=b.add(J(T,"r",!1,!1,u,"50%"),0),h=U(T,"fx","fy",!0,u);else b=U(T,"x1","y1",!1,u,"0%","0%"),f=U(T,"x2","y2",!1,u,"100%","0%");var v=L(new z0(G,b,f,h),T);return v._scaleToBounds=u,null}var A={"#document":function(T,q,_,z){var G=T.childNodes;for(var C=0,P=G.length;C<P;C++){var j=G[C];if(j.nodeType===1)return E(j,_,z)}},g:H,svg:H,clippath:H,polygon:W,polyline:W,path:Y,lineargradient:F,radialgradient:F,image:function(T){var q=new e0(J(T,"href",!0));return q.on("load",function(){var _=Z(T);this.setSize(_);var z=U(T).add(_.divide(2));this._matrix.append(new V0().translate(z))}),q},symbol:function(T,q,_,z){return new d0(H(T,q,_,z),!0)},defs:H,use:function(T){var q=(J(T,"href",!0)||"").substring(1),_=$[q],z=U(T);return _?_ instanceof d0?_.place(z):_.clone().translate(z):null},circle:function(T){return new k0.Circle(U(T,"cx","cy"),J(T,"r"))},ellipse:function(T){return new k0.Ellipse({center:U(T,"cx","cy"),radius:Z(T,"rx","ry")})},rect:function(T){return new k0.Rectangle(new t(U(T),Z(T)),Z(T,"rx","ry"))},line:function(T){return new F0.Line(U(T,"x1","y1"),U(T,"x2","y2"))},text:function(T){var q=new g8(U(T).add(U(T,"dx","dy")));return q.setContent(T.textContent.trim()||""),q},switch:H};function V(T,q,_,z){if(T.transform){var G=(z.getAttribute(_)||"").split(/\)\s*/g),C=new V0;for(var P=0,j=G.length;P<j;P++){var k=G[P];if(!k)break;var x=k.split(/\(\s*/),b=x[0],f=x[1].split(/[\s,]+/g);for(var h=0,u=f.length;h<u;h++)f[h]=parseFloat(f[h]);switch(b){case"matrix":C.append(new V0(f[0],f[1],f[2],f[3],f[4],f[5]));break;case"rotate":C.rotate(f[0],f[1]||0,f[2]||0);break;case"translate":C.translate(f[0],f[1]||0);break;case"scale":C.scale(f);break;case"skewX":C.skew(f[0],0);break;case"skewY":C.skew(0,f[0]);break}}T.transform(C)}}function O(T,q,_){var z=_==="fill-opacity"?"getFillColor":"getStrokeColor",G=T[z]&&T[z]();if(G)G.setAlpha(parseFloat(q))}var X=S.set(S.each(L8,function(T){this[T.attribute]=function(q,_){if(q[T.set]){if(q[T.set](K(_,T.type,T.fromSVG)),T.type==="color"){var z=q[T.get]();if(z){if(z._scaleToBounds){var G=q.getBounds();z.transform(new V0().translate(G.getPoint()).scale(G.getSize()))}}}}}},{}),{id:function(T,q){if($[q]=T,T.setName)T.setName(q)},"clip-path":function(T,q){var _=B(q);if(_)if(_=_.clone(),_.setClipMask(!0),T instanceof v0)T.insertChild(0,_);else return new v0(_,T)},gradientTransform:V,transform:V,"fill-opacity":O,"stroke-opacity":O,visibility:function(T,q){if(T.setVisible)T.setVisible(q==="visible")},display:function(T,q){if(T.setVisible)T.setVisible(q!==null)},"stop-color":function(T,q){if(T.setColor)T.setColor(q)},"stop-opacity":function(T,q){if(T._color)T._color.setAlpha(parseFloat(q))},offset:function(T,q){if(T.setOffset){var _=q.match(/(.*)%$/);T.setOffset(_?_[1]/100:parseFloat(q))}},viewBox:function(T,q,_,z,G){var C=new t(K(q,"array")),P=Z(z,null,null,!0),j,k;if(T instanceof v0){var x=P?P.divide(C.getSize()):1,k=new V0().scale(x).translate(C.getPoint().negate());j=T}else if(T instanceof d0){if(P)C.setSize(P);j=T._item}if(j){if(N(z,"overflow",G)!=="visible"){var b=new k0.Rectangle(C);b.setClipMask(!0),j.addChild(b)}if(k)j.transform(k)}}});function N(T,q,_){var z=T.attributes[q],G=z&&z.value;if(!G&&T.style){var C=S.camelize(q);if(G=T.style[C],!G&&_.node[C]!==_.parent[C])G=_.node[C]}return!G?I:G==="none"?null:G}function L(T,q,_){var z=q.parentNode,G={node:N0.getStyles(q)||{},parent:!_&&!/^defs$/i.test(z.tagName)&&N0.getStyles(z)||{}};return S.each(X,function(C,P){var j=N(q,P,G);T=j!==I&&C(T,j,P,q,G)||T}),T}function B(T){var q=T&&T.match(/\((?:["'#]*)([^"')]+)/),_=q&&q[1],z=_&&$[w?_.replace(w.location.href.split("#")[0]+"#",""):_];if(z&&z._scaleToBounds)z=z.clone(),z._scaleToBounds=!0;return z}function E(T,q,_){var z=T.nodeName.toLowerCase(),G=z!=="#document",C=g.body,P,j,k;if(_&&G)Q=W0.getView().getSize(),Q=Z(T,null,null,!0)||Q,P=_0.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),j=T.parentNode,k=T.nextSibling,P.appendChild(T),C.appendChild(P);var x=W0.settings,b=x.applyMatrix,f=x.insertItems;x.applyMatrix=!1,x.insertItems=!1;var h=A[z],u=h&&h(T,z,q,_)||null;if(x.insertItems=f,x.applyMatrix=b,u){if(G&&!(u instanceof v0))u=L(u,T,_);var v=q.onImport,m=G&&T.getAttribute("data-paper-data");if(v)u=v(T,u,q)||u;if(q.expandShapes&&u instanceof k0)u.remove(),u=u.toPath();if(m)u._data=JSON.parse(m)}if(P){if(C.removeChild(P),j)if(k)j.insertBefore(T,k);else j.appendChild(T)}if(_){if($={},u&&S.pick(q.applyMatrix,b))u.matrix.apply(!0,!0)}return u}function R(T,q,_){if(!T)return null;q=typeof q==="function"?{onLoad:q}:q||{};var z=W0,G=null;function C(x){try{var b=typeof x==="object"?x:new M.DOMParser().parseFromString(x.trim(),"image/svg+xml");if(!b.nodeName)throw b=null,new Error("Unsupported SVG source: "+T);if(W0=z,G=E(b,q,!0),!q||q.insert!==!1)_._insertItem(I,G);var f=q.onLoad;if(f)f(G,x)}catch(h){P(h)}}function P(x,b){var f=q.onError;if(f)f(x,b);else throw new Error(x)}if(typeof T==="string"&&!/^[\s\S]*</.test(T)){var j=g.getElementById(T);if(j)C(j);else c8.request({url:T,async:!0,onLoad:C,onError:P})}else if(typeof File!=="undefined"&&T instanceof File){var k=new FileReader;return k.onload=function(){C(k.result)},k.onerror=function(){P(k.error)},k.readAsText(T)}else C(T);return G}Q0.inject({importSVG:function(T,q){return R(T,q,this)}}),J8.inject({importSVG:function(T,q){return this.activate(),R(T,q,this)}})};var W0=new($0.inject(S.exports,{Base:S,Numerical:Z0,Key:_8,DomEvent:I0,DomElement:N0,document:g,window:w,Symbol:d0,PlacedSymbol:O8}));if(W0.agent.node)(()=>({}))(W0);if(typeof define==="function"&&define.amd)define("paper",W0);else if(typeof r0==="object"&&r0)r0.exports=W0;return W0}.call(M8,typeof self==="object"?self:null)});var F6=E8(H8(),1);var Y8=E8(H8(),1);import{useRef as e8,useEffect as $6} from"preact/hooks";import{useEditor as Q6} from"@blockcode/core";import{ScratchBlocks as j0} from"@blockcode/blocks-editor";import{ScratchBlocks as f0} from"@blockcode/blocks-editor";var D=new f0.Generator("JavaScript");D.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(globalThis).join(","));D.ORDER_ATOMIC=0;D.ORDER_NEW=1.1;D.ORDER_MEMBER=1.2;D.ORDER_FUNCTION_CALL=2;D.ORDER_INCREMENT=3;D.ORDER_DECREMENT=3;D.ORDER_BITWISE_NOT=4.1;D.ORDER_UNARY_PLUS=4.2;D.ORDER_UNARY_NEGATION=4.3;D.ORDER_LOGICAL_NOT=4.4;D.ORDER_TYPEOF=4.5;D.ORDER_VOID=4.6;D.ORDER_DELETE=4.7;D.ORDER_DIVISION=5.1;D.ORDER_MULTIPLICATION=5.2;D.ORDER_MODULUS=5.3;D.ORDER_SUBTRACTION=6.1;D.ORDER_ADDITION=6.2;D.ORDER_BITWISE_SHIFT=7;D.ORDER_RELATIONAL=8;D.ORDER_IN=8;D.ORDER_INSTANCEOF=8;D.ORDER_EQUALITY=9;D.ORDER_BITWISE_AND=10;D.ORDER_BITWISE_XOR=11;D.ORDER_BITWISE_OR=12;D.ORDER_LOGICAL_AND=13;D.ORDER_LOGICAL_OR=14;D.ORDER_CONDITIONAL=15;D.ORDER_ASSIGNMENT=16;D.ORDER_COMMA=17;D.ORDER_NONE=99;D.ORDER_OVERRIDES=[[D.ORDER_FUNCTION_CALL,D.ORDER_MEMBER],[D.ORDER_FUNCTION_CALL,D.ORDER_FUNCTION_CALL],[D.ORDER_MEMBER,D.ORDER_MEMBER],[D.ORDER_MEMBER,D.ORDER_FUNCTION_CALL],[D.ORDER_LOGICAL_NOT,D.ORDER_LOGICAL_NOT],[D.ORDER_MULTIPLICATION,D.ORDER_MULTIPLICATION],[D.ORDER_ADDITION,D.ORDER_ADDITION],[D.ORDER_LOGICAL_AND,D.ORDER_LOGICAL_AND],[D.ORDER_LOGICAL_OR,D.ORDER_LOGICAL_OR]];D.init=function(M){if(D.definitions_=Object.create(null),D.functionNames_=Object.create(null),!D.variableDB_)D.variableDB_=new f0.Names(D.RESERVED_WORDS_);else D.variableDB_.reset();D.variableDB_.setVariableMap(M.getVariableMap());var I=[],w=M.getAllVariables();for(var g=0;g<w.length;g++){if(w[g].type===f0.BROADCAST_MESSAGE_VARIABLE_TYPE)continue;const a=D.variableDB_.getName(w[g].getId(),f0.Variables.NAME_TYPE);if(w[g].type===f0.LIST_VARIABLE_TYPE)I.push(`let ${a}${f0.LIST_VARIABLE_TYPE} = [];`);else I.push(`let ${a} = 0;`)}var S=f0.Variables.allDeveloperVariables(M);for(var g=0;g<S.length;g++){const $0=D.variableDB_.getName(S[g],f0.Names.DEVELOPER_VARIABLE_TYPE);if(w[g].type===f0.LIST_VARIABLE_TYPE)I.push(`let ${$0}${f0.LIST_VARIABLE_TYPE} = [];`);else I.push(`let ${$0} = 0;`)}if(I.length)D.definitions_.variables=I.join("\n")};D.finish=function(M){var I=[];for(var w in D.definitions_)I.push(D.definitions_[w]);return delete D.definitions_,delete D.functionNames_,D.variableDB_.reset(),I.join("\n\n")+"\n\n\n"+M};D.scrubNakedValue=function(M){return M+";\n"};D.quote_=function(M){return M=M.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"),"'"+M+"'"};D.HAT_CODE="/* HatCode */";D.scrub_=function(M,I){var w="";if(!M.outputConnection||!M.outputConnection.targetConnection){var g=M.getCommentText();if(g=f0.utils.wrap(g,D.COMMENT_WRAP-3),g)if(M.getProcedureDef)w+="/**\n"+D.prefixLines(g+"\n"," * ")+" */\n";else w+=D.prefixLines(g+"\n","// ");for(var S=0;S<M.inputList.length;S++)if(M.inputList[S].type==f0.INPUT_VALUE){var a=M.inputList[S].connection.targetBlock();if(a){var g=D.allNestedComments(a);if(g)w+=D.prefixLines(g,"// ")}}}if(M.startHat_){const $0=M.nextConnection&&M.nextConnection.targetBlock();let T0=D.blockToCode($0);if(T0)T0=D.prefixLines(T0,D.INDENT),I=I.replace(D.HAT_CODE,T0);return w+I}if(M.parentBlock_){const $0=M.nextConnection&&M.nextConnection.targetBlock(),T0=D.blockToCode($0);return w+I+T0}return""};D.getAdjusted=function(M,I,w,g,S){var a=w||0,$0=S||D.ORDER_NONE;if(M.workspace.options.oneBasedIndex)a--;var T0=M.workspace.options.oneBasedIndex?"1":"0";if(a>0)var O0=D.valueToCode(M,I,D.ORDER_ADDITION)||T0;else if(a<0)var O0=D.valueToCode(M,I,D.ORDER_SUBTRACTION)||T0;else if(g)var O0=D.valueToCode(M,I,D.ORDER_UNARY_NEGATION)||T0;else var O0=D.valueToCode(M,I,$0)||T0;if(f0.isNumber(O0)){if(O0=parseFloat(O0)+a,g)O0=-O0}else{if(a>0){O0=O0+" + "+a;var D0=D.ORDER_ADDITION}else if(a<0){O0=O0+" - "+-a;var D0=D.ORDER_SUBTRACTION}if(g){if(a)O0="-("+O0+")";else O0="-"+O0;var D0=D.ORDER_UNARY_NEGATION}if(D0=Math.floor(D0),$0=Math.floor($0),D0&&$0>=D0)O0="("+O0+")"}return O0};var B8="if (abort || !runtime.running) break;\n",Q8=`  await runtime.nextFrame();\n  ${B8}`;D.control_wait=(M)=>{let I="";if(D.STATEMENT_PREFIX)I+=D.injectId(D.STATEMENT_PREFIX,M);const w=D.valueToCode(M,"DURATION",D.ORDER_NONE)||0;return I+=`await runtime.sleep(runtime.number(${w}));\n${B8}`,I};D.control_repeat=(M)=>{let I="";if(D.STATEMENT_PREFIX)I+=D.injectId(D.STATEMENT_PREFIX,M);let w=D.statementToCode(M,"SUBSTACK")||"";if(D.STATEMENT_SUFFIX)w=D.prefixLines(D.injectId(D.STATEMENT_SUFFIX,M),D.INDENT)+w;const g=D.valueToCode(M,"TIMES",D.ORDER_NONE)||0;return I+=`for (let _ = 0; _ < runtime.number(${g}); _++) {\n${Q8}${w}}\n`,I};D.control_forever=(M)=>{let I="";if(D.STATEMENT_PREFIX)I+=D.injectId(D.STATEMENT_PREFIX,M);let w=D.statementToCode(M,"SUBSTACK")||"";if(D.STATEMENT_SUFFIX)w=D.prefixLines(D.injectId(D.STATEMENT_SUFFIX,M),D.INDENT)+w;return I+=`while (true) {\n${Q8}${w}}\n`,I};D.control_if=(M)=>{let I="";if(D.STATEMENT_PREFIX)I+=D.injectId(D.STATEMENT_PREFIX,M);let w=D.statementToCode(M,"SUBSTACK")||"";if(D.STATEMENT_SUFFIX)w=D.prefixLines(D.injectId(D.STATEMENT_SUFFIX,M),D.INDENT)+w;const g=D.valueToCode(M,"CONDITION",D.ORDER_NONE)||"false";if(I+=`if (${g}) {\n${w}}\n`,M.getInput("SUBSTACK2")){if(w=D.statementToCode(M,"SUBSTACK2")||"",D.STATEMENT_SUFFIX)w=D.prefixLines(D.injectId(D.STATEMENT_SUFFIX,M),D.INDENT)+w;I+=`else {\n${w}}\n`}return I};D.control_if_else=D.control_if;D.control_wait_until=(M)=>{let I="";if(D.STATEMENT_PREFIX)I+=D.injectId(D.STATEMENT_PREFIX,M);const w=D.valueToCode(M,"CONDITION",D.ORDER_NONE)||"false";return I+=`while (!(${w})) {\n${Q8}}\n`,I};D.control_repeat_until=(M)=>{let I="";if(D.STATEMENT_PREFIX)I+=D.injectId(D.STATEMENT_PREFIX,M);let w=D.statementToCode(M,"SUBSTACK")||"";if(D.STATEMENT_SUFFIX)w=D.prefixLines(D.injectId(D.STATEMENT_SUFFIX,M),D.INDENT)+w;const g=D.valueToCode(M,"CONDITION",D.ORDER_NONE)||"false";return I+=`while (!(${g})) {\n${Q8}${w}}\n`,I};D.control_while=(M)=>{let I="";if(D.STATEMENT_PREFIX)I+=D.injectId(D.STATEMENT_PREFIX,M);let w=D.statementToCode(M,"SUBSTACK")||"";if(D.STATEMENT_SUFFIX)w=D.prefixLines(D.injectId(D.STATEMENT_SUFFIX,M),D.INDENT)+w;const g=D.valueToCode(M,"CONDITION",D.ORDER_NONE)||"false";return I+=`while (${g}) {\n${Q8}${w}}\n`,I};D.control_stop=(M)=>{let I="";if(D.STATEMENT_PREFIX)I+=D.injectId(D.STATEMENT_PREFIX,M);switch(M.getFieldValue("STOP_OPTION")){case"all":I+="runtime.stop();\n";break;case"this script":I+="return done();\n";break;case"other scripts in sprite":I+="abort = true;\n";break}return I};import{ScratchBlocks as E0} from"@blockcode/blocks-editor";D.data_variable=(M)=>{return[D.variableDB_.getName(M.getFieldValue("VARIABLE"),E0.Variables.NAME_TYPE),D.ORDER_CONDITIONAL]};D.data_setvariableto=(M)=>{let I="";if(D.STATEMENT_PREFIX)I+=D.injectId(D.STATEMENT_PREFIX,M);const w=D.variableDB_.getName(M.getFieldValue("VARIABLE"),E0.Variables.NAME_TYPE),g=D.valueToCode(M,"VALUE",D.ORDER_NONE)||'""';return I+=`${w} = ${g};\n`,I};D.data_changevariableby=(M)=>{let I="";if(D.STATEMENT_PREFIX)I+=D.injectId(D.STATEMENT_PREFIX,M);const w=D.variableDB_.getName(M.getFieldValue("VARIABLE"),E0.Variables.NAME_TYPE),g=D.valueToCode(M,"VALUE",D.ORDER_NONE)||0;return I+=`${w} = runtime.number(${w}) + runtime.number(${g});\n`,I};D.data_listcontents=(M)=>{return[D.variableDB_.getName(M.getFieldValue("LIST"),E0.Variables.NAME_TYPE)+E0.LIST_VARIABLE_TYPE,D.ORDER_ATOMIC]};D.data_addtolist=(M)=>{let I="";if(D.STATEMENT_PREFIX)I+=D.injectId(D.STATEMENT_PREFIX,M);const w=D.variableDB_.getName(M.getFieldValue("LIST"),E0.Variables.NAME_TYPE)+E0.LIST_VARIABLE_TYPE,g=D.valueToCode(M,"ITEM",D.ORDER_NONE)||'""';return I+=`${w}.push(${g});\n`,I};D.data_deleteoflist=(M)=>{let I="";if(D.STATEMENT_PREFIX)I+=D.injectId(D.STATEMENT_PREFIX,M);const w=D.variableDB_.getName(M.getFieldValue("LIST"),E0.Variables.NAME_TYPE)+E0.LIST_VARIABLE_TYPE,g=D.valueToCode(M,"INDEX",D.ORDER_NONE)||1;return I+=`${w}.splice(runtime.index(${g}, ${w}.length), 1);\n`,I};D.data_deletealloflist=(M)=>{let I="";if(D.STATEMENT_PREFIX)I+=D.injectId(D.STATEMENT_PREFIX,M);const w=D.variableDB_.getName(M.getFieldValue("LIST"),E0.Variables.NAME_TYPE)+E0.LIST_VARIABLE_TYPE;return I+=`${w}.length = 0;\n`,I};D.data_insertatlist=(M)=>{let I="";if(D.STATEMENT_PREFIX)I+=D.injectId(D.STATEMENT_PREFIX,M);const w=D.variableDB_.getName(M.getFieldValue("LIST"),E0.Variables.NAME_TYPE)+E0.LIST_VARIABLE_TYPE,g=D.valueToCode(M,"INDEX",D.ORDER_NONE)||1,S=D.valueToCode(M,"ITEM",D.ORDER_NONE)||'""';return I+=`${w}.splice(runtime.index(${g}, ${w}.length), 0, ${S});\n`,I};D.data_replaceitemoflist=(M)=>{let I="";if(D.STATEMENT_PREFIX)I+=D.injectId(D.STATEMENT_PREFIX,M);const w=D.variableDB_.getName(M.getFieldValue("LIST"),E0.Variables.NAME_TYPE)+E0.LIST_VARIABLE_TYPE,g=D.valueToCode(M,"INDEX",D.ORDER_NONE)||1,S=D.valueToCode(M,"ITEM",D.ORDER_NONE)||'""';return I+=`${w}.splice(runtime.index(${g}, ${w}.length), 1, ${S});\n`,I};D.data_itemoflist=(M)=>{const I=D.variableDB_.getName(M.getFieldValue("LIST"),E0.Variables.NAME_TYPE)+E0.LIST_VARIABLE_TYPE,w=D.valueToCode(M,"INDEX",D.ORDER_NONE)||1;return[`(${I}[runtime.index(${w}, ${I}.length)] || '""')`,D.ORDER_CONDITIONAL]};D.data_itemnumoflist=(M)=>{const I=D.variableDB_.getName(M.getFieldValue("LIST"),E0.Variables.NAME_TYPE)+E0.LIST_VARIABLE_TYPE,w=D.valueToCode(M,"ITEM",D.ORDER_NONE)||'""';return[`(${I}.indexOf(${w}) + 1)`,D.ORDER_NONE]};D.data_lengthoflist=(M)=>{return[`${D.variableDB_.getName(M.getFieldValue("LIST"),E0.Variables.NAME_TYPE)+E0.LIST_VARIABLE_TYPE}.length`,D.ORDER_MEMBER]};D.data_listcontainsitem=(M)=>{const I=D.variableDB_.getName(M.getFieldValue("LIST"),E0.Variables.NAME_TYPE)+E0.LIST_VARIABLE_TYPE,w=D.valueToCode(M,"ITEM",D.ORDER_NONE)||'""';return[`${I}.includes(${w})`,D.ORDER_FUNCTION_CALL]};import{ScratchBlocks as G8} from"@blockcode/blocks-editor";var t8="if (abort || !runtime.running) break;\n",N8=`async (done) => {\ndo {\n${D.HAT_CODE}} while (false);\n  done();\n}`;D.event_whenflagclicked=(M)=>{return`runtime.when('start', ${N8});\n`};D.event_whengreaterthan=(M)=>{const I=M.getFieldValue("WHENGREATERTHANMENU"),w=D.valueToCode(M,"VALUE",D.ORDER_NONE)||10;return`runtime.whenGreaterThen('${I}', runtime.number(${w}), ${N8});\n`};D.event_whenbroadcastreceived=(M)=>{return`runtime.when('message:${D.variableDB_.getName(M.getFieldValue("BROADCAST_OPTION"),G8.Variables.NAME_TYPE)}', ${N8});\n`};D.event_broadcast_menu=(M)=>{return[D.variableDB_.getName(M.getFieldValue("BROADCAST_OPTION"),G8.Variables.NAME_TYPE),D.ORDER_ATOMIC]};D.event_broadcast=(M)=>{let I="";if(D.STATEMENT_PREFIX)I+=D.injectId(D.STATEMENT_PREFIX,M);const w=D.valueToCode(M,"BROADCAST_INPUT",D.ORDER_NONE)||"message1";return I+=`runtime.fire('message:${w}')\n`,I};D.event_broadcastandwait=(M)=>{let I="";if(D.STATEMENT_PREFIX)I+=D.injectId(D.STATEMENT_PREFIX,M);const w=D.valueToCode(M,"BROADCAST_INPUT",D.ORDER_NONE)||"message1";return I+=`await runtime.fire('message:${w}')\n${t8}`,I};D.math_number=(M)=>{let I=parseFloat(M.getFieldValue("NUM")),w;if(I===Infinity)I="Infinity",w=D.ORDER_FUNCTION_CALL;else if(I===(-Infinity))I="-Infinity",w=D.ORDER_UNARY_SIGN;else if(Number.isNaN(I))I="NaN",w=D.ORDER_UNARY_SIGN;else w=I<0?D.ORDER_UNARY_SIGN:D.ORDER_ATOMIC;return[I,w]};D.math_integer=(M)=>{const I=parseInt(M.getFieldValue("NUM")),w=I<0?D.ORDER_UNARY_SIGN:D.ORDER_ATOMIC;return[I,w]};D.math_whole_number=(M)=>{return[Math.abs(parseInt(M.getFieldValue("NUM"))),D.ORDER_ATOMIC]};D.math_positive_number=(M)=>{let I=parseFloat(M.getFieldValue("NUM")),w;if(I===Infinity)I="Infinity",w=D.ORDER_FUNCTION_CALL;else if(I===(-Infinity))I="-Infinity",w=D.ORDER_FUNCTION_CALL;else if(Number.isNaN(I))I="NaN",w=D.ORDER_FUNCTION_CALL;else I=I<0?0:I,w=D.ORDER_ATOMIC;return[I,w]};D.math_angle=(M)=>{let I=parseFloat(M.getFieldValue("NUM")),w;if(I==Infinity)I="Infinity",w=D.ORDER_FUNCTION_CALL;else if(I==(-Infinity))I="-Infinity",w=D.ORDER_UNARY_SIGN;else I=I%360,I=I<0?I+360:I,w=D.ORDER_ATOMIC;return[I,w]};D.operator_add=(M)=>{const I=D.valueToCode(M,"NUM1",D.ORDER_NONE)||0,w=D.valueToCode(M,"NUM2",D.ORDER_NONE)||0;return[`(runtime.number(${I}) + runtime.number(${w}))`,D.ORDER_SUBTRACTION]};D.operator_subtract=(M)=>{const I=D.valueToCode(M,"NUM1",D.ORDER_NONE)||0,w=D.valueToCode(M,"NUM2",D.ORDER_NONE)||0;return[`(runtime.number(${I}) - runtime.number(${w}))`,D.ORDER_ADDITION]};D.operator_multiply=(M)=>{const I=D.valueToCode(M,"NUM1",D.ORDER_NONE)||0,w=D.valueToCode(M,"NUM2",D.ORDER_NONE)||0;return[`(runtime.number(${I}) * runtime.number(${w}))`,D.ORDER_MULTIPLICATION]};D.operator_divide=(M)=>{const I=D.valueToCode(M,"NUM1",D.ORDER_NONE)||0,w=D.valueToCode(M,"NUM2",D.ORDER_NONE)||0;return[`(runtime.number(${I}) / runtime.number(${w}))`,D.ORDER_DIVISION]};D.operator_random=(M)=>{const I=D.valueToCode(M,"FROM",D.ORDER_NONE)||0,w=D.valueToCode(M,"TO",D.ORDER_NONE)||0;return[`runtime.random(${I}, ${w})`,D.ORDER_FUNCTION_CALL]};D.operator_gt=(M)=>{const I=D.valueToCode(M,"OPERAND1",D.ORDER_NONE)||0,w=D.valueToCode(M,"OPERAND2",D.ORDER_NONE)||0;return[`(runtime.number(${I}) > runtime.number(${w}))`,D.ORDER_RELATIONAL]};D.operator_lt=(M)=>{const I=D.valueToCode(M,"OPERAND1",D.ORDER_NONE)||0,w=D.valueToCode(M,"OPERAND2",D.ORDER_NONE)||0;return[`(runtime.number(${I}) < runtime.number(${w}))`,D.ORDER_RELATIONAL]};D.operator_equals=(M)=>{const I=D.valueToCode(M,"OPERAND1",D.ORDER_NONE)||0,w=D.valueToCode(M,"OPERAND2",D.ORDER_NONE)||0;return[`(${I} == ${w})`,D.ORDER_RELATIONAL]};D.operator_and=(M)=>{const I=D.valueToCode(M,"OPERAND1",D.ORDER_NONE)||0,w=D.valueToCode(M,"OPERAND2",D.ORDER_NONE)||0;return[`(${I} && ${w})`,D.ORDER_LOGICAL_AND]};D.operator_or=(M)=>{const I=D.valueToCode(M,"OPERAND1",D.ORDER_NONE)||0,w=D.valueToCode(M,"OPERAND2",D.ORDER_NONE)||0;return[`(${I} || ${w})`,D.ORDER_LOGICAL_OR]};D.operator_not=(M)=>{return[`!(${D.valueToCode(M,"OPERAND",D.ORDER_NONE)||0})`,D.ORDER_LOGICAL_NOT]};D.operator_join=(M)=>{const I=D.valueToCode(M,"STRING1",D.ORDER_NONE)||'""',w=D.valueToCode(M,"STRING2",D.ORDER_NONE)||'""';return[`(String(${I}) + String(${w}))`,D.ORDER_ATOMIC]};D.operator_letter_of=(M)=>{const I=D.valueToCode(M,"LETTER",D.ORDER_NONE)||0;return[`(String(${D.valueToCode(M,"STRING",D.ORDER_NONE)||'""'}).at(${I} - 1) || '')`,D.ORDER_ATOMIC]};D.operator_length=(M)=>{return[`String(${D.valueToCode(M,"STRING",D.ORDER_NONE)||'""'}).length`,D.ORDER_MEMBER]};D.operator_contains=(M)=>{const I=D.valueToCode(M,"STRING1",D.ORDER_NONE)||'""',w=D.valueToCode(M,"STRING2",D.ORDER_NONE)||'""';return[`String(${I}).includes(String(${w}))`,D.ORDER_FUNCTION_CALL]};D.operator_mod=(M)=>{const I=D.valueToCode(M,"NUM1",D.ORDER_NONE)||0,w=D.valueToCode(M,"NUM2",D.ORDER_NONE)||0;return[`(runtime.number(${I}) % runtime.number(${w}))`,D.ORDER_MODULUS]};D.operator_round=(M)=>{return[`Math.round(${D.valueToCode(M,"NUM",D.ORDER_NONE)||0})`,D.ORDER_FUNCTION_CALL]};D.operator_mathop=(M)=>{const I=D.valueToCode(M,"NUM",D.ORDER_NONE)||0,w=M.getFieldValue("OPERATOR");let g="";if(w==="ceiling")g+=`Math.ceil(runtime.number(${I}))`;else if(w==="sin"||w==="cos"||w==="tan")g+=`Math.${w}(Math.PI * runtime.number(${I}) / 180)`;else if(w==="asin"||w==="acos"||w==="atan")g+=`(Math.${w}(runtime.number(${I})) * 180 / Math.PI)`;else if(w==="ln")g+=`Math.log(runtime.number(${I}))`;else if(w==="log")g+=`Math.log10(runtime.number(${I}))`;else if(w==="e ^")g+=`Math.exp(runtime.number(${I}))`;else if(w==="10 ^")g+=`Math.pow(10, runtime.number(${I}))`;else g+=`Math.${w}(runtime.number(${I}))`;return[g,D.ORDER_FUNCTION_CALL]};D.procedures_definition=(M)=>{};D.procedures_call=(M)=>{};D.procedures_prototype=(M)=>{};D.procedures_declaration=(M)=>{};D.argument_reporter_boolean=(M)=>{};D.argument_reporter_string_number=(M)=>{};D.argument_editor_boolean=(M)=>{};D.argument_editor_string_number=(M)=>{};D.sensing_timer=(M)=>{return["runtime.time",D.ORDER_FUNCTION_CALL]};D.sensing_resettimer=(M)=>{return"runtime.resetTimer()\n"};D.text=(M)=>{const I=M.getFieldValue("TEXT");return[isNaN(I)?D.quote_(I):+I,D.ORDER_ATOMIC]};function U6({width:M,height:I,onSetup:w,...g}){const S=e8(null),{fileList:a,selectedIndex:$0,modifyFile:T0}=Q6(),O0=a[$0];return S.script=O0.script,S.xml=O0.xml,$6(()=>{if(S.current){if(Y8.default.setup(S.current),w)w(S.current);const D0=()=>{const Z0=j0.getMainWorkspace();if(Z0){Z0.addChangeListener((n0)=>{if(Z0.isDragging())return;if(!J6.has(n0.type))return;const y=j0.Xml.workspaceToDom(Z0),h0=j0.Xml.domToText(y).replace(/<variable type="broadcast_msg"[^>]+>[^<]+<\/variable>/gi,"");if(!S.script||S.xml!==h0){const s=D.workspaceToCode(Z0);if(S.script!==s)T0({script:s})}});return}setTimeout(D0)};D0()}return()=>{Y8.default.project.clear(),Y8.default.project.remove()}},[S]),Z6("canvas",{id:"blockcode-blocks-player",ref:S,style:{width:M,height:I},...g})}import{jsx as Z6} from"preact/jsx-runtime";var J6=new Set([j0.Events.BLOCK_CHANGE,j0.Events.BLOCK_CREATE,j0.Events.BLOCK_DELETE,j0.Events.BLOCK_MOVE,j0.Events.COMMENT_CHANGE,j0.Events.COMMENT_CREATE,j0.Events.COMMENT_DELETE,j0.Events.COMMENT_MOVE,j0.Events.VAR_CREATE,j0.Events.VAR_DELETE,j0.Events.VAR_RENAME]);var K6=function(M){console&&console.warn&&console.warn(M)},A0=function(){A0.init.call(this)},X8=function(M){if(typeof M!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof M)},w8=function(M){return M._maxListeners===void 0?A0.defaultMaxListeners:M._maxListeners},j8=function(M,I,w,g){var S,a,$0;if(X8(w),a=M._events,a===void 0?(a=M._events=Object.create(null),M._eventsCount=0):(a.newListener!==void 0&&(M.emit("newListener",I,w.listener?w.listener:w),a=M._events),$0=a[I]),$0===void 0)$0=a[I]=w,++M._eventsCount;else if(typeof $0=="function"?$0=a[I]=g?[w,$0]:[$0,w]:g?$0.unshift(w):$0.push(w),S=w8(M),S>0&&$0.length>S&&!$0.warned){$0.warned=!0;var T0=new Error("Possible EventEmitter memory leak detected. "+$0.length+" "+String(I)+" listeners added. Use emitter.setMaxListeners() to increase limit");T0.name="MaxListenersExceededWarning",T0.emitter=M,T0.type=I,T0.count=$0.length,K6(T0)}return M},W6=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)},k8=function(M,I,w){var g={fired:!1,wrapFn:void 0,target:M,type:I,listener:w},S=W6.bind(g);return S.listener=w,g.wrapFn=S,S},f8=function(M,I,w){var g=M._events;if(g===void 0)return[];var S=g[I];return S===void 0?[]:typeof S=="function"?w?[S.listener||S]:[S]:w?Y6(S):y8(S,S.length)},b8=function(M){var I=this._events;if(I!==void 0){var w=I[M];if(typeof w=="function")return 1;if(w!==void 0)return w.length}return 0},y8=function(M,I){for(var w=new Array(I),g=0;g<I;++g)w[g]=M[g];return w},H6=function(M,I){for(;I+1<M.length;I++)M[I]=M[I+1];M.pop()},Y6=function(M){for(var I=new Array(M.length),w=0;w<I.length;++w)I[w]=M[w].listener||M[w];return I};var a0=typeof Reflect=="object"?Reflect:null,S8=a0&&typeof a0.apply=="function"?a0.apply:function(M,I,w){return Function.prototype.apply.call(M,I,w)},F8;a0&&typeof a0.ownKeys=="function"?F8=a0.ownKeys:Object.getOwnPropertySymbols?F8=function(M){return Object.getOwnPropertyNames(M).concat(Object.getOwnPropertySymbols(M))}:F8=function(M){return Object.getOwnPropertyNames(M)};var P8=Number.isNaN||function(M){return M!==M};A0.EventEmitter=A0;A0.prototype._events=void 0;A0.prototype._eventsCount=0;A0.prototype._maxListeners=void 0;var C8=10;Object.defineProperty(A0,"defaultMaxListeners",{enumerable:!0,get:function(){return C8},set:function(M){if(typeof M!="number"||M<0||P8(M))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+M+".");C8=M}});A0.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};A0.prototype.setMaxListeners=function(M){if(typeof M!="number"||M<0||P8(M))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+M+".");return this._maxListeners=M,this};A0.prototype.getMaxListeners=function(){return w8(this)};A0.prototype.emit=function(M){for(var I=[],w=1;w<arguments.length;w++)I.push(arguments[w]);var g=M==="error",S=this._events;if(S!==void 0)g=g&&S.error===void 0;else if(!g)return!1;if(g){var a;if(I.length>0&&(a=I[0]),a instanceof Error)throw a;var $0=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw $0.context=a,$0}var T0=S[M];if(T0===void 0)return!1;if(typeof T0=="function")S8(T0,this,I);else for(var O0=T0.length,D0=y8(T0,O0),w=0;w<O0;++w)S8(D0[w],this,I);return!0};A0.prototype.addListener=function(M,I){return j8(this,M,I,!1)};A0.prototype.on=A0.prototype.addListener;A0.prototype.prependListener=function(M,I){return j8(this,M,I,!0)};A0.prototype.once=function(M,I){return X8(I),this.on(M,k8(this,M,I)),this};A0.prototype.prependOnceListener=function(M,I){return X8(I),this.prependListener(M,k8(this,M,I)),this};A0.prototype.removeListener=function(M,I){var w,g,S,a,$0;if(X8(I),g=this._events,g===void 0)return this;if(w=g[M],w===void 0)return this;if(w===I||w.listener===I)--this._eventsCount===0?this._events=Object.create(null):(delete g[M],g.removeListener&&this.emit("removeListener",M,w.listener||I));else if(typeof w!="function"){for(S=-1,a=w.length-1;a>=0;a--)if(w[a]===I||w[a].listener===I){$0=w[a].listener,S=a;break}if(S<0)return this;S===0?w.shift():H6(w,S),w.length===1&&(g[M]=w[0]),g.removeListener!==void 0&&this.emit("removeListener",M,$0||I)}return this};A0.prototype.off=A0.prototype.removeListener;A0.prototype.removeAllListeners=function(M){var I,w,g;if(w=this._events,w===void 0)return this;if(w.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):w[M]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete w[M]),this;if(arguments.length===0){var S=Object.keys(w),a;for(g=0;g<S.length;++g)a=S[g],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(I=w[M],typeof I=="function")this.removeListener(M,I);else if(I!==void 0)for(g=I.length-1;g>=0;g--)this.removeListener(M,I[g]);return this};A0.prototype.listeners=function(M){return f8(this,M,!0)};A0.prototype.rawListeners=function(M){return f8(this,M,!1)};A0.listenerCount=function(M,I){return typeof M.listenerCount=="function"?M.listenerCount(I):b8.call(M,I)};A0.prototype.listenerCount=b8;A0.prototype.eventNames=function(){return this._eventsCount>0?F8(this._events):[]};var m6=A0.prototype;var h8=E8(H8(),1);class T8 extends A0{static DEFAULT_FPS=24;constructor(M,I,w=T8.DEFAULT_FPS){super();this._fps=w,this._frame_sec=1/w,this._running=!1,this._requestStop=I,this._timer=0,this._timers=[],this._greaterThen={},this._eventsHappening={},new Function("runtime",M)(this)}get running(){return this._running}get time(){return(Date.now()-this._timer)/1000}resetTimer(){this._timer=Date.now()}when(M,I){this._eventsHappening[M]=this._eventsHappening[M]||[],this._eventsHappening[M].push(!1);const w=this._eventsHappening[M].length-1;this.on(`${M}_${w}`,I)}whenGreaterThen(M,I,w){const g=`${M}>${I}`;this._greaterThen[g]=!1,this.when(`greaterthen:${g}`,w)}emit(...M){return new Promise((I)=>{if(this.running)super.emit(...M,I)})}fire(M,...I){if(this.emit(M,...I),this._eventsHappening[M]=this._eventsHappening[M]||[],this._eventsHappening[M].length>0)return Promise.race(this._eventsHappening[M].map(async(w,g)=>{if(!w)this._eventsHappening[M][g]=!0,await this.emit(`${M}_${g}`,...I),this._eventsHappening[M][g]=!1}));return Promise.resolve()}_handleFrameForGreaterThen(M){const I=Object.keys(this._greaterThen);for(let w of I){const[g,S]=w.split(">");if(g==="TIMER"){const a=this.time>parseFloat(S);if(a&&!this._greaterThen[w])this.fire(`greaterthen:${w}`);this._greaterThen[w]=a}}M()}async _handleStart(){while(this.running){if(!h8.default.project){this.stop();break}await this.nextFrame(),this.fire("frame")}}start(){this._running=!0,this.on("frame",this._handleFrameForGreaterThen.bind(this)),this.on("start",this._handleStart.bind(this)),this.fire("start"),this.resetTimer()}async stop(){this._running=!1,await this.nextFrame(),this._timers.forEach(clearTimeout),this._timers.length=0,this._requestStop()}sleep(M){return new Promise((I)=>this._timers.push(setTimeout(I,M*1000)))}nextFrame(){return this.sleep(this._frame_sec)}random(M=1,I=10){const w=Math.ceil(Math.min(M,I)),g=Math.floor(Math.max(M,I));return Math.floor(Math.random()*(g-w+1))+w}number(M,I=0){return isNaN(M)?I:+M}index(M,I){let w=this.number(M)-1;return w%=I,w+=I,w%I}}var export_paperCore=F6.default;export{export_paperCore as paperCore,D as javascriptGenerator,T8 as Runtime,U6 as BlocksPlayer};
