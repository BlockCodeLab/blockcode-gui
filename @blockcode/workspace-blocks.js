import{Text as X1} from"@blockcode/ui";import{Keys as H} from"@blockcode/core";import{Text as z,Spinner as E1} from"@blockcode/ui";import{ScratchBlocks as J1} from"@blockcode/blocks-editor";import{connectDevice as l,disconnectDevice as Q1,downloadDevice as p} from"@blockcode/device-pyboard";var h=[{usbVendorId:12346},{usbVendorId:11914}];import{jsx as W} from"preact/jsx-runtime";var u=/Mac/i.test(navigator.platform||navigator.userAgent);function b({newProject:O,openStoreLibrary:F,setPrompt:X,setAlert:E,removeAlert:J,extendsMenu:Z,filters:P}={}){let Q=()=>{},U=()=>{},$;const M=()=>{if($=J1.getMainWorkspace(),$){$.addChangeListener(()=>{Q($.undoStack_.length===0),U($.redoStack_.length===0)}),Q($.undoStack_.length===0),U($.redoStack_.length===0);return}setTimeout(M)};M();const _=(Y)=>{if(!_.id)_.id=`download.${Date.now()}`;if(Y<100){if(E)E({id:_.id,icon:W(E1,{level:"success"}),message:W(z,{id:"blocks.alert.downloading",defaultMessage:"Downloading...{progress}%",progress:Y})})}else if(J)J(_.id),delete _.id},j={label:W(z,{id:"blocks.menu.file",defaultMessage:"File"}),menuItems:[[{label:W(z,{id:"blocks.menu.file.newProject",defaultMessage:"New"}),hotkey:[u?H.COMMAND:H.CONTROL,H.N],onClick({context:Y}){if(Y.modified)X({title:W(z,{id:"gui.projects.notSaved",defaultMessage:"Not saved"}),label:W(z,{id:"gui.projects.replaceProject",defaultMessage:"Replace contents of the current project?"}),onSubmit:O});else O()}}],[{label:W(z,{id:"blocks.menu.file.openProject",defaultMessage:"Open"}),hotkey:[u?H.COMMAND:H.CONTROL,H.O],onClick(){F()}},{label:W(z,{id:"blocks.menu.file.saveProject",defaultMessage:"Save"}),hotkey:[u?H.COMMAND:H.CONTROL,H.S],onClick({context:Y}){if(Y.saveNow(),_.id)return;if(Y.device&&Y.editor.autoDownload)p(Y.device,[].concat(Y.fileList,Y.assetList),_)}}],[{label:W(z,{id:"blocks.menu.file.uploadProject",defaultMessage:"Load from your computer"}),disabled:!0,async onClick(){console.log("upload")}},{label:W(z,{id:"blocks.menu.file.downloadProject",defaultMessage:"save to your computer"}),disabled:!0,async onClick(){console.log("download")}}]]},v={label:W(z,{id:"blocks.menu.edit",defaultMessage:"Edit"}),menuItems:[[{label:W(z,{id:"blocks.menu.edit.undo",defaultMessage:"Undo"}),hotkey:[u?H.COMMAND:H.CONTROL,H.Z],onDisable({setDisable:Y}){if(Q=Y,$)Q($.undoStack_.length===0)},async onClick(Y){if(Y instanceof MouseEvent&&$)$.undo(!1)}},{label:W(z,{id:"blocks.menu.edit.redo",defaultMessage:"Redo"}),hotkey:u?[H.SHIFT,H.COMMAND,H.Z]:[H.CONTROL,H.Y],onDisable({setDisable:Y}){if(U=Y,$)U($.redoStack_.length===0)},async onClick(Y){if(Y instanceof MouseEvent&&$)$.undo(!0)}}]]},D={label:W(z,{id:"blocks.menu.device",defaultMessage:"Device"}),menuItems:[[{label:W(z,{id:"blocks.menu.device.connect",defaultMessage:"Connect your device"}),onLabel({locale:Y,context:I}){if(I.device)return Y.getText("blocks.menu.device.disconnect","Disconnect this device");return Y.getText("blocks.menu.device.connect","Connect your device")},onClick({context:Y}){if(Y.device)Q1(Y.device,Y.connectDevice);else l(P||h,Y.connectDevice)}},{label:W(z,{id:"blocks.menu.device.download",defaultMessage:"Download program"}),async onClick({context:Y}){if(_.id)return;let{device:I}=Y;if(!I)I=await l(P,Y.connectDevice);p(I,[].concat(Y.fileList,Y.assetList),_)}}],[{label:W(z,{id:"blocks.menu.device.turnOnAutoDownload",defaultMessage:"Turn on auto download"}),onLabel({locale:Y,context:I}){if(I.editor.autoDownload)return Y.getText("blocks.menu.device.turnOffAutoDownload","Turn off auto download");return Y.getText("blocks.menu.device.turnOnAutoDownload","Turn on auto download")},onDisable({context:Y,setDisable:I}){if(!Y.device&&Y.editor.autoDownload)Y.setEditor({autoDownload:!1});I(!Y.device)},async onClick({context:Y}){Y.setEditor({autoDownload:!Y.editor.autoDownload})}}]]};Z=Z||[];const V=(Y,I)=>{const x=Z.findIndex((g)=>g.id===I);if(x>=0){const[g]=Z.splice(x,1);if(g.hidden)return[];Y.menuItems.concat(g.menuItems)}return Y};return[].concat(V(j,"file"),V(v,"edit"),V(D,"device"),Z)}var c={assetList:[{id:"main",type:"text/x-python",content:`
from popsicle.blocks import *
import code1
run()
`}],fileList:[{id:"code1",type:"text/x-python"}]};import{ScratchBlocks as L} from"@blockcode/blocks-editor";var R=new L.Generator("Python");R.addReservedWords("False,None,True,and,as,assert,break,class,continue,def,del,elif,else,except,exec,finally,for,from,global,if,import,in,is,lambda,nonlocal,not,or,pass,print,raise,return,try,while,with,yield,NotImplemented,Ellipsis,__debug__,quit,exit,copyright,license,credits,ArithmeticError,AssertionError,AttributeError,BaseException,BlockingIOError,BrokenPipeError,BufferError,BytesWarning,ChildProcessError,ConnectionAbortedError,ConnectionError,ConnectionRefusedError,ConnectionResetError,DeprecationWarning,EOFError,Ellipsis,EnvironmentError,Exception,FileExistsError,FileNotFoundError,FloatingPointError,FutureWarning,GeneratorExit,IOError,ImportError,ImportWarning,IndentationError,IndexError,InterruptedError,IsADirectoryError,KeyError,KeyboardInterrupt,LookupError,MemoryError,ModuleNotFoundError,NameError,NotADirectoryError,NotImplemented,NotImplementedError,OSError,OverflowError,PendingDeprecationWarning,PermissionError,ProcessLookupError,RecursionError,ReferenceError,ResourceWarning,RuntimeError,RuntimeWarning,StandardError,StopAsyncIteration,StopIteration,SyntaxError,SyntaxWarning,SystemError,SystemExit,TabError,TimeoutError,TypeError,UnboundLocalError,UnicodeDecodeError,UnicodeEncodeError,UnicodeError,UnicodeTranslateError,UnicodeWarning,UserWarning,ValueError,Warning,ZeroDivisionError,_,__build_class__,__debug__,__doc__,__import__,__loader__,__name__,__package__,__spec__,abs,all,any,apply,ascii,basestring,bin,bool,buffer,bytearray,bytes,callable,chr,classmethod,cmp,coerce,compile,complex,copyright,credits,delattr,dict,dir,divmod,enumerate,eval,exec,execfile,exit,file,filter,float,format,frozenset,getattr,globals,hasattr,hash,help,hex,id,input,int,intern,isinstance,issubclass,iter,len,license,list,locals,long,map,max,memoryview,min,next,object,oct,open,ord,pow,print,property,quit,range,raw_input,reduce,reload,repr,reversed,round,set,setattr,slice,sorted,staticmethod,str,sum,super,tuple,type,unichr,unicode,vars,xrange,zip");R.ORDER_ATOMIC=0;R.ORDER_COLLECTION=1;R.ORDER_STRING_CONVERSION=1;R.ORDER_MEMBER=2.1;R.ORDER_FUNCTION_CALL=2.2;R.ORDER_EXPONENTIATION=3;R.ORDER_UNARY_SIGN=4;R.ORDER_BITWISE_NOT=4;R.ORDER_MULTIPLICATIVE=5;R.ORDER_ADDITIVE=6;R.ORDER_BITWISE_SHIFT=7;R.ORDER_BITWISE_AND=8;R.ORDER_BITWISE_XOR=9;R.ORDER_BITWISE_OR=10;R.ORDER_RELATIONAL=11;R.ORDER_LOGICAL_NOT=12;R.ORDER_LOGICAL_AND=13;R.ORDER_LOGICAL_OR=14;R.ORDER_CONDITIONAL=15;R.ORDER_LAMBDA=16;R.ORDER_NONE=99;R.ORDER_OVERRIDES=[[R.ORDER_FUNCTION_CALL,R.ORDER_MEMBER],[R.ORDER_FUNCTION_CALL,R.ORDER_FUNCTION_CALL],[R.ORDER_MEMBER,R.ORDER_MEMBER],[R.ORDER_MEMBER,R.ORDER_FUNCTION_CALL],[R.ORDER_LOGICAL_NOT,R.ORDER_LOGICAL_NOT],[R.ORDER_LOGICAL_AND,R.ORDER_LOGICAL_AND],[R.ORDER_LOGICAL_OR,R.ORDER_LOGICAL_OR]];R.init=(O)=>{if(R.PASS=R.INDENT+"pass\n",R.definitions_=Object.create(null),R.functionNames_=Object.create(null),!R.variableDB_)R.variableDB_=new L.Names(R.RESERVED_WORDS_);else R.variableDB_.reset();R.variableDB_.setVariableMap(O.getVariableMap());const F=[],X=O.getAllVariables();for(let J=0;J<X.length;J++){if(X[J].type===L.BROADCAST_MESSAGE_VARIABLE_TYPE)continue;const Z=R.variableDB_.getName(X[J].getId(),L.Variables.NAME_TYPE);if(X[J].type===L.LIST_VARIABLE_TYPE)F.push(`${Z}_${L.LIST_VARIABLE_TYPE} = []`);else F.push(`${Z} = None`)}const E=L.Variables.allDeveloperVariables(O);for(let J=0;J<E.length;J++){const Z=R.variableDB_.getName(E[J],L.Names.DEVELOPER_VARIABLE_TYPE);if(X[J].type===L.LIST_VARIABLE_TYPE)F.push(`${Z}_${L.LIST_VARIABLE_TYPE} = []`);else F.push(`${Z} = None`)}if(F.length)R.definitions_.variables=F.join("\n");R.definitions_.import_popsicle_scratch="from popsicle.scratch import *"};R.finish=(O)=>{const F=[],X=[];for(let J in R.definitions_){const Z=R.definitions_[J];if(Z.match(/^(from\s+\S+\s+)?import\s+\S+/))F.push(Z);else X.push(Z)}return delete R.definitions_,delete R.functionNames_,R.variableDB_.reset(),(F.join("\n")+"\n\n"+X.join("\n\n")).replace(/\n\n+/g,"\n\n").replace(/\n*$/,"\n\n\n")+O};R.scrubNakedValue=(O)=>{return O+"\n"};R.quote_=(O)=>{O=O.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/\%/g,"\\%");let F="'";if(O.indexOf("'")!==-1)if(O.indexOf('"')===-1)F='"';else O=O.replace(/'/g,"\\'");return F+O+F};R.scrub_=(O,F)=>{let X="";if(!O.outputConnection||!O.outputConnection.targetConnection){let E=O.getCommentText();if(E=L.utils.wrap(E,R.COMMENT_WRAP-3),E)if(O.getProcedureDef)X+='"""'+E+'\n"""\n';else X+=R.prefixLines(E+"\n","# ");for(let J=0;J<O.inputList.length;J++)if(O.inputList[J].type==L.INPUT_VALUE){const Z=O.inputList[J].connection.targetBlock();if(Z){const P=R.allNestedComments(Z);if(P)X+=R.prefixLines(P,"# ")}}}if(O.startHat_){const E=O.nextConnection&&O.nextConnection.targetBlock();let J=R.blockToCode(E);if(J)J=R.prefixLines(J,R.INDENT),F=F.replace(`:\n${R.PASS}`,`:\n${J}`);return X+F}if(O.parentBlock_){const E=O.nextConnection&&O.nextConnection.targetBlock(),J=R.blockToCode(E);return X+F+J}};R.getAdjustedInt=(O,F,X,E)=>{let J=X||0;if(O.workspace.options.oneBasedIndex)J--;const Z=O.workspace.options.oneBasedIndex?"1":"0",P=J?R.ORDER_ADDITIVE:R.ORDER_NONE;let Q=R.valueToCode(O,F,P)||Z;if(L.isNumber(Q)){if(Q=parseInt(Q,10)+J,E)Q=-Q}else{if(J>0)Q="int("+Q+" + "+J+")";else if(J<0)Q="int("+Q+" - "+-J+")";else Q="int("+Q+")";if(E)Q="-"+Q}return Q};R.functionToCode=(O="",...F)=>{if(!R.functionNames_[O])R.functionNames_[O]=0;R.functionNames_[O]+=1,O=`${O}_${R.functionNames_[O]}`;const X=`async def ${O}(${F.join(",")}):\n${R.PASS}`;return[O,X]};R.control_wait=(O)=>{let F="";if(R.STATEMENT_PREFIX)F+=R.injectId(R.STATEMENT_PREFIX,O);const X=R.valueToCode(O,"DURATION",R.ORDER_NONE);return F+=`await wait_for(${X})\n`,F};R.control_repeat=(O)=>{let F="",X,E;if(R.STATEMENT_PREFIX)F+=R.injectId(R.STATEMENT_PREFIX,O);if(X=R.valueToCode(O,"TIMES",R.ORDER_NONE)||"False",E=R.statementToCode(O,"SUBSTACK")||R.PASS,R.STATEMENT_SUFFIX)E=R.prefixLines(R.injectId(R.STATEMENT_SUFFIX,O),R.INDENT)+E;return F+=`for _ in range(${X}):\n${E}  await sleep_fps()\n`,F};R.control_forever=(O)=>{let F="",X;if(R.STATEMENT_PREFIX)F+=R.injectId(R.STATEMENT_PREFIX,O);if(X=R.statementToCode(O,"SUBSTACK")||R.PASS,R.STATEMENT_SUFFIX)X=R.prefixLines(R.injectId(R.STATEMENT_SUFFIX,O),R.INDENT)+X;return F+=`while True:\n${X}  await sleep_fps()\n`,F};R.control_if=(O)=>{let F="",X,E;if(R.STATEMENT_PREFIX)F+=R.injectId(R.STATEMENT_PREFIX,O);if(E=R.valueToCode(O,"CONDITION",R.ORDER_NONE)||"False",X=R.statementToCode(O,"SUBSTACK")||R.PASS,R.STATEMENT_SUFFIX)X=R.prefixLines(R.injectId(R.STATEMENT_SUFFIX,O),R.INDENT)+X;if(F+=`if ${E}:\n${X}`,O.getInput("SUBSTACK2")){if(X=R.statementToCode(O,"SUBSTACK2")||R.PASS,R.STATEMENT_SUFFIX)X=R.prefixLines(R.injectId(R.STATEMENT_SUFFIX,O),R.INDENT)+X;F+=`else:\n${X}`}return F};R.control_if_else=R.control_if;R.control_wait_until=(O)=>{let F="";if(R.STATEMENT_PREFIX)F+=R.injectId(R.STATEMENT_PREFIX,O);const X=R.valueToCode(O,"CONDITION",R.ORDER_NONE)||"False";return F+=`while not ${X}: await sleep_fps()\n`,F};R.control_repeat_until=(O)=>{let F="",X,E;if(R.STATEMENT_PREFIX)F+=R.injectId(R.STATEMENT_PREFIX,O);if(E=R.valueToCode(O,"CONDITION",R.ORDER_NONE)||"False",X=R.statementToCode(O,"SUBSTACK")||R.PASS,R.STATEMENT_SUFFIX)X=R.prefixLines(R.injectId(R.STATEMENT_SUFFIX,O),R.INDENT)+X;return F+=`while not ${E}:\n${X}  await sleep_fps()\n`,F};R.control_while=(O)=>{let F="",X,E;if(R.STATEMENT_PREFIX)F+=R.injectId(R.STATEMENT_PREFIX,O);if(E=R.valueToCode(O,"CONDITION",R.ORDER_NONE)||"False",X=R.statementToCode(O,"SUBSTACK")||R.PASS,R.STATEMENT_SUFFIX)X=R.prefixLines(R.injectId(R.STATEMENT_SUFFIX,O),R.INDENT)+X;return F+=`while ${E}:\n${X}  await sleep_fps()\n`,F};R.control_stop=(O)=>{let F="";if(R.STATEMENT_PREFIX)F+=R.injectId(R.STATEMENT_PREFIX,O);switch(O.getFieldValue("STOP_OPTION")){case"all":R.definitions_.import_sys="import sys",F+="sys.exit()\n";break;case"this script":F+="return\n";break;case"other scripts in sprite":F+="pass\n";break}return F};import{ScratchBlocks as G} from"@blockcode/blocks-editor";R.data_variable=(O)=>{return[`${R.variableDB_.getName(O.getFieldValue("VARIABLE"),G.Variables.NAME_TYPE)}.value`,R.ORDER_ATOMIC]};R.data_setvariableto=(O)=>{const F=R.variableDB_.getName(O.getFieldValue("VARIABLE"),G.Variables.NAME_TYPE),X=R.valueToCode(O,"VALUE",R.ORDER_NONE)||"0";return`${F}.set(${X})\n`};R.data_changevariableby=(O)=>{const F=R.variableDB_.getName(O.getFieldValue("VARIABLE"),G.Variables.NAME_TYPE),X=R.valueToCode(O,"VALUE",R.ORDER_NONE)||"0";return`${F}.inc(${X})\n`};R.data_listcontents=(O)=>{};R.data_addtolist=(O)=>{};R.data_deleteoflist=(O)=>{};R.data_deletealloflist=(O)=>{};R.data_insertatlist=(O)=>{};R.data_replaceitemoflist=(O)=>{};R.data_itemoflist=(O)=>{};R.data_itemnumoflist=(O)=>{};R.data_lengthoflist=(O)=>{};R.data_listcontainsitem=(O)=>{};import{ScratchBlocks as a} from"@blockcode/blocks-editor";R.event_whenflagclicked=(O)=>{let F="";const[X,E]=R.functionToCode("start");return F+=`${E}when_start(${X})\n`,F};R.event_whengreaterthan=(O)=>{};R.event_whenbroadcastreceived=(O)=>{let F="";const X=R.variableDB_.getName(O.getFieldValue("BROADCAST_OPTION"),a.Variables.NAME_TYPE),[E,J]=R.functionToCode("broadcast_received","sprite");return F+=`${J}when_broadcast_received("${X}",${E},sprite)\n`,F};R.event_broadcast_menu=(O)=>{return[R.variableDB_.getName(O.getFieldValue("BROADCAST_OPTION"),a.Variables.NAME_TYPE),R.ORDER_ATOMIC]};R.event_broadcast=(O)=>{return`broadcast_message("${R.valueToCode(O,"BROADCAST_INPUT",R.ORDER_NONE)||"None"}")\n`};R.event_broadcastandwait=(O)=>{return`await broadcast_message("${R.valueToCode(O,"BROADCAST_INPUT",R.ORDER_NONE)||"None"}")\n`};R.addReservedWords("math,random,Number");R.math_number=(O)=>{let F=parseFloat(O.getFieldValue("NUM")),X;if(F===Infinity)F='float("inf")',X=R.ORDER_FUNCTION_CALL;else if(F===(-Infinity))F='-float("inf")',X=R.ORDER_UNARY_SIGN;else if(Number.isNaN(F))F='float("nan")',X=R.ORDER_UNARY_SIGN;else X=F<0?R.ORDER_UNARY_SIGN:R.ORDER_ATOMIC;return[F,X]};R.math_integer=(O)=>{const F=parseInt(O.getFieldValue("NUM")),X=F<0?R.ORDER_UNARY_SIGN:R.ORDER_ATOMIC;return[F,X]};R.math_whole_number=(O)=>{return[Math.abs(parseInt(O.getFieldValue("NUM"))),R.ORDER_ATOMIC]};R.math_positive_number=(O)=>{let F=parseFloat(O.getFieldValue("NUM")),X;if(F===Infinity)F='float("inf")',X=R.ORDER_FUNCTION_CALL;else if(F===(-Infinity))F='-float("inf")',X=R.ORDER_FUNCTION_CALL;else if(Number.isNaN(F))F='float("nan")',X=R.ORDER_FUNCTION_CALL;else F=F<0?0:F,X=R.ORDER_ATOMIC;return[F,X]};R.math_angle=(O)=>{let F=parseFloat(O.getFieldValue("NUM")),X;if(F==Infinity)F='float("inf")',X=R.ORDER_FUNCTION_CALL;else if(F==(-Infinity))F='-float("inf")',X=R.ORDER_UNARY_SIGN;else F=F%360,F=F<0?F+360:F,X=R.ORDER_ATOMIC;return[F,X]};R.operator_add=(O)=>{};R.operator_subtract=(O)=>{};R.operator_multiply=(O)=>{};R.operator_divide=(O)=>{};R.operator_random=(O)=>{};R.operator_gt=(O)=>{};R.operator_lt=(O)=>{};R.operator_equals=(O)=>{};R.operator_and=(O)=>{};R.operator_or=(O)=>{};R.operator_not=(O)=>{};R.operator_join=(O)=>{};R.operator_letter_of=(O)=>{};R.operator_length=(O)=>{};R.operator_contains=(O)=>{};R.operator_mod=(O)=>{};R.operator_round=(O)=>{};R.operator_mathop=(O)=>{};R.procedures_definition=(O)=>{};R.procedures_call=(O)=>{};R.procedures_prototype=(O)=>{};R.procedures_declaration=(O)=>{};R.argument_reporter_boolean=(O)=>{};R.argument_reporter_string_number=(O)=>{};R.argument_editor_boolean=(O)=>{};R.argument_editor_string_number=(O)=>{};R.sensing_timer=(O)=>{return["get_timer()",R.ORDER_FUNCTION_CALL]};R.sensing_resettimer=(O)=>{return"reset_timer()\n"};R.text=(O)=>{return[R.quote_(O.getFieldValue("TEXT")),R.ORDER_ATOMIC]};import{useState as o} from"preact/hooks";import{useLocale as U1,useEditor as _1} from"@blockcode/core";import{classNames as I1,ComingSoon as N1} from"@blockcode/ui";import{BlocksEditor as L1,ScratchBlocks as K,makeToolboxXML as P1} from"@blockcode/blocks-editor";import{useRef as Z1,useEffect as $1,useState as r} from"preact/hooks";import{classNames as q1,Text as C,Button as n,Modal as H1,BufferedInput as W1} from"@blockcode/ui";function B(O){const F=globalThis.document,X=F.createElement("style");X.appendChild(F.createTextNode(O)),F.head.append(X)}B(".R1cW-q_prompt-modal{width:360px}.R1cW-q_prompt-content{background:var(--ui-white);padding:1.5rem 2.25rem}.R1cW-q_prompt-content input[type=checkbox],.R1cW-q_prompt-content input[type=radio]{margin:3px}.R1cW-q_label{margin:0 0 .75rem;font-weight:500}.R1cW-q_variable-name-text-input{border:1px solid var(--ui-black-transparent);color:var(--text-primary-transparent);border-radius:5px;width:100%;height:3rem;margin-bottom:1.5rem;padding:0 1rem;font-size:.875rem}.R1cW-q_info-message{text-align:center;margin-bottom:1.5rem;font-size:.875rem;font-weight:400}.R1cW-q_options{justify-content:space-between;margin-bottom:1.5rem;font-weight:400;display:flex}.R1cW-q_button-row{text-align:right;font-weight:bolder}.R1cW-q_button{padding:.75rem 1rem;font-size:.85rem;font-weight:600}.R1cW-q_ok-button{background:var(--motion-primary);border:var(--motion-primary);color:var(--ui-white);margin-left:var(--space)}");var A={infoMessage:"R1cW-q_info-message",promptModal:"R1cW-q_prompt-modal",options:"R1cW-q_options",variableNameTextInput:"R1cW-q_variable-name-text-input",promptContent:"R1cW-q_prompt-content",button:"R1cW-q_button",okButton:"R1cW-q_ok-button",buttonRow:"R1cW-q_button-row",label:"R1cW-q_label"};import{jsx as q} from"preact/jsx-runtime";function d({title:O,label:F,defaultValue:X,enableLocalVariable:E,showListMessage:J,showVariableOptions:Z,showCloudOption:P,onClose:Q,onSubmit:U}){const $=Z1(null),[M,_]=r(X),[j,v]=r({scope:"global",isCloud:!1}),D=()=>{U(M,j)},V=(Y)=>{if(Y.key==="Escape")Q();if(Y.key==="Enter")U($.current.base.value,j)};return $1(()=>{if($.current)$.current.base.focus(),window.addEventListener("keydown",V);return()=>{window.removeEventListener("keydown",V)}},[$]),q(H1,{title:O,className:A.promptModal,onClose:Q,children:q("div",{className:A.promptContent,children:[q("div",{className:A.label,children:F}),q(W1,{autoFocus:!0,forceFocus:!0,ref:$,className:A.variableNameTextInput,defaultValue:M,onSubmit:_}),Z&&q("div",{children:E?q("div",{className:A.options,children:[q("label",{children:[q("input",{checked:j.scope==="global",name:"variableScopeOption",type:"radio",value:"global",onChange:()=>v({...j,scope:"global"})}),q(C,{id:"blocks.dataPrompt.forAllTargets",defaultMessage:"For all targets"})]}),q("label",{children:[q("input",{checked:j.scope==="local",name:"variableScopeOption",type:"radio",value:"local",onChange:()=>v({...j,scope:"local"})}),q(C,{id:"blocks.dataPrompt.forThisTarget",defaultMessage:"For this target only"})]})]}):q("div",{className:A.infoMessage,children:J?q(C,{id:"blocks.dataPrompt.listAvailableToAllTargets",defaultMessage:"This list will be available to all targets."}):q(C,{id:"blocks.dataPrompt.availableToAllTargets",defaultMessage:"This variable will be available to all targets."})})}),q("div",{className:A.buttonRow,children:[q(n,{className:A.button,onClick:Q,children:q(C,{id:"blocks.dataPrompt.cancel",defaultMessage:"Cancel"})}),q(n,{className:q1(A.button,A.okButton),onClick:D,children:q(C,{id:"blocks.dataPrompt.ok",defaultMessage:"OK"})})]})]})})}B(".OF790G_editor-wrapper{border-radius:inherit;width:100%;height:100%;position:relative}.OF790G_extension-button{z-index:var(--z-index-extension-button);background:var(--motion-primary);border:1px solid var(--motion-primary);box-sizing:content-box;border-bottom-left-radius:inherit;border-top:0;height:3.25rem;position:absolute;bottom:-1px;left:-1px}.OF790G_extension-button:before{--fade-out-distance:15px;content:\"\";top:calc(calc(-1*var(--fade-out-distance)));height:var(--fade-out-distance);background:linear-gradient(#0000,#00000026);position:absolute;left:0;right:0}.OF790G_add-button{cursor:pointer;background:0 0;border:none;outline:none;width:100%;height:100%}.OF790G_add-button img{width:1.75rem;height:1.75rem}");var k={addButton:"OF790G_add-button",editorWrapper:"OF790G_editor-wrapper",extensionButton:"OF790G_extension-button"};var t="./assets/icon-add-extension-5ec2ee35b87b4126.svg";import{jsx as w} from"preact/jsx-runtime";function s({toolbox:O,messages:F,xml:X,enableMultiTargets:E,enableLocalVariable:J,disableGenerator:Z,disableExtension:P,onChange:Q}){const{getText:U}=U1(),{fileList:$,selectedIndex:M,modifyFile:_}=_1(),[j,v]=o(),[D,V]=o(!1);if(F={EVENT_WHENPROGRAMSTART:U("blocks.event.programStart","when program start"),CONTROL_STOP_OTHER:U("blocks.control.stopOther","other scripts"),...F||[]},K.prompt=(N,T,S,m,i)=>{const f={callback:S,message:N,defaultValue:T};f.title=m?m:K.Msg.VARIABLE_MODAL_TITLE,f.varType=typeof i==="string"?i:K.SCALAR_VARIABLE_TYPE,f.showVariableOptions=E&&i!==K.BROADCAST_MESSAGE_VARIABLE_TYPE&&f.title!==K.Msg.RENAME_VARIABLE_MODAL_TITLE&&f.title!==K.Msg.RENAME_LIST_MODAL_TITLE,f.showCloudOption=i===K.SCALAR_VARIABLE_TYPE&&this.props.canUseCloud,V(f)},O=O||P1(),!X&&M!==-1){const N=$[M];X=N&&N.xml}let Y;if(j)Y=j.getAllVariables().filter((N)=>{if(N.isLocal)return!1;if(N.type===K.BROADCAST_MESSAGE_VARIABLE_TYPE){if(N.name===K.Msg.DEFAULT_BROADCAST_MESSAGE_NAME)return!1;const T=N.id_.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),S=new RegExp(`<field name="BROADCAST_OPTION" id="${T}"[^>]+>[^<]+</field>`,"g");for(let m of $)if(S.test(m.xml))return!0;return!1}return!0});const I=Q||((N,T)=>{const S={xml:N};if(!Z)S.content=R.workspaceToCode(T);_(S)}),x=(N,T)=>{D.callback(N,[],T),V(!1)},g=()=>V(!1);return w("div",{className:k.editorWrapper,children:[w(L1,{toolbox:O,messages:F,xml:X,variables:Y,onWorkspaceCreated:v,onChange:M!==-1?I:null}),P?null:w("div",{className:I1("scratchCategoryMenu",k.extensionButton),children:w(N1,{children:w("button",{className:k.addButton,title:U("blocks.extensions.addExtension","Add Extension"),children:w("img",{src:t,title:"Add Extension"})})})}),D&&w(d,{title:D.title,label:D.message,defaultValue:D.defaultValue,enableLocalVariable:J,showListMessage:D.varType===K.LIST_VARIABLE_TYPE,showVariableOptions:D.showVariableOptions,showCloudOption:D.showCloudOption,onClose:g,onSubmit:x})]})}B(".GS2oYa_pane{height:8rem}");var e={pane:"GS2oYa_pane"};import{jsx as D1} from"preact/jsx-runtime";function y(){return D1("div",{className:e.pane})}var R1="./assets/icon-blocks-d7e4a3a3eb74d0fb.svg";var O1={"blocks.menu.file":"File","blocks.menu.file.newProject":"New","blocks.menu.file.openProject":"Open","blocks.menu.file.saveProject":"Save","blocks.menu.file.uploadProject":"Load from your computer","blocks.menu.file.downloadProject":"Save to your computer","blocks.menu.edit":"Edit","blocks.menu.edit.undo":"Undo","blocks.menu.edit.redo":"Redo","blocks.menu.device":"Device","blocks.menu.device.connect":"Connect to your device","blocks.menu.device.disconnect":"Disconnect this device","blocks.menu.device.download":"Download program","blocks.menu.device.turnOnAutoDownload":"Turn on Auto Download","blocks.menu.device.turnOffAutoDownload":"Turn off Auto Download","blocks.alert.downloading":"Downloading...{progress}%","blocks.codeTab":"Code","blocks.backpackPane.title":"Backpack","blocks.downloadToDevice":"Download","blocks.extensions.addExtension":"Add Extension","blocks.dataPrompt.forAllTargets":"For all targets","blocks.dataPrompt.forThisTarget":"For this target only","blocks.dataPrompt.availableToAllTargets":"This variable will be available to all targets.","blocks.dataPrompt.listAvailableToAllTargets":"This list will be available to all targets.","blocks.dataPrompt.cancel":"Cancel","blocks.dataPrompt.ok":"OK","blocks.event.programStart":"when program start","blocks.control.stopOther":"other scripts"};var F1={"blocks.menu.file":"\u6587\u4EF6","blocks.menu.file.newProject":"\u65B0\u4F5C\u54C1","blocks.menu.file.openProject":"\u6253\u5F00","blocks.menu.file.saveProject":"\u4FDD\u5B58","blocks.menu.file.uploadProject":"\u4ECE\u7535\u8111\u4E2D\u6253\u5F00","blocks.menu.file.downloadProject":"\u4FDD\u5B58\u5230\u7535\u8111","blocks.menu.edit":"\u7F16\u8F91","blocks.menu.edit.undo":"\u64A4\u9500","blocks.menu.edit.redo":"\u6062\u590D","blocks.menu.device":"\u8BBE\u5907","blocks.menu.device.connect":"\u8FDE\u63A5\u8BBE\u5907","blocks.menu.device.disconnect":"\u65AD\u5F00\u8BBE\u5907\u8FDE\u63A5","blocks.menu.device.download":"\u4E0B\u8F7D\u7A0B\u5E8F","blocks.menu.device.turnOnAutoDownload":"\u6253\u5F00\u81EA\u52A8\u4E0B\u8F7D","blocks.menu.device.turnOffAutoDownload":"\u5173\u95ED\u81EA\u52A8\u4E0B\u8F7D","blocks.alert.downloading":"\u6B63\u5728\u4E0B\u8F7D\u2026{progress}%","blocks.codeTab":"\u4EE3\u7801","blocks.backpackPane.title":"\u4E66\u5305","blocks.downloadToDevice":"\u4E0B\u8F7D","blocks.extensions.addExtension":"\u6DFB\u52A0\u6269\u5C55","blocks.dataPrompt.forAllTargets":"\u9002\u7528\u4E8E\u5168\u5C40","blocks.dataPrompt.forThisTarget":"\u4EC5\u9002\u7528\u4E8E\u5F53\u524D","blocks.dataPrompt.availableToAllTargets":"\u5168\u5C40\u90FD\u53EF\u4F7F\u7528\u8BE5\u53D8\u91CF\u3002","blocks.dataPrompt.listAvailableToAllTargets":"\u5168\u5C40\u90FD\u53EF\u4F7F\u7528\u8BE5\u5217\u8868\u3002","blocks.dataPrompt.cancel":"\u53D6\u6D88","blocks.dataPrompt.ok":"\u786E\u5B9A","blocks.event.programStart":"\u5F53\u7A0B\u5E8F\u5F00\u59CB\u8FD0\u884C","blocks.control.stopOther":"\u5176\u4ED6\u811A\u672C"};import{jsx as Y1} from"preact/jsx-runtime";var A1={en:O1,"zh-Hans":F1},V1={icon:R1,label:Y1(X1,{id:"blocks.codeTab",defaultMessage:"Code"}),Content:s},b6={label:Y1(X1,{id:"blocks.backpackPane.title",defaultMessage:"Backpack"}),Content:y};function K1({addLocaleData:O,setLayout:F,openStoreLibrary:X,closeStoreLibrary:E,setPrompt:J,setAlert:Z,removeAlert:P,openProject:Q}){O(A1);const U=()=>{Q(Object.assign({selectedIndex:0},c))};U(),F({menus:b({openStoreLibrary:X,closeStoreLibrary:E,newProject:U,setPrompt:J,setAlert:Z,removeAlert:P}),tabs:[V1],sidebars:[],pane:!1,tutorials:!0,canEditProjectName:!0})}export{R as pythonGenerator,b as makeMenus,A1 as locales,K1 as default,V1 as CodeTab,b6 as BackpackPane};
