var d8=Object.defineProperty;var r8=(n,m)=>{for(var y in m)d8(n,y,{get:m[y],enumerable:!0,configurable:!0,set:(V)=>m[y]=()=>V})};var z6=((n)=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy(n,{get:(m,y)=>(typeof require!=="undefined"?require:m)[y]}):n)(function(n){if(typeof require!=="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+n+'" is not supported')});import{Text as b5} from"@blockcode/ui";import{Text as B4} from"@blockcode/ui";import{Keys as C6,useLayout as k8,useEditor as L8} from"@blockcode/core";import{Text as A6,MenuSection as u5,MenuItem as Q6} from"@blockcode/ui";import{ScratchBlocks as c8} from"@blockcode/blocks-editor";import{jsx as f6,Fragment as V8} from"preact/jsx-runtime";var E8=function({itemClassName:n,onNew:m,onSave:y,children:V}){const{createPrompt:N,setStoreLibrary:T}=k8(),{modified:F,saveNow:k}=L8();return f6(V8,{children:[f6(u5,{children:[f6(Q6,{className:n,label:f6(A6,{id:"blocks.menu.file.newProject",defaultMessage:"New"}),hotkey:[k4?C6.COMMAND:C6.CONTROL,C6.N],onClick:()=>{if(F)N({title:f6(A6,{id:"gui.projects.notSaved",defaultMessage:"Not saved"}),label:f6(A6,{id:"gui.projects.replaceProject",defaultMessage:"Replace contents of the current project?"}),onSubmit:m});else m()}}),f6(Q6,{className:n,label:f6(A6,{id:"blocks.menu.file.openProject",defaultMessage:"Open"}),hotkey:[k4?C6.COMMAND:C6.CONTROL,C6.O],onClick:()=>T(!0)}),f6(Q6,{className:n,label:f6(A6,{id:"blocks.menu.file.saveProject",defaultMessage:"Save"}),hotkey:[k4?C6.COMMAND:C6.CONTROL,C6.S],onClick:async()=>{let Y,H;const w0=c8.getMainWorkspace();if(w0)Y=await B8.svgAsDataUri(w0.getCanvas(),{}),H=Array.from(new Set(Object.values(w0.blockDB_).filter((x0)=>["nes","translate","color-sensor","servo","time","pen","brain","request","text","broadcast"].find((y0)=>y0===x0.category_)).map((x0)=>x0.category_)));k((x0)=>{const y0={thumb:Y,...x0,...y?y():{},editor:{...x0.editor,extensions:H}};return y0.fileList=y0.fileList.map((t0)=>({...t0,script:void 0,content:void 0})),y0})}})]}),f6(u5,{children:[f6(Q6,{disabled:!0,className:n,label:f6(A6,{id:"blocks.menu.file.uploadProject",defaultMessage:"Load from your computer"})}),f6(Q6,{disabled:!0,className:n,label:f6(A6,{id:"blocks.menu.file.downloadProject",defaultMessage:"save to your computer"})})]}),V]})};import{useEffect as N8,useState as L4} from"preact/hooks";import{Keys as c6} from"@blockcode/core";import{Text as h5,MenuSection as M8,MenuItem as v5} from"@blockcode/ui";import{ScratchBlocks as R8} from"@blockcode/blocks-editor";import{jsx as W6,Fragment as a8} from"preact/jsx-runtime";var O8=function({itemClassName:n,children:m}){const[y,V]=L4(!0),[N,T]=L4(!0),[F,k]=L4(null),Y=R8.getMainWorkspace();if(Y){if(F?.id!==Y.id)k(Y)}return N8(()=>{if(F)F.addChangeListener(()=>{V(F.undoStack_.length===0),T(F.redoStack_.length===0)}),V(F.undoStack_.length===0),T(F.redoStack_.length===0)},[F]),W6(a8,{children:[W6(M8,{children:[W6(v5,{disabled:y,className:n,label:W6(h5,{id:"blocks.menu.edit.undo",defaultMessage:"Undo"}),hotkey:[n5?c6.COMMAND:c6.CONTROL,c6.Z],onClick:async(H)=>{if(H instanceof MouseEvent&&F)F.undo(!1)}}),W6(v5,{disabled:N,className:n,label:W6(h5,{id:"blocks.menu.edit.redo",defaultMessage:"Redo"}),hotkey:n5?[c6.SHIFT,c6.COMMAND,c6.Z]:[c6.CONTROL,c6.Y],onClick:async(H)=>{if(H instanceof MouseEvent&&F)F.undo(!0)}})]}),m]})};import{useState as z8} from"preact/hooks";import{useLocale as A8,useLayout as q8,useEditor as F8} from"@blockcode/core";import{Text as q6,Spinner as X8,MenuSection as e8,MenuItem as f5} from"@blockcode/ui";import{Serial as b8,sleep as o4} from"@blockcode/core";var S8=function(n,m){const y=`data:${n};base64,${m}`;return fetch(y).then((V)=>V.arrayBuffer())},Y4=function(n){return n.replaceAll("\r\n","\n")},U4=function(n){return n.slice(2,-3)},P8="\x01",Z4="\x02",C4="\x03",I4="\x04",D4=128;class J4{constructor(){this.serial=null,this._connected=!1,this._encoder=new TextEncoder,this._decoder=new TextDecoder}requestPort(n=[]){return navigator.serial.requestPort({filters:n}).then((m)=>{if(m._serial){this.serial=m._serial,this.serial.on("connect",()=>this._connected=!0),this.serial.on("disconnect",()=>this._connected=!1);return}this.serial=new b8(m),this.serial.on("connect",()=>this._connected=!0),this.serial.on("disconnect",()=>this._connected=!1)})}connect(n={}){return new Promise((m,y)=>{if(this.serial)this.serial.open({baudRate:115200,...n}).then(()=>m()).catch((V)=>{if(V.name==="InvalidStateError")this._connected=!0,m();y(V)});else y(new Error("No device specified"))})}get connected(){return this._connected}disconnect(){return this.serial.close()}get deviceInfo(){return this.serial.getInfo()}readUntil(n,m){return new Promise((y)=>{let V="";const N=async(T)=>{if(T){if(V+=this._decoder.decode(T),m)m(T)}if(V.indexOf(n)!==-1)this.serial.off("data",N),y(V)};this.serial.on("data",N)})}writeAndReadUntil(n,m,y){return new Promise(async(V)=>{if(m)this.readUntil(m,y).then(V);for(let N=0;N<n.length;N+=D4)await this.serial.write(n.slice(N,N+D4)),await o4(10);if(!m)V()})}async getPrompt(){return await o4(150),await this.stop(),await o4(150),await this.writeAndReadUntil(`\r${C4}${Z4}`,"\r\n>>>")}async enterRawRepl(){return await this.writeAndReadUntil(P8,"raw REPL; CTRL-B to exit")}async exitRawRepl(){return await this.writeAndReadUntil(Z4,"\r\n>>>")}async execRaw(n,m){return await this.writeAndReadUntil(n),await this.writeAndReadUntil(I4,`${I4}>`,m)}async execFile(n,m){if(m=m||function(){},n){await this.enterRawRepl();const y=await this.execRaw(n,m);return await this.exitRawRepl(),y}return Promise.reject()}async run(n,m){return m=m||function(){},new Promise(async(y,V)=>{if(this.rejectRun)this.rejectRun(new Error("re-run")),this.rejectRun=null;this.rejectRun=V;try{await this.enterRawRepl();const N=await this.execRaw(n||"#",m);return await this.exitRawRepl(),y(N)}catch(N){V(N),this.rejectRun=null}})}async eval(n){await this.serial.write(n)}async stop(){if(this.rejectRun)this.rejectRun(new Error("pre stop")),this.rejectRun=null;await this.serial.write(C4)}async reset(){if(this.rejectRun)this.rejectRun(new Error("pre reset")),this.rejectRun=null;await this.serial.write(C4),await this.serial.write(I4)}async exists(n){n=n||"";let m="";m+="try:\n",m+=`  f = open('${n}', 'r')\n`,m+="  print(1)\n",m+="except OSError:\n",m+="  print(0)\n",await this.enterRawRepl();const y=await this.execRaw(m);return await this.exitRawRepl(),y[2]=="1"}async listdir(n){n=n||"";let m="";m+="import os\n",m+="try:\n",m+=`  print(os.listdir('${n}'))\n`,m+="except OSError:\n",m+="  print([])\n",await this.enterRawRepl();let y=await this.execRaw(m);return await this.exitRawRepl(),y=U4(y),y=y.replace(/'/g,'"'),JSON.parse(y)}async mkdir(n){if(n){await this.enterRawRepl();const m=await this.execRaw(`import os\nos.mkdir('${n}')`);return await this.exitRawRepl(),m}return Promise.reject(new Error("Path to file was not specified"))}async rmdir(n){if(n){let m="";m+="import os\n",m+="try:\n",m+=`  os.rmdir("${n}")\n`,m+="except OSError:\n",m+="  print(0)\n",await this.enterRawRepl();const y=await this.execRaw(m);return await this.exitRawRepl(),y}return Promise.reject(new Error("Path to file was not specified"))}async remove(n){if(n){let m="";m+="import os\n",m+="try:\n",m+=`  os.remove("${n}")\n`,m+="except OSError:\n",m+="  print(0)\n",await this.enterRawRepl();const y=await this.execRaw(m);return this.exitRawRepl(),y}return Promise.reject(new Error("Path to file was not specified"))}async rename(n,m){if(n&&m){await this.enterRawRepl();const y=await this.execRaw(`import os\nos.rename('${n}', '${m}')`);return this.exitRawRepl(),y}return Promise.reject(new Error("Path to file was not specified"))}async cat(n){if(n){await this.enterRawRepl();let m=await this.execRaw(`with open('${n}','r') as f:\n while 1:\n  b=f.read(256)\n  if not b:break\n  print(b,end='')`);return await this.exitRawRepl(),m=U4(m),Y4(m)}return Promise.reject(new Error("Path to file was not specified"))}async checkHash(n,m){if(n){let y="";y+="import os\n",y+="import hashlib\n",y+="import binascii\n",y+="hash = hashlib.sha256()\n",y+=`with open('${n}', 'rb') as f:\n`,y+="  while True:\n",y+=`    c = f.read(${D4})\n`,y+="    if not c: break\n",y+="    hash.update(c)\n",y+="print(binascii.hexlify(hash.digest()).decode())\n",await this.enterRawRepl();let V=await this.execRaw(y);return await this.exitRawRepl(),V=V.slice(2,V.indexOf("\n")-1),m===V}return Promise.reject(new Error("Path to file was not specified"))}async put(n,m,y){if(!m){Promise.reject(new Error("Must specify content and destination path"));return}let V;if(typeof n==="string")V=this._encoder.encode(Y4(n));else if(n instanceof ArrayBuffer)V=new Uint8Array(n);else if(n instanceof Uint8Array)V=n;else Promise.reject(new Error(`${n} must string, Uint8Array or ArrayBuffer`));if(y=y||function(){},await this.exists(m)){const Y=await crypto.subtle.digest("SHA-256",V),H=Array.from(new Uint8Array(Y)).map((w0)=>w0.toString(16).padStart(2,"0")).join("");if(await this.checkHash(m,H)){y(100);return}}const N=Array.from(V).map((Y)=>Y.toString(16).padStart(2,"0"));let T="";T+=await this.enterRawRepl();let F=m.split("/");if(F.pop(),F.length>0){T+=await this.execRaw("import os");const Y=[];F.reduce((H,w0)=>{if(w0===""||H!==""&&H.at(-1)!=="/")H+="/";if(H+=w0,H!=="/")Y.push(H);return H},"");for(let H of Y)T+=await this.execRaw(`os.mkdir('${H}')`)}T+=await this.execRaw(`f=open('${m}','w')\nw=f.write`);const k=48;for(let Y=0;Y<N.length;Y+=k){let H=`w(bytes([${N.slice(Y,Y+k).map((w0)=>`0x${w0}`).join(",")}]))`;T+=await this.execRaw(H),y(parseInt(Y/N.length*100))}return T+=await this.execRaw("f.close()"),T+=await this.exitRawRepl(),y(100),T}}var G4=async(n,m)=>{const y=new J4;await y.requestPort(n),await y.connect(),await y.stop(),m(y);const V=()=>setTimeout(async()=>{if(y.connected)V();else m(null)},1000);return V(),y},Q4=async(n,m)=>{await n.disconnect(),m(null)},$4=async(n,m)=>{await n.stop(),await n.enterRawRepl(),await n.execRaw(`from ${m} import display`),await n.execRaw("display.fill(0x0000)"),await n.execRaw("cx, cy = display.width // 2, display.height // 2"),await n.execRaw("display.ellipse(cx, cy, 60, 60, 0xffff, True)"),await n.execRaw("display.ellipse(cx, cy, 50, 50, 0x0000, True)"),await n.execRaw("display.linex(cx, cy - 30, cx, cy + 30, 10, 0xffff)"),await n.execRaw("display.linex(cx, cy + 30, cx + 15, cy + 15, 10, 0xffff)"),await n.execRaw("display.linex(cx, cy + 30, cx - 15, cy + 15, 10, 0xffff)"),await n.execRaw("display.render()"),await n.exitRawRepl()},t5=async(n,m,y)=>{await n.stop();const V=m.length;let N=0;const T=(F)=>{y(parseInt((N+1/V*(F/100))*100))};for(let F of m){let{id:k,content:Y}=F;if(F.type==="text/x-python")k+=".py";else if(F.type.startsWith("image/")&&!Y)Y=await S8(F.type,F.data);await n.put(Y||"",k,T),N+=1/V}y(100),await n.reset()};import{jsx as w6,Fragment as T8} from"preact/jsx-runtime";var W8=function({itemClassName:n,deviceName:m,deviceFilters:y,downloadScreen:V,onDownload:N,children:T}){const[F,k]=z8(!1),{maybeLocaleText:Y}=A8(),{createAlert:H,removeAlert:w0}=q8(),{fileList:x0,assetList:y0,device:t0,setDevice:P0}=F8(),R=()=>k(!1),c0=()=>k(!0),i0=(e0)=>{if(!i0.id)i0.id=`download.${Date.now()}`,c0();if(e0<100)H({id:i0.id,icon:w6(X8,{level:"success"}),message:w6(q6,{id:"blocks.alert.downloading",defaultMessage:"Downloading...{progress}%",progress:e0})});else H({id:i0.id,icon:null,message:w6(q6,{id:"blocks.alert.downloadCompleted",defaultMessage:"Download completed."})}),setTimeout(()=>{w0(i0.id),R(),delete i0.id},1000)};return w6(T8,{children:[w6(e8,{children:[w6(f5,{className:n,label:t0?w6(q6,{id:"blocks.menu.device.disconnect",defaultMessage:"Disconnect this {name}",name:Y(m||w6(q6,{id:"blocks.menu.device.name",defaultMessage:"device"}))}):w6(q6,{id:"blocks.menu.device.connect",defaultMessage:"Connect your {name}",name:Y(m||w6(q6,{id:"blocks.menu.device.name",defaultMessage:"device"}))}),onClick:async()=>{if(t0){if(await Q4(t0,P0),i0.id)w0(i0.id),delete i0.id}else try{await G4(y||m5,P0)}catch(e0){}}}),w6(f5,{disabled:F,className:n,label:w6(q6,{id:"blocks.menu.device.download",defaultMessage:"Download program"}),onClick:async()=>{if(i0.id)return;try{const e0=t0||await G4(y||m5,P0);if(V)await $4(e0,V);t5(e0,N?await N(x0,y0):[].concat(y0),i0)}catch(e0){}}})]}),T]})};import{jsx as K6} from"preact/jsx-runtime";var P5=function({deviceName:n,deviceFilters:m,createDefaultProject:y,saveCurrentProject:V,downloadProjectToDevice:N,showDownloadScreen:T}){return[{icon:K8,label:K6(B4,{id:"blocks.menu.file",defaultMessage:"File"}),Menu:({itemClassName:F,children:k})=>K6(E8,{itemClassName:F,onNew:y,onSave:V,children:k})},{icon:H8,label:K6(B4,{id:"blocks.menu.edit",defaultMessage:"Edit"}),Menu:({itemClassName:F,children:k})=>K6(O8,{itemClassName:F,children:k})},{icon:Y8,label:K6(B4,{id:"blocks.menu.device",defaultMessage:"Device"}),Menu:({itemClassName:F,children:k})=>K6(W8,{deviceName:n,itemClassName:F,deviceFilters:m,downloadScreen:T,onDownload:N,children:k})}]};import{ScratchBlocks as p6} from"@blockcode/blocks-editor";import{ScratchBlocks as q0} from"@blockcode/blocks-editor";import{ScratchBlocks as S5} from"@blockcode/blocks-editor";import{useEffect as Z8,useState as g4} from"preact/hooks";import{useLocale as J8,useLayout as Q8,useEditor as x5} from"@blockcode/core";import{classNames as $8} from"@blockcode/ui";import{BlocksEditor as t3,ScratchBlocks as m6,makeToolboxXML as i3} from"@blockcode/blocks-editor";import{ScratchBlocks as s5,blockSeparator as u3} from"@blockcode/blocks-editor";var m3=function(n,m,y,V){const{id:N}=n,T=y(n.name);let F=`<category name="${V6(T)}" id="${V6(N)}"`;if(F+=` colour="${V6(n.themeColor||g5)}"`,F+=` secondaryColour="${V6(n.inputColor||p5)}"`,n.connectionConfig)F+=' showStatusButton="true"';if(n.iconURI)F+=` iconURI="${V6(n.iconURI)}"`;return F+=">",n.blocks.forEach((k)=>{if(k==="---"){F+=`${u3}`;return}if(k.button){F+=`<button text="${y(k.text)}" callbackKey="${k.button}"></button>`;const y0=s5.getMainWorkspace();if(y0){const t0=y0.getFlyout();if(t0){const P0=t0.getWorkspace();if(P0)P0.registerButtonCallback(k.button,V(k.onClick))}}return}if(m&&k.useStage===!1)return;if(!m&&k.useSprite===!1)return;const Y=`${N}_${k.id.toLowerCase()}`,H={message0:y(k.text),category:N,outputShape:n3,colour:n.themeColor||g5,colourSecondary:n.inputColor||p5,colourTertiary:n.otherColor||f3};let w0=1;if(n.iconURI)H.message0=`%1 %2 ${H.message0}`,H.args0=[{type:"field_image",src:n.iconURI,width:40,height:40},{type:"field_vertical_separator"}],H.extensions=["scratch_extension"],w0+=2;if(k.hat)H.nextStatement=null;else if(k.output){if(k.output==="boolean")H.output="Boolean",H.outputShape=h3;else H.output="String",H.outputShape=v3;H.checkboxInFlyout=k.monitoring!==!1}else H.previousStatement=null,H.nextStatement=null;let x0=`<block type="${V6(Y)}">`;if(k.inputs)H.checkboxInFlyout=!1,H.args0=[].concat(H.args0||[],Object.entries(k.inputs).map(([y0,t0])=>{const P0={name:y0,type:"input_value"};if(t0.menu)P0.type="field_dropdown",P0.options=t0.menu.map(([R,c0])=>[y(R),c0]);else if(t0.type==="boolean")P0.check="Boolean";else{if(x0+=`<value name="${V6(y0)}">`,y5[t0.type]){if(x0+=`<shadow type="${y5[t0.type]}">`,t0.default&&w5[t0.type])x0+=`<field name="${w5[t0.type]}">${V6(y(t0.default))}</field>`;x0+="</shadow>"}x0+="</value>"}return H.message0=H.message0.replace(`[${y0}]`,`%${w0++}`),P0}));if(s5.Blocks[Y]={init(){this.jsonInit(H)}},k.python)I[Y]=k.python.bind(I);else I[Y]=()=>"";x0+="</block>",F+=x0}),F+="</category>",F};import{useRef as x3,useEffect as s3,useState as l5} from"preact/hooks";import{classNames as g3,Text as H6,Button as d5,Modal as p3,BufferedInput as y3} from"@blockcode/ui";var _5=function(n){const m=globalThis.document,y=m.createElement("style");y.appendChild(m.createTextNode(n)),m.head.append(y)};import{jsx as U0} from"preact/jsx-runtime";var w3=function({title:n,label:m,defaultValue:y,enableLocalVariable:V,showListMessage:N,showVariableOptions:T,showCloudOption:F,onClose:k,onSubmit:Y}){const H=x3(null),[w0,x0]=l5(y),[y0,t0]=l5({scope:"global",isCloud:!1}),P0=()=>{Y(w0,y0)},R=(c0)=>{if(c0.key==="Escape")k();if(c0.key==="Enter")Y(H.current.base.value,y0)};return s3(()=>{if(H.current)H.current.base.focus(),window.addEventListener("keydown",R);return()=>{window.removeEventListener("keydown",R)}},[H]),U0(p3,{title:n,className:_6.promptModal,onClose:k,children:U0("div",{className:_6.promptContent,children:[U0("div",{className:_6.label,children:m}),U0(y3,{autoFocus:!0,forceFocus:!0,ref:H,className:_6.variableNameTextInput,defaultValue:w0,onSubmit:x0}),T&&U0("div",{children:V?U0("div",{className:_6.options,children:[U0("label",{children:[U0("input",{checked:y0.scope==="global",name:"variableScopeOption",type:"radio",value:"global",onChange:()=>t0({...y0,scope:"global"})}),U0(H6,{id:"blocks.dataPrompt.forAllTargets",defaultMessage:"For all targets"})]}),U0("label",{children:[U0("input",{checked:y0.scope==="local",name:"variableScopeOption",type:"radio",value:"local",onChange:()=>t0({...y0,scope:"local"})}),U0(H6,{id:"blocks.dataPrompt.forThisTarget",defaultMessage:"For this target only"})]})]}):U0("div",{className:_6.infoMessage,children:N?U0(H6,{id:"blocks.dataPrompt.listAvailableToAllTargets",defaultMessage:"This list will be available to all targets."}):U0(H6,{id:"blocks.dataPrompt.availableToAllTargets",defaultMessage:"This variable will be available to all targets."})})}),U0("div",{className:_6.buttonRow,children:[U0(d5,{className:_6.button,onClick:k,children:U0(H6,{id:"blocks.dataPrompt.cancel",defaultMessage:"Cancel"})}),U0(d5,{className:g3(_6.button,_6.okButton),onClick:P0,children:U0(H6,{id:"blocks.dataPrompt.ok",defaultMessage:"OK"})})]})]})})};import{useEffect as l3,useState as r5} from"preact/hooks";import{useLocale as d3,useLayout as r3,useEditor as b3} from"@blockcode/core";import{Library as P3} from"@blockcode/ui";import{jsx as _3} from"preact/jsx-runtime";var o3=function({deviceId:n,onSelect:m,onClose:y,onFilter:V}){const[N,T]=r5([]),[F,k]=r5(!1),{language:Y,getText:H}=d3(),{createAlert:w0,removeAlert:x0}=r3(),{addAsset:y0}=b3(),t0=(P0)=>{const R=P0.tags||[];let c0=["blocks",["dupont","data"],["3v3","5v"]];if(V)c0=V(R);if(Array.isArray(c0))return c0.every((i0)=>{if(Array.isArray(i0))return i0.some((e0)=>R.includes(e0));return R.includes(i0)});return c0};return l3(()=>{j3.then((P0)=>{T(P0.filter(t0).map((R)=>Object.assign({...R,featured:!0,onSelect:async()=>{w0("importing",{id:R.id});let{default:c0}=await import(`@blockcode/extension-${R.id}/blocks`);if(typeof c0==="function")c0=c0(n);if(c0.id=R.id,c0.files)c0.files.forEach(async(i0)=>{const e0=`extensions/${R.id.replace(/[^a-z\d]/gi,"_")}/${i0.name}`,m0=await fetch(i0.uri).then((G6)=>G6.text());y0({...i0,id:e0,content:m0})});m(c0),x0(R.id),y()}},R.translations&&R.translations[Y]?{name:R.translations[Y].name||R.name,description:R.translations[Y].description||R.description,collaborator:R.translations[Y].collaborator||R.collaborator}:{}))),k(!1)})},[]),_3(P3,{filterable:!0,loading:F,items:N,filterPlaceholder:H("gui.library.search","Search"),title:H("blocks.extensions.addExtension","Add Extension"),emptyText:H("blocks.extensions.empty","No extension!"),onClose:y})};import{jsx as E6,Fragment as I3} from"preact/jsx-runtime";var G3=function({toolbox:n,messages:m,enableMultiTargets:y,enableLocalVariable:V,disableGenerator:N,disableExtension:T,deviceId:F,onChange:k,onExtensionsFilter:Y,onLoadExtension:H}){const{addLocaleData:w0,getText:x0,maybeLocaleText:y0}=J8(),{splash:t0,createPrompt:P0,createAlert:R,removeAlert:c0,setSplash:i0}=Q8(),{editor:e0,fileList:m0,selectedIndex:G6,openFile:B0,modifyFile:Y0,modifyAsset:b6,setModified:l0}=x5(),[J0,P6]=g4(),[n0,$]=g4(!1),[u0,Z]=g4(!1),[f0,J]=g4(!1);if(t0){if(t0===!0&&f0===!1)j6.clear(),J(setTimeout(()=>{J(D3(F,e0.extensions,w0,b6,H).then(()=>J(!0)))},100));if(f0===!0){let U=!0;if(m0.length>1){for(let o0=0;o0>-m0.length;o0--)if(!m0.at(o0).content){U=!1,setTimeout(()=>{B0((o0+m0.length)%m0.length)},100);break}}if(U)setTimeout(()=>{i0(!1),l0(!1)},100)}}m={EVENT_WHENPROGRAMSTART:x0("blocks.event.programStart","when program start"),CONTROL_STOP_OTHER:x0("blocks.control.stopOther","other scripts"),...m||[]},Z8(()=>{m6.prompt=(U,o0,R0,z0,E0)=>{const N0={callback:R0,message:U,defaultValue:o0};N0.title=z0?z0:m6.Msg.VARIABLE_MODAL_TITLE,N0.varType=typeof E0==="string"?E0:m6.SCALAR_VARIABLE_TYPE,N0.showVariableOptions=y&&E0!==m6.BROADCAST_MESSAGE_VARIABLE_TYPE&&N0.title!==m6.Msg.RENAME_VARIABLE_MODAL_TITLE&&N0.title!==m6.Msg.RENAME_LIST_MODAL_TITLE,N0.showCloudOption=E0===m6.SCALAR_VARIABLE_TYPE&&this.props.canUseCloud,$(N0)},m6.FlyoutExtensionCategoryHeader.getExtensionState=(U)=>{if(j6.has(U)){const o0=j6.get(U);if(o0.connectionConfig?.items.every((R0)=>localStorage.getItem(`${o0.id}.connection.${R0.id}`)))return m6.StatusButtonState.READY}return m6.StatusButtonState.NOT_READY},m6.statusButtonCallback=(U)=>{if(!j6.has(U))return;const o0=j6.get(U),{connectionConfig:R0}=o0;if(!R0)return;P0({title:o0.name,label:R0.title,inputMode:R0.items.map((z0)=>({name:z0.id,placeholder:z0.text,defaultValue:localStorage.getItem(`${o0.id}.connection.${z0.id}`)})),content:R0.description,onSubmit:(z0)=>{if(Object.entries(z0).forEach(([E0,N0])=>{localStorage.setItem(`${o0.id}.connection.${E0}`,`${N0}`)}),J0)m6.refreshStatusButtons(J0)}})}},[J0]);let I0;if(J0)I0=J0.getAllVariables().filter((U)=>{if(U.isLocal)return!1;if(U.type===m6.BROADCAST_MESSAGE_VARIABLE_TYPE){if(U.name===m6.Msg.DEFAULT_BROADCAST_MESSAGE_NAME)return!1;const o0=U.id_.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),R0=new RegExp(`<field name="BROADCAST_OPTION" id="${o0}"[^>]+>[^<]+</field>`,"g");for(let z0 of m0)if(R0.test(z0.xml))return!0;return!1}return!0});let W=n||i3();const X0=G6===0,t6=(U)=>U.bind(null,{context:x5(),createPrompt:P0,createAlert:R,removeAlert:c0});j6.forEach((U)=>{W+=m3(U,X0,y0,t6)});const d0=(U,o0)=>{let R0;if(!N)R0=I.workspaceToCode(o0);if(Y0({xml:U,content:R0}),k)k(U,o0)},T0=(U,o0)=>{n0.callback(U,[],o0),$(!1)},n6=()=>$(!1),W0=()=>Z(!0),i6=()=>Z(!1),K0=(U)=>{if(!j6.has(U.id)){if(w0(U.translations),H)H({...U,blocks:U.blocks.filter(j5)});j6.set(U.id,U)}setTimeout(()=>{J0.toolbox_.setSelectedCategoryById(U.id)},100)};return E6(I3,{children:[E6("div",{className:c4.editorWrapper,children:[E6(t3,{toolbox:W,messages:m,globalVariables:I0,onWorkspaceCreated:P6,onChange:G6!==-1?d0:null}),T?null:E6("div",{className:$8("scratchCategoryMenu",c4.extensionButton),children:E6("button",{className:c4.addButton,title:x0("blocks.extensions.addExtension","Add Extension"),onClick:W0,children:E6("img",{src:C3,title:"Add Extension"})})}),n0&&E6(w3,{title:n0.title,label:n0.message,defaultValue:n0.defaultValue,enableLocalVariable:V,showListMessage:n0.varType===m6.LIST_VARIABLE_TYPE,showVariableOptions:n0.showVariableOptions,showCloudOption:n0.showCloudOption,onClose:n6,onSubmit:T0}),u0&&E6(o3,{deviceId:F,onFilter:Y,onSelect:K0,onClose:i6})]}),!1]})};import{jsx as o5} from"preact/jsx-runtime";var _8=Object.create,{defineProperty:i5,getPrototypeOf:j8,getOwnPropertyNames:o8}=Object,C8=Object.prototype.hasOwnProperty,I8=(n,m,y)=>{y=n!=null?_8(j8(n)):{};const V=m||!n||!n.__esModule?i5(y,"default",{value:n,enumerable:!0}):y;for(let N of o8(n))if(!C8.call(V,N))i5(V,N,{get:()=>n[N],enumerable:!0});return V},D8=(n,m)=>()=>(m||n((m={exports:{}}).exports,m),m.exports),G8=D8((n)=>{(function(){var m=typeof n!="undefined"&&n||typeof define!="undefined"&&{}||this||window;if(typeof define!=="undefined")define("save-svg-as-png",[],function(){return m});m.default=m;var y="http://www.w3.org/2000/xmlns/",V="http://www.w3.org/1999/xhtml",N="http://www.w3.org/2000/svg",T='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd" [<!ENTITY nbsp "&#160;">]>',F=/url\(["']?(.+?)["']?\)/,k={woff2:"font/woff2",woff:"font/woff",otf:"application/x-font-opentype",ttf:"application/x-font-ttf",eot:"application/vnd.ms-fontobject",sfnt:"application/font-sfnt",svg:"image/svg+xml"},Y=function n0($){return $ instanceof HTMLElement||$ instanceof SVGElement},H=function n0($){if(!Y($))throw new Error("an HTMLElement or SVGElement is required; got "+$)},w0=function n0($){return new Promise(function(u0,Z){if(Y($))u0($);else Z(new Error("an HTMLElement or SVGElement is required; got "+$))})},x0=function n0($){return $&&$.lastIndexOf("http",0)===0&&$.lastIndexOf(window.location.host)===-1},y0=function n0($){var u0=Object.keys(k).filter(function(Z){return $.indexOf("."+Z)>0}).map(function(Z){return k[Z]});if(u0)return u0[0];return console.error("Unknown font format for "+$+". Fonts may not be working correctly."),"application/octet-stream"},t0=function n0($){var u0="",Z=new Uint8Array($);for(var f0=0;f0<Z.byteLength;f0++)u0+=String.fromCharCode(Z[f0]);return window.btoa(u0)},P0=function n0($,u0,Z){var f0=$.viewBox&&$.viewBox.baseVal&&$.viewBox.baseVal[Z]||u0.getAttribute(Z)!==null&&!u0.getAttribute(Z).match(/%$/)&&parseInt(u0.getAttribute(Z))||$.getBoundingClientRect()[Z]||parseInt(u0.style[Z])||parseInt(window.getComputedStyle($).getPropertyValue(Z));return typeof f0==="undefined"||f0===null||isNaN(parseFloat(f0))?0:f0},R=function n0($,u0,Z,f0){if($.tagName==="svg")return{width:Z||P0($,u0,"width"),height:f0||P0($,u0,"height")};else if($.getBBox){var J=$.getBBox(),I0=J.x,W=J.y,X0=J.width,t6=J.height;return{width:I0+X0,height:W+t6}}},c0=function n0($){return decodeURIComponent(encodeURIComponent($).replace(/%([0-9A-F]{2})/g,function(u0,Z){var f0=String.fromCharCode("0x"+Z);return f0==="%"?"%25":f0}))},i0=function n0($){var u0=window.atob($.split(",")[1]),Z=$.split(",")[0].split(":")[1].split(";")[0],f0=new ArrayBuffer(u0.length),J=new Uint8Array(f0);for(var I0=0;I0<u0.length;I0++)J[I0]=u0.charCodeAt(I0);return new Blob([f0],{type:Z})},e0=function n0($,u0){if(!u0)return;try{return $.querySelector(u0)||$.parentNode&&$.parentNode.querySelector(u0)}catch(Z){console.warn('Invalid CSS selector "'+u0+'"',Z)}},m0=function n0($,u0){var Z=$.cssText.match(F),f0=Z&&Z[1]||"";if(!f0||f0.match(/^data:/)||f0==="about:blank")return;var J=f0.startsWith("../")?u0+"/../"+f0:f0.startsWith("./")?u0+"/."+f0:f0;return{text:$.cssText,format:y0(J),url:J}},G6=function n0($){return Promise.all(Array.from($.querySelectorAll("image")).map(function(u0){var Z=u0.getAttributeNS("http://www.w3.org/1999/xlink","href")||u0.getAttribute("href");if(!Z)return Promise.resolve(null);if(x0(Z))Z+=(Z.indexOf("?")===-1?"?":"&")+"t="+(new Date()).valueOf();return new Promise(function(f0,J){var I0=document.createElement("canvas"),W=new Image;W.crossOrigin="anonymous",W.src=Z,W.onerror=function(){return J(new Error("Could not load "+Z))},W.onload=function(){I0.width=W.width,I0.height=W.height,I0.getContext("2d").drawImage(W,0,0),u0.setAttributeNS("http://www.w3.org/1999/xlink","href",I0.toDataURL("image/png")),f0(!0)}})}))},B0={},Y0=function n0($){return Promise.all($.map(function(u0){return new Promise(function(Z,f0){if(B0[u0.url])return Z(B0[u0.url]);var J=new XMLHttpRequest;J.addEventListener("load",function(){var I0=t0(J.response),W=u0.text.replace(F,'url("data:'+u0.format+";base64,"+I0+'")')+"\n";B0[u0.url]=W,Z(W)}),J.addEventListener("error",function(I0){console.warn("Failed to load font from: "+u0.url,I0),B0[u0.url]=null,Z(null)}),J.addEventListener("abort",function(I0){console.warn("Aborted loading font from: "+u0.url,I0),Z(null)}),J.open("GET",u0.url),J.responseType="arraybuffer",J.send()})})).then(function(u0){return u0.filter(function(Z){return Z}).join("")})},b6=null,l0=function n0(){if(b6)return b6;return b6=Array.from(document.styleSheets).map(function($){try{return{rules:$.cssRules,href:$.href}}catch(u0){return console.warn("Stylesheet could not be loaded: "+$.href,u0),{}}})},J0=function n0($,u0){var Z=u0||{},f0=Z.selectorRemap,J=Z.modifyStyle,I0=Z.modifyCss,W=Z.fonts,X0=Z.excludeUnusedCss,t6=I0||function(W0,i6){var K0=f0?f0(W0):W0,U=J?J(i6):i6;return K0+"{"+U+"}\n"},d0=[],T0=typeof W==="undefined",n6=W||[];return l0().forEach(function(W0){var{rules:i6,href:K0}=W0;if(!i6)return;Array.from(i6).forEach(function(U){if(typeof U.style!="undefined"){if(e0($,U.selectorText))d0.push(t6(U.selectorText,U.style.cssText));else if(T0&&U.cssText.match(/^@font-face/)){var o0=m0(U,K0);if(o0)n6.push(o0)}else if(!X0)d0.push(U.cssText)}})}),Y0(n6).then(function(W0){return d0.join("\n")+W0})},P6=function n0(){if(!navigator.msSaveOrOpenBlob&&!("download"in document.createElement("a")))return{popup:window.open()}};m.prepareSvg=function(n0,$,u0){H(n0);var Z=$||{},f0=Z.left,J=f0===void 0?0:f0,I0=Z.top,W=I0===void 0?0:I0,X0=Z.width,t6=Z.height,d0=Z.scale,T0=d0===void 0?1:d0,n6=Z.responsive,W0=n6===void 0?!1:n6,i6=Z.excludeCss,K0=i6===void 0?!1:i6;return G6(n0).then(function(){var U=n0.cloneNode(!0);U.style.backgroundColor=($||{}).backgroundColor||n0.style.backgroundColor;var o0=R(n0,U,X0,t6),R0=o0.width,z0=o0.height;if(n0.tagName!=="svg")if(n0.getBBox){if(U.getAttribute("transform")!=null)U.setAttribute("transform",U.getAttribute("transform").replace(/translate\(.*?\)/,""));var E0=document.createElementNS("http://www.w3.org/2000/svg","svg");E0.appendChild(U),U=E0}else{console.error("Attempted to render non-SVG element",n0);return}if(U.setAttribute("version","1.1"),U.setAttribute("viewBox",[J,W,R0,z0].join(" ")),!U.getAttribute("xmlns"))U.setAttributeNS(y,"xmlns",N);if(!U.getAttribute("xmlns:xlink"))U.setAttributeNS(y,"xmlns:xlink","http://www.w3.org/1999/xlink");if(W0)U.removeAttribute("width"),U.removeAttribute("height"),U.setAttribute("preserveAspectRatio","xMinYMin meet");else U.setAttribute("width",R0*T0),U.setAttribute("height",z0*T0);if(Array.from(U.querySelectorAll("foreignObject > *")).forEach(function(T6){T6.setAttributeNS(y,"xmlns",T6.tagName==="svg"?N:V)}),K0){var N0=document.createElement("div");N0.appendChild(U);var A0=N0.innerHTML;if(typeof u0==="function")u0(A0,R0,z0);else return{src:A0,width:R0,height:z0}}else return J0(n0,$).then(function(T6){var B6=document.createElement("style");B6.setAttribute("type","text/css"),B6.innerHTML="<![CDATA[\n"+T6+"\n]]>";var m4=document.createElement("defs");m4.appendChild(B6),U.insertBefore(m4,U.firstChild);var Z6=document.createElement("div");Z6.appendChild(U);var x4=Z6.innerHTML.replace(/NS\d+:href/gi,'xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href');if(typeof u0==="function")u0(x4,R0,z0);else return{src:x4,width:R0,height:z0}})})},m.svgAsDataUri=function(n0,$,u0){return H(n0),m.prepareSvg(n0,$).then(function(Z){var{src:f0,width:J,height:I0}=Z,W="data:image/svg+xml;base64,"+window.btoa(c0(T+f0));if(typeof u0==="function")u0(W,J,I0);return W})},m.svgAsPngUri=function(n0,$,u0){H(n0);var Z=$||{},f0=Z.encoderType,J=f0===void 0?"image/png":f0,I0=Z.encoderOptions,W=I0===void 0?0.8:I0,X0=Z.canvg,t6=function d0(T0){var{src:n6,width:W0,height:i6}=T0,K0=document.createElement("canvas"),U=K0.getContext("2d"),o0=window.devicePixelRatio||1;if(K0.width=W0*o0,K0.height=i6*o0,K0.style.width=K0.width+"px",K0.style.height=K0.height+"px",U.setTransform(o0,0,0,o0,0,0),X0)X0(K0,n6);else U.drawImage(n6,0,0);var R0=void 0;try{R0=K0.toDataURL(J,W)}catch(z0){if(typeof SecurityError!=="undefined"&&z0 instanceof SecurityError||z0.name==="SecurityError"){console.error("Rendered SVG images cannot be downloaded in this browser.");return}else throw z0}if(typeof u0==="function")u0(R0,K0.width,K0.height);return Promise.resolve(R0)};if(X0)return m.prepareSvg(n0,$).then(t6);else return m.svgAsDataUri(n0,$).then(function(d0){return new Promise(function(T0,n6){var W0=new Image;W0.onload=function(){return T0(t6({src:W0,width:W0.width,height:W0.height}))},W0.onerror=function(){n6("There was an error loading the data URI as an image on the following SVG\n"+window.atob(d0.slice(26))+"Open the following link to see browser\'s diagnosis\n"+d0)},W0.src=d0})})},m.download=function(n0,$,u0){if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(i0($),n0);else{var Z=document.createElement("a");if("download"in Z){Z.download=n0,Z.style.display="none",document.body.appendChild(Z);try{var f0=i0($),J=URL.createObjectURL(f0);Z.href=J,Z.onclick=function(){return requestAnimationFrame(function(){return URL.revokeObjectURL(J)})}}catch(I0){console.error(I0),console.warn("Error while getting object URL. Falling back to string URL."),Z.href=$}Z.click(),document.body.removeChild(Z)}else if(u0&&u0.popup)u0.popup.document.title=n0,u0.popup.location.replace($)}},m.saveSvg=function(n0,$,u0){var Z=P6();return w0(n0).then(function(f0){return m.svgAsDataUri(f0,u0||{})}).then(function(f0){return m.download($,f0,Z)})},m.saveSvgAsPng=function(n0,$,u0){var Z=P6();return w0(n0).then(function(f0){return m.svgAsPngUri(f0,u0||{})}).then(function(f0){return m.download($,f0,Z)})}})()}),B8=I8(G8(),1),k4=/Mac/i.test(navigator.platform||navigator.userAgent),n5=/Mac/i.test(navigator.platform||navigator.userAgent),m5=[{usbVendorId:12346},{usbVendorId:11914}],K8="./assets/icon-file-1def53419f4ad0ae.svg",H8="./assets/icon-edit-2b1e47b495524ed2.svg",Y8="./assets/icon-device-c2fafab2eaccf043.svg";var I=new p6.Generator("Python");I.addReservedWords("False,None,True,and,as,assert,break,class,continue,def,del,elif,else,except,exec,finally,for,from,global,if,import,in,is,lambda,nonlocal,not,or,pass,print,raise,return,try,while,with,yield,NotImplemented,Ellipsis,__debug__,quit,exit,copyright,license,credits,ArithmeticError,AssertionError,AttributeError,BaseException,BlockingIOError,BrokenPipeError,BufferError,BytesWarning,ChildProcessError,ConnectionAbortedError,ConnectionError,ConnectionRefusedError,ConnectionResetError,DeprecationWarning,EOFError,Ellipsis,EnvironmentError,Exception,FileExistsError,FileNotFoundError,FloatingPointError,FutureWarning,GeneratorExit,IOError,ImportError,ImportWarning,IndentationError,IndexError,InterruptedError,IsADirectoryError,KeyError,KeyboardInterrupt,LookupError,MemoryError,ModuleNotFoundError,NameError,NotADirectoryError,NotImplemented,NotImplementedError,OSError,OverflowError,PendingDeprecationWarning,PermissionError,ProcessLookupError,RecursionError,ReferenceError,ResourceWarning,RuntimeError,RuntimeWarning,StandardError,StopAsyncIteration,StopIteration,SyntaxError,SyntaxWarning,SystemError,SystemExit,TabError,TimeoutError,TypeError,UnboundLocalError,UnicodeDecodeError,UnicodeEncodeError,UnicodeError,UnicodeTranslateError,UnicodeWarning,UserWarning,ValueError,Warning,ZeroDivisionError,_,__build_class__,__debug__,__doc__,__import__,__loader__,__name__,__package__,__spec__,abs,all,any,apply,ascii,basestring,bin,bool,buffer,bytearray,bytes,callable,chr,classmethod,cmp,coerce,compile,complex,copyright,credits,delattr,dict,dir,divmod,enumerate,eval,exec,execfile,exit,file,filter,float,format,frozenset,getattr,globals,hasattr,hash,help,hex,id,input,int,intern,isinstance,issubclass,iter,len,license,list,locals,long,map,max,memoryview,min,next,object,oct,open,ord,pow,print,property,quit,range,raw_input,reduce,reload,repr,reversed,round,set,setattr,slice,sorted,staticmethod,str,sum,super,tuple,type,unichr,unicode,vars,xrange,zip");I.ORDER_ATOMIC=0;I.ORDER_COLLECTION=1;I.ORDER_STRING_CONVERSION=1;I.ORDER_MEMBER=2.1;I.ORDER_FUNCTION_CALL=2.2;I.ORDER_EXPONENTIATION=3;I.ORDER_UNARY_SIGN=4;I.ORDER_BITWISE_NOT=4;I.ORDER_MULTIPLICATIVE=5;I.ORDER_ADDITIVE=6;I.ORDER_BITWISE_SHIFT=7;I.ORDER_BITWISE_AND=8;I.ORDER_BITWISE_XOR=9;I.ORDER_BITWISE_OR=10;I.ORDER_RELATIONAL=11;I.ORDER_LOGICAL_NOT=12;I.ORDER_LOGICAL_AND=13;I.ORDER_LOGICAL_OR=14;I.ORDER_CONDITIONAL=15;I.ORDER_LAMBDA=16;I.ORDER_NONE=99;I.ORDER_OVERRIDES=[[I.ORDER_FUNCTION_CALL,I.ORDER_MEMBER],[I.ORDER_FUNCTION_CALL,I.ORDER_FUNCTION_CALL],[I.ORDER_MEMBER,I.ORDER_MEMBER],[I.ORDER_MEMBER,I.ORDER_FUNCTION_CALL],[I.ORDER_LOGICAL_NOT,I.ORDER_LOGICAL_NOT],[I.ORDER_LOGICAL_AND,I.ORDER_LOGICAL_AND],[I.ORDER_LOGICAL_OR,I.ORDER_LOGICAL_OR]];I.init=(n)=>{if(I.PASS=I.INDENT+"pass\n",I.definitions_=Object.create(null),I.functionNames_=Object.create(null),!I.variableDB_)I.variableDB_=new p6.Names(I.RESERVED_WORDS_);else I.variableDB_.reset();I.variableDB_.setVariableMap(n.getVariableMap());const m=[],y=n.getAllVariables();for(let N=0;N<y.length;N++){if(y[N].type===p6.BROADCAST_MESSAGE_VARIABLE_TYPE)continue;let T=I.variableDB_.getName(y[N].getId(),p6.Variables.NAME_TYPE),F="";if(y[N].type===p6.LIST_VARIABLE_TYPE)T=`${T}_${p6.LIST_VARIABLE_TYPE}`,F="[]";m.push(`${T} = ${F}`)}const V=p6.Variables.allDeveloperVariables(n);for(let N=0;N<V.length;N++){let T=I.variableDB_.getName(V[N],p6.Names.DEVELOPER_VARIABLE_TYPE),F="";if(y[N].type===p6.LIST_VARIABLE_TYPE)T=`${T}_${p6.LIST_VARIABLE_TYPE}`,F="[]";m.push(`${T} = ${F}`)}if(m.length)I.definitions_.variables=m.join("\n");I.definitions_.import_blocks="from blocks import *"};I.finish=(n)=>{const m=[],y=[];for(let V in I.definitions_){const N=I.definitions_[V];if(N.match(/^(from\s+\S+\s+)?import\s+\S+/))m.push(N);else y.push(N)}return delete I.definitions_,delete I.functionNames_,I.variableDB_.reset(),(m.join("\n")+"\n\n"+y.join("\n\n")).replace(/\n\n+/g,"\n\n").replace(/\n*$/,"\n\n\n")+n};I.scrubNakedValue=(n)=>{return n+"\n"};I.quote_=(n)=>{n=n.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/\%/g,"\\%");let m='"';if(n.indexOf('"')!==-1)if(n.indexOf("'")===-1)m="'";else n=n.replace(/"/g,'\\"');return m+n+m};I.scrub_=(n,m)=>{let y="";if(!n.outputConnection?.targetConnection){let V=n.getCommentText();if(V=p6.utils.wrap(V,I.COMMENT_WRAP-3),V)if(n.getProcedureDef)y+='"""'+V+'\n"""\n';else y+=I.prefixLines(V+"\n","# ");for(let N=0;N<n.inputList.length;N++)if(n.inputList[N].type==p6.INPUT_VALUE){const T=n.inputList[N].connection.targetBlock();if(T){const F=I.allNestedComments(T);if(F)y+=I.prefixLines(F,"# ")}}}if(n.startHat_){const V=n.nextConnection&&n.nextConnection.targetBlock();let N=I.blockToCode(V);if(N)N=I.prefixLines(N,I.INDENT),m=m.replace(`\n${I.PASS}`,`\n${N}`);return y+m}if(n.parentBlock_){const V=n.nextConnection&&n.nextConnection.targetBlock(),N=I.blockToCode(V);return y+m+N}};I.getAdjustedInt=(n,m,y,V)=>{let N=y||0;if(n.workspace.options.oneBasedIndex)N--;const T=n.workspace.options.oneBasedIndex?"1":"0",F=N?I.ORDER_ADDITIVE:I.ORDER_NONE;let k=I.valueToCode(n,m,F)||T;if(p6.isNumber(k)){if(k=parseInt(k,10)+N,V)k=-k}else{if(N>0)k="int("+k+" + "+N+")";else if(N<0)k="int("+k+" - "+-N+")";else k="int("+k+")";if(V)k="-"+k}return k};I.hatToCode=(n="",...m)=>{if(!I.functionNames_[n])I.functionNames_[n]=0;I.functionNames_[n]+=1;const y=`${n}_${I.functionNames_[n]}`;return I.HAT_FUNCTION_PLACEHOLDER=y,`async def ${y}(${m.join(", ")}):\n  this_func = ${y}\n${I.PASS}\n`};var U8=(n)=>{const m=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;n=n.replace(m,(V,N,T,F)=>N+N+T+T+F+F);const y=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return y?{r:parseInt(y[1],16),g:parseInt(y[2],16),b:parseInt(y[3],16)}:null};I.colour_picker=(n)=>{const{r:m,g:y,b:V}=U8(n.getFieldValue("COLOUR"));return[`(${m}, ${y}, ${V})`,I.ORDER_ATOMIC]};var $6="  await runtime.next_frame()\n";I.control_wait=(n)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,n);const y=I.valueToCode(n,"DURATION",I.ORDER_NONE)||0;return m+=`await runtime.wait_for(num(${y}))\n`,m};I.control_repeat=(n)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,n);let y=I.statementToCode(n,"SUBSTACK")||I.PASS;if(I.STATEMENT_SUFFIX)y=I.prefixLines(I.injectId(I.STATEMENT_SUFFIX,n),I.INDENT)+y;const V=I.valueToCode(n,"TIMES",I.ORDER_NONE)||10;return m+=`for _ in range(num(${V})):\n${y}${$6}`,m};I.control_forever=(n)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,n);let y=I.statementToCode(n,"SUBSTACK")||I.PASS;if(I.STATEMENT_SUFFIX)y=I.prefixLines(I.injectId(I.STATEMENT_SUFFIX,n),I.INDENT)+y;return m+=`while True:\n${y}${$6}`,m};I.control_if=(n)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,n);let y=I.statementToCode(n,"SUBSTACK")||I.PASS;if(I.STATEMENT_SUFFIX)y=I.prefixLines(I.injectId(I.STATEMENT_SUFFIX,n),I.INDENT)+y;const V=I.valueToCode(n,"CONDITION",I.ORDER_NONE)||"False";if(m+=`if ${V}:\n${y}`,n.getInput("SUBSTACK2")){if(y=I.statementToCode(n,"SUBSTACK2")||I.PASS,I.STATEMENT_SUFFIX)y=I.prefixLines(I.injectId(I.STATEMENT_SUFFIX,n),I.INDENT)+y;m+=`else:\n${y}`}return m};I.control_if_else=I.control_if;I.control_wait_until=(n)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,n);const y=I.valueToCode(n,"CONDITION",I.ORDER_NONE)||"False";return m+=`while not ${y}:\n${$6}`,m};I.control_repeat_until=(n)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,n);let y=I.statementToCode(n,"SUBSTACK")||I.PASS;if(I.STATEMENT_SUFFIX)y=I.prefixLines(I.injectId(I.STATEMENT_SUFFIX,n),I.INDENT)+y;const V=I.valueToCode(n,"CONDITION",I.ORDER_NONE)||"False";return m+=`while not ${V}:\n${y}${$6}`,m};I.control_while=(n)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,n);let y=I.statementToCode(n,"SUBSTACK")||I.PASS;if(I.STATEMENT_SUFFIX)y=I.prefixLines(I.injectId(I.STATEMENT_SUFFIX,n),I.INDENT)+y;const V=I.valueToCode(n,"CONDITION",I.ORDER_NONE)||"False";return m+=`while ${V}:\n${y}${$6}`,m};I.control_stop=(n)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,n);switch(n.getFieldValue("STOP_OPTION")){case"all":m+="runtime.stop()\n";break;case"this script":m+="return\n";break;case"other scripts in sprite":m+="runtime.stop_tasks(this_func)\n";break}return m};I.data_variable=(n)=>{return[I.variableDB_.getName(n.getFieldValue("VARIABLE"),q0.Variables.NAME_TYPE),I.ORDER_ATOMIC]};I.data_setvariableto=(n)=>{let m="";if(javascriptGenerator.STATEMENT_PREFIX)m+=javascriptGenerator.injectId(javascriptGenerator.STATEMENT_PREFIX,n);const y=I.variableDB_.getName(n.getFieldValue("VARIABLE"),q0.Variables.NAME_TYPE),V=I.valueToCode(n,"VALUE",I.ORDER_NONE)||'""';return m+=`${y} = ${V}\n`,m};I.data_changevariableby=(n)=>{let m="";if(javascriptGenerator.STATEMENT_PREFIX)m+=javascriptGenerator.injectId(javascriptGenerator.STATEMENT_PREFIX,n);const y=I.variableDB_.getName(n.getFieldValue("VARIABLE"),q0.Variables.NAME_TYPE),V=I.valueToCode(n,"VALUE",I.ORDER_NONE)||0;return m+=`${y} = num(${y}) + num(${V})\n`,m};I.data_listcontents=(n)=>{return[I.variableDB_.getName(n.getFieldValue("LIST"),q0.Variables.NAME_TYPE)+"_"+q0.LIST_VARIABLE_TYPE,I.ORDER_ATOMIC]};I.data_addtolist=(n)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,n);const y=I.variableDB_.getName(n.getFieldValue("LIST"),q0.Variables.NAME_TYPE)+"_"+q0.LIST_VARIABLE_TYPE,V=I.valueToCode(n,"ITEM",I.ORDER_NONE)||'""';return m+=`${y}.append(${V})\n`,m};I.data_deleteoflist=(n)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,n);const y=I.variableDB_.getName(n.getFieldValue("LIST"),q0.Variables.NAME_TYPE)+"_"+q0.LIST_VARIABLE_TYPE,V=I.valueToCode(n,"INDEX",I.ORDER_NONE)||1;return m+=`${y}.remove(runtime.index(${V}, len(${y})))\n`,m};I.data_deletealloflist=(n)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,n);const y=I.variableDB_.getName(n.getFieldValue("LIST"),q0.Variables.NAME_TYPE)+"_"+q0.LIST_VARIABLE_TYPE;return m+=`${y} = []\n`,m};I.data_insertatlist=(n)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,n);const y=I.variableDB_.getName(n.getFieldValue("LIST"),q0.Variables.NAME_TYPE)+"_"+q0.LIST_VARIABLE_TYPE,V=I.valueToCode(n,"INDEX",I.ORDER_NONE)||1,N=I.valueToCode(n,"ITEM",I.ORDER_NONE)||'""';return m+=`${y}.insert(runtime.index(${V}, len(${y})), ${N})\n`,m};I.data_replaceitemoflist=(n)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,n);const y=I.variableDB_.getName(n.getFieldValue("LIST"),q0.Variables.NAME_TYPE)+"_"+q0.LIST_VARIABLE_TYPE,V=I.valueToCode(n,"INDEX",I.ORDER_NONE)||1,N=I.valueToCode(n,"ITEM",I.ORDER_NONE)||'""';return m+=`${y}[runtime.index(${V}, len(${y}))] = ${N}\n`,m};I.data_itemoflist=(n)=>{const m=I.variableDB_.getName(n.getFieldValue("LIST"),q0.Variables.NAME_TYPE)+"_"+q0.LIST_VARIABLE_TYPE,y=I.valueToCode(n,"INDEX",I.ORDER_NONE)||1;return[`${m}[runtime.index(${y}, len(${m}))]`,I.ORDER_CONDITIONAL]};I.data_itemnumoflist=(n)=>{const m=I.variableDB_.getName(n.getFieldValue("LIST"),q0.Variables.NAME_TYPE)+"_"+q0.LIST_VARIABLE_TYPE,y=I.valueToCode(n,"ITEM",I.ORDER_NONE)||0;return[`(${m}.index(${y}) + 1)`,I.ORDER_NONE]};I.data_lengthoflist=(n)=>{return[`len(${I.variableDB_.getName(n.getFieldValue("LIST"),q0.Variables.NAME_TYPE)+"_"+q0.LIST_VARIABLE_TYPE})`,I.ORDER_FUNCTION_CALL]};I.data_listcontainsitem=(n)=>{const m=I.variableDB_.getName(n.getFieldValue("LIST"),q0.Variables.NAME_TYPE)+"_"+q0.LIST_VARIABLE_TYPE,y=I.valueToCode(n,"ITEM",I.ORDER_NONE)||0;return[`bool(${m}.count(${y}))`,I.ORDER_FUNCTION_CALL]};I.event_whenflagclicked=()=>{return`${I.hatToCode("start")}runtime.when_start(${I.HAT_FUNCTION_PLACEHOLDER})\n`};I.event_whengreaterthan=(n)=>{const m=n.getFieldValue("WHENGREATERTHANMENU"),y=I.valueToCode(n,"VALUE",I.ORDER_NONE)||0;return`${I.hatToCode("greaterthen")}runtime.when_greaterthen("${m}", num(${y}), ${I.HAT_FUNCTION_PLACEHOLDER})\n`};I.event_whenbroadcastreceived=(n)=>{const m=I.variableDB_.getName(n.getFieldValue("BROADCAST_OPTION"),S5.Variables.NAME_TYPE);return`${I.hatToCode("broadcastreceived")}runtime.when_broadcastreceived("${m}", ${I.HAT_FUNCTION_PLACEHOLDER})\n`};I.event_broadcast_menu=(n)=>{return[I.variableDB_.getName(n.getFieldValue("BROADCAST_OPTION"),S5.Variables.NAME_TYPE),I.ORDER_ATOMIC]};I.event_broadcast=(n)=>{return`runtime.broadcast("${I.valueToCode(n,"BROADCAST_INPUT",I.ORDER_NONE)||'"message1"'}")\n`};I.event_broadcastandwait=(n)=>{return`await runtime.broadcast("${I.valueToCode(n,"BROADCAST_INPUT",I.ORDER_NONE)||'"message1"'}")\n`};I.addReservedWords("math,random,Number");I.math_number=(n)=>{let m=parseFloat(n.getFieldValue("NUM")),y;if(m===Infinity)m='float("inf")',y=I.ORDER_FUNCTION_CALL;else if(m===(-Infinity))m='-float("inf")',y=I.ORDER_UNARY_SIGN;else if(Number.isNaN(m))m='float("nan")',y=I.ORDER_UNARY_SIGN;else y=m<0?I.ORDER_UNARY_SIGN:I.ORDER_ATOMIC;return[m,y]};I.math_integer=(n)=>{const m=parseInt(n.getFieldValue("NUM")),y=m<0?I.ORDER_UNARY_SIGN:I.ORDER_ATOMIC;return[m,y]};I.math_whole_number=(n)=>{return[Math.abs(parseInt(n.getFieldValue("NUM"))),I.ORDER_ATOMIC]};I.math_positive_number=(n)=>{let m=parseFloat(n.getFieldValue("NUM")),y;if(m===Infinity)m='float("inf")',y=I.ORDER_FUNCTION_CALL;else if(m===(-Infinity))m='-float("inf")',y=I.ORDER_FUNCTION_CALL;else if(Number.isNaN(m))m='float("nan")',y=I.ORDER_FUNCTION_CALL;else m=m<0?0:m,y=I.ORDER_ATOMIC;return[m,y]};I.math_angle=(n)=>{let m=parseFloat(n.getFieldValue("NUM")),y;if(m==Infinity)m='float("inf")',y=I.ORDER_FUNCTION_CALL;else if(m==(-Infinity))m='-float("inf")',y=I.ORDER_UNARY_SIGN;else m=m%360,m=m<0?m+360:m,y=I.ORDER_ATOMIC;return[m,y]};I.operator_add=(n)=>{const m=I.valueToCode(n,"NUM1",I.ORDER_NONE)||0,y=I.valueToCode(n,"NUM2",I.ORDER_NONE)||0;return[`(num(${m}) + num(${y}))`,I.ORDER_SUBTRACTION]};I.operator_subtract=(n)=>{const m=I.valueToCode(n,"NUM1",I.ORDER_NONE)||0,y=I.valueToCode(n,"NUM2",I.ORDER_NONE)||0;return[`(num(${m}) - num(${y}))`,I.ORDER_SUBTRACTION]};I.operator_multiply=(n)=>{const m=I.valueToCode(n,"NUM1",I.ORDER_NONE)||0,y=I.valueToCode(n,"NUM2",I.ORDER_NONE)||0;return[`(num(${m}) * num(${y}))`,I.ORDER_SUBTRACTION]};I.operator_divide=(n)=>{const m=I.valueToCode(n,"NUM1",I.ORDER_NONE)||0,y=I.valueToCode(n,"NUM2",I.ORDER_NONE)||0;return[`(num(${m}) / num(${y}))`,I.ORDER_SUBTRACTION]};I.operator_random=(n)=>{const m=I.valueToCode(n,"FROM",I.ORDER_NONE)||0,y=I.valueToCode(n,"TO",I.ORDER_NONE)||0;return[`runtime.random(${m}, ${y})`,I.ORDER_FUNCTION_CALL]};I.operator_gt=(n)=>{const m=I.valueToCode(n,"OPERAND1",I.ORDER_NONE)||0,y=I.valueToCode(n,"OPERAND2",I.ORDER_NONE)||0;return[`(num(${m}) > num(${y}))`,I.ORDER_RELATIONAL]};I.operator_lt=(n)=>{const m=I.valueToCode(n,"OPERAND1",I.ORDER_NONE)||0,y=I.valueToCode(n,"OPERAND2",I.ORDER_NONE)||0;return[`(num(${m}) < num(${y}))`,I.ORDER_RELATIONAL]};I.operator_equals=(n)=>{const m=I.valueToCode(n,"OPERAND1",I.ORDER_NONE)||0,y=I.valueToCode(n,"OPERAND2",I.ORDER_NONE)||0;return[`(num(${m}) == num(${y}) or str(${m}) == str(${y}))`,I.ORDER_RELATIONAL]};I.operator_and=(n)=>{const m=I.valueToCode(n,"OPERAND1",I.ORDER_NONE)||"False",y=I.valueToCode(n,"OPERAND2",I.ORDER_NONE)||"False";return[`(${m} and ${y})`,I.ORDER_LOGICAL_AND]};I.operator_or=(n)=>{const m=I.valueToCode(n,"OPERAND1",I.ORDER_NONE)||"False",y=I.valueToCode(n,"OPERAND2",I.ORDER_NONE)||"False";return[`(${m} or ${y})`,I.ORDER_LOGICAL_OR]};I.operator_not=(n)=>{return[`(not ${I.valueToCode(n,"OPERAND",I.ORDER_NONE)||"False"})`,I.ORDER_LOGICAL_NOT]};I.operator_join=(n)=>{const m=I.valueToCode(n,"STRING1",I.ORDER_NONE)||'""',y=I.valueToCode(n,"STRING2",I.ORDER_NONE)||'""';return[`(str(${m}) + str(${y}))`,I.ORDER_ATOMIC]};I.operator_letter_of=(n)=>{const m=I.valueToCode(n,"LETTER",I.ORDER_NONE)||0;return[`(str(${I.valueToCode(n,"STRING",I.ORDER_NONE)||'""'})[num(${m}) - 1] || "")`,I.ORDER_MEMBER]};I.operator_length=(n)=>{return[`len(str(${I.valueToCode(n,"STRING",I.ORDER_NONE)||'""'}))`,I.ORDER_FUNCTION_CALL]};I.operator_contains=(n)=>{const m=I.valueToCode(n,"STRING1",I.ORDER_NONE)||'""',y=I.valueToCode(n,"STRING2",I.ORDER_NONE)||'""';return[`(str(${m}).count(str(${y})) > 0)`,I.ORDER_FUNCTION_CALL]};I.operator_mod=(n)=>{const m=I.valueToCode(n,"NUM1",I.ORDER_NONE)||0,y=I.valueToCode(n,"NUM2",I.ORDER_NONE)||0;return[`(num(${m}) % num(${y}))`,I.ORDER_MODULUS]};I.operator_round=(n)=>{return I.definitions_.import_math="import math",[`math.round(num(${I.valueToCode(n,"NUM",I.ORDER_NONE)||0}))`,I.ORDER_FUNCTION_CALL]};I.operator_mathop=(n)=>{I.definitions_.import_math="import math";const m=I.valueToCode(n,"NUM",I.ORDER_NONE)||0,y=n.getFieldValue("OPERATOR");let V="";if(y==="ceiling")V+=`math.ceil(num(${m}))`;else if(y==="sin"||y==="cos"||y==="tan")V+=`math.${y}(math.radians(num(${m})))`;else if(y==="asin"||y==="acos"||y==="atan")V+=`math.degrees(math.${y}(num(${m})))`;else if(y==="ln")V+=`(math.log(num(${m}))`;else if(y==="log")V+=`(math.log10(num(${m}))`;else if(y==="e ^")V+=`math.exp(num(${m}))`;else if(y==="10 ^")V+=`math.pow(10, num(${m}))`;else V+=`math.${y}(num(${m}))`;return[V,I.ORDER_FUNCTION_CALL]};I.procedures_definition=(n)=>{};I.procedures_call=(n)=>{};I.procedures_prototype=(n)=>{};I.procedures_declaration=(n)=>{};I.argument_reporter_boolean=(n)=>{};I.argument_reporter_string_number=(n)=>{};I.argument_editor_boolean=(n)=>{};I.argument_editor_string_number=(n)=>{};I.sensing_timer=()=>{return["runtime.time",I.ORDER_MEMBER]};I.sensing_resettimer=()=>{return"runtime.reset_timer()\n"};I.text=(n)=>{const m=n.getFieldValue("TEXT");return[m.length===0||isNaN(m)?I.quote_(m):+m,I.ORDER_ATOMIC]};var h3=1,v3=2,n3=3,g5="#0FBD8C",p5="#0DA57A",f3="#0B8E69",V6=(n)=>{if(typeof n!=="string")if(Array.isArray(n))n=String(n);else return n;return n.replace(/[<>&'"]/g,(m)=>{switch(m){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;"}})},y5={number:"math_number",angle:"math_angle",text:"text",string:"text",color:"colour_picker",matrix:"matrix",note:"note"},w5={number:"NUM",angle:"NUM",text:"TEXT",string:"TEXT",matrix:"MATRIX",note:"NOTE"};_5("._5SVWFW_prompt-modal{width:360px}._5SVWFW_prompt-content{background:var(--ui-white);padding:1.5rem 2.25rem}._5SVWFW_prompt-content input[type=checkbox],._5SVWFW_prompt-content input[type=radio]{margin:3px}._5SVWFW_label{margin:0 0 .75rem;font-weight:500}._5SVWFW_variable-name-text-input{border:1px solid var(--ui-black-transparent);color:var(--text-primary-transparent);border-radius:5px;width:100%;height:3rem;margin-bottom:1.5rem;padding:0 1rem;font-size:.875rem}._5SVWFW_info-message{text-align:center;margin-bottom:1.5rem;font-size:.875rem;font-weight:400}._5SVWFW_options{justify-content:space-between;margin-bottom:1.5rem;font-weight:400;display:flex}._5SVWFW_button-row{text-align:right;font-weight:bolder}._5SVWFW_button{padding:.75rem 1rem;font-size:.85rem;font-weight:600}._5SVWFW_ok-button{background:var(--motion-primary);border:var(--motion-primary);color:var(--ui-white);margin-left:var(--space)}");var _6={promptContent:"_5SVWFW_prompt-content",options:"_5SVWFW_options",promptModal:"_5SVWFW_prompt-modal",buttonRow:"_5SVWFW_button-row",infoMessage:"_5SVWFW_info-message",button:"_5SVWFW_button",okButton:"_5SVWFW_ok-button",label:"_5SVWFW_label",variableNameTextInput:"_5SVWFW_variable-name-text-input"},S3=["nes","translate","color-sensor","servo","time","pen","brain","request","text","broadcast"].map(async(n)=>{const{default:m}=await import(`@blockcode/extension-${n}`);return m.id=n,m}),j3=Promise.all(S3);_5(".cujmXa_editor-wrapper{border-radius:inherit;width:100%;height:100%;position:relative}.cujmXa_extension-button{z-index:var(--z-index-extension-button);background:var(--motion-primary);border:1px solid var(--motion-primary);box-sizing:content-box;border-bottom-left-radius:inherit;border-top:0;height:3.25rem;position:absolute;bottom:-1px;left:-1px}.cujmXa_extension-button:before{--fade-out-distance:15px;content:\"\";top:calc(calc(-1*var(--fade-out-distance)));height:var(--fade-out-distance);background:linear-gradient(#0000,#00000026);position:absolute;left:0;right:0}.cujmXa_add-button{cursor:pointer;background:0 0;border:none;outline:none;width:100%;height:100%}.cujmXa_add-button img{width:1.75rem;height:1.75rem}.cujmXa_debug-box{z-index:var(--z-index-monitor);border:1px solid var(--ui-tertiary);border-radius:var(--space)var(--space)0 0;opacity:.8;font-size:var(--standard-font-size);background:#fff;border-bottom:0;width:600px;height:300px;position:absolute;bottom:0;left:50vw;overflow:auto;transform:translate(-50%)}.cujmXa_debug-box pre{margin:calc(var(--space)/2)}");var c4={editorWrapper:"cujmXa_editor-wrapper",addButton:"cujmXa_add-button",debugBox:"cujmXa_debug-box",extensionButton:"cujmXa_extension-button"},C3="./assets/icon-extension-5ec2ee35b87b4126.svg",j6=new Map,j5=(n)=>typeof n!=="string"&&!n.button,D3=async(n,m,y,V,N)=>{if(m){for(let T of m)if(!j6.has(T)){let{default:F}=await import(`@blockcode/extension-${T}/blocks`);if(typeof F==="function")F=F(n);if(F.id=T,F.files)F.files.forEach(async(k)=>{const Y=`extensions/${T}/${k.name}`,H=await fetch(k.uri).then((w0)=>w0.text());V({...k,id:Y,content:H})});if(y(F.translations),N)N({...F,blocks:F.blocks.filter(j5)});j6.set(T,F)}}},B3="./assets/icon-blocks-d7e4a3a3eb74d0fb.svg",k3={"blocks.menu.file":"File","blocks.menu.file.newProject":"New","blocks.menu.file.openProject":"Open","blocks.menu.file.saveProject":"Save","blocks.menu.file.uploadProject":"Load from your computer","blocks.menu.file.downloadProject":"Save to your computer","blocks.menu.edit":"Edit","blocks.menu.edit.undo":"Undo","blocks.menu.edit.redo":"Redo","blocks.menu.device":"Device","blocks.menu.device.name":"device","blocks.menu.device.connect":"Connect to your {name}","blocks.menu.device.disconnect":"Disconnect this {name}","blocks.menu.device.download":"Download program","blocks.menu.device.turnOnAutoDownload":"Turn on Auto Download","blocks.menu.device.turnOffAutoDownload":"Turn off Auto Download","blocks.alert.downloading":"Downloading...{progress}%","blocks.alert.downloadCompleted":"Download completed.","blocks.codeTab":"Code","blocks.monitorPane.title":"Monitor","blocks.downloadToDevice":"Download","blocks.extensions.addExtension":"Add Extension","blocks.extensions.empty":"No extension!","blocks.dataPrompt.forAllTargets":"For all targets","blocks.dataPrompt.forThisTarget":"For this target only","blocks.dataPrompt.availableToAllTargets":"This variable will be available to all targets.","blocks.dataPrompt.listAvailableToAllTargets":"This list will be available to all targets.","blocks.dataPrompt.cancel":"Cancel","blocks.dataPrompt.ok":"OK","blocks.event.programStart":"when program start","blocks.control.stopOther":"other scripts"},L3={"blocks.menu.file":"\u6587\u4EF6","blocks.menu.file.newProject":"\u65B0\u4F5C\u54C1","blocks.menu.file.openProject":"\u6253\u5F00","blocks.menu.file.saveProject":"\u4FDD\u5B58","blocks.menu.file.uploadProject":"\u4ECE\u7535\u8111\u4E2D\u6253\u5F00","blocks.menu.file.downloadProject":"\u4FDD\u5B58\u5230\u7535\u8111","blocks.menu.edit":"\u7F16\u8F91","blocks.menu.edit.undo":"\u64A4\u9500","blocks.menu.edit.redo":"\u6062\u590D","blocks.menu.device":"\u8BBE\u5907","blocks.menu.device.name":"\u8BBE\u5907","blocks.menu.device.connect":"\u8FDE\u63A5{name}","blocks.menu.device.disconnect":"\u65AD\u5F00{name}\u8FDE\u63A5","blocks.menu.device.download":"\u4E0B\u8F7D\u7A0B\u5E8F","blocks.menu.device.turnOnAutoDownload":"\u6253\u5F00\u81EA\u52A8\u4E0B\u8F7D","blocks.menu.device.turnOffAutoDownload":"\u5173\u95ED\u81EA\u52A8\u4E0B\u8F7D","blocks.alert.downloading":"\u6B63\u5728\u4E0B\u8F7D\u2026{progress}%","blocks.alert.downloadCompleted":"\u4E0B\u8F7D\u5B8C\u6210\u3002","blocks.codeTab":"\u4EE3\u7801","blocks.monitorPane.title":"\u76D1\u89C6\u5668","blocks.downloadToDevice":"\u4E0B\u8F7D","blocks.extensions.addExtension":"\u6DFB\u52A0\u6269\u5C55","blocks.extensions.empty":"\u6CA1\u6709\u6269\u5C55\uFF01","blocks.dataPrompt.forAllTargets":"\u9002\u7528\u4E8E\u5168\u5C40","blocks.dataPrompt.forThisTarget":"\u4EC5\u9002\u7528\u4E8E\u5F53\u524D","blocks.dataPrompt.availableToAllTargets":"\u5168\u5C40\u90FD\u53EF\u4F7F\u7528\u8BE5\u53D8\u91CF\u3002","blocks.dataPrompt.listAvailableToAllTargets":"\u5168\u5C40\u90FD\u53EF\u4F7F\u7528\u8BE5\u5217\u8868\u3002","blocks.dataPrompt.cancel":"\u53D6\u6D88","blocks.dataPrompt.ok":"\u786E\u5B9A","blocks.event.programStart":"\u5F53\u7A0B\u5E8F\u5F00\u59CB\u8FD0\u884C","blocks.control.stopOther":"\u5176\u4ED6\u811A\u672C"},C5={en:k3,"zh-Hans":L3},p4={icon:B3,label:o5(b5,{id:"blocks.codeTab",defaultMessage:"Code"}),Content:G3},_t={label:o5(b5,{id:"blocks.monitorPane.title",defaultMessage:"Monitor"}),Content:null};import{useLocale as Z3} from"@blockcode/core";import{ScratchBlocks as Ft,makeToolboxXML as K3,blockSeparator as o6,categorySeparator as R4} from"@blockcode/blocks-editor";import{ScratchBlocks as y4} from"@blockcode/blocks-editor";y4.Blocks.event_whenflagclicked={init(){this.jsonInit({message0:y4.Msg.EVENT_WHENFLAGCLICKED,args0:[{type:"field_image",src:y4.mainWorkspace.options.pathToMedia+"green-flag.svg",width:24,height:24,alt:"flag"}],category:y4.Categories.event,extensions:["colours_event","shape_hat"]})}};import{ScratchBlocks as x6} from"@blockcode/blocks-editor";x6.Blocks.motion_attack={init(){this.jsonInit({message0:x6.Msg.MOTION_ATTACK,args0:[{type:"input_value",name:"DIRECTION"},{type:"input_value",name:"DISTANCE"}],category:x6.Categories.motion,extensions:["colours_motion","shape_statement"]})}};x6.Blocks.motion_move={init(){this.jsonInit({message0:x6.Msg.MOTION_MOVE,args0:[{type:"input_value",name:"DIRECTION"},{type:"input_value",name:"SPEED"}],category:x6.Categories.motion,extensions:["colours_motion","shape_statement"]})}};x6.Blocks.motion_setspeed={init(){this.jsonInit({message0:x6.Msg.MOTION_SETSPEED,args0:[{type:"input_value",name:"SPEED"}],category:x6.Categories.motion,extensions:["colours_motion","shape_statement"]})}};x6.Blocks.motion_stop={init(){this.jsonInit({message0:x6.Msg.MOTION_STOP,category:x6.Categories.motion,extensions:["colours_motion","shape_statement"]})}};x6.Blocks.motion_speed={init(){this.jsonInit({message0:x6.Msg.MOTION_SPEED,category:x6.Categories.motion,checkboxInFlyout:!0,extensions:["colours_motion","output_number"]})}};import{ScratchBlocks as l6} from"@blockcode/blocks-editor";l6.Blocks.sensing_scanwidth={init(){this.jsonInit({message0:l6.Msg.SENSING_SCANWIDTH,args0:[{type:"input_value",name:"WIDTH"}],category:l6.Categories.sensing,extensions:["colours_sensing","shape_statement"]})}};l6.Blocks.sensing_scan={init(){this.jsonInit({message0:l6.Msg.SENSING_SCAN,args0:[{type:"input_value",name:"DIRECTION"}],category:l6.Categories.sensing,extensions:["colours_sensing","output_boolean"]})}};l6.Blocks.sensing_scandistance={init(){this.jsonInit({message0:l6.Msg.SENSING_DISTANCE,args0:[{type:"input_value",name:"DIRECTION"}],category:l6.Categories.sensing,extensions:["colours_sensing","output_number"]})}};l6.Blocks.sensing_health={init(){this.jsonInit({message0:l6.Msg.SENSING_HEALTH,category:l6.Categories.sensing,checkboxInFlyout:!0,extensions:["colours_sensing","output_number"]})}};import{useRef as a3,useEffect as O3} from"preact/hooks";import{useEditor as z3} from"@blockcode/core";import{ScratchBlocks as g6} from"@blockcode/blocks-editor";import{ScratchBlocks as y6} from"@blockcode/blocks-editor";import{ScratchBlocks as F0} from"@blockcode/blocks-editor";import{ScratchBlocks as k5} from"@blockcode/blocks-editor";var L5=function({width:n,height:m,onSetup:y,...V}){const N=a3(null),{fileList:T,selectedIndex:F,modifyFile:k}=z3(),Y=T[F];if(N.script=Y.script,N.xml=Y.xml,N.current){const H=g6.getMainWorkspace();if(H&&H!==N.workspace)N.workspace=H,H.addChangeListener((w0)=>{if(H.isDragging())return;if(!F3.has(w0.type))return;const x0=g6.Xml.workspaceToDom(H),y0=g6.Xml.domToText(x0).replace(/<variable type="broadcast_msg"[^>]+>[^<]+<\/variable>/gi,"");if(!N.script||N.xml!==y0){const t0=b.workspaceToCode(H);if(N.script!==t0)k({script:t0})}})}return O3(()=>{if(N.current){if(V4.default.setup(N.current),y)y(N.current)}return()=>{V4.default.project.clear(),V4.default.project.remove()}},[N]),q3("canvas",{id:"blockcode-blocks-player",ref:N,style:{width:n,height:m},...V})};import{jsx as q3} from"preact/jsx-runtime";var c3=Object.create,{defineProperty:I5,getPrototypeOf:V3,getOwnPropertyNames:E3}=Object,N3=Object.prototype.hasOwnProperty,E4=(n,m,y)=>{y=n!=null?c3(V3(n)):{};const V=m||!n||!n.__esModule?I5(y,"default",{value:n,enumerable:!0}):y;for(let N of E3(n))if(!N3.call(V,N))I5(V,N,{get:()=>n[N],enumerable:!0});return V},M3=(n,m)=>()=>(m||n((m={exports:{}}).exports,m),m.exports),Dt=((n)=>typeof z6!=="undefined"?z6:typeof Proxy!=="undefined"?new Proxy(n,{get:(m,y)=>(typeof z6!=="undefined"?z6:m)[y]}):n)(function(n){if(typeof z6!=="undefined")return z6.apply(this,arguments);throw Error('Dynamic require of "'+n+'" is not supported')}),N4=M3((n,m)=>{/*!
 * Paper.js v0.12.17 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, Jürg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Thu Nov 3 21:15:36 2022 +0100
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 Jürg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */var y=function(V,N){V=V||(()=>({}));var{window:T,document:F}=V,k=new function(){var t=/^(statics|enumerable|beans|preserve)$/,i=[],u=i.slice,h=Object.create,v=Object.getOwnPropertyDescriptor,f=Object.defineProperty,s=i.forEach||function(r,l){for(var _=0,D=this.length;_<D;_++)r.call(l,this[_],_,this)},x=function(r,l){for(var _ in this)if(this.hasOwnProperty(_))r.call(l,this[_],_,this)},g=Object.assign||function(r){for(var l=1,_=arguments.length;l<_;l++){var D=arguments[l];for(var B in D)if(D.hasOwnProperty(B))r[B]=D[B]}return r},p=function(r,l,_){if(r){var D=v(r,"length");(D&&typeof D.value==="number"?s:x).call(r,l,_=_||r)}return _};function d(r,l,_,D,B){var j={};function o(L,c){if(c=c||(c=v(l,L))&&(c.get?c:c.value),typeof c==="string"&&c[0]==="#")c=r[c.substring(1)]||c;var E=typeof c==="function",M=c,a=B||E&&!c.base?c&&c.get?L in r:r[L]:null,q;if(!B||!a){if(E&&a)c.base=a;if(E&&D!==!1&&(q=L.match(/^([gs]et|is)(([A-Z])(.*))$/)))j[q[3].toLowerCase()+q[4]]=q[2];if(!M||E||!M.get||typeof M.get!=="function"||!P.isPlainObject(M))M={value:M,writable:!0};if((v(r,L)||{configurable:!0}).configurable)M.configurable=!0,M.enumerable=_!=null?_:!q;f(r,L,M)}}if(l){for(var w in l)if(l.hasOwnProperty(w)&&!t.test(w))o(w);for(var w in j){var S=j[w],C=r["set"+S],G=r["get"+S]||C&&r["is"+S];if(G&&(D===!0||G.length===0))o(w,{get:G,set:C})}}return r}function P(){for(var r=0,l=arguments.length;r<l;r++){var _=arguments[r];if(_)g(this,_)}return this}return d(P,{inject:function(r){if(r){var l=r.statics===!0?r:r.statics,_=r.beans,D=r.preserve;if(l!==r)d(this.prototype,r,r.enumerable,_,D);d(this,l,null,_,D)}for(var B=1,j=arguments.length;B<j;B++)this.inject(arguments[B]);return this},extend:function(){var r=this,l,_;for(var D=0,B,j=arguments.length;D<j&&!(l&&_);D++)B=arguments[D],l=l||B.initialize,_=_||B.prototype;if(l=l||function(){r.apply(this,arguments)},_=l.prototype=_||h(this.prototype),f(_,"constructor",{value:l,writable:!0,configurable:!0}),d(l,this),arguments.length)this.inject.apply(l,arguments);return l.base=r,l}}).inject({enumerable:!1,initialize:P,set:P,inject:function(){for(var r=0,l=arguments.length;r<l;r++){var _=arguments[r];if(_)d(this,_,_.enumerable,_.beans,_.preserve)}return this},extend:function(){var r=h(this);return r.inject.apply(r,arguments)},each:function(r,l){return p(this,r,l)},clone:function(){return new this.constructor(this)},statics:{set:g,each:p,create:h,define:f,describe:v,clone:function(r){return g(new r.constructor,r)},isPlainObject:function(r){var l=r!=null&&r.constructor;return l&&(l===Object||l===P||l.name==="Object")},pick:function(r,l){return r!==N?r:l},slice:function(r,l,_){return u.call(r,l,_)}}})};if(typeof m!=="undefined")m.exports=k;k.inject({enumerable:!1,toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+k.each(this,function(t,i){if(!/^_/.test(i)){var u=typeof t;this.push(i+": "+(u==="number"?y0.instance.number(t):u==="string"?"'"+t+"'":t))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(t){return k.importJSON(t,this)},exportJSON:function(t){return k.exportJSON(this,t)},toJSON:function(){return k.serialize(this)},set:function(t,i){if(t)k.filter(this,t,i,this._prioritize);return this}},{beans:!1,statics:{exports:{},extend:function t(){var i=t.base.apply(this,arguments),u=i.prototype._class;if(u&&!k.exports[u])k.exports[u]=i;return i},equals:function(t,i){if(t===i)return!0;if(t&&t.equals)return t.equals(i);if(i&&i.equals)return i.equals(t);if(t&&i&&typeof t==="object"&&typeof i==="object"){if(Array.isArray(t)&&Array.isArray(i)){var u=t.length;if(u!==i.length)return!1;while(u--)if(!k.equals(t[u],i[u]))return!1}else{var h=Object.keys(t),u=h.length;if(u!==Object.keys(i).length)return!1;while(u--){var v=h[u];if(!(i.hasOwnProperty(v)&&k.equals(t[v],i[v])))return!1}}return!0}return!1},read:function(t,i,u,h){if(this===k){var v=this.peek(t,i);return t.__index++,v}var f=this.prototype,s=f._readIndex,x=i||s&&t.__index||0,g=t.length,p=t[x];if(h=h||g-x,p instanceof this||u&&u.readNull&&p==null&&h<=1){if(s)t.__index=x+1;return p&&u&&u.clone?p.clone():p}if(p=k.create(f),s)p.__read=!0;if(p=p.initialize.apply(p,x>0||x+h<g?k.slice(t,x,x+h):t)||p,s){t.__index=x+p.__read;var d=p.__filtered;if(d)t.__filtered=d,p.__filtered=N;p.__read=N}return p},peek:function(t,i){return t[t.__index=i||t.__index||0]},remain:function(t){return t.length-(t.__index||0)},readList:function(t,i,u,h){var v=[],f,s=i||0,x=h?s+h:t.length;for(var g=s;g<x;g++)v.push(Array.isArray(f=t[g])?this.read(f,0,u):this.read(t,g,u,1));return v},readNamed:function(t,i,u,h,v){var f=this.getNamed(t,i),s=f!==N;if(s){var x=t.__filtered;if(!x){var g=this.getSource(t);x=t.__filtered=k.create(g),x.__unfiltered=g}x[i]=N}return this.read(s?[f]:t,u,h,v)},readSupported:function(t,i){var u=this.getSource(t),h=this,v=!1;if(u)Object.keys(u).forEach(function(f){if(f in i){var s=h.readNamed(t,f);if(s!==N)i[f]=s;v=!0}});return v},getSource:function(t){var i=t.__source;if(i===N){var u=t.length===1&&t[0];i=t.__source=u&&k.isPlainObject(u)?u:null}return i},getNamed:function(t,i){var u=this.getSource(t);if(u)return i?u[i]:t.__filtered||u},hasNamed:function(t,i){return!!this.getNamed(t,i)},filter:function(t,i,u,h){var v;function f(d){if(!(u&&(d in u))&&!(v&&(d in v))){var P=i[d];if(P!==N)t[d]=P}}if(h){var s={};for(var x=0,g,p=h.length;x<p;x++)if((g=h[x])in i)f(g),s[g]=!0;v=s}return Object.keys(i.__unfiltered||i).forEach(f),t},isPlainValue:function(t,i){return k.isPlainObject(t)||Array.isArray(t)||i&&typeof t==="string"},serialize:function(t,i,u,h){i=i||{};var v=!h,f;if(v)i.formatter=new y0(i.precision),h={length:0,definitions:{},references:{},add:function(P,r){var l="#"+P._id,_=this.references[l];if(!_){this.length++;var D=r.call(P),B=P._class;if(B&&D[0]!==B)D.unshift(B);this.definitions[l]=D,_=this.references[l]=[l]}return _}};if(t&&t._serialize){f=t._serialize(i,h);var s=t._class;if(s&&!t._compactSerialize&&(v||!u)&&f[0]!==s)f.unshift(s)}else if(Array.isArray(t)){f=[];for(var x=0,g=t.length;x<g;x++)f[x]=k.serialize(t[x],i,u,h)}else if(k.isPlainObject(t)){f={};var p=Object.keys(t);for(var x=0,g=p.length;x<g;x++){var d=p[x];f[d]=k.serialize(t[d],i,u,h)}}else if(typeof t==="number")f=i.formatter.number(t,i.precision);else f=t;return v&&h.length>0?[["dictionary",h.definitions],f]:f},deserialize:function(t,i,u,h,v){var f=t,s=!u,x=s&&t&&t.length&&t[0][0]==="dictionary";if(u=u||{},Array.isArray(t)){var g=t[0],p=g==="dictionary";if(t.length==1&&/^#/.test(g))return u.dictionary[g];g=k.exports[g],f=[];for(var d=g?1:0,P=t.length;d<P;d++)f.push(k.deserialize(t[d],i,u,p,x));if(g){var r=f;if(i)f=i(g,r,s||v);else f=new g(r)}}else if(k.isPlainObject(t)){if(f={},h)u.dictionary=f;for(var l in t)f[l]=k.deserialize(t[l],i,u)}return x?f[1]:f},exportJSON:function(t,i){var u=k.serialize(t,i);return i&&i.asString==!1?u:JSON.stringify(u)},importJSON:function(t,i){return k.deserialize(typeof t==="string"?JSON.parse(t):t,function(u,h,v){var f=v&&i&&i.constructor===u,s=f?i:k.create(u.prototype);if(h.length===1&&s instanceof l0&&(f||!(s instanceof P6))){var x=h[0];if(k.isPlainObject(x)){if(x.insert=!1,f)h=h.concat([l0.INSERT])}}if((f?s.set:u).apply(s,h),f)i=null;return s})},push:function(t,i){var u=i.length;if(u<4096)t.push.apply(t,i);else{var h=t.length;t.length+=u;for(var v=0;v<u;v++)t[h+v]=i[v]}return t},splice:function(t,i,u,h){var v=i&&i.length,f=u===N;if(u=f?t.length:u,u>t.length)u=t.length;for(var s=0;s<v;s++)i[s]._index=u+s;if(f)return k.push(t,i),[];else{var x=[u,h];if(i)k.push(x,i);var g=t.splice.apply(t,x);for(var s=0,p=g.length;s<p;s++)g[s]._index=N;for(var s=u+v,p=t.length;s<p;s++)t[s]._index=s;return g}},capitalize:function(t){return t.replace(/\b[a-z]/g,function(i){return i.toUpperCase()})},camelize:function(t){return t.replace(/-(.)/g,function(i,u){return u.toUpperCase()})},hyphenate:function(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var Y={on:function(t,i){if(typeof t!=="string")k.each(t,function(f,s){this.on(s,f)},this);else{var u=this._eventTypes,h=u&&u[t],v=this._callbacks=this._callbacks||{};if(v=v[t]=v[t]||[],v.indexOf(i)===-1){if(v.push(i),h&&h.install&&v.length===1)h.install.call(this,t)}}return this},off:function(t,i){if(typeof t!=="string"){k.each(t,function(s,x){this.off(x,s)},this);return}var u=this._eventTypes,h=u&&u[t],v=this._callbacks&&this._callbacks[t],f;if(v){if(!i||(f=v.indexOf(i))!==-1&&v.length===1){if(h&&h.uninstall)h.uninstall.call(this,t);delete this._callbacks[t]}else if(f!==-1)v.splice(f,1)}return this},once:function(t,i){return this.on(t,function u(){i.apply(this,arguments),this.off(t,u)})},emit:function(t,i){var u=this._callbacks&&this._callbacks[t];if(!u)return!1;var h=k.slice(arguments,1),v=i&&i.target&&!i.currentTarget;if(u=u.slice(),v)i.currentTarget=this;for(var f=0,s=u.length;f<s;f++)if(u[f].apply(this,h)==!1){if(i&&i.stop)i.stop();break}if(v)delete i.currentTarget;return!0},responds:function(t){return!!(this._callbacks&&this._callbacks[t])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(t){var i=this._eventTypes,u=this._callbacks,h=t?"install":"uninstall";if(i){for(var v in u)if(u[v].length>0){var f=i[v],s=f&&f[h];if(s)s.call(this,v)}}},statics:{inject:function t(i){var u=i._events;if(u){var h={};k.each(u,function(v,f){var s=typeof v==="string",x=s?v:f,g=k.capitalize(x),p=x.substring(2).toLowerCase();h[p]=s?{}:v,x="_"+x,i["get"+g]=function(){return this[x]},i["set"+g]=function(d){var P=this[x];if(P)this.off(p,P);if(d)this.on(p,d);this[x]=d}}),i._eventTypes=h}return t.base.apply(this,arguments)}}},H=k.extend({_class:"PaperScope",initialize:function t(){G0=this,this.settings=new k({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=t._id++,t._scopes[this._id]=this;var i=t.prototype;if(!this.support){var u=Z0.getContext(1,1)||{};i.support={nativeDash:"setLineDash"in u||"mozDash"in u,nativeBlendModes:j4.nativeModes},Z0.release(u)}if(!this.agent){var h=V.navigator.userAgent.toLowerCase(),v=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(h)||[])[0],f=v==="darwin"?"mac":v,s=i.agent=i.browser={platform:f};if(f)s[f]=!0;if(h.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(x,g,p,d,P){if(!s.chrome){var r=g==="opera"?d:/^(node|trident)$/.test(g)?P:p;s.version=r,s.versionNumber=parseFloat(r),g={trident:"msie",jsdom:"node"}[g]||g,s.name=g,s[g]=!0}}),s.chrome)delete s.webkit;if(s.atom)delete s.chrome}},version:"0.12.17",getView:function(){var t=this.project;return t&&t._view},getPaper:function(){return this},execute:function(t,i){},install:function(t){var i=this;k.each(["project","view","tool"],function(h){k.define(t,h,{configurable:!0,get:function(){return i[h]}})});for(var u in this)if(!/^_/.test(u)&&this[u])t[u]=this[u]},setup:function(t){return G0=this,this.project=new b6(t),this},createCanvas:function(t,i){return Z0.getCanvas(t,i)},activate:function(){G0=this},clear:function(){var t=this.projects,i=this.tools;for(var u=t.length-1;u>=0;u--)t[u].remove();for(var u=i.length-1;u>=0;u--)i[u].remove()},remove:function(){this.clear(),delete H._scopes[this._id]},statics:new function(){function t(i){return i+="Attribute",function(u,h){return u[i](h)||u[i]("data-paper-"+h)}}return{_scopes:{},_id:0,get:function(i){return this._scopes[i]||null},getAttribute:t("get"),hasAttribute:t("has")}}}),w0=k.extend(Y,{initialize:function(t){if(this._scope=G0,this._index=this._scope[this._list].push(this)-1,t||!this._scope[this._reference])this.activate()},activate:function(){if(!this._scope)return!1;var t=this._scope[this._reference];if(t&&t!==this)t.emit("deactivate");return this._scope[this._reference]=this,this.emit("activate",t),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){if(this._index==null)return!1;if(k.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this)this._scope[this._reference]=null;return this._scope=null,!0},getView:function(){return this._scope.getView()}}),x0={findItemBoundsCollisions:function(t,i,u){function h(s){var x=new Array(s.length);for(var g=0;g<s.length;g++){var p=s[g].getBounds();x[g]=[p.left,p.top,p.right,p.bottom]}return x}var v=h(t),f=!i||i===t?v:h(i);return this.findBoundsCollisions(v,f,u||0)},findCurveBoundsCollisions:function(t,i,u,h){function v(r){var{min:l,max:_}=Math,D=new Array(r.length);for(var B=0;B<r.length;B++){var j=r[B];D[B]=[l(j[0],j[2],j[4],j[6]),l(j[1],j[3],j[5],j[7]),_(j[0],j[2],j[4],j[6]),_(j[1],j[3],j[5],j[7])]}return D}var f=v(t),s=!i||i===t?f:v(i);if(h){var x=this.findBoundsCollisions(f,s,u||0,!1,!0),g=this.findBoundsCollisions(f,s,u||0,!0,!0),p=[];for(var d=0,P=x.length;d<P;d++)p[d]={hor:x[d],ver:g[d]};return p}return this.findBoundsCollisions(f,s,u||0)},findBoundsCollisions:function(t,i,u,h,v){var f=!i||t===i,s=f?t:t.concat(i),x=t.length,g=s.length;function p(Q,h0,p0){var s0=0,b0=Q.length;while(s0<b0){var v0=b0+s0>>>1;if(s[Q[v0]][h0]<p0)s0=v0+1;else b0=v0}return s0-1}var d=h?1:0,P=d+2,r=h?0:1,l=r+2,_=new Array(g);for(var D=0;D<g;D++)_[D]=D;_.sort(function(Q,h0){return s[Q][d]-s[h0][d]});var B=[],j=new Array(x);for(var D=0;D<g;D++){var o=_[D],w=s[o],S=f?o:o-x,C=o<x,G=f||!C,L=C?[]:null;if(B.length){var c=p(B,P,w[d]-u)+1;if(B.splice(0,c),f&&v){L=L.concat(B);for(var E=0;E<B.length;E++){var M=B[E];j[M].push(S)}}else{var a=w[l],q=w[r];for(var E=0;E<B.length;E++){var M=B[E],z=s[M],O=M<x,A=f||M>=x;if(v||(C&&A||G&&O)&&(a>=z[r]-u&&q<=z[l]+u)){if(C&&A)L.push(f?M:M-x);if(G&&O)j[M].push(S)}}}}if(C){if(t===i)L.push(o);j[o]=L}if(B.length){var X=w[P],e=p(B,P,X);B.splice(e+1,0,o)}else B.push(o)}for(var D=0;D<j.length;D++){var K=j[D];if(K)K.sort(function(h0,p0){return h0-p0})}return j}},y0=k.extend({initialize:function(t){this.precision=k.pick(t,5),this.multiplier=Math.pow(10,this.precision)},number:function(t){return this.precision<16?Math.round(t*this.multiplier)/this.multiplier:t},pair:function(t,i,u){return this.number(t)+(u||",")+this.number(i)},point:function(t,i){return this.number(t.x)+(i||",")+this.number(t.y)},size:function(t,i){return this.number(t.width)+(i||",")+this.number(t.height)},rectangle:function(t,i){return this.point(t,i)+(i||",")+this.size(t,i)}});y0.instance=new y0;var t0=new function(){var t=[[0.5773502691896257],[0,0.7745966692414834],[0.33998104358485626,0.8611363115940526],[0,0.5384693101056831,0.906179845938664],[0.2386191860831969,0.6612093864662645,0.932469514203152],[0,0.4058451513773972,0.7415311855993945,0.9491079123427585],[0.1834346424956498,0.525532409916329,0.7966664774136267,0.9602898564975363],[0,0.3242534234038089,0.6133714327005904,0.8360311073266358,0.9681602395076261],[0.14887433898163122,0.4333953941292472,0.6794095682990244,0.8650633666889845,0.9739065285171717],[0,0.26954315595234496,0.5190961292068118,0.7301520055740494,0.8870625997680953,0.978228658146057],[0.1252334085114689,0.3678314989981802,0.5873179542866175,0.7699026741943047,0.9041172563704749,0.9815606342467192],[0,0.2304583159551348,0.44849275103644687,0.6423493394403402,0.8015780907333099,0.9175983992229779,0.9841830547185881],[0.10805494870734367,0.31911236892788974,0.5152486363581541,0.6872929048116855,0.827201315069765,0.9284348836635735,0.9862838086968123],[0,0.20119409399743451,0.3941513470775634,0.5709721726085388,0.7244177313601701,0.8482065834104272,0.937273392400706,0.9879925180204854],[0.09501250983763744,0.2816035507792589,0.45801677765722737,0.6178762444026438,0.755404408355003,0.8656312023878318,0.9445750230732326,0.9894009349916499]],i=[[1],[0.8888888888888888,0.5555555555555556],[0.6521451548625461,0.34785484513745385],[0.5688888888888889,0.47862867049936647,0.23692688505618908],[0.46791393457269104,0.3607615730481386,0.17132449237917036],[0.4179591836734694,0.3818300505051189,0.27970539148927664,0.1294849661688697],[0.362683783378362,0.31370664587788727,0.22238103445337448,0.10122853629037626],[0.3302393550012598,0.31234707704000286,0.26061069640293544,0.1806481606948574,0.08127438836157441],[0.29552422471475287,0.26926671930999635,0.21908636251598204,0.1494513491505806,0.06667134430868814],[0.2729250867779006,0.26280454451024665,0.23319376459199048,0.18629021092773426,0.1255803694649046,0.05566856711617366],[0.24914704581340277,0.2334925365383548,0.20316742672306592,0.16007832854334622,0.10693932599531843,0.04717533638651183],[0.2325515532308739,0.22628318026289723,0.2078160475368885,0.17814598076194574,0.13887351021978725,0.09212149983772845,0.04048400476531588],[0.2152638534631578,0.2051984637212956,0.18553839747793782,0.15720316715819355,0.12151857068790319,0.08015808715976021,0.03511946033175186],[0.2025782419255613,0.19843148532711158,0.1861610000155622,0.16626920581699392,0.13957067792615432,0.10715922046717194,0.07036604748810812,0.03075324199611727],[0.1894506104550685,0.18260341504492358,0.16915651939500254,0.14959598881657674,0.12462897125553388,0.09515851168249279,0.062253523938647894,0.027152459411754096]],u=Math.abs,h=Math.sqrt,v=Math.pow,f=Math.log2||function(P){return Math.log(P)*Math.LOG2E},s=0.000000000001,x=0.000000000000000112;function g(P,r,l){return P<r?r:P>l?l:P}function p(P,r,l){function _(c){var E=c*134217729,M=c-E,a=M+E,q=c-a;return[a,q]}var D=r*r-P*l,B=r*r+P*l;if(u(D)*3<B){var j=_(P),o=_(r),w=_(l),S=r*r,C=o[0]*o[0]-S+2*o[0]*o[1]+o[1]*o[1],G=P*l,L=j[0]*w[0]-G+j[0]*w[1]+j[1]*w[0]+j[1]*w[1];D=S-G+(C-L)}return D}function d(){var P=Math.max.apply(Math,arguments);return P&&(P<0.00000001||P>1e8)?v(2,-Math.round(f(P))):0}return{EPSILON:s,MACHINE_EPSILON:x,CURVETIME_EPSILON:0.00000001,GEOMETRIC_EPSILON:0.0000001,TRIGONOMETRIC_EPSILON:0.00000001,ANGULAR_EPSILON:0.00001,KAPPA:4*(h(2)-1)/3,isZero:function(P){return P>=-s&&P<=s},isMachineZero:function(P){return P>=-x&&P<=x},clamp:g,integrate:function(P,r,l,_){var D=t[_-2],B=i[_-2],j=(l-r)*0.5,o=j+r,w=0,S=_+1>>1,C=_&1?B[w++]*P(o):0;while(w<S){var G=j*D[w];C+=B[w++]*(P(o+G)+P(o-G))}return j*C},findRoot:function(P,r,l,_,D,B,j){for(var o=0;o<B;o++){var w=P(l),S=w/r(l),C=l-S;if(u(S)<j){l=C;break}if(w>0)D=l,l=C<=_?(_+D)*0.5:C;else _=l,l=C>=D?(_+D)*0.5:C}return g(l,_,D)},solveQuadratic:function(P,r,l,_,D,B){var j,o=Infinity;if(u(P)<s){if(u(r)<s)return u(l)<s?-1:0;j=-l/r}else{r*=-0.5;var w=p(P,r,l);if(w&&u(w)<x){var S=d(u(P),u(r),u(l));if(S)P*=S,r*=S,l*=S,w=p(P,r,l)}if(w>=-x){var C=w<0?0:h(w),G=r+(r<0?-C:C);if(G===0)j=l/P,o=-j;else j=G/P,o=l/G}}var L=0,c=D==null,E=D-s,M=B+s;if(isFinite(j)&&(c||j>E&&j<M))_[L++]=c?j:g(j,D,B);if(o!==j&&isFinite(o)&&(c||o>E&&o<M))_[L++]=c?o:g(o,D,B);return L},solveCubic:function(P,r,l,_,D,B,j){var o=d(u(P),u(r),u(l),u(_)),w,S,C,G,L;if(o)P*=o,r*=o,l*=o,_*=o;function c(e){w=e;var K=P*w;S=K+r,C=S*w+l,G=(K+S)*w+C,L=C*w+_}if(u(P)<s)P=r,S=l,C=_,w=Infinity;else if(u(_)<s)S=r,C=l,w=0;else{c(-(r/P)/3);var E=L/P,M=v(u(E),0.3333333333333333),a=E<0?-1:1,q=-G/P,z=q>0?1.324717957244746*Math.max(M,h(q)):M,O=w-a*z;if(O!==w){do c(O),O=G===0?w:w-L/G/(1+x);while(a*O>a*w);if(u(P)*w*w>u(_/w))C=-_/w,S=(C-l)/w}}var A=t0.solveQuadratic(P,S,C,D,B,j),X=B==null;if(isFinite(w)&&(A===0||A>0&&w!==D[0]&&w!==D[1])&&(X||w>B-s&&w<j+s))D[A++]=X?w:g(w,B,j);return A}}},P0={_id:1,_pools:{},get:function(t){if(t){var i=this._pools[t];if(!i)i=this._pools[t]={_id:1};return i._id++}else return this._id++}},R=k.extend({_class:"Point",_readIndex:!0,initialize:function t(i,u){var h=typeof i,v=this.__read,f=0;if(h==="number"){var s=typeof u==="number";if(this._set(i,s?u:i),v)f=s?2:1}else if(h==="undefined"||i===null){if(this._set(0,0),v)f=i===null?1:0}else{var x=h==="string"?i.split(/[\s,]+/)||[]:i;if(f=1,Array.isArray(x))this._set(+x[0],+(x.length>1?x[1]:x[0]));else if("x"in x)this._set(x.x||0,x.y||0);else if("width"in x)this._set(x.width||0,x.height||0);else if("angle"in x)this._set(x.length||0,0),this.setAngle(x.angle||0);else this._set(0,0),f=0}if(v)this.__read=f;return this},set:"#initialize",_set:function(t,i){return this.x=t,this.y=i,this},equals:function(t){return this===t||t&&(this.x===t.x&&this.y===t.y||Array.isArray(t)&&this.x===t[0]&&this.y===t[1])||!1},clone:function(){return new R(this.x,this.y)},toString:function(){var t=y0.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+" }"},_serialize:function(t){var i=t.formatter;return[i.number(this.x),i.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(t){if(this.isZero()){var i=this._angle||0;this._set(Math.cos(i)*t,Math.sin(i)*t)}else{var u=t/this.getLength();if(t0.isZero(u))this.getAngle();this._set(this.x*u,this.y*u)}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180/Math.PI},setAngle:function(t){this.setAngleInRadians.call(this,t*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(!arguments.length)return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x);else{var t=R.read(arguments),i=this.getLength()*t.getLength();if(t0.isZero(i))return NaN;else{var u=this.dot(t)/i;return Math.acos(u<-1?-1:u>1?1:u)}}},setAngleInRadians:function(t){if(this._angle=t,!this.isZero()){var i=this.getLength();this._set(Math.cos(t)*i,Math.sin(t)*i)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var t=R.read(arguments);return Math.atan2(this.cross(t),this.dot(t))*180/Math.PI},getDistance:function(){var t=arguments,i=R.read(t),u=i.x-this.x,h=i.y-this.y,v=u*u+h*h,f=k.read(t);return f?v:Math.sqrt(v)},normalize:function(t){if(t===N)t=1;var i=this.getLength(),u=i!==0?t/i:0,h=new R(this.x*u,this.y*u);if(u>=0)h._angle=this._angle;return h},rotate:function(t,i){if(t===0)return this.clone();t=t*Math.PI/180;var u=i?this.subtract(i):this,h=Math.sin(t),v=Math.cos(t);return u=new R(u.x*v-u.y*h,u.x*h+u.y*v),i?u.add(i):u},transform:function(t){return t?t._transformPoint(this):this},add:function(){var t=R.read(arguments);return new R(this.x+t.x,this.y+t.y)},subtract:function(){var t=R.read(arguments);return new R(this.x-t.x,this.y-t.y)},multiply:function(){var t=R.read(arguments);return new R(this.x*t.x,this.y*t.y)},divide:function(){var t=R.read(arguments);return new R(this.x/t.x,this.y/t.y)},modulo:function(){var t=R.read(arguments);return new R(this.x%t.x,this.y%t.y)},negate:function(){return new R(-this.x,-this.y)},isInside:function(){return m0.read(arguments).contains(this)},isClose:function(){var t=arguments,i=R.read(t),u=k.read(t);return this.getDistance(i)<=u},isCollinear:function(){var t=R.read(arguments);return R.isCollinear(this.x,this.y,t.x,t.y)},isColinear:"#isCollinear",isOrthogonal:function(){var t=R.read(arguments);return R.isOrthogonal(this.x,this.y,t.x,t.y)},isZero:function(){var t=t0.isZero;return t(this.x)&&t(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(t){return this.x*(t>1&&t<4?-1:1)>=0&&this.y*(t>2?-1:1)>=0},dot:function(){var t=R.read(arguments);return this.x*t.x+this.y*t.y},cross:function(){var t=R.read(arguments);return this.x*t.y-this.y*t.x},project:function(){var t=R.read(arguments),i=t.isZero()?0:this.dot(t)/t.dot(t);return new R(t.x*i,t.y*i)},statics:{min:function(){var t=arguments,i=R.read(t),u=R.read(t);return new R(Math.min(i.x,u.x),Math.min(i.y,u.y))},max:function(){var t=arguments,i=R.read(t),u=R.read(t);return new R(Math.max(i.x,u.x),Math.max(i.y,u.y))},random:function(){return new R(Math.random(),Math.random())},isCollinear:function(t,i,u,h){return Math.abs(t*h-i*u)<=Math.sqrt((t*t+i*i)*(u*u+h*h))*0.00000001},isOrthogonal:function(t,i,u,h){return Math.abs(t*u+i*h)<=Math.sqrt((t*t+i*i)*(u*u+h*h))*0.00000001}}},k.each(["round","ceil","floor","abs"],function(t){var i=Math[t];this[t]=function(){return new R(i(this.x),i(this.y))}},{})),c0=R.extend({initialize:function t(i,u,h,v){this._x=i,this._y=u,this._owner=h,this._setter=v},_set:function(t,i,u){if(this._x=t,this._y=i,!u)this._owner[this._setter](this);return this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){return this._setter==="setPosition"?4:0}}),i0=k.extend({_class:"Size",_readIndex:!0,initialize:function t(i,u){var h=typeof i,v=this.__read,f=0;if(h==="number"){var s=typeof u==="number";if(this._set(i,s?u:i),v)f=s?2:1}else if(h==="undefined"||i===null){if(this._set(0,0),v)f=i===null?1:0}else{var x=h==="string"?i.split(/[\s,]+/)||[]:i;if(f=1,Array.isArray(x))this._set(+x[0],+(x.length>1?x[1]:x[0]));else if("width"in x)this._set(x.width||0,x.height||0);else if("x"in x)this._set(x.x||0,x.y||0);else this._set(0,0),f=0}if(v)this.__read=f;return this},set:"#initialize",_set:function(t,i){return this.width=t,this.height=i,this},equals:function(t){return t===this||t&&(this.width===t.width&&this.height===t.height||Array.isArray(t)&&this.width===t[0]&&this.height===t[1])||!1},clone:function(){return new i0(this.width,this.height)},toString:function(){var t=y0.instance;return"{ width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var i=t.formatter;return[i.number(this.width),i.number(this.height)]},add:function(){var t=i0.read(arguments);return new i0(this.width+t.width,this.height+t.height)},subtract:function(){var t=i0.read(arguments);return new i0(this.width-t.width,this.height-t.height)},multiply:function(){var t=i0.read(arguments);return new i0(this.width*t.width,this.height*t.height)},divide:function(){var t=i0.read(arguments);return new i0(this.width/t.width,this.height/t.height)},modulo:function(){var t=i0.read(arguments);return new i0(this.width%t.width,this.height%t.height)},negate:function(){return new i0(-this.width,-this.height)},isZero:function(){var t=t0.isZero;return t(this.width)&&t(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(t,i){return new i0(Math.min(t.width,i.width),Math.min(t.height,i.height))},max:function(t,i){return new i0(Math.max(t.width,i.width),Math.max(t.height,i.height))},random:function(){return new i0(Math.random(),Math.random())}}},k.each(["round","ceil","floor","abs"],function(t){var i=Math[t];this[t]=function(){return new i0(i(this.width),i(this.height))}},{})),e0=i0.extend({initialize:function t(i,u,h,v){this._width=i,this._height=u,this._owner=h,this._setter=v},_set:function(t,i,u){if(this._width=t,this._height=i,!u)this._owner[this._setter](this);return this},getWidth:function(){return this._width},setWidth:function(t){this._width=t,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(t){this._height=t,this._owner[this._setter](this)}}),m0=k.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function t(i,u,h,v){var f=arguments,s=typeof i,x;if(s==="number")this._set(i,u,h,v),x=4;else if(s==="undefined"||i===null)this._set(0,0,0,0),x=i===null?1:0;else if(f.length===1){if(Array.isArray(i))this._set.apply(this,i),x=1;else if(i.x!==N||i.width!==N)this._set(i.x||0,i.y||0,i.width||0,i.height||0),x=1;else if(i.from===N&&i.to===N){if(this._set(0,0,0,0),k.readSupported(f,this))x=1}}if(x===N){var g=R.readNamed(f,"from"),p=k.peek(f),d=g.x,P=g.y,r,l;if(p&&p.x!==N||k.hasNamed(f,"to")){var _=R.readNamed(f,"to");if(r=_.x-d,l=_.y-P,r<0)d=_.x,r=-r;if(l<0)P=_.y,l=-l}else{var D=i0.read(f);r=D.width,l=D.height}this._set(d,P,r,l),x=f.__index}var B=f.__filtered;if(B)this.__filtered=B;if(this.__read)this.__read=x;return this},set:"#initialize",_set:function(t,i,u,h){return this.x=t,this.y=i,this.width=u,this.height=h,this},clone:function(){return new m0(this.x,this.y,this.width,this.height)},equals:function(t){var i=k.isPlainValue(t)?m0.read(arguments):t;return i===this||i&&this.x===i.x&&this.y===i.y&&this.width===i.width&&this.height===i.height||!1},toString:function(){var t=y0.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+", width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var i=t.formatter;return[i.number(this.x),i.number(this.y),i.number(this.width),i.number(this.height)]},getPoint:function(t){var i=t?R:c0;return new i(this.x,this.y,this,"setPoint")},setPoint:function(){var t=R.read(arguments);this.x=t.x,this.y=t.y},getSize:function(t){var i=t?i0:e0;return new i(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var t=i0.read(arguments),i=this._sx,u=this._sy,h=t.width,v=t.height;if(i)this.x+=(this.width-h)*i;if(u)this.y+=(this.height-v)*u;this.width=h,this.height=v,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(t){if(!this._fw){var i=t-this.x;this.width-=this._sx===0.5?i*2:i}this.x=t,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(t){if(!this._fh){var i=t-this.y;this.height-=this._sy===0.5?i*2:i}this.y=t,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(t){if(!this._fw){var i=t-this.x;this.width=this._sx===0.5?i*2:i}this.x=t-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(t){if(!this._fh){var i=t-this.y;this.height=this._sy===0.5?i*2:i}this.y=t-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(t){if(this._fw||this._sx===0.5)this.x=t-this.width/2;else{if(this._sx)this.x+=(t-this.x)*2*this._sx;this.width=(t-this.x)*2}this._sx=0.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(t){if(this._fh||this._sy===0.5)this.y=t-this.height/2;else{if(this._sy)this.y+=(t-this.y)*2*this._sy;this.height=(t-this.y)*2}this._sy=0.5,this._fh=0},getCenter:function(t){var i=t?R:c0;return new i(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var t=R.read(arguments);return this.setCenterX(t.x),this.setCenterY(t.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return this.width===0||this.height===0},contains:function(t){return t&&t.width!==N||(Array.isArray(t)?t:arguments).length===4?this._containsRectangle(m0.read(arguments)):this._containsPoint(R.read(arguments))},_containsPoint:function(t){var{x:i,y:u}=t;return i>=this.x&&u>=this.y&&i<=this.x+this.width&&u<=this.y+this.height},_containsRectangle:function(t){var{x:i,y:u}=t;return i>=this.x&&u>=this.y&&i+t.width<=this.x+this.width&&u+t.height<=this.y+this.height},intersects:function(){var t=m0.read(arguments),i=k.read(arguments)||0;return t.x+t.width>this.x-i&&t.y+t.height>this.y-i&&t.x<this.x+this.width+i&&t.y<this.y+this.height+i},intersect:function(){var t=m0.read(arguments),i=Math.max(this.x,t.x),u=Math.max(this.y,t.y),h=Math.min(this.x+this.width,t.x+t.width),v=Math.min(this.y+this.height,t.y+t.height);return new m0(i,u,h-i,v-u)},unite:function(){var t=m0.read(arguments),i=Math.min(this.x,t.x),u=Math.min(this.y,t.y),h=Math.max(this.x+this.width,t.x+t.width),v=Math.max(this.y+this.height,t.y+t.height);return new m0(i,u,h-i,v-u)},include:function(){var t=R.read(arguments),i=Math.min(this.x,t.x),u=Math.min(this.y,t.y),h=Math.max(this.x+this.width,t.x),v=Math.max(this.y+this.height,t.y);return new m0(i,u,h-i,v-u)},expand:function(){var t=i0.read(arguments),i=t.width,u=t.height;return new m0(this.x-i/2,this.y-u/2,this.width+i,this.height+u)},scale:function(t,i){return this.expand(this.width*t-this.width,this.height*(i===N?t:i)-this.height)}},k.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(t,i){var u=t.join(""),h=/^[RL]/.test(u);if(i>=4)t[1]+=h?"Y":"X";var v=t[h?0:1],f=t[h?1:0],s="get"+v,x="get"+f,g="set"+v,p="set"+f,d="get"+u,P="set"+u;this[d]=function(r){var l=r?R:c0;return new l(this[s](),this[x](),this,P)},this[P]=function(){var r=R.read(arguments);this[g](r.x),this[p](r.y)}},{beans:!0})),G6=m0.extend({initialize:function t(i,u,h,v,f,s){this._set(i,u,h,v,!0),this._owner=f,this._setter=s},_set:function(t,i,u,h,v){if(this._x=t,this._y=i,this._width=u,this._height=h,!v)this._owner[this._setter](this);return this}},new function(){var t=m0.prototype;return k.each(["x","y","width","height"],function(i){var u=k.capitalize(i),h="_"+i;this["get"+u]=function(){return this[h]},this["set"+u]=function(v){if(this[h]=v,!this._dontNotify)this._owner[this._setter](this)}},k.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(i){var u="set"+i;this[u]=function(){this._dontNotify=!0,t[u].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(i){var u=this._owner;if(u._changeSelection)u._changeSelection(2,i)}}))}),B0=k.extend({_class:"Matrix",initialize:function t(i,u){var h=arguments,v=h.length,f=!0;if(v>=6)this._set.apply(this,h);else if(v===1||v===2)if(i instanceof t)this._set(i._a,i._b,i._c,i._d,i._tx,i._ty,u);else if(Array.isArray(i))this._set.apply(this,u?i.concat([u]):i);else f=!1;else if(!v)this.reset();else f=!1;if(!f)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(t,i,u,h,v,f,s){if(this._a=t,this._b=i,this._c=u,this._d=h,this._tx=v,this._ty=f,!s)this._changed();return this},_serialize:function(t,i){return k.serialize(this.getValues(),t,!0,i)},_changed:function(){var t=this._owner;if(t)if(t._applyMatrix)t.transform(null,!0);else t._changed(25)},clone:function(){return new B0(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(t){return t===this||t&&this._a===t._a&&this._b===t._b&&this._c===t._c&&this._d===t._d&&this._tx===t._tx&&this._ty===t._ty},toString:function(){var t=y0.instance;return"[["+[t.number(this._a),t.number(this._c),t.number(this._tx)].join(", ")+"], ["+[t.number(this._b),t.number(this._d),t.number(this._ty)].join(", ")+"]]"},reset:function(t){if(this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,!t)this._changed();return this},apply:function(t,i){var u=this._owner;if(u)return u.transform(null,k.pick(t,!0),i),this.isIdentity();return!1},translate:function(){var t=R.read(arguments),i=t.x,u=t.y;return this._tx+=i*this._a+u*this._c,this._ty+=i*this._b+u*this._d,this._changed(),this},scale:function(){var t=arguments,i=R.read(t),u=R.read(t,0,{readNull:!0});if(u)this.translate(u);if(this._a*=i.x,this._b*=i.x,this._c*=i.y,this._d*=i.y,u)this.translate(u.negate());return this._changed(),this},rotate:function(t){t*=Math.PI/180;var i=R.read(arguments,1),u=i.x,h=i.y,v=Math.cos(t),f=Math.sin(t),s=u-u*v+h*f,x=h-u*f-h*v,g=this._a,p=this._b,d=this._c,P=this._d;return this._a=v*g+f*d,this._b=v*p+f*P,this._c=-f*g+v*d,this._d=-f*p+v*P,this._tx+=s*g+x*d,this._ty+=s*p+x*P,this._changed(),this},shear:function(){var t=arguments,i=R.read(t),u=R.read(t,0,{readNull:!0});if(u)this.translate(u);var h=this._a,v=this._b;if(this._a+=i.y*this._c,this._b+=i.y*this._d,this._c+=i.x*h,this._d+=i.x*v,u)this.translate(u.negate());return this._changed(),this},skew:function(){var t=arguments,i=R.read(t),u=R.read(t,0,{readNull:!0}),h=Math.PI/180,v=new R(Math.tan(i.x*h),Math.tan(i.y*h));return this.shear(v,u)},append:function(t,i){if(t){var u=this._a,h=this._b,v=this._c,f=this._d,s=t._a,x=t._c,g=t._b,p=t._d,d=t._tx,P=t._ty;if(this._a=s*u+g*v,this._c=x*u+p*v,this._b=s*h+g*f,this._d=x*h+p*f,this._tx+=d*u+P*v,this._ty+=d*h+P*f,!i)this._changed()}return this},prepend:function(t,i){if(t){var u=this._a,h=this._b,v=this._c,f=this._d,s=this._tx,x=this._ty,g=t._a,p=t._c,d=t._b,P=t._d,r=t._tx,l=t._ty;if(this._a=g*u+p*h,this._c=g*v+p*f,this._b=d*u+P*h,this._d=d*v+P*f,this._tx=g*s+p*x+r,this._ty=d*s+P*x+l,!i)this._changed()}return this},appended:function(t){return this.clone().append(t)},prepended:function(t){return this.clone().prepend(t)},invert:function(){var t=this._a,i=this._b,u=this._c,h=this._d,v=this._tx,f=this._ty,s=t*h-i*u,x=null;if(s&&!isNaN(s)&&isFinite(v)&&isFinite(f))this._a=h/s,this._b=-i/s,this._c=-u/s,this._d=t/s,this._tx=(u*f-h*v)/s,this._ty=(i*v-t*f)/s,x=this;return x},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new B0(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0},isInvertible:function(){var t=this._a*this._d-this._c*this._b;return t&&!isNaN(t)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(t,i,u){return arguments.length<3?this._transformPoint(R.read(arguments)):this._transformCoordinates(t,i,u)},_transformPoint:function(t,i,u){var{x:h,y:v}=t;if(!i)i=new R;return i._set(h*this._a+v*this._c+this._tx,h*this._b+v*this._d+this._ty,u)},_transformCoordinates:function(t,i,u){for(var h=0,v=2*u;h<v;h+=2){var f=t[h],s=t[h+1];i[h]=f*this._a+s*this._c+this._tx,i[h+1]=f*this._b+s*this._d+this._ty}return i},_transformCorners:function(t){var{x:i,y:u}=t,h=i+t.width,v=u+t.height,f=[i,u,h,u,h,v,i,v];return this._transformCoordinates(f,f,4)},_transformBounds:function(t,i,u){var h=this._transformCorners(t),v=h.slice(0,2),f=v.slice();for(var s=2;s<8;s++){var x=h[s],g=s&1;if(x<v[g])v[g]=x;else if(x>f[g])f[g]=x}if(!i)i=new m0;return i._set(v[0],v[1],f[0]-v[0],f[1]-v[1],u)},inverseTransform:function(){return this._inverseTransform(R.read(arguments))},_inverseTransform:function(t,i,u){var h=this._a,v=this._b,f=this._c,s=this._d,x=this._tx,g=this._ty,p=h*s-v*f,d=null;if(p&&!isNaN(p)&&isFinite(x)&&isFinite(g)){var P=t.x-this._tx,r=t.y-this._ty;if(!i)i=new R;d=i._set((P*s-r*f)/p,(r*h-P*v)/p,u)}return d},decompose:function(){var t=this._a,i=this._b,u=this._c,h=this._d,v=t*h-i*u,f=Math.sqrt,s=Math.atan2,x=180/Math.PI,g,p,d;if(t!==0||i!==0){var P=f(t*t+i*i);g=Math.acos(t/P)*(i>0?1:-1),p=[P,v/P],d=[s(t*u+i*h,P*P),0]}else if(u!==0||h!==0){var r=f(u*u+h*h);g=Math.asin(u/r)*(h>0?1:-1),p=[v/r,r],d=[0,s(t*u+i*h,r*r)]}else g=0,d=p=[0,0];return{translation:this.getTranslation(),rotation:g*x,scaling:new R(p),skewing:new R(d[0]*x,d[1]*x)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new R(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(t){if(!this.isIdentity())t.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},k.each(["a","b","c","d","tx","ty"],function(t){var i=k.capitalize(t),u="_"+t;this["get"+i]=function(){return this[u]},this["set"+i]=function(h){this[u]=h,this._changed()}},{})),Y0=k.extend({_class:"Line",initialize:function t(i,u,h,v,f){var s=!1;if(arguments.length>=4)this._px=i,this._py=u,this._vx=h,this._vy=v,s=f;else this._px=i.x,this._py=i.y,this._vx=u.x,this._vy=u.y,s=h;if(!s)this._vx-=this._px,this._vy-=this._py},getPoint:function(){return new R(this._px,this._py)},getVector:function(){return new R(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(t,i){return Y0.intersect(this._px,this._py,this._vx,this._vy,t._px,t._py,t._vx,t._vy,!0,i)},getSide:function(t,i){return Y0.getSide(this._px,this._py,this._vx,this._vy,t.x,t.y,!0,i)},getDistance:function(t){return Math.abs(this.getSignedDistance(t))},getSignedDistance:function(t){return Y0.getSignedDistance(this._px,this._py,this._vx,this._vy,t.x,t.y,!0)},isCollinear:function(t){return R.isCollinear(this._vx,this._vy,t._vx,t._vy)},isOrthogonal:function(t){return R.isOrthogonal(this._vx,this._vy,t._vx,t._vy)},statics:{intersect:function(t,i,u,h,v,f,s,x,g,p){if(!g)u-=t,h-=i,s-=v,x-=f;var d=u*x-h*s;if(!t0.isMachineZero(d)){var P=t-v,r=i-f,l=(s*r-x*P)/d,_=(u*r-h*P)/d,D=0.000000000001,B=-D,j=1+D;if(p||B<l&&l<j&&B<_&&_<j){if(!p)l=l<=0?0:l>=1?1:l;return new R(t+l*u,i+l*h)}}},getSide:function(t,i,u,h,v,f,s,x){if(!s)u-=t,h-=i;var g=v-t,p=f-i,d=g*h-p*u;if(!x&&t0.isMachineZero(d)){if(d=(g*u+g*u)/(u*u+h*h),d>=0&&d<=1)d=0}return d<0?-1:d>0?1:0},getSignedDistance:function(t,i,u,h,v,f,s){if(!s)u-=t,h-=i;return u===0?h>0?v-t:t-v:h===0?u<0?f-i:i-f:((v-t)*h-(f-i)*u)/(h>u?h*Math.sqrt(1+u*u/(h*h)):u*Math.sqrt(1+h*h/(u*u)))},getDistance:function(t,i,u,h,v,f,s){return Math.abs(Y0.getSignedDistance(t,i,u,h,v,f,s))}}}),b6=w0.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function t(i){w0.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new z0(null,null,this),this._view=A0.create(this,i||Z0.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(t,i){return k.serialize(this._children,t,!0,i)},_changed:function(t,i){if(t&1){var u=this._view;if(u){if(u._needsUpdate=!0,!u._requested&&u._autoUpdate)u.requestUpdate()}}var h=this._changes;if(h&&i){var v=this._changesById,f=i._id,s=v[f];if(s)s.flags|=t;else h.push(v[f]={item:i,flags:t})}},clear:function(){var t=this._children;for(var i=t.length-1;i>=0;i--)t[i].remove()},isEmpty:function(){return!this._children.length},remove:function t(){if(!t.base.call(this))return!1;if(this._view)this._view.remove();return!0},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(t){this._currentStyle.set(t)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new P6({project:this,insert:!0})},getSymbolDefinitions:function(){var t=[],i={};return this.getItems({class:u0,match:function(u){var h=u._definition,v=h._id;if(!i[v])i[v]=!0,t.push(h);return!1}}),t},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var t=this._selectionItems,i=[];for(var u in t){var h=t[u],v=h._selection;if(v&1&&h.isInserted())i.push(h);else if(!v)this._updateSelection(h)}return i},_updateSelection:function(t){var i=t._id,u=this._selectionItems;if(t._selection){if(u[i]!==t)this._selectionCount++,u[i]=t}else if(u[i]===t)this._selectionCount--,delete u[i]},selectAll:function(){var t=this._children;for(var i=0,u=t.length;i<u;i++)t[i].setFullySelected(!0)},deselectAll:function(){var t=this._selectionItems;for(var i in t)t[i].setFullySelected(!1)},addLayer:function(t){return this.insertLayer(N,t)},insertLayer:function(t,i){if(i instanceof P6){i._remove(!1,!0),k.splice(this._children,[i],t,0),i._setProject(this,!0);var u=i._name;if(u)i.setName(u);if(this._changes)i._changed(5);if(!this._activeLayer)this._activeLayer=i}else i=null;return i},_insertItem:function(t,i,u){if(i=this.insertLayer(t,i)||(this._activeLayer||this._insertItem(N,new P6(l0.NO_INSERT),!0)).insertChild(t,i),u&&i.activate)i.activate();return i},getItems:function(t){return l0._getItems(this,t)},getItem:function(t){return l0._getItems(this,t,null,null,!0)[0]||null},importJSON:function(t){this.activate();var i=this._activeLayer;return k.importJSON(t,i&&i.isEmpty()&&i)},removeOn:function(t){var i=this._removeSets;if(i){if(t==="mouseup")i.mousedrag=null;var u=i[t];if(u){for(var h in u){var v=u[h];for(var f in i){var s=i[f];if(s&&s!=u)delete s[v._id]}v.remove()}i[t]=null}}},draw:function(t,i,u){this._updateVersion++,t.save(),i.applyToContext(t);var h=this._children,v=new k({offset:new R(0,0),pixelRatio:u,viewMatrix:i.isIdentity()?null:i,matrices:[new B0],updateMatrix:!0});for(var f=0,s=h.length;f<s;f++)h[f].draw(t,v);if(t.restore(),this._selectionCount>0){t.save(),t.strokeWidth=1;var x=this._selectionItems,g=this._scope.settings.handleSize,p=this._updateVersion;for(var d in x)x[d]._drawSelection(t,i,g,x,p);t.restore()}}}),l0=k.extend(Y,{statics:{extend:function t(i){if(i._serializeFields)i._serializeFields=k.set({},this.prototype._serializeFields,i._serializeFields);return t.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new B0,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var t=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return k.each(t,function(i){this._events[i]={install:function(u){this.getView()._countItemEvent(u,1)},uninstall:function(u){this.getView()._countItemEvent(u,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:t}})},{initialize:function t(){},_initialize:function(t,i){var u=t&&k.isPlainObject(t),h=u&&t.internal===!0,v=this._matrix=new B0,f=u&&t.project||G0.project,s=G0.settings;if(this._id=h?null:P0.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&s.applyMatrix,i)v.translate(i);if(v._owner=this,this._style=new z0(f._currentStyle,this,f),h||u&&t.insert==!1||!s.insertItems&&!(u&&t.insert==!0))this._setProject(f);else(u&&t.parent||f)._insertItem(N,this,!0);if(u&&t!==l0.NO_INSERT&&t!==l0.INSERT)this.set(t,{internal:!0,insert:!0,project:!0,parent:!0});return u},_serialize:function(t,i){var u={},h=this;function v(f){for(var s in f){var x=h[s];if(!k.equals(x,s==="leading"?f.fontSize*1.2:f[s]))u[s]=k.serialize(x,t,s!=="data",i)}}if(v(this._serializeFields),!(this instanceof J0))v(this._style._defaults);return[this._class,u]},_changed:function(t){var i=this._symbol,u=this._parent||i,h=this._project;if(t&8)this._bounds=this._position=this._decomposed=N;if(t&16)this._globalMatrix=N;if(u&&t&72)l0._clearBoundsCache(u);if(t&2)l0._clearBoundsCache(this);if(h)h._changed(t,this);if(i)i._changed(t)},getId:function(){return this._id},getName:function(){return this._name},setName:function(t){if(this._name)this._removeNamed();if(t===+t+"")throw new Error("Names consisting only of numbers are not supported.");var i=this._getOwner();if(t&&i){var{_children:u,_namedChildren:h}=i;if((h[t]=h[t]||[]).push(this),!(t in u))u[t]=this}this._name=t||N,this._changed(256)},getStyle:function(){return this._style},setStyle:function(t){this.getStyle().set(t)}},k.each(["locked","visible","blendMode","opacity","guide"],function(t){var i=k.capitalize(t),u="_"+t,h={locked:256,visible:265};this["get"+i]=function(){return this[u]},this["set"+i]=function(v){if(v!=this[u])this[u]=v,this._changed(h[t]||257)}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(t){if(t!==this._selection){this._selection=t;var i=this._project;if(i)i._updateSelection(this),this._changed(257)}},_changeSelection:function(t,i){var u=this._selection;this.setSelection(i?u|t:u&~t)},isSelected:function(){if(this._selectChildren){var t=this._children;for(var i=0,u=t.length;i<u;i++)if(t[i].isSelected())return!0}return!!(this._selection&1)},setSelected:function(t){if(this._selectChildren){var i=this._children;for(var u=0,h=i.length;u<h;u++)i[u].setSelected(t)}this._changeSelection(1,t)},isFullySelected:function(){var t=this._children,i=!!(this._selection&1);if(t&&i){for(var u=0,h=t.length;u<h;u++)if(!t[u].isFullySelected())return!1;return!0}return i},setFullySelected:function(t){var i=this._children;if(i)for(var u=0,h=i.length;u<h;u++)i[u].setFullySelected(t);this._changeSelection(1,t)},isClipMask:function(){return this._clipMask},setClipMask:function(t){if(this._clipMask!=(t=!!t)){if(this._clipMask=t,t)this.setFillColor(null),this.setStrokeColor(null);if(this._changed(257),this._parent)this._parent._changed(2048)}},getData:function(){if(!this._data)this._data={};return this._data},setData:function(t){this._data=t},getPosition:function(t){var i=t?R:c0,u=this._position||(this._position=this._getPositionFromBounds());return new i(u.x,u.y,this,"setPosition")},setPosition:function(){this.translate(R.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(t){return this._pivot?this._matrix._transformPoint(this._pivot):(t||this.getBounds()).getCenter(!0)},getPivot:function(){var t=this._pivot;return t?new c0(t.x,t.y,this,"setPivot"):null},setPivot:function(){this._pivot=R.read(arguments,0,{clone:!0,readNull:!0}),this._position=N}},k.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(t,i){this[i]=function(u){return this.getBounds(u,t)}},{beans:!0,getBounds:function(t,i){var u=i||t instanceof B0,h=k.set({},u?i:t,this._boundsOptions);if(!h.stroke||this.getStrokeScaling())h.cacheItem=this;var v=this._getCachedBounds(u&&t,h).rect;return!arguments.length?new G6(v.x,v.y,v.width,v.height,this,"setBounds"):v},setBounds:function(){var t=m0.read(arguments),i=this.getBounds(),u=this._matrix,h=new B0,v=t.getCenter();if(h.translate(v),t.width!=i.width||t.height!=i.height){if(!u.isInvertible())u.set(u._backup||new B0().translate(u.getTranslation())),i=this.getBounds();h.scale(i.width!==0?t.width/i.width:0,i.height!==0?t.height/i.height:0)}v=i.getCenter(),h.translate(-v.x,-v.y),this.transform(h)},_getBounds:function(t,i){var u=this._children;if(!u||!u.length)return new m0;return l0._updateBoundsCache(this,i.cacheItem),l0._getBounds(u,t,i)},_getBoundsCacheKey:function(t,i){return[t.stroke?1:0,t.handle?1:0,i?1:0].join("")},_getCachedBounds:function(t,i,u){t=t&&t._orNullIfIdentity();var h=i.internal&&!u,v=i.cacheItem,f=h?null:this._matrix._orNullIfIdentity(),s=v&&(!t||t.equals(f))&&this._getBoundsCacheKey(i,h),x=this._bounds;if(l0._updateBoundsCache(this._parent||this._symbol,v),s&&x&&s in x){var g=x[s];return{rect:g.rect.clone(),nonscaling:g.nonscaling}}var p=this._getBounds(t||f,i),d=p.rect||p,P=this._style,r=p.nonscaling||P.hasStroke()&&!P.getStrokeScaling();if(s){if(!x)this._bounds=x={};var g=x[s]={rect:d.clone(),nonscaling:r,internal:h}}return{rect:d,nonscaling:r}},_getStrokeMatrix:function(t,i){var u=this.getStrokeScaling()?null:i&&i.internal?this:this._parent||this._symbol&&this._symbol._item,h=u?u.getViewMatrix().invert():t;return h&&h._shiftless()},statics:{_updateBoundsCache:function(t,i){if(t&&i){var u=i._id,h=t._boundsCache=t._boundsCache||{ids:{},list:[]};if(!h.ids[u])h.list.push(i),h.ids[u]=i}},_clearBoundsCache:function(t){var i=t._boundsCache;if(i){t._bounds=t._position=t._boundsCache=N;for(var u=0,h=i.list,v=h.length;u<v;u++){var f=h[u];if(f!==t){if(f._bounds=f._position=N,f._boundsCache)l0._clearBoundsCache(f)}}}},_getBounds:function(t,i,u){var h=Infinity,v=-h,f=h,s=v,x=!1;u=u||{};for(var g=0,p=t.length;g<p;g++){var d=t[g];if(d._visible&&!d.isEmpty(!0)){var P=d._getCachedBounds(i&&i.appended(d._matrix),u,!0),r=P.rect;if(h=Math.min(r.x,h),f=Math.min(r.y,f),v=Math.max(r.x+r.width,v),s=Math.max(r.y+r.height,s),P.nonscaling)x=!0}}return{rect:isFinite(h)?new m0(h,f,v-h,s-f):new m0,nonscaling:x}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var t=this._decompose();return t?t.rotation:0},setRotation:function(t){var i=this.getRotation();if(i!=null&&t!=null){var u=this._decomposed;if(this.rotate(t-i),u)u.rotation=t,this._decomposed=u}},getScaling:function(){var t=this._decompose(),i=t&&t.scaling;return new c0(i?i.x:1,i?i.y:1,this,"setScaling")},setScaling:function(){var t=this.getScaling(),i=R.read(arguments,0,{clone:!0,readNull:!0});if(t&&i&&!t.equals(i)){var u=this.getRotation(),h=this._decomposed,v=new B0,f=t0.isZero;if(f(t.x)||f(t.y)){if(v.translate(h.translation),u)v.rotate(u);v.scale(i.x,i.y),this._matrix.set(v)}else{var s=this.getPosition(!0);if(v.translate(s),u)v.rotate(u);if(v.scale(i.x/t.x,i.y/t.y),u)v.rotate(-u);v.translate(s.negate()),this.transform(v)}if(h)h.scaling=i,this._decomposed=h}},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},getGlobalMatrix:function(t){var i=this._globalMatrix;if(i){var u=this._parent,h=[];while(u){if(!u._globalMatrix){i=null;for(var v=0,f=h.length;v<f;v++)h[v]._globalMatrix=null;break}h.push(u),u=u._parent}}if(!i){i=this._globalMatrix=this._matrix.clone();var u=this._parent;if(u)i.prepend(u.getGlobalMatrix(!0))}return t?i:i.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(t){if(this._applyMatrix=this._canApplyMatrix&&!!t)this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(t,i){if(this._project!==t){if(this._project)this._installEvents(!1);this._project=t;var u=this._children;for(var h=0,v=u&&u.length;h<v;h++)u[h]._setProject(t);i=!0}if(i)this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function t(i){t.base.call(this,i);var u=this._children;for(var h=0,v=u&&u.length;h<v;h++)u[h]._installEvents(i)},getLayer:function(){var t=this;while(t=t._parent)if(t instanceof P6)return t;return null},getParent:function(){return this._parent},setParent:function(t){return t.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(t){this.removeChildren(),this.addChildren(t)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var t=this._getOwner();return t&&t._children[this._index+1]||null},getPreviousSibling:function(){var t=this._getOwner();return t&&t._children[this._index-1]||null},getIndex:function(){return this._index},equals:function(t){return t===this||t&&this._class===t._class&&this._style.equals(t._style)&&this._matrix.equals(t._matrix)&&this._locked===t._locked&&this._visible===t._visible&&this._blendMode===t._blendMode&&this._opacity===t._opacity&&this._clipMask===t._clipMask&&this._guide===t._guide&&this._equals(t)||!1},_equals:function(t){return k.equals(this._children,t._children)},clone:function(t){var i=new this.constructor(l0.NO_INSERT),u=this._children,h=k.pick(t?t.insert:N,t===N||t===!0),v=k.pick(t?t.deep:N,!0);if(u)i.copyAttributes(this);if(!u||v)i.copyContent(this);if(!u)i.copyAttributes(this);if(h)i.insertAbove(this);var f=this._name,s=this._parent;if(f&&s){var u=s._children,x=f,g=1;while(u[f])f=x+" "+g++;if(f!==x)i.setName(f)}return i},copyContent:function(t){var i=t._children;for(var u=0,h=i&&i.length;u<h;u++)this.addChild(i[u].clone(!1),!0)},copyAttributes:function(t,i){this.setStyle(t._style);var u=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"];for(var h=0,v=u.length;h<v;h++){var f=u[h];if(t.hasOwnProperty(f))this[f]=t[f]}if(!i)this._matrix.set(t._matrix,!0);this.setApplyMatrix(t._applyMatrix),this.setPivot(t._pivot),this.setSelection(t._selection);var{_data:s,_name:x}=t;if(this._data=s?k.clone(s):null,x)this.setName(x)},rasterize:function(t,i){var u,h,v;if(k.isPlainObject(t))u=t.resolution,h=t.insert,v=t.raster;else u=t,h=i;if(!v)v=new $(l0.NO_INSERT);var f=this.getStrokeBounds(),s=(u||this.getView().getResolution())/72,x=f.getTopLeft().floor(),g=f.getBottomRight().ceil(),p=new i0(g.subtract(x)),d=p.multiply(s);if(v.setSize(d,!0),!d.isZero()){var P=v.getContext(!0),r=new B0().scale(s).translate(x.negate());P.save(),r.applyToContext(P),this.draw(P,new k({matrices:[r]})),P.restore()}if(v._matrix.set(new B0().translate(x.add(p.divide(2))).scale(1/s)),h===N||h)v.insertAbove(this);return v},contains:function(){var t=this._matrix;return t.isInvertible()&&!!this._contains(t._inverseTransform(R.read(arguments)))},_contains:function(t){var i=this._children;if(i){for(var u=i.length-1;u>=0;u--)if(i[u].contains(t))return!0;return!1}return t.isInside(this.getInternalBounds())},isInside:function(){return m0.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new d0.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(t,i){if(!(t instanceof l0))return!1;return this._asPathItem().getIntersections(t._asPathItem(),null,i,!0).length>0}},new function(){function t(){var h=arguments;return this._hitTest(R.read(h),f0.getOptions(h))}function i(){var h=arguments,v=R.read(h),f=f0.getOptions(h),s=[];return this._hitTest(v,new k({all:s},f)),s}function u(h,v,f,s){var x=this._children;if(x)for(var g=x.length-1;g>=0;g--){var p=x[g],d=p!==s&&p._hitTest(h,v,f);if(d&&!v.all)return d}return null}return b6.inject({hitTest:t,hitTestAll:i,_hitTest:u}),{hitTest:t,hitTestAll:i,_hitTestChildren:u}},{_hitTest:function(t,i,u){if(this._locked||!this._visible||this._guide&&!i.guides||this.isEmpty())return null;var h=this._matrix,v=u?u.appended(h):this.getGlobalMatrix().prepend(this.getView()._matrix),f=Math.max(i.tolerance,0.000000000001),s=i._tolerancePadding=new i0(d0._getStrokePadding(f,h._shiftless().invert()));if(t=h._inverseTransform(t),!t||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(s.multiply(2))._containsPoint(t))return null;var x=!(i.guides&&!this._guide||i.selected&&!this.isSelected()||i.type&&i.type!==k.hyphenate(this._class)||i.class&&!(this instanceof i.class)),g=i.match,p=this,d,P;function r(w){if(w&&g&&!g(w))w=null;if(w&&i.all)i.all.push(w);return w}function l(w,S){var C=S?d["get"+S]():p.getPosition();if(t.subtract(C).divide(s).length<=1)return new f0(w,p,{name:S?k.hyphenate(S):w,point:C})}var{position:_,center:D,bounds:B}=i;if(x&&this._parent&&(_||D||B)){if(D||B)d=this.getInternalBounds();if(P=_&&l("position")||D&&l("center","Center"),!P&&B){var j=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"];for(var o=0;o<8&&!P;o++)P=l("bounds",j[o])}P=r(P)}if(!P)P=this._hitTestChildren(t,i,v)||x&&r(this._hitTestSelf(t,i,v,this.getStrokeScaling()?null:v._shiftless().invert()))||null;if(P&&P.point)P.point=h.transform(P.point);return P},_hitTestSelf:function(t,i){if(i.fill&&this.hasFill()&&this._contains(t))return new f0("fill",this)},matches:function(t,i){function u(s,x){for(var g in s)if(s.hasOwnProperty(g)){var p=s[g],d=x[g];if(k.isPlainObject(p)&&k.isPlainObject(d)){if(!u(p,d))return!1}else if(!k.equals(p,d))return!1}return!0}var h=typeof t;if(h==="object"){for(var v in t)if(t.hasOwnProperty(v)&&!this.matches(v,t[v]))return!1;return!0}else if(h==="function")return t(this);else if(t==="match")return i(this);else{var f=/^(empty|editable)$/.test(t)?this["is"+k.capitalize(t)]():t==="type"?k.hyphenate(this._class):this[t];if(t==="class"){if(typeof i==="function")return this instanceof i;f=this._class}if(typeof i==="function")return!!i(f);else if(i){if(i.test)return i.test(f);else if(k.isPlainObject(i))return u(i,f)}return k.equals(f,i)}},getItems:function(t){return l0._getItems(this,t,this._matrix)},getItem:function(t){return l0._getItems(this,t,this._matrix,null,!0)[0]||null},statics:{_getItems:function t(i,u,h,v,f){if(!v){var s=typeof u==="object"&&u,x=s&&s.overlapping,g=s&&s.inside,p=x||g,r=p&&m0.read([p]);if(v={items:[],recursive:s&&s.recursive!==!1,inside:!!g,overlapping:!!x,rect:r,path:x&&new d0.Rectangle({rectangle:r,insert:!1})},s)u=k.filter({},u,{recursive:!0,inside:!0,overlapping:!0})}var d=i._children,P=v.items,r=v.rect;h=r&&(h||new B0);for(var l=0,_=d&&d.length;l<_;l++){var D=d[l],B=h&&h.appended(D._matrix),j=!0;if(r){var p=D.getBounds(B);if(!r.intersects(p))continue;if(!(r.contains(p)||v.overlapping&&(p.contains(r)||v.path.intersects(D,B))))j=!1}if(j&&D.matches(u)){if(P.push(D),f)break}if(v.recursive!==!1)t(D,u,B,v,f);if(f&&P.length>0)break}return P}}},{importJSON:function(t){var i=k.importJSON(t,this);return i!==this?this.addChild(i):i},addChild:function(t){return this.insertChild(N,t)},insertChild:function(t,i){var u=i?this.insertChildren(t,[i]):null;return u&&u[0]},addChildren:function(t){return this.insertChildren(this._children.length,t)},insertChildren:function(t,i){var u=this._children;if(u&&i&&i.length>0){i=k.slice(i);var h={};for(var v=i.length-1;v>=0;v--){var f=i[v],s=f&&f._id;if(!f||h[s])i.splice(v,1);else f._remove(!1,!0),h[s]=!0}k.splice(u,i,t,0);var x=this._project,g=x._changes;for(var v=0,p=i.length;v<p;v++){var f=i[v],d=f._name;if(f._parent=this,f._setProject(x,!0),d)f.setName(d);if(g)f._changed(5)}this._changed(11)}else i=null;return i},_insertItem:"#insertChild",_insertAt:function(t,i){var u=t&&t._getOwner(),h=t!==this&&u?this:null;if(h)h._remove(!1,!0),u._insertItem(t._index+i,h);return h},insertAbove:function(t){return this._insertAt(t,1)},insertBelow:function(t){return this._insertAt(t,0)},sendToBack:function(){var t=this._getOwner();return t?t._insertItem(0,this):null},bringToFront:function(){var t=this._getOwner();return t?t._insertItem(N,this):null},appendTop:"#addChild",appendBottom:function(t){return this.insertChild(0,t)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(t){return t._insertItem(N,this)},copyTo:function(t){return this.clone(!1).addTo(t)},reduce:function(t){var i=this._children;if(i&&i.length===1){var u=i[0].reduce(t);if(this._parent)u.insertAbove(this),this.remove();else u.remove();return u}return this},_removeNamed:function(){var t=this._getOwner();if(t){var{_children:i,_namedChildren:u}=t,h=this._name,v=u[h],f=v?v.indexOf(this):-1;if(f!==-1){if(i[h]==this)delete i[h];if(v.splice(f,1),v.length)i[h]=v[0];else delete u[h]}}},_remove:function(t,i){var u=this._getOwner(),h=this._project,v=this._index;if(this._style)this._style._dispose();if(u){if(this._name)this._removeNamed();if(v!=null){if(h._activeLayer===this)h._activeLayer=this.getNextSibling()||this.getPreviousSibling();k.splice(u._children,null,v,1)}if(this._installEvents(!1),t&&h._changes)this._changed(5);if(i)u._changed(11,this);return this._parent=null,!0}return!1},remove:function(){return this._remove(!0,!0)},replaceWith:function(t){var i=t&&t.insertBelow(this);if(i)this.remove();return i},removeChildren:function(t,i){if(!this._children)return null;t=t||0,i=k.pick(i,this._children.length);var u=k.splice(this._children,null,t,i-t);for(var h=u.length-1;h>=0;h--)u[h]._remove(!0,!1);if(u.length>0)this._changed(11);return u},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var t=0,i=this._children.length;t<i;t++)this._children[t]._index=t;this._changed(11)}},isEmpty:function(t){var i=this._children,u=i?i.length:0;if(t){for(var h=0;h<u;h++)if(!i[h].isEmpty(t))return!1;return!0}return!u},isEditable:function(){var t=this;while(t){if(!t._visible||t._locked)return!1;t=t._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(t){function i(s){var x=[];do x.unshift(s);while(s=s._parent);return x}var u=i(this),h=i(t);for(var v=0,f=Math.min(u.length,h.length);v<f;v++)if(u[v]!=h[v])return u[v]._index<h[v]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return this._parent?this._parent.isInserted():!1},isAbove:function(t){return this._getOrder(t)===-1},isBelow:function(t){return this._getOrder(t)===1},isParent:function(t){return this._parent===t},isChild:function(t){return t&&t._parent===this},isDescendant:function(t){var i=this;while(i=i._parent)if(i===t)return!0;return!1},isAncestor:function(t){return t?t.isDescendant(this):!1},isSibling:function(t){return this._parent===t._parent},isGroupedWith:function(t){var i=this._parent;while(i){if(i._parent&&/^(Group|Layer|CompoundPath)$/.test(i._class)&&t.isDescendant(i))return!0;i=i._parent}return!1}},k.each(["rotate","scale","shear","skew"],function(t){var i=t==="rotate";this[t]=function(){var u=arguments,h=(i?k:R).read(u),v=R.read(u,0,{readNull:!0});return this.transform(new B0()[t](h,v||this.getPosition(!0)))}},{translate:function(){var t=new B0;return this.transform(t.translate.apply(t,arguments))},transform:function(t,i,u){var h=this._matrix,v=t&&!t.isIdentity(),f=u&&this._canApplyMatrix||this._applyMatrix&&(v||!h.isIdentity()||i&&this._children);if(!v&&!f)return this;if(v){if(!t.isInvertible()&&h.isInvertible())h._backup=h.getValues();h.prepend(t,!0);var s=this._style,x=s.getFillColor(!0),g=s.getStrokeColor(!0);if(x)x.transform(t);if(g)g.transform(t)}if(f&&(f=this._transformContent(h,i,u))){var p=this._pivot;if(p)h._transformPoint(p,p,!0);if(h.reset(!0),u&&this._canApplyMatrix)this._applyMatrix=!0}var d=this._bounds,P=this._position;if(v||f)this._changed(25);var r=v&&d&&t.decompose();if(r&&r.skewing.isZero()&&r.rotation%90===0){for(var l in d){var _=d[l];if(_.nonscaling)delete d[l];else if(f||!_.internal){var D=_.rect;t._transformBounds(D,D)}}this._bounds=d;var B=d[this._getBoundsCacheKey(this._boundsOptions||{})];if(B)this._position=this._getPositionFromBounds(B.rect)}else if(v&&P&&this._pivot)this._position=t._transformPoint(P,P);return this},_transformContent:function(t,i,u){var h=this._children;if(h){for(var v=0,f=h.length;v<f;v++)h[v].transform(t,i,u);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(R.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(R.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(R.read(arguments))},localToParent:function(){return this._matrix._transformPoint(R.read(arguments))},fitBounds:function(t,i){t=m0.read(arguments);var u=this.getBounds(),h=u.height/u.width,v=t.height/t.width,f=(i?h>v:h<v)?t.width/u.width:t.height/u.height,s=new m0(new R,new i0(u.width*f,u.height*f));s.setCenter(t.getCenter()),this.setBounds(s)}}),{_setStyles:function(t,i,u){var h=this._style,v=this._matrix;if(h.hasFill())t.fillStyle=h.getFillColor().toCanvasStyle(t,v);if(h.hasStroke()){t.strokeStyle=h.getStrokeColor().toCanvasStyle(t,v),t.lineWidth=h.getStrokeWidth();var f=h.getStrokeJoin(),s=h.getStrokeCap(),x=h.getMiterLimit();if(f)t.lineJoin=f;if(s)t.lineCap=s;if(x)t.miterLimit=x;if(G0.support.nativeDash){var g=h.getDashArray(),p=h.getDashOffset();if(g&&g.length)if("setLineDash"in t)t.setLineDash(g),t.lineDashOffset=p;else t.mozDash=g,t.mozDashOffset=p}}if(h.hasShadow()){var d=i.pixelRatio||1,P=u._shiftless().prepend(new B0().scale(d,d)),r=P.transform(new R(h.getShadowBlur(),0)),l=P.transform(this.getShadowOffset());t.shadowColor=h.getShadowColor().toCanvasStyle(t),t.shadowBlur=r.getLength(),t.shadowOffsetX=l.x,t.shadowOffsetY=l.y}},draw:function(t,i,u){var h=this._updateVersion=this._project._updateVersion;if(!this._visible||this._opacity===0)return;var{matrices:v,viewMatrix:f}=i,s=this._matrix,x=v[v.length-1].appended(s);if(!x.isInvertible())return;if(f=f?f.appended(x):x,v.push(x),i.updateMatrix)this._globalMatrix=x;var g=this._blendMode,p=t0.clamp(this._opacity,0,1),d=g==="normal",P=j4.nativeModes[g],r=d&&p===1||i.dontStart||i.clip||(P||d&&p<1)&&this._canComposite(),l=i.pixelRatio||1,_,D,B;if(!r){var j=this.getStrokeBounds(f);if(!j.width||!j.height){v.pop();return}if(B=i.offset,D=i.offset=j.getTopLeft().floor(),_=t,t=Z0.getContext(j.getSize().ceil().add(1).multiply(l)),l!==1)t.scale(l,l)}t.save();var o=u?u.appended(s):this._canScaleStroke&&!this.getStrokeScaling(!0)&&f,w=!r&&i.clipItem,S=!o||w;if(r){if(t.globalAlpha=p,P)t.globalCompositeOperation=g}else if(S)t.translate(-D.x,-D.y);if(S)(r?s:f).applyToContext(t);if(w)i.clipItem.draw(t,i.extend({clip:!0}));if(o){t.setTransform(l,0,0,l,0,0);var C=i.offset;if(C)t.translate(-C.x,-C.y)}if(this._draw(t,i,f,o),t.restore(),v.pop(),i.clip&&!i.dontFinish)t.clip(this.getFillRule());if(!r)j4.process(g,t,_,p,D.subtract(B).multiply(l)),Z0.release(t),i.offset=B},_isUpdated:function(t){var i=this._parent;if(i instanceof T0)return i._isUpdated(t);var u=this._updateVersion===t;if(!u&&i&&i._visible&&i._isUpdated(t))this._updateVersion=t,u=!0;return u},_drawSelection:function(t,i,u,h,v){var f=this._selection,s=f&1,x=f&2||s&&this._selectBounds,g=f&4;if(!this._drawSelected)s=!1;if((s||x||g)&&this._isUpdated(v)){var p,d=this.getSelectedColor(!0)||(p=this.getLayer())&&p.getSelectedColor(!0),P=i.appended(this.getGlobalMatrix(!0)),r=u/2;if(t.strokeStyle=t.fillStyle=d?d.toCanvasStyle(t):"#009dec",s)this._drawSelected(t,P,h);if(g){var l=this.getPosition(!0),_=this._parent,D=_?_.localToGlobal(l):l,B=D.x,j=D.y;t.beginPath(),t.arc(B,j,r,0,Math.PI*2,!0),t.stroke();var o=[[0,-1],[1,0],[0,1],[-1,0]],w=r,S=u+1;for(var C=0;C<4;C++){var G=o[C],L=G[0],c=G[1];t.moveTo(B+L*w,j+c*w),t.lineTo(B+L*S,j+c*S),t.stroke()}}if(x){var E=P._transformCorners(this.getInternalBounds());t.beginPath();for(var C=0;C<8;C++)t[!C?"moveTo":"lineTo"](E[C],E[++C]);t.closePath(),t.stroke();for(var C=0;C<8;C++)t.fillRect(E[C]-r,E[++C]-r,u,u)}}},_canComposite:function(){return!1}},k.each(["down","drag","up","move"],function(t){this["removeOn"+k.capitalize(t)]=function(){var i={};return i[t]=!0,this.removeOn(i)}},{removeOn:function(t){for(var i in t)if(t[i]){var u="mouse"+i,h=this._project,v=h._removeSets=h._removeSets||{};v[u]=v[u]||{},v[u][this._id]=this}return this}}),{tween:function(t,i,u){if(!u){if(u=i,i=t,t=null,!u)u=i,i=null}var h=u&&u.easing,v=u&&u.start,f=u!=null&&(typeof u==="number"?u:u.duration),s=new y8(this,t,i,f,h,v);function x(g){if(s._handleFrame(g.time*1000),!s.running)this.off("frame",x)}if(f)this.on("frame",x);return s},tweenTo:function(t,i){return this.tween(null,t,i)},tweenFrom:function(t,i){return this.tween(t,null,i)}}),J0=l0.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function t(i){if(this._children=[],this._namedChildren={},!this._initialize(i))this.addChildren(Array.isArray(i)?i:arguments)},_changed:function t(i){if(t.base.call(this,i),i&2050)this._clipItem=N},_getClipItem:function(){var t=this._clipItem;if(t===N){t=null;var i=this._children;for(var u=0,h=i.length;u<h;u++)if(i[u]._clipMask){t=i[u];break}this._clipItem=t}return t},isClipped:function(){return!!this._getClipItem()},setClipped:function(t){var i=this.getFirstChild();if(i)i.setClipMask(t)},_getBounds:function t(i,u){var h=this._getClipItem();return h?h._getCachedBounds(h._matrix.prepended(i),k.set({},u,{stroke:!1})):t.base.call(this,i,u)},_hitTestChildren:function t(i,u,h){var v=this._getClipItem();return(!v||v.contains(i))&&t.base.call(this,i,u,h,v)},_draw:function(t,i){var u=i.clip,h=!u&&this._getClipItem();if(i=i.extend({clipItem:h,clip:!1}),u)t.beginPath(),i.dontStart=i.dontFinish=!0;else if(h)h.draw(t,i.extend({clip:!0}));var v=this._children;for(var f=0,s=v.length;f<s;f++){var x=v[f];if(x!==h)x.draw(t,i)}}}),P6=J0.extend({_class:"Layer",initialize:function t(){J0.apply(this,arguments)},_getOwner:function(){return this._parent||this._index!=null&&this._project},isInserted:function t(){return this._parent?t.base.call(this):this._index!=null},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),n0=l0.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function t(i,u){this._initialize(i,u)},_equals:function(t){return this._type===t._type&&this._size.equals(t._size)&&k.equals(this._radius,t._radius)},copyContent:function(t){this.setType(t._type),this.setSize(t._size),this.setRadius(t._radius)},getType:function(){return this._type},setType:function(t){this._type=t},getShape:"#getType",setShape:"#setType",getSize:function(){var t=this._size;return new e0(t.width,t.height,this,"setSize")},setSize:function(){var t=i0.read(arguments);if(!this._size)this._size=t.clone();else if(!this._size.equals(t)){var i=this._type,u=t.width,h=t.height;if(i==="rectangle")this._radius.set(i0.min(this._radius,t.divide(2).abs()));else if(i==="circle")u=h=(u+h)/2,this._radius=u/2;else if(i==="ellipse")this._radius._set(u/2,h/2);this._size._set(u,h),this._changed(9)}},getRadius:function(){var t=this._radius;return this._type==="circle"?t:new e0(t.width,t.height,this,"setRadius")},setRadius:function(t){var i=this._type;if(i==="circle"){if(t===this._radius)return;var u=t*2;this._radius=t,this._size._set(u,u)}else if(t=i0.read(arguments),!this._radius)this._radius=t.clone();else{if(this._radius.equals(t))return;if(this._radius.set(t),i==="rectangle"){var u=i0.max(this._size,t.multiply(2));this._size.set(u)}else if(i==="ellipse")this._size._set(t.width*2,t.height*2)}this._changed(9)},isEmpty:function(){return!1},toPath:function(t){var i=new d0[k.capitalize(this._type)]({center:new R,size:this._size,radius:this._radius,insert:!1});if(i.copyAttributes(this),G0.settings.applyMatrix)i.setApplyMatrix(!0);if(t===N||t)i.insertAbove(this);return i},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(t,i,u,h){var v=this._style,f=v.hasFill(),s=v.hasStroke(),x=i.dontFinish||i.clip,g=!h;if(f||s||x){var p=this._type,d=this._radius,P=p==="circle";if(!i.dontStart)t.beginPath();if(g&&P)t.arc(0,0,d,0,Math.PI*2,!0);else{var r=P?d:d.width,l=P?d:d.height,_=this._size,D=_.width,B=_.height;if(g&&p==="rectangle"&&r===0&&l===0)t.rect(-D/2,-B/2,D,B);else{var j=D/2,o=B/2,w=0.44771525016920644,S=r*w,C=l*w,G=[-j,-o+l,-j,-o+C,-j+S,-o,-j+r,-o,j-r,-o,j-S,-o,j,-o+C,j,-o+l,j,o-l,j,o-C,j-S,o,j-r,o,-j+r,o,-j+S,o,-j,o-C,-j,o-l];if(h)h.transform(G,G,32);if(t.moveTo(G[0],G[1]),t.bezierCurveTo(G[2],G[3],G[4],G[5],G[6],G[7]),j!==r)t.lineTo(G[8],G[9]);if(t.bezierCurveTo(G[10],G[11],G[12],G[13],G[14],G[15]),o!==l)t.lineTo(G[16],G[17]);if(t.bezierCurveTo(G[18],G[19],G[20],G[21],G[22],G[23]),j!==r)t.lineTo(G[24],G[25]);t.bezierCurveTo(G[26],G[27],G[28],G[29],G[30],G[31])}}t.closePath()}if(!x&&(f||s)){if(this._setStyles(t,i,u),f)t.fill(v.getFillRule()),t.shadowColor="rgba(0,0,0,0)";if(s)t.stroke()}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(t,i){var u=new m0(this._size).setCenter(0,0),h=this._style,v=i.stroke&&h.hasStroke()&&h.getStrokeWidth();if(t)u=t._transformBounds(u);return v?u.expand(d0._getStrokePadding(v,this._getStrokeMatrix(t,i))):u}},new function(){function t(u,h,v){var f=u._radius;if(!f.isZero()){var s=u._size.divide(2);for(var x=1;x<=4;x++){var g=new R(x>1&&x<4?-1:1,x>2?-1:1),p=g.multiply(s),d=p.subtract(g.multiply(f)),P=new m0(v?p.add(g.multiply(v)):p,d);if(P.contains(h))return{point:d,quadrant:x}}}}function i(u,h,v,f){var s=u.divide(h);return(!f||s.isInQuadrant(f))&&s.subtract(s.normalize()).multiply(h).divide(v).length<=1}return{_contains:function u(h){if(this._type==="rectangle"){var v=t(this,h);return v?h.subtract(v.point).divide(this._radius).getLength()<=1:u.base.call(this,h)}else return h.divide(this.size).getLength()<=0.5},_hitTestSelf:function u(h,v,f,s){var x=!1,g=this._style,p=v.stroke&&g.hasStroke(),d=v.fill&&g.hasFill();if(p||d){var P=this._type,r=this._radius,l=p?g.getStrokeWidth()/2:0,_=v._tolerancePadding.add(d0._getStrokePadding(l,!g.getStrokeScaling()&&s));if(P==="rectangle"){var D=_.multiply(2),B=t(this,h,D);if(B)x=i(h.subtract(B.point),r,_,B.quadrant);else{var j=new m0(this._size).setCenter(0,0),o=j.expand(D),w=j.expand(D.negate());x=o._containsPoint(h)&&!w._containsPoint(h)}}else x=i(h,r,_)}return x?new f0(p?"stroke":"fill",this):u.base.apply(this,arguments)}}},{statics:new function(){function t(i,u,h,v,f){var s=k.create(n0.prototype);return s._type=i,s._size=h,s._radius=v,s._initialize(k.getNamed(f),u),s}return{Circle:function(){var i=arguments,u=R.readNamed(i,"center"),h=k.readNamed(i,"radius");return t("circle",u,new i0(h*2),h,i)},Rectangle:function(){var i=arguments,u=m0.readNamed(i,"rectangle"),h=i0.min(i0.readNamed(i,"radius"),u.getSize(!0).divide(2));return t("rectangle",u.getCenter(!0),u.getSize(!0),h,i)},Ellipse:function(){var i=arguments,u=n0._readEllipse(i),h=u.radius;return t("ellipse",u.center,h.multiply(2),h,i)},_readEllipse:function(i){var u,h;if(k.hasNamed(i,"radius"))u=R.readNamed(i,"center"),h=i0.readNamed(i,"radius");else{var v=m0.readNamed(i,"rectangle");u=v.getCenter(!0),h=v.getSize(!0).divide(2)}return{center:u,radius:h}}}}}),$=l0.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function t(i,u){if(!this._initialize(i,u!==N&&R.read(arguments))){var h,v=typeof i,f=v==="string"?F.getElementById(i):v==="object"?i:null;if(f&&f!==l0.NO_INSERT){if(f.getContext||f.naturalHeight!=null)h=f;else if(f){var s=i0.read(arguments);if(!s.isZero())h=Z0.getCanvas(s)}}if(h)this.setImage(h);else this.setSource(i)}if(!this._size)this._size=new i0,this._loaded=!1},_equals:function(t){return this.getSource()===t.getSource()},copyContent:function(t){var{_image:i,_canvas:u}=t;if(i)this._setImage(i);else if(u){var h=Z0.getCanvas(t._size);h.getContext("2d").drawImage(u,0,0),this._setImage(h)}this._crossOrigin=t._crossOrigin},getSize:function(){var t=this._size;return new e0(t?t.width:0,t?t.height:0,this,"setSize")},setSize:function(t,i){var u=i0.read(arguments);if(!u.equals(this._size))if(u.width>0&&u.height>0){var h=!i&&this.getElement();if(this._setImage(Z0.getCanvas(u)),h)this.getContext(!0).drawImage(h,0,0,u.width,u.height)}else{if(this._canvas)Z0.release(this._canvas);this._size=u.clone()}else if(i)this.clear()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(t){this.setSize(t,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(t){this.setSize(this.getWidth(),t)},getLoaded:function(){return this._loaded},isEmpty:function(){var t=this._size;return!t||t.width===0&&t.height===0},getResolution:function(){var t=this._matrix,i=new R(0,0).transform(t),u=new R(1,0).transform(t).subtract(i),h=new R(0,1).transform(t).subtract(i);return new i0(72/u.getLength(),72/h.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(t){var i=this;function u(h){var v=i.getView(),f=h&&h.type||"load";if(v&&i.responds(f))G0=v._scope,i.emit(f,new B6(h))}if(this._setImage(t),this._loaded)setTimeout(u,0);else if(t)N0.add(t,{load:function(h){i._setImage(t),u(h)},error:u})},_setImage:function(t){if(this._canvas)Z0.release(this._canvas);if(t&&t.getContext)this._image=null,this._canvas=t,this._loaded=!0;else this._image=t,this._canvas=null,this._loaded=!!(t&&t.src&&t.complete);this._size=new i0(t?t.naturalWidth||t.width:0,t?t.naturalHeight||t.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var t=Z0.getContext(this._size);try{if(this._image)t.drawImage(this._image,0,0);this._canvas=t.canvas}catch(i){Z0.release(t)}}return this._canvas},setCanvas:"#setImage",getContext:function(t){if(!this._context)this._context=this.getCanvas().getContext("2d");if(t)this._image=null,this._changed(1025);return this._context},setContext:function(t){this._context=t},getSource:function(){var t=this._image;return t&&t.src||this.toDataURL()},setSource:function(t){var i=new V.Image,u=this._crossOrigin;if(u)i.crossOrigin=u;if(t)i.src=t;this.setImage(i)},getCrossOrigin:function(){var t=this._image;return t&&t.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(t){this._crossOrigin=t;var i=this._image;if(i)i.crossOrigin=t},getSmoothing:function(){return this._smoothing},setSmoothing:function(t){this._smoothing=typeof t==="string"?t:t?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var t=m0.read(arguments),i=Z0.getContext(t.getSize());return i.drawImage(this.getCanvas(),t.x,t.y,t.width,t.height,0,0,t.width,t.height),i.canvas},getSubRaster:function(){var t=m0.read(arguments),i=new $(l0.NO_INSERT);return i._setImage(this.getSubCanvas(t)),i.translate(t.getCenter().subtract(this.getSize().divide(2))),i._matrix.prepend(this._matrix),i.insertAbove(this),i},toDataURL:function(){var t=this._image,i=t&&t.src;if(/^data:/.test(i))return i;var u=this.getCanvas();return u?u.toDataURL.apply(u,arguments):null},drawImage:function(t){var i=R.read(arguments,1);this.getContext(!0).drawImage(t,i.x,i.y)},getAverageColor:function(t){var i,u;if(!t)i=this.getBounds();else if(t instanceof t6)u=t,i=t.getBounds();else if(typeof t==="object"){if("width"in t)i=new m0(t);else if("x"in t)i=new m0(t.x-0.5,t.y-0.5,1,1)}if(!i)return null;var h=32,v=Math.min(i.width,h),f=Math.min(i.height,h),s=$._sampleContext;if(!s)s=$._sampleContext=Z0.getContext(new i0(h));else s.clearRect(0,0,h+1,h+1);s.save();var x=new B0().scale(v/i.width,f/i.height).translate(-i.x,-i.y);if(x.applyToContext(s),u)u.draw(s,new k({clip:!0,matrices:[x]}));this._matrix.applyToContext(s);var g=this.getElement(),p=this._size;if(g)s.drawImage(g,-p.width/2,-p.height/2);s.restore();var d=s.getImageData(0.5,0.5,Math.ceil(v),Math.ceil(f)).data,P=[0,0,0],r=0;for(var l=0,_=d.length;l<_;l+=4){var D=d[l+3];r+=D,D/=255,P[0]+=d[l]*D,P[1]+=d[l+1]*D,P[2]+=d[l+2]*D}for(var l=0;l<3;l++)P[l]/=r;return r?U.read(P):null},getPixel:function(){var t=R.read(arguments),i=this.getContext().getImageData(t.x,t.y,1,1).data;return new U("rgb",[i[0]/255,i[1]/255,i[2]/255],i[3]/255)},setPixel:function(){var t=arguments,i=R.read(t),u=U.read(t),h=u._convert("rgb"),v=u._alpha,f=this.getContext(!0),s=f.createImageData(1,1),x=s.data;x[0]=h[0]*255,x[1]=h[1]*255,x[2]=h[2]*255,x[3]=v!=null?v*255:255,f.putImageData(s,i.x,i.y)},clear:function(){var t=this._size;this.getContext(!0).clearRect(0,0,t.width+1,t.height+1)},createImageData:function(){var t=i0.read(arguments);return this.getContext().createImageData(t.width,t.height)},getImageData:function(){var t=m0.read(arguments);if(t.isEmpty())t=new m0(this._size);return this.getContext().getImageData(t.x,t.y,t.width,t.height)},putImageData:function(t){var i=R.read(arguments,1);this.getContext(!0).putImageData(t,i.x,i.y)},setImageData:function(t){this.setSize(t),this.getContext(!0).putImageData(t,0,0)},_getBounds:function(t,i){var u=new m0(this._size).setCenter(0,0);return t?t._transformBounds(u):u},_hitTestSelf:function(t){if(this._contains(t)){var i=this;return new f0("pixel",i,{offset:t.add(i._size.divide(2)).round(),color:{get:function(){return i.getPixel(this.offset)}}})}},_draw:function(t,i,u){var h=this.getElement();if(h&&h.width>0&&h.height>0){t.globalAlpha=t0.clamp(this._opacity,0,1),this._setStyles(t,i,u);var v=this._smoothing,f=v==="off";E0.setPrefixed(t,f?"imageSmoothingEnabled":"imageSmoothingQuality",f?!1:v),t.drawImage(h,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),u0=l0.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function t(i,u){if(!this._initialize(i,u!==N&&R.read(arguments,1)))this.setDefinition(i instanceof Z?i:new Z(i))},_equals:function(t){return this._definition===t._definition},copyContent:function(t){this.setDefinition(t._definition)},getDefinition:function(){return this._definition},setDefinition:function(t){this._definition=t,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(t,i){var u=this._definition._item;return u._getCachedBounds(u._matrix.prepended(t),i)},_hitTestSelf:function(t,i,u){var h=i.extend({all:!1}),v=this._definition._item._hitTest(t,h,u);if(v)v.item=this;return v},_draw:function(t,i){this._definition._item.draw(t,i)}}),Z=k.extend({_class:"SymbolDefinition",initialize:function t(i,u){if(this._id=P0.get(),this.project=G0.project,i)this.setItem(i,u)},_serialize:function(t,i){return i.add(this,function(){return k.serialize([this._class,this._item],t,!1,i)})},_changed:function(t){if(t&8)l0._clearBoundsCache(this);if(t&1)this.project._changed(t)},getItem:function(){return this._item},setItem:function(t,i){if(t._symbol)t=t.clone();if(this._item)this._item._symbol=null;if(this._item=t,t.remove(),t.setSelected(!1),!i)t.setPosition(new R);t._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(t){return new u0(this,t)},clone:function(){return new Z(this._item.clone(!1))},equals:function(t){return t===this||t&&this._item.equals(t._item)||!1}}),f0=k.extend({_class:"HitResult",initialize:function t(i,u,h){if(this.type=i,this.item=u,h)this.inject(h)},statics:{getOptions:function(t){var i=t&&k.read(t);return new k({type:null,tolerance:G0.settings.hitTolerance,fill:!i,stroke:!i,segments:!i,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},i)}}}),J=k.extend({_class:"Segment",beans:!0,_selection:0,initialize:function t(i,u,h,v,f,s){var x=arguments.length,g,p,d,P;if(x>0)if(i==null||typeof i==="object")if(x===1&&i&&"point"in i)g=i.point,p=i.handleIn,d=i.handleOut,P=i.selection;else g=i,p=u,d=h,P=v;else g=[i,u],p=h!==N?[h,v]:null,d=f!==N?[f,s]:null;if(new I0(g,this,"_point"),new I0(p,this,"_handleIn"),new I0(d,this,"_handleOut"),P)this.setSelection(P)},_serialize:function(t,i){var u=this._point,h=this._selection,v=h||this.hasHandles()?[u,this._handleIn,this._handleOut]:u;if(h)v.push(h);return k.serialize(v,t,!0,i)},_changed:function(t){var i=this._path;if(!i)return;var u=i._curves,h=this._index,v;if(u){if((!t||t===this._point||t===this._handleIn)&&(v=h>0?u[h-1]:i._closed?u[u.length-1]:null))v._changed();if((!t||t===this._point||t===this._handleOut)&&(v=u[h]))v._changed()}i._changed(41)},getPoint:function(){return this._point},setPoint:function(){this._point.set(R.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(R.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(R.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var t=this._handleIn,i=this._handleOut;return!t.isZero()&&!i.isZero()&&t.isCollinear(i)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(t){var i=this._selection,u=this._path;if(this._selection=t=t||0,u&&t!==i)u._updateSelection(this,i,t),u._changed(257)},_changeSelection:function(t,i){var u=this._selection;this.setSelection(i?u|t:u&~t)},isSelected:function(){return!!(this._selection&7)},setSelected:function(t){this._changeSelection(7,t)},getIndex:function(){return this._index!==N?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var t=this._path,i=this._index;if(t){if(i>0&&!t._closed&&i===t._segments.length-1)i--;return t.getCurves()[i]||null}return null},getLocation:function(){var t=this.getCurve();return t?new X0(t,this===t._segment1?0:1):null},getNext:function(){var t=this._path&&this._path._segments;return t&&(t[this._index+1]||this._path._closed&&t[0])||null},smooth:function(t,i,u){var h=t||{},v=h.type,f=h.factor,s=this.getPrevious(),x=this.getNext(),g=(s||this)._point,p=this._point,d=(x||this)._point,P=g.getDistance(p),r=p.getDistance(d);if(!v||v==="catmull-rom"){var l=f===N?0.5:f,_=Math.pow(P,l),D=_*_,B=Math.pow(r,l),j=B*B;if(!i&&s){var o=2*j+3*B*_+D,w=3*B*(B+_);this.setHandleIn(w!==0?new R((j*g._x+o*p._x-D*d._x)/w-p._x,(j*g._y+o*p._y-D*d._y)/w-p._y):new R)}if(!u&&x){var o=2*D+3*_*B+j,w=3*_*(_+B);this.setHandleOut(w!==0?new R((D*d._x+o*p._x-j*g._x)/w-p._x,(D*d._y+o*p._y-j*g._y)/w-p._y):new R)}}else if(v==="geometric"){if(s&&x){var S=g.subtract(d),C=f===N?0.4:f,G=C*P/(P+r);if(!i)this.setHandleIn(S.multiply(G));if(!u)this.setHandleOut(S.multiply(G-C))}}else throw new Error("Smoothing method \'"+v+"\' not supported.")},getPrevious:function(){var t=this._path&&this._path._segments;return t&&(t[this._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var t=this._path;return t&&this._index===t._segments.length-1||!1},reverse:function(){var t=this._handleIn,i=this._handleOut,u=t.clone();t.set(i),i.set(u)},reversed:function(){return new J(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new J(this._point,this._handleIn,this._handleOut)},equals:function(t){return t===this||t&&this._class===t._class&&this._point.equals(t._point)&&this._handleIn.equals(t._handleIn)&&this._handleOut.equals(t._handleOut)||!1},toString:function(){var t=["point: "+this._point];if(!this._handleIn.isZero())t.push("handleIn: "+this._handleIn);if(!this._handleOut.isZero())t.push("handleOut: "+this._handleOut);return"{ "+t.join(", ")+" }"},transform:function(t){this._transformCoordinates(t,new Array(6),!0),this._changed()},interpolate:function(t,i,u){var h=1-u,v=u,f=t._point,s=i._point,x=t._handleIn,g=i._handleIn,p=i._handleOut,d=t._handleOut;this._point._set(h*f._x+v*s._x,h*f._y+v*s._y,!0),this._handleIn._set(h*x._x+v*g._x,h*x._y+v*g._y,!0),this._handleOut._set(h*d._x+v*p._x,h*d._y+v*p._y,!0),this._changed()},_transformCoordinates:function(t,i,u){var h=this._point,v=!u||!this._handleIn.isZero()?this._handleIn:null,f=!u||!this._handleOut.isZero()?this._handleOut:null,s=h._x,x=h._y,g=2;if(i[0]=s,i[1]=x,v)i[g++]=v._x+s,i[g++]=v._y+x;if(f)i[g++]=f._x+s,i[g++]=f._y+x;if(t)if(t._transformCoordinates(i,i,g/2),s=i[0],x=i[1],u){if(h._x=s,h._y=x,g=2,v)v._x=i[g++]-s,v._y=i[g++]-x;if(f)f._x=i[g++]-s,f._y=i[g++]-x}else{if(!v)i[g++]=s,i[g++]=x;if(!f)i[g++]=s,i[g++]=x}return i}}),I0=R.extend({initialize:function t(i,u,h){var v,f,s;if(!i)v=f=0;else if((v=i[0])!==N)f=i[1];else{var x=i;if((v=x.x)===N)x=R.read(arguments),v=x.x;f=x.y,s=x.selected}if(this._x=v,this._y=f,this._owner=u,u[h]=this,s)this.setSelected(!0)},_set:function(t,i){return this._x=t,this._y=i,this._owner._changed(this),this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner._changed(this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner._changed(this)},isZero:function(){var t=t0.isZero;return t(this._x)&&t(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){var t=this._owner;return this===t._point?1:this===t._handleIn?2:this===t._handleOut?4:0}}),W=k.extend({_class:"Curve",beans:!0,initialize:function t(i,u,h,v,f,s,x,g){var p=arguments.length,d,P,r,l,_,D;if(p===3)this._path=i,d=u,P=h;else if(!p)d=new J,P=new J;else if(p===1){if("segment1"in i)d=new J(i.segment1),P=new J(i.segment2);else if("point1"in i)r=i.point1,_=i.handle1,D=i.handle2,l=i.point2;else if(Array.isArray(i))r=[i[0],i[1]],l=[i[6],i[7]],_=[i[2]-i[0],i[3]-i[1]],D=[i[4]-i[6],i[5]-i[7]]}else if(p===2)d=new J(i),P=new J(u);else if(p===4)r=i,_=u,D=h,l=v;else if(p===8)r=[i,u],l=[x,g],_=[h-i,v-u],D=[f-x,s-g];this._segment1=d||new J(r,null,_),this._segment2=P||new J(l,D,null)},_serialize:function(t,i){return k.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],t,!0,i)},_changed:function(){this._length=this._bounds=N},clone:function(){return new W(this._segment1,this._segment2)},toString:function(){var t=["point1: "+this._segment1._point];if(!this._segment1._handleOut.isZero())t.push("handle1: "+this._segment1._handleOut);if(!this._segment2._handleIn.isZero())t.push("handle2: "+this._segment2._handleIn);return t.push("point2: "+this._segment2._point),"{ "+t.join(", ")+" }"},classify:function(){return W.classify(this.getValues())},remove:function(){var t=!1;if(this._path){var i=this._segment2,u=i._handleOut;if(t=i.remove(),t)this._segment1._handleOut.set(u)}return t},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(R.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(R.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(R.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(R.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index+1]||this._path._closed&&t[0])||null},getPrevious:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var t=this._path;return t&&this._segment1._index===t._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(t){this.getPoint1().setSelected(t),this.getHandle1().setSelected(t),this.getHandle2().setSelected(t),this.getPoint2().setSelected(t)},getValues:function(t){return W.getValues(this._segment1,this._segment2,t)},getPoints:function(){var t=this.getValues(),i=[];for(var u=0;u<8;u+=2)i.push(new R(t[u],t[u+1]));return i}},{getLength:function(){if(this._length==null)this._length=W.getLength(this.getValues(),0,1);return this._length},getArea:function(){return W.getArea(this.getValues())},getLine:function(){return new Y0(this._segment1._point,this._segment2._point)},getPart:function(t,i){return new W(W.getPart(this.getValues(),t,i))},getPartLength:function(t,i){return W.getLength(this.getValues(),t,i)},divideAt:function(t){return this.divideAtTime(t&&t.curve===this?t.time:this.getTimeAt(t))},divideAtTime:function(t,i){var u=0.00000001,h=1-u,v=null;if(t>=u&&t<=h){var f=W.subdivide(this.getValues(),t),s=f[0],x=f[1],g=i||this.hasHandles(),p=this._segment1,d=this._segment2,P=this._path;if(g)p._handleOut._set(s[2]-s[0],s[3]-s[1]),d._handleIn._set(x[4]-x[6],x[5]-x[7]);var r=s[6],l=s[7],_=new J(new R(r,l),g&&new R(s[4]-r,s[5]-l),g&&new R(x[2]-r,x[3]-l));if(P)P.insert(p._index+1,_),v=this.getNext();else this._segment2=_,this._changed(),v=new W(_,d)}return v},splitAt:function(t){var i=this._path;return i?i.splitAt(t):null},splitAtTime:function(t){return this.splitAt(this.getLocationAtTime(t))},divide:function(t,i){return this.divideAtTime(t===N?0.5:i?t:this.getTimeAt(t))},split:function(t,i){return this.splitAtTime(t===N?0.5:i?t:this.getTimeAt(t))},reversed:function(){return new W(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(t,i,u,h){var{_point:v,_handleOut:f}=t,s=i._handleIn,x=i._point,g=v.x,p=v.y,d=x.x,P=x.y,r=h?[g,p,g,p,d,P,d,P]:[g,p,g+f._x,p+f._y,d+s._x,P+s._y,d,P];if(u)u._transformCoordinates(r,r,4);return r},subdivide:function(t,i){var u=t[0],h=t[1],v=t[2],f=t[3],s=t[4],x=t[5],g=t[6],p=t[7];if(i===N)i=0.5;var d=1-i,P=d*u+i*v,r=d*h+i*f,l=d*v+i*s,_=d*f+i*x,D=d*s+i*g,B=d*x+i*p,j=d*P+i*l,o=d*r+i*_,w=d*l+i*D,S=d*_+i*B,C=d*j+i*w,G=d*o+i*S;return[[u,h,P,r,j,o,C,G],[C,G,w,S,D,B,g,p]]},getMonoCurves:function(t,i){var u=[],h=i?0:1,v=t[h+0],f=t[h+2],s=t[h+4],x=t[h+6];if(v>=f===f>=s&&f>=s===s>=x||W.isStraight(t))u.push(t);else{var g=3*(f-s)-v+x,p=2*(v+s)-4*f,d=f-v,P=0.00000001,r=1-P,l=[],_=t0.solveQuadratic(g,p,d,l,P,r);if(!_)u.push(t);else{l.sort();var D=l[0],B=W.subdivide(t,D);if(u.push(B[0]),_>1)D=(l[1]-D)/(1-D),B=W.subdivide(B[1],D),u.push(B[0]);u.push(B[1])}}return u},solveCubic:function(t,i,u,h,v,f){var s=t[i],x=t[i+2],g=t[i+4],p=t[i+6],d=0;if(!(s<u&&p<u&&x<u&&g<u||s>u&&p>u&&x>u&&g>u)){var P=3*(x-s),r=3*(g-x)-P,l=p-s-P-r;d=t0.solveCubic(l,r,P,s-u,h,v,f)}return d},getTimeOf:function(t,i){var u=new R(t[0],t[1]),h=new R(t[6],t[7]),v=0.000000000001,f=0.0000001,s=i.isClose(u,v)?0:i.isClose(h,v)?1:null;if(s===null){var x=[i.x,i.y],g=[];for(var p=0;p<2;p++){var d=W.solveCubic(t,p,x[p],g,0,1);for(var P=0;P<d;P++){var r=g[P];if(i.isClose(W.getPoint(t,r),f))return r}}}return i.isClose(u,f)?0:i.isClose(h,f)?1:null},getNearestTime:function(t,i){if(W.isStraight(t)){var u=t[0],h=t[1],v=t[6],f=t[7],s=v-u,x=f-h,g=s*s+x*x;if(g===0)return 0;var p=((i.x-u)*s+(i.y-h)*x)/g;return p<0.000000000001?0:p>0.999999999999?1:W.getTimeOf(t,new R(u+p*s,h+p*x))}var d=100,P=Infinity,r=0;function l(B){if(B>=0&&B<=1){var j=i.getDistance(W.getPoint(t,B),!0);if(j<P)return P=j,r=B,!0}}for(var _=0;_<=d;_++)l(_/d);var D=1/(d*2);while(D>0.00000001)if(!l(r-D)&&!l(r+D))D/=2;return r},getPart:function(t,i,u){var h=i>u;if(h){var v=i;i=u,u=v}if(i>0)t=W.subdivide(t,i)[1];if(u<1)t=W.subdivide(t,(u-i)/(1-i))[0];return h?[t[6],t[7],t[4],t[5],t[2],t[3],t[0],t[1]]:t},isFlatEnough:function(t,i){var u=t[0],h=t[1],v=t[2],f=t[3],s=t[4],x=t[5],g=t[6],p=t[7],d=3*v-2*u-g,P=3*f-2*h-p,r=3*s-2*g-u,l=3*x-2*p-h;return Math.max(d*d,r*r)+Math.max(P*P,l*l)<=16*i*i},getArea:function(t){var i=t[0],u=t[1],h=t[2],v=t[3],f=t[4],s=t[5],x=t[6],g=t[7];return 3*((g-u)*(h+f)-(x-i)*(v+s)+v*(i-f)-h*(u-s)+g*(f+i/3)-x*(s+u/3))/20},getBounds:function(t){var i=t.slice(0,2),u=i.slice(),h=[0,0];for(var v=0;v<2;v++)W._addBounds(t[v],t[v+2],t[v+4],t[v+6],v,0,i,u,h);return new m0(i[0],i[1],u[0]-i[0],u[1]-i[1])},_addBounds:function(t,i,u,h,v,f,s,x,g){function p(C,G){var L=C-G,c=C+G;if(L<s[v])s[v]=L;if(c>x[v])x[v]=c}f/=2;var d=s[v]+f,P=x[v]-f;if(t<d||i<d||u<d||h<d||t>P||i>P||u>P||h>P)if(i<t!=i<h&&u<t!=u<h)p(t,0),p(h,0);else{var r=3*(i-u)-t+h,l=2*(t+u)-4*i,_=i-t,D=t0.solveQuadratic(r,l,_,g),B=0.00000001,j=1-B;p(h,0);for(var o=0;o<D;o++){var w=g[o],S=1-w;if(B<=w&&w<=j)p(S*S*S*t+3*S*S*w*i+3*S*w*w*u+w*w*w*h,f)}}}}},k.each(["getBounds","getStrokeBounds","getHandleBounds"],function(t){this[t]=function(){if(!this._bounds)this._bounds={};var i=this._bounds[t];if(!i)i=this._bounds[t]=d0[t]([this._segment1,this._segment2],!1,this._path);return i.clone()}},{}),k.each({isStraight:function(t,i,u,h){if(i.isZero()&&u.isZero())return!0;else{var v=h.subtract(t);if(v.isZero())return!1;else if(v.isCollinear(i)&&v.isCollinear(u)){var f=new Y0(t,h),s=0.0000001;if(f.getDistance(t.add(i))<s&&f.getDistance(h.add(u))<s){var x=v.dot(v),g=v.dot(i)/x,p=v.dot(u)/x;return g>=0&&g<=1&&p<=0&&p>=-1}}}return!1},isLinear:function(t,i,u,h){var v=h.subtract(t).divide(3);return i.equals(v)&&u.negate().equals(v)}},function(t,i){this[i]=function(u){var h=this._segment1,v=this._segment2;return t(h._point,h._handleOut,v._handleIn,v._point,u)},this.statics[i]=function(u,h){var v=u[0],f=u[1],s=u[6],x=u[7];return t(new R(v,f),new R(u[2]-v,u[3]-f),new R(u[4]-s,u[5]-x),new R(s,x),h)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(t){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(t||0)},isCollinear:function(t){return t&&this.isStraight()&&t.isStraight()&&this.getLine().isCollinear(t.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(0.5).y)<0.00000001},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(0.5).x)<0.00000001}}),{beans:!1,getLocationAt:function(t,i){return this.getLocationAtTime(i?t:this.getTimeAt(t))},getLocationAtTime:function(t){return t!=null&&t>=0&&t<=1?new X0(this,t):null},getTimeAt:function(t,i){return W.getTimeAt(this.getValues(),t,i)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var t=R.read(arguments);return t.isZero()?[]:W.getTimesWithTangent(this.getValues(),t)},getOffsetAtTime:function(t){return this.getPartLength(0,t)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(R.read(arguments)))},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getTimeOf:function(){return W.getTimeOf(this.getValues(),R.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var t=R.read(arguments),i=this.getValues(),u=W.getNearestTime(i,t),h=W.getPoint(i,u);return new X0(this,u,h,null,t.getDistance(h))},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t?t.getPoint():t}},new function(){var t=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return k.each(t,function(i){this[i+"At"]=function(u,h){var v=this.getValues();return W[i](v,h?u:W.getTimeAt(v,u))},this[i+"AtTime"]=function(u){return W[i](this.getValues(),u)}},{statics:{_evaluateMethods:t}})},new function(){function t(h){var v=h[0],f=h[1],s=h[2],x=h[3],g=h[4],p=h[5],d=h[6],P=h[7],r=9*(s-g)+3*(d-v),l=6*(v+g)-12*s,_=3*(s-v),D=9*(x-p)+3*(P-f),B=6*(f+p)-12*x,j=3*(x-f);return function(o){var w=(r*o+l)*o+_,S=(D*o+B)*o+j;return Math.sqrt(w*w+S*S)}}function i(h,v){return Math.max(2,Math.min(16,Math.ceil(Math.abs(v-h)*32)))}function u(h,v,f,s){if(v==null||v<0||v>1)return null;var x=h[0],g=h[1],p=h[2],d=h[3],P=h[4],r=h[5],l=h[6],_=h[7],D=t0.isZero;if(D(p-x)&&D(d-g))p=x,d=g;if(D(P-l)&&D(r-_))P=l,r=_;var B=3*(p-x),j=3*(P-p)-B,o=l-x-B-j,w=3*(d-g),S=3*(r-d)-w,C=_-g-w-S,G,L;if(f===0)G=v===0?x:v===1?l:((o*v+j)*v+B)*v+x,L=v===0?g:v===1?_:((C*v+S)*v+w)*v+g;else{var c=0.00000001,E=1-c;if(v<c)G=B,L=w;else if(v>E)G=3*(l-P),L=3*(_-r);else G=(3*o*v+2*j)*v+B,L=(3*C*v+2*S)*v+w;if(s){if(G===0&&L===0&&(v<c||v>E))G=P-p,L=r-d;var M=Math.sqrt(G*G+L*L);if(M)G/=M,L/=M}if(f===3){var P=6*o*v+2*j,r=6*C*v+2*S,a=Math.pow(G*G+L*L,1.5);G=a!==0?(G*r-L*P)/a:0,L=0}}return f===2?new R(L,-G):new R(G,L)}return{statics:{classify:function(h){var v=h[0],f=h[1],s=h[2],x=h[3],g=h[4],p=h[5],d=h[6],P=h[7],r=v*(P-p)+f*(g-d)+d*p-P*g,l=s*(f-P)+x*(d-v)+v*P-f*d,_=g*(x-f)+p*(v-s)+s*f-x*v,D=3*_,B=D-l,j=B-l+r,o=Math.sqrt(j*j+B*B+D*D),w=o!==0?1/o:0,S=t0.isZero,C="serpentine";j*=w,B*=w,D*=w;function G(M,a,q){var z=a!==N,O=z&&a>0&&a<1,A=z&&q>0&&q<1;if(z&&(!(O||A)||M==="loop"&&!(O&&A)))M="arch",O=A=!1;return{type:M,roots:O||A?O&&A?a<q?[a,q]:[q,a]:[O?a:q]:null}}if(S(j))return S(B)?G(S(D)?"line":"quadratic"):G(C,D/(3*B));var L=3*B*B-4*j*D;if(S(L))return G("cusp",B/(2*j));var c=L>0?Math.sqrt(L/3):Math.sqrt(-L),E=2*j;return G(L>0?C:"loop",(B+c)/E,(B-c)/E)},getLength:function(h,v,f,s){if(v===N)v=0;if(f===N)f=1;if(W.isStraight(h)){var x=h;if(f<1)x=W.subdivide(x,f)[0],v/=f;if(v>0)x=W.subdivide(x,v)[1];var g=x[6]-x[0],p=x[7]-x[1];return Math.sqrt(g*g+p*p)}return t0.integrate(s||t(h),v,f,i(v,f))},getTimeAt:function(h,v,f){if(f===N)f=v<0?1:0;if(v===0)return f;var s=Math.abs,x=0.000000000001,g=v>0,p=g?f:0,d=g?1:f,P=t(h),r=W.getLength(h,p,d,P),l=s(v)-r;if(s(l)<x)return g?d:p;else if(l>x)return null;var _=v/r,D=0;function B(j){return D+=t0.integrate(P,f,j,i(f,j)),f=j,D-v}return t0.findRoot(B,P,f+_,p,d,32,0.000000000001)},getPoint:function(h,v){return u(h,v,0,!1)},getTangent:function(h,v){return u(h,v,1,!0)},getWeightedTangent:function(h,v){return u(h,v,1,!1)},getNormal:function(h,v){return u(h,v,2,!0)},getWeightedNormal:function(h,v){return u(h,v,2,!1)},getCurvature:function(h,v){return u(h,v,3,!1).x},getPeaks:function(h){var v=h[0],f=h[1],s=h[2],x=h[3],g=h[4],p=h[5],d=h[6],P=h[7],r=-v+3*s-3*g+d,l=3*v-6*s+3*g,_=-3*v+3*s,D=-f+3*x-3*p+P,B=3*f-6*x+3*p,j=-3*f+3*x,o=0.00000001,w=1-o,S=[];return t0.solveCubic(9*(r*r+D*D),9*(r*l+B*D),2*(l*l+B*B)+3*(_*r+j*D),_*l+B*j,S,o,w),S.sort()}}}},new function(){function t(l,_,D,B,j,o,w){var S=!w&&D.getPrevious()===j,C=!w&&D!==j&&D.getNext()===j,G=0.00000001,L=1-G;if(B!==null&&B>=(S?G:0)&&B<=(C?L:1)){if(o!==null&&o>=(C?G:0)&&o<=(S?L:1)){var c=new X0(D,B,null,w),E=new X0(j,o,null,w);if(c._intersection=E,E._intersection=c,!_||_(c))X0.insert(l,c,!0)}}}function i(l,_,D,B,j,o,w,S,C,G,L,c,E){if(++C>=4096||++S>=40)return C;var M=0.000000001,a=_[0],q=_[1],z=_[6],O=_[7],A=Y0.getSignedDistance,X=A(a,q,z,O,_[2],_[3]),e=A(a,q,z,O,_[4],_[5]),K=X*e>0?0.75:0.4444444444444444,Q=K*Math.min(0,X,e),h0=K*Math.max(0,X,e),p0=A(a,q,z,O,l[0],l[1]),s0=A(a,q,z,O,l[2],l[3]),b0=A(a,q,z,O,l[4],l[5]),v0=A(a,q,z,O,l[6],l[7]),_0=u(p0,s0,b0,v0),g0=_0[0],V0=_0[1],j0,k0;if(X===0&&e===0&&p0===0&&s0===0&&b0===0&&v0===0||(j0=h(g0,V0,Q,h0))==null||(k0=h(g0.reverse(),V0.reverse(),Q,h0))==null)return C;var L0=G+(L-G)*j0,D0=G+(L-G)*k0;if(Math.max(E-c,D0-L0)<M){var u6=(L0+D0)/2,h6=(c+E)/2;t(j,o,w?B:D,w?h6:u6,w?D:B,w?u6:h6)}else{l=W.getPart(l,j0,k0);var s6=E-c;if(k0-j0>0.8)if(D0-L0>s6){var Q0=W.subdivide(l,0.5),u6=(L0+D0)/2;C=i(_,Q0[0],B,D,j,o,!w,S,C,c,E,L0,u6),C=i(_,Q0[1],B,D,j,o,!w,S,C,c,E,u6,D0)}else{var Q0=W.subdivide(_,0.5),h6=(c+E)/2;C=i(Q0[0],l,B,D,j,o,!w,S,C,c,h6,L0,D0),C=i(Q0[1],l,B,D,j,o,!w,S,C,h6,E,L0,D0)}else if(s6===0||s6>=M)C=i(_,l,B,D,j,o,!w,S,C,c,E,L0,D0);else C=i(l,_,D,B,j,o,w,S,C,L0,D0,c,E)}return C}function u(l,_,D,B){var j=[0,l],o=[0.3333333333333333,_],w=[0.6666666666666666,D],S=[1,B],C=_-(2*l+B)/3,G=D-(l+2*B)/3,L;if(C*G<0)L=[[j,o,S],[j,w,S]];else{var c=C/G;L=[c>=2?[j,o,S]:c<=0.5?[j,w,S]:[j,o,w,S],[j,S]]}return(C||G)<0?L.reverse():L}function h(l,_,D,B){if(l[0][1]<D)return v(l,!0,D);else if(_[0][1]>B)return v(_,!1,B);else return l[0][0]}function v(l,_,D){var B=l[0][0],j=l[0][1];for(var o=1,w=l.length;o<w;o++){var S=l[o][0],C=l[o][1];if(_?C>=D:C<=D)return C===D?S:B+(D-j)*(S-B)/(C-j);B=S,j=C}return null}function f(l,_,D,B,j){var o=t0.isZero;if(o(B)&&o(j)){var w=W.getTimeOf(l,new R(_,D));return w===null?[]:[w]}var S=Math.atan2(-j,B),C=Math.sin(S),G=Math.cos(S),L=[],c=[];for(var E=0;E<8;E+=2){var M=l[E]-_,a=l[E+1]-D;L.push(M*G-a*C,M*C+a*G)}return W.solveCubic(L,1,0,c,0,1),c}function s(l,_,D,B,j,o,w){var S=_[0],C=_[1],G=_[6],L=_[7],c=f(l,S,C,G-S,L-C);for(var E=0,M=c.length;E<M;E++){var a=c[E],q=W.getPoint(l,a),z=W.getTimeOf(_,q);if(z!==null)t(j,o,w?B:D,w?z:a,w?D:B,w?a:z)}}function x(l,_,D,B,j,o){var w=Y0.intersect(l[0],l[1],l[6],l[7],_[0],_[1],_[6],_[7]);if(w)t(j,o,D,W.getTimeOf(l,w),B,W.getTimeOf(_,w))}function g(l,_,D,B,j,o){var w=0.000000000001,S=Math.min,C=Math.max;if(C(l[0],l[2],l[4],l[6])+w>S(_[0],_[2],_[4],_[6])&&S(l[0],l[2],l[4],l[6])-w<C(_[0],_[2],_[4],_[6])&&C(l[1],l[3],l[5],l[7])+w>S(_[1],_[3],_[5],_[7])&&S(l[1],l[3],l[5],l[7])-w<C(_[1],_[3],_[5],_[7])){var G=P(l,_);if(G)for(var L=0;L<2;L++){var c=G[L];t(j,o,D,c[0],B,c[1],!0)}else{var E=W.isStraight(l),M=W.isStraight(_),a=E&&M,q=E&&!M,z=j.length;if((a?x:E||M?s:i)(q?_:l,q?l:_,q?B:D,q?D:B,j,o,q,0,0,0,1,0,1),!a||j.length===z)for(var L=0;L<4;L++){var O=L>>1,A=L&1,X=O*6,e=A*6,K=new R(l[X],l[X+1]),Q=new R(_[e],_[e+1]);if(K.isClose(Q,w))t(j,o,D,O,B,A)}}}return j}function p(l,_,D,B){var j=W.classify(l);if(j.type==="loop"){var o=j.roots;t(D,B,_,o[0],_,o[1])}return D}function d(l,_,D,B,j,o){var w=0.0000001,S=!_;if(S)_=l;var C=l.length,G=_.length,L=new Array(C),c=S?L:new Array(G),E=[];for(var M=0;M<C;M++)L[M]=l[M].getValues(B);if(!S)for(var M=0;M<G;M++)c[M]=_[M].getValues(j);var a=x0.findCurveBoundsCollisions(L,c,w);for(var q=0;q<C;q++){var z=l[q],O=L[q];if(S)p(O,z,E,D);var A=a[q];if(A)for(var X=0;X<A.length;X++){if(o&&E.length)return E;var e=A[X];if(!S||e>q){var K=_[e],Q=c[e];g(O,Q,z,K,E,D)}}}return E}function P(l,_){function D(v0){var _0=v0[6]-v0[0],g0=v0[7]-v0[1];return _0*_0+g0*g0}var B=Math.abs,j=Y0.getDistance,o=0.00000001,w=0.0000001,S=W.isStraight(l),C=W.isStraight(_),G=S&&C,L=D(l)<D(_),c=L?_:l,E=L?l:_,M=c[0],a=c[1],q=c[6]-M,z=c[7]-a;if(j(M,a,q,z,E[0],E[1],!0)<w&&j(M,a,q,z,E[6],E[7],!0)<w){if(!G&&j(M,a,q,z,c[2],c[3],!0)<w&&j(M,a,q,z,c[4],c[5],!0)<w&&j(M,a,q,z,E[2],E[3],!0)<w&&j(M,a,q,z,E[4],E[5],!0)<w)S=C=G=!0}else if(G)return null;if(S^C)return null;var O=[l,_],A=[];for(var X=0;X<4&&A.length<2;X++){var e=X&1,K=e^1,Q=X>>1,h0=W.getTimeOf(O[e],new R(O[K][Q?6:0],O[K][Q?7:1]));if(h0!=null){var p0=e?[Q,h0]:[h0,Q];if(!A.length||B(p0[0]-A[0][0])>o&&B(p0[1]-A[0][1])>o)A.push(p0)}if(X>2&&!A.length)break}if(A.length!==2)A=null;else if(!G){var s0=W.getPart(l,A[0][0],A[1][0]),b0=W.getPart(_,A[0][1],A[1][1]);if(B(b0[2]-s0[2])>w||B(b0[3]-s0[3])>w||B(b0[4]-s0[4])>w||B(b0[5]-s0[5])>w)A=null}return A}function r(l,_){var D=l[0],B=l[1],j=l[2],o=l[3],w=l[4],S=l[5],C=l[6],G=l[7],L=_.normalize(),c=L.x,E=L.y,M=3*C-9*w+9*j-3*D,a=3*G-9*S+9*o-3*B,q=6*w-12*j+6*D,z=6*S-12*o+6*B,O=3*j-3*D,A=3*o-3*B,X=2*M*E-2*a*c,e=[];if(Math.abs(X)<t0.CURVETIME_EPSILON){var K=M*A-a*O,X=M*z-a*q;if(X!=0){var Q=-K/X;if(Q>=0&&Q<=1)e.push(Q)}}else{var h0=(q*q-4*M*O)*E*E+(-2*q*z+4*a*O+4*M*A)*c*E+(z*z-4*a*A)*c*c,p0=q*E-z*c;if(h0>=0&&X!=0){var s0=Math.sqrt(h0),b0=-(p0+s0)/X,v0=(-p0+s0)/X;if(b0>=0&&b0<=1)e.push(b0);if(v0>=0&&v0<=1)e.push(v0)}}return e}return{getIntersections:function(l){var _=this.getValues(),D=l&&l!==this&&l.getValues();return D?g(_,D,this,l,[]):p(_,this,[])},statics:{getOverlaps:P,getIntersections:d,getCurveLineIntersections:f,getTimesWithTangent:r}}}),X0=k.extend({_class:"CurveLocation",initialize:function t(i,u,h,v,f){if(u>=0.99999999){var s=i.getNext();if(s)u=0,i=s}this._setCurve(i),this._time=u,this._point=h||i.getPointAtTime(u),this._overlap=v,this._distance=f,this._intersection=this._next=this._previous=null},_setPath:function(t){this._path=t,this._version=t?t._version:0},_setCurve:function(t){this._setPath(t._path),this._curve=t,this._segment=null,this._segment1=t._segment1,this._segment2=t._segment2},_setSegment:function(t){var i=t.getCurve();if(i)this._setCurve(i);else this._setPath(t._path),this._segment1=t,this._segment2=null;this._segment=t,this._time=t===this._segment1?0:1,this._point=t._point.clone()},getSegment:function(){var t=this._segment;if(!t){var i=this.getCurve(),u=this.getTime();if(u===0)t=i._segment1;else if(u===1)t=i._segment2;else if(u!=null)t=i.getPartLength(0,u)<i.getPartLength(u,1)?i._segment1:i._segment2;this._segment=t}return t},getCurve:function(){var t=this._path,i=this;if(t&&t._version!==this._version)this._time=this._offset=this._curveOffset=this._curve=null;function u(h){var v=h&&h.getCurve();if(v&&(i._time=v.getTimeOf(i._point))!=null)return i._setCurve(v),v}return this._curve||u(this._segment)||u(this._segment1)||u(this._segment2.getPrevious())},getPath:function(){var t=this.getCurve();return t&&t._path},getIndex:function(){var t=this.getCurve();return t&&t.getIndex()},getTime:function(){var t=this.getCurve(),i=this._time;return t&&i==null?this._time=t.getTimeOf(this._point):i},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var t=this._offset;if(t==null){t=0;var i=this.getPath(),u=this.getIndex();if(i&&u!=null){var h=i.getCurves();for(var v=0;v<u;v++)t+=h[v].getLength()}this._offset=t+=this.getCurveOffset()}return t},getCurveOffset:function(){var t=this._curveOffset;if(t==null){var i=this.getCurve(),u=this.getTime();this._curveOffset=t=u!=null&&i&&i.getPartLength(0,u)}return t},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var t=this.getCurve(),i=t&&t.divideAtTime(this.getTime());if(i)this._setSegment(i._segment1);return i},split:function(){var t=this.getCurve(),i=t._path,u=t&&t.splitAtTime(this.getTime());if(u)this._setSegment(i.getLastSegment());return u},equals:function(t,i){var u=this===t;if(!u&&t instanceof X0){var h=this.getCurve(),v=t.getCurve(),f=h._path,s=v._path;if(f===s){var x=Math.abs,g=0.0000001,p=x(this.getOffset()-t.getOffset()),d=!i&&this._intersection,P=!i&&t._intersection;u=(p<g||f&&x(f.getLength()-p)<g)&&(!d&&!P||d&&P&&d.equals(P,!0))}}return u},toString:function(){var t=[],i=this.getPoint(),u=y0.instance;if(i)t.push("point: "+i);var h=this.getIndex();if(h!=null)t.push("index: "+h);var v=this.getTime();if(v!=null)t.push("time: "+u.number(v));if(this._distance!=null)t.push("distance: "+u.number(this._distance));return"{ "+t.join(", ")+" }"},isTouching:function(){var t=this._intersection;if(t&&this.getTangent().isCollinear(t.getTangent())){var i=this.getCurve(),u=t.getCurve();return!(i.isStraight()&&u.isStraight()&&i.getLine().intersect(u.getLine()))}return!1},isCrossing:function(){var t=this._intersection;if(!t)return!1;var i=this.getTime(),u=t.getTime(),h=0.00000001,v=1-h,f=i>=h&&i<=v,s=u>=h&&u<=v;if(f&&s)return!this.isTouching();var x=this.getCurve(),g=x&&i<h?x.getPrevious():x,p=t.getCurve(),d=p&&u<h?p.getPrevious():p;if(i>v)x=x.getNext();if(u>v)p=p.getNext();if(!g||!x||!d||!p)return!1;var P=[];function r(c,E){var M=c.getValues(),a=W.classify(M).roots||W.getPeaks(M),q=a.length,z=W.getLength(M,E&&q?a[q-1]:0,!E&&q?a[0]:1);P.push(q?z:z/32)}function l(c,E,M){return E<M?c>E&&c<M:c>E||c<M}if(!f)r(g,!0),r(x,!1);if(!s)r(d,!0),r(p,!1);var _=this.getPoint(),D=Math.min.apply(Math,P),B=f?x.getTangentAtTime(i):x.getPointAt(D).subtract(_),j=f?B.negate():g.getPointAt(-D).subtract(_),o=s?p.getTangentAtTime(u):p.getPointAt(D).subtract(_),w=s?o.negate():d.getPointAt(-D).subtract(_),S=j.getAngle(),C=B.getAngle(),G=w.getAngle(),L=o.getAngle();return!!(f?l(S,G,L)^l(C,G,L)&&l(S,L,G)^l(C,L,G):l(G,S,C)^l(L,S,C)&&l(G,C,S)^l(L,C,S))},hasOverlap:function(){return!!this._overlap}},k.each(W._evaluateMethods,function(t){var i=t+"At";this[t]=function(){var u=this.getCurve(),h=this.getTime();return h!=null&&u&&u[i](h,!0)}},{preserve:!0}),new function(){function t(i,u,h){var v=i.length,f=0,s=v-1;function x(_,D){for(var B=_+D;B>=-1&&B<=v;B+=D){var j=i[(B%v+v)%v];if(!u.getPoint().isClose(j.getPoint(),0.0000001))break;if(u.equals(j))return j}return null}while(f<=s){var g=f+s>>>1,p=i[g],d;if(h&&(d=u.equals(p)?p:x(g,-1)||x(g,1))){if(u._overlap)d._overlap=d._intersection._overlap=!0;return d}var P=u.getPath(),r=p.getPath(),l=P!==r?P._id-r._id:u.getIndex()+u.getTime()-(p.getIndex()+p.getTime());if(l<0)s=g-1;else f=g+1}return i.splice(f,0,u),u}return{statics:{insert:t,expand:function(i){var u=i.slice();for(var h=i.length-1;h>=0;h--)t(u,i[h]._intersection,!1);return u}}}}),t6=l0.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function t(){},statics:{create:function(t){var i,u,h;if(k.isPlainObject(t))u=t.segments,i=t.pathData;else if(Array.isArray(t))u=t;else if(typeof t==="string")i=t;if(u){var v=u[0];h=v&&Array.isArray(v[0])}else if(i)h=(i.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(i);var f=h?T0:d0;return new f(t)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(t){if(this.isClockwise()!=(t=!!t))this.reverse()},setPathData:function(t){var i=t&&t.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),u,h=!1,v,f,s=new R,x=new R;function g(w,S){var C=+u[w];if(h)C+=s[S];return C}function p(w){return new R(g(w,"x"),g(w+1,"y"))}this.clear();for(var d=0,P=i&&i.length;d<P;d++){var r=i[d],l=r[0],_=l.toLowerCase();u=r.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var D=u&&u.length;if(h=l===_,v==="z"&&!/[mz]/.test(_))this.moveTo(s);switch(_){case"m":case"l":var B=_==="m";for(var j=0;j<D;j+=2)if(this[B?"moveTo":"lineTo"](s=p(j)),B)x=s,B=!1;f=s;break;case"h":case"v":var o=_==="h"?"x":"y";s=s.clone();for(var j=0;j<D;j++)s[o]=g(j,o),this.lineTo(s);f=s;break;case"c":for(var j=0;j<D;j+=6)this.cubicCurveTo(p(j),f=p(j+2),s=p(j+4));break;case"s":for(var j=0;j<D;j+=4)this.cubicCurveTo(/[cs]/.test(v)?s.multiply(2).subtract(f):s,f=p(j),s=p(j+2)),v=_;break;case"q":for(var j=0;j<D;j+=4)this.quadraticCurveTo(f=p(j),s=p(j+2));break;case"t":for(var j=0;j<D;j+=2)this.quadraticCurveTo(f=/[qt]/.test(v)?s.multiply(2).subtract(f):s,s=p(j)),v=_;break;case"a":for(var j=0;j<D;j+=7)this.arcTo(s=p(j+5),new i0(+u[j],+u[j+1]),+u[j+2],+u[j+4],+u[j+3]);break;case"z":this.closePath(0.000000000001),s=x;break}v=_}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(t){var i=t.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(t):{};return i.onPath||!!(this.getFillRule()==="evenodd"?i.windingL&1||i.windingR&1:i.winding)},getIntersections:function(t,i,u,h){var v=this===t||!t,f=this._matrix._orNullIfIdentity(),s=v?f:(u||t._matrix)._orNullIfIdentity();return v||this.getBounds(f).intersects(t.getBounds(s),0.000000000001)?W.getIntersections(this.getCurves(),!v&&t.getCurves(),i,f,s,h):[]},getCrossings:function(t){return this.getIntersections(t,function(i){return i.isCrossing()})},getNearestLocation:function(){var t=R.read(arguments),i=this.getCurves(),u=Infinity,h=null;for(var v=0,f=i.length;v<f;v++){var s=i[v].getNearestLocation(t);if(s._distance<u)u=s._distance,h=s}return h},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t?t.getPoint():t},interpolate:function(t,i,u){var h=!this._children,v=h?"_segments":"_children",f=t[v],s=i[v],x=this[v];if(!f||!s||f.length!==s.length)throw new Error("Invalid operands in interpolate() call: "+t+", "+i);var g=x.length,p=s.length;if(g<p){var d=h?J:d0;for(var P=g;P<p;P++)this.add(new d)}else if(g>p)this[h?"removeSegments":"removeChildren"](p,g);for(var P=0;P<p;P++)x[P].interpolate(f[P],s[P],u);if(h)this.setClosed(t._closed),this._changed(9)},compare:function(t){var i=!1;if(t){var u=this._children||[this],h=t._children?t._children.slice():[t],v=u.length,f=h.length,s=[],x=0;i=!0;var g=x0.findItemBoundsCollisions(u,h,t0.GEOMETRIC_EPSILON);for(var p=v-1;p>=0&&i;p--){var d=u[p];i=!1;var P=g[p];if(P){for(var r=P.length-1;r>=0&&!i;r--)if(d.compare(h[P[r]])){if(!s[P[r]])s[P[r]]=!0,x++;i=!0}}}i=i&&x===f}return i}}),d0=t6.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function t(i){this._closed=!1,this._segments=[],this._version=0;var u=arguments,h=Array.isArray(i)?typeof i[0]==="object"?i:u:i&&(i.size===N&&(i.x!==N||i.point!==N))?u:null;if(h&&h.length>0)this.setSegments(h);else if(this._curves=N,this._segmentSelection=0,!h&&typeof i==="string")this.setPathData(i),i=null;this._initialize(!h&&i)},_equals:function(t){return this._closed===t._closed&&k.equals(this._segments,t._segments)},copyContent:function(t){this.setSegments(t._segments),this._closed=t._closed},_changed:function t(i){if(t.base.call(this,i),i&8){if(this._length=this._area=N,i&32)this._version++;else if(this._curves)for(var u=0,h=this._curves.length;u<h;u++)this._curves[u]._changed()}else if(i&64)this._bounds=N},getStyle:function(){var t=this._parent;return(t instanceof T0?t:this)._style},getSegments:function(){return this._segments},setSegments:function(t){var i=this.isFullySelected(),u=t&&t.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=N,u){var h=t[u-1];if(typeof h==="boolean")this.setClosed(h),u--;this._add(J.readList(t,0,{},u))}if(i)this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var t=this._curves,i=this._segments;if(!t){var u=this._countCurves();t=this._curves=new Array(u);for(var h=0;h<u;h++)t[h]=new W(this,i[h],i[h+1]||i[0])}return t},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var t=this.getCurves();return t[t.length-1]},isClosed:function(){return this._closed},setClosed:function(t){if(this._closed!=(t=!!t)){if(this._closed=t,this._curves){var i=this._curves.length=this._countCurves();if(t)this._curves[i-1]=new W(this,this._segments[i-1],this._segments[0])}this._changed(41)}}},{beans:!0,getPathData:function(t,i){var u=this._segments,h=u.length,v=new y0(i),f=new Array(6),s=!0,x,g,p,d,P,r,l,_,D=[];function B(o,w){if(o._transformCoordinates(t,f),x=f[0],g=f[1],s)D.push("M"+v.pair(x,g)),s=!1;else if(P=f[2],r=f[3],P===x&&r===g&&l===p&&_===d){if(!w){var S=x-p,C=g-d;D.push(S===0?"v"+v.number(C):C===0?"h"+v.number(S):"l"+v.pair(S,C))}}else D.push("c"+v.pair(l-p,_-d)+" "+v.pair(P-p,r-d)+" "+v.pair(x-p,g-d));p=x,d=g,l=f[4],_=f[5]}if(!h)return"";for(var j=0;j<h;j++)B(u[j]);if(this._closed&&h>0)B(u[0],!0),D.push("z");return D.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(t){var i=this._segments,u=new Array(6);for(var h=0,v=i.length;h<v;h++)i[h]._transformCoordinates(t,u,!0);return!0},_add:function(t,s){var u=this._segments,h=this._curves,v=t.length,f=s==null,s=f?u.length:s;for(var x=0;x<v;x++){var g=t[x];if(g._path)g=t[x]=g.clone();if(g._path=this,g._index=s+x,g._selection)this._updateSelection(g,0,g._selection)}if(f)k.push(u,t);else{u.splice.apply(u,[s,0].concat(t));for(var x=s+v,p=u.length;x<p;x++)u[x]._index=x}if(h){var d=this._countCurves(),P=s>0&&s+v-1===d?s-1:s,r=P,l=Math.min(P+v,d);if(t._curves)h.splice.apply(h,[P,0].concat(t._curves)),r+=t._curves.length;for(var x=r;x<l;x++)h.splice(x,0,new W(this,null,null));this._adjustCurves(P,l)}return this._changed(41),t},_adjustCurves:function(t,i){var u=this._segments,h=this._curves,v;for(var f=t;f<i;f++)v=h[f],v._path=this,v._segment1=u[f],v._segment2=u[f+1]||u[0],v._changed();if(v=h[this._closed&&!t?u.length-1:t-1])v._segment2=u[t]||u[0],v._changed();if(v=h[i])v._segment1=u[i],v._changed()},_countCurves:function(){var t=this._segments.length;return!this._closed&&t>0?t-1:t},add:function(t){var i=arguments;return i.length>1&&typeof t!=="number"?this._add(J.readList(i)):this._add([J.read(i)])[0]},insert:function(t,i){var u=arguments;return u.length>2&&typeof i!=="number"?this._add(J.readList(u,1),t):this._add([J.read(u,1)],t)[0]},addSegment:function(){return this._add([J.read(arguments)])[0]},insertSegment:function(t){return this._add([J.read(arguments,1)],t)[0]},addSegments:function(t){return this._add(J.readList(t))},insertSegments:function(t,i){return this._add(J.readList(i),t)},removeSegment:function(t){return this.removeSegments(t,t+1)[0]||null},removeSegments:function(t,i,u){t=t||0,i=k.pick(i,this._segments.length);var h=this._segments,v=this._curves,f=h.length,s=h.splice(t,i-t),x=s.length;if(!x)return s;for(var g=0;g<x;g++){var p=s[g];if(p._selection)this._updateSelection(p,p._selection,0);p._index=p._path=null}for(var g=t,d=h.length;g<d;g++)h[g]._index=g;if(v){var P=t>0&&i===f+(this._closed?1:0)?t-1:t,v=v.splice(P,x);for(var g=v.length-1;g>=0;g--)v[g]._path=null;if(u)s._curves=v.slice(1);this._adjustCurves(P,P)}return this._changed(41),s},clear:"#removeSegments",hasHandles:function(){var t=this._segments;for(var i=0,u=t.length;i<u;i++)if(t[i].hasHandles())return!0;return!1},clearHandles:function(){var t=this._segments;for(var i=0,u=t.length;i<u;i++)t[i].clearHandles()},getLength:function(){if(this._length==null){var t=this.getCurves(),i=0;for(var u=0,h=t.length;u<h;u++)i+=t[u].getLength();this._length=i}return this._length},getArea:function(){var t=this._area;if(t==null){var i=this._segments,u=this._closed;t=0;for(var h=0,v=i.length;h<v;h++){var f=h+1===v;t+=W.getArea(W.getValues(i[h],i[f?0:h+1],null,f&&!u))}this._area=t}return t},isFullySelected:function(){var t=this._segments.length;return this.isSelected()&&t>0&&this._segmentSelection===t*7},setFullySelected:function(t){if(t)this._selectSegments(!0);this.setSelected(t)},setSelection:function t(i){if(!(i&1))this._selectSegments(!1);t.base.call(this,i)},_selectSegments:function(t){var i=this._segments,u=i.length,h=t?7:0;this._segmentSelection=h*u;for(var v=0;v<u;v++)i[v]._selection=h},_updateSelection:function(t,i,u){t._selection=u;var h=this._segmentSelection+=u-i;if(h>0)this.setSelected(!0)},divideAt:function(t){var i=this.getLocationAt(t),u;return i&&(u=i.getCurve().divideAt(i.getCurveOffset()))?u._segment1:null},splitAt:function(t){var i=this.getLocationAt(t),u=i&&i.index,h=i&&i.time,v=0.00000001,f=1-v;if(h>f)u++,h=0;var s=this.getCurves();if(u>=0&&u<s.length){if(h>=v)s[u++].divideAtTime(h);var x=this.removeSegments(u,this._segments.length,!0),g;if(this._closed)this.setClosed(!1),g=this;else g=new d0(l0.NO_INSERT),g.insertAbove(this),g.copyAttributes(this);return g._add(x,0),this.addSegment(x[0]),g}return null},split:function(t,i){var u,h=i===N?t:(u=this.getCurves()[t])&&u.getLocationAtTime(i);return h!=null?this.splitAt(h):null},join:function(t,i){var u=i||0;if(t&&t!==this){var h=t._segments,v=this.getLastSegment(),f=t.getLastSegment();if(!f)return this;if(v&&v._point.isClose(f._point,u))t.reverse();var s=t.getFirstSegment();if(v&&v._point.isClose(s._point,u))v.setHandleOut(s._handleOut),this._add(h.slice(1));else{var x=this.getFirstSegment();if(x&&x._point.isClose(s._point,u))t.reverse();if(f=t.getLastSegment(),x&&x._point.isClose(f._point,u))x.setHandleIn(f._handleIn),this._add(h.slice(0,h.length-1),0);else this._add(h.slice())}if(t._closed)this._add([h[0]]);t.remove()}var g=this.getFirstSegment(),p=this.getLastSegment();if(g!==p&&g._point.isClose(p._point,u))g.setHandleIn(p._handleIn),p.remove(),this.setClosed(!0);return this},reduce:function(t){var i=this.getCurves(),u=t&&t.simplify,h=u?0.0000001:0;for(var v=i.length-1;v>=0;v--){var f=i[v];if(!f.hasHandles()&&(!f.hasLength(h)||u&&f.isCollinear(f.getNext())))f.remove()}return this},reverse:function(){this._segments.reverse();for(var t=0,i=this._segments.length;t<i;t++){var u=this._segments[t],h=u._handleIn;u._handleIn=u._handleOut,u._handleOut=h,u._index=t}this._curves=null,this._changed(9)},flatten:function(t){var i=new n6(this,t||0.25,256,!0),u=i.parts,h=u.length,v=[];for(var f=0;f<h;f++)v.push(new J(u[f].curve.slice(0,2)));if(!this._closed&&h>0)v.push(new J(u[h-1].curve.slice(6)));this.setSegments(v)},simplify:function(t){var i=new W0(this).fit(t||2.5);if(i)this.setSegments(i);return!!i},smooth:function(t){var i=this,u=t||{},h=u.type||"asymmetric",v=this._segments,f=v.length,s=this._closed;function x(g0,V0){var j0=g0&&g0.index;if(j0!=null){var k0=g0.path;if(k0&&k0!==i)throw new Error(g0._class+" "+j0+" of "+k0+" is not part of "+i);if(V0&&g0 instanceof W)j0++}else j0=typeof g0==="number"?g0:V0;return Math.min(j0<0&&s?j0%f:j0<0?j0+f:j0,f-1)}var g=s&&u.from===N&&u.to===N,p=x(u.from,0),d=x(u.to,f-1);if(p>d)if(s)p-=f;else{var P=p;p=d,d=P}if(/^(?:asymmetric|continuous)$/.test(h)){var r=h==="asymmetric",l=Math.min,_=d-p+1,D=_-1,B=g?l(_,4):1,j=B,o=B,w=[];if(!s)j=l(1,p),o=l(1,f-d-1);if(D+=j+o,D<=1)return;for(var S=0,C=p-j;S<=D;S++,C++)w[S]=v[(C<0?C+f:C)%f]._point;var G=w[0]._x+2*w[1]._x,L=w[0]._y+2*w[1]._y,c=2,E=D-1,M=[G],a=[L],q=[c],z=[],O=[];for(var S=1;S<D;S++){var A=S<E,X=A?1:r?1:2,e=A?4:r?2:7,K=A?4:r?3:8,Q=A?2:r?0:1,h0=X/c;c=q[S]=e-h0,G=M[S]=K*w[S]._x+Q*w[S+1]._x-h0*G,L=a[S]=K*w[S]._y+Q*w[S+1]._y-h0*L}z[E]=M[E]/q[E],O[E]=a[E]/q[E];for(var S=D-2;S>=0;S--)z[S]=(M[S]-z[S+1])/q[S],O[S]=(a[S]-O[S+1])/q[S];z[D]=(3*w[D]._x-z[E])/2,O[D]=(3*w[D]._y-O[E])/2;for(var S=j,p0=D-o,C=p;S<=p0;S++,C++){var s0=v[C<0?C+f:C],b0=s0._point,v0=z[S]-b0._x,_0=O[S]-b0._y;if(g||S<p0)s0.setHandleOut(v0,_0);if(g||S>j)s0.setHandleIn(-v0,-_0)}}else for(var S=p;S<=d;S++)v[S<0?S+f:S].smooth(u,!g&&S===p,!g&&S===d)},toShape:function(t){if(!this._closed)return null;var i=this._segments,u,h,v,f;function s(r,l){var _=i[r],D=_.getNext(),B=i[l],j=B.getNext();return _._handleOut.isZero()&&D._handleIn.isZero()&&B._handleOut.isZero()&&j._handleIn.isZero()&&D._point.subtract(_._point).isCollinear(j._point.subtract(B._point))}function x(r){var l=i[r],_=l.getPrevious(),D=l.getNext();return _._handleOut.isZero()&&l._handleIn.isZero()&&l._handleOut.isZero()&&D._handleIn.isZero()&&l._point.subtract(_._point).isOrthogonal(D._point.subtract(l._point))}function g(r){var l=i[r],_=l.getNext(),D=l._handleOut,B=_._handleIn,j=0.5522847498307936;if(D.isOrthogonal(B)){var o=l._point,w=_._point,S=new Y0(o,D,!0).intersect(new Y0(w,B,!0),!0);return S&&t0.isZero(D.getLength()/S.subtract(o).getLength()-j)&&t0.isZero(B.getLength()/S.subtract(w).getLength()-j)}return!1}function p(r,l){return i[r]._point.getDistance(i[l]._point)}if(!this.hasHandles()&&i.length===4&&s(0,2)&&s(1,3)&&x(1))u=n0.Rectangle,h=new i0(p(0,3),p(0,1)),f=i[1]._point.add(i[2]._point).divide(2);else if(i.length===8&&g(0)&&g(2)&&g(4)&&g(6)&&s(1,5)&&s(3,7))u=n0.Rectangle,h=new i0(p(1,6),p(0,3)),v=h.subtract(new i0(p(0,7),p(1,2))).divide(2),f=i[3]._point.add(i[4]._point).divide(2);else if(i.length===4&&g(0)&&g(1)&&g(2)&&g(3)){if(t0.isZero(p(0,2)-p(1,3)))u=n0.Circle,v=p(0,2)/2;else u=n0.Ellipse,v=new i0(p(2,0)/2,p(3,1)/2);f=i[1]._point}if(u){var d=this.getPosition(!0),P=new u({center:d,size:h,radius:v,insert:!1});if(P.copyAttributes(this,!0),P._matrix.prepend(this._matrix),P.rotate(f.subtract(d).getAngle()+90),t===N||t)P.insertAbove(this);return P}return null},toPath:"#clone",compare:function t(i){if(!i||i instanceof T0)return t.base.call(this,i);var u=this.getCurves(),h=i.getCurves(),v=u.length,f=h.length;if(!v||!f)return v==f;var s=u[0].getValues(),x=[],g=0,p,d=0,P;for(var r=0;r<f;r++){var B=h[r].getValues();x.push(B);var l=W.getOverlaps(s,B);if(l){p=!r&&l[0][0]>0?f-1:r,P=l[0][1];break}}var _=Math.abs,D=0.00000001,B=x[p],j;while(s&&B){var l=W.getOverlaps(s,B);if(l){var o=l[0][0];if(_(o-d)<D){if(d=l[1][0],d===1)s=++g<v?u[g].getValues():null,d=0;var w=l[0][1];if(_(w-P)<D){if(!j)j=[p,w];if(P=l[1][1],P===1){if(++p>=f)p=0;B=x[p]||h[p].getValues(),P=0}if(!s)return j[0]===p&&j[1]===P;continue}}}break}return!1},_hitTestSelf:function(t,i,u,h){var v=this,f=this.getStyle(),s=this._segments,x=s.length,g=this._closed,p=i._tolerancePadding,d=p,P,r,l,_,D,B,j=i.stroke&&f.hasStroke(),o=i.fill&&f.hasFill(),w=i.curves,S=j?f.getStrokeWidth()/2:o&&i.tolerance>0||w?0:null;if(S!==null)if(S>0)P=f.getStrokeJoin(),r=f.getStrokeCap(),l=f.getMiterLimit(),d=d.add(d0._getStrokePadding(S,h));else P=r="round";function C(z,O){return t.subtract(z).divide(O).length<=1}function G(z,O,A){if(!i.selected||O.isSelected()){var X=z._point;if(O!==X)O=O.add(X);if(C(O,d))return new f0(A,v,{segment:z,point:O})}}function L(z,O){return(O||i.segments)&&G(z,z._point,"segment")||!O&&i.handles&&(G(z,z._handleIn,"handle-in")||G(z,z._handleOut,"handle-out"))}function c(z){_.add(z)}function E(z){var O=g||z._index>0&&z._index<x-1;if((O?P:r)==="round")return C(z._point,d);else{if(_=new d0({internal:!0,closed:!0}),O){if(!z.isSmooth())d0._addBevelJoin(z,P,S,l,null,h,c,!0)}else if(r==="square")d0._addSquareCap(z,r,S,null,h,c,!0);if(!_.isEmpty()){var A;return _.contains(t)||(A=_.getNearestLocation(t))&&C(A.getPoint(),p)}}}if(i.ends&&!i.segments&&!g){if(B=L(s[0],!0)||L(s[x-1],!0))return B}else if(i.segments||i.handles){for(var M=0;M<x;M++)if(B=L(s[M]))return B}if(S!==null){if(D=this.getNearestLocation(t),D){var a=D.getTime();if(a===0||a===1&&x>1){if(!E(D.getSegment()))D=null}else if(!C(D.getPoint(),d))D=null}if(!D&&P==="miter"&&x>1)for(var M=0;M<x;M++){var q=s[M];if(t.getDistance(q._point)<=l*S&&E(q)){D=q.getLocation();break}}}return!D&&o&&this._contains(t)||D&&!j&&!w?new f0("fill",this):D?new f0(j?"stroke":"curve",this,{location:D,point:D.getPoint()}):null}},k.each(W._evaluateMethods,function(t){this[t+"At"]=function(i){var u=this.getLocationAt(i);return u&&u[t]()}},{beans:!1,getLocationOf:function(){var t=R.read(arguments),i=this.getCurves();for(var u=0,h=i.length;u<h;u++){var v=i[u].getLocationOf(t);if(v)return v}return null},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getLocationAt:function(t){if(typeof t==="number"){var i=this.getCurves(),u=0;for(var h=0,v=i.length;h<v;h++){var f=u,s=i[h];if(u+=s.getLength(),u>t)return s.getLocationAt(t-f)}if(i.length>0&&t<=this.getLength())return new X0(i[i.length-1],1)}else if(t&&t.getPath&&t.getPath()===this)return t;return null},getOffsetsWithTangent:function(){var t=R.read(arguments);if(t.isZero())return[];var i=[],u=0,h=this.getCurves();for(var v=0,f=h.length;v<f;v++){var s=h[v],x=s.getTimesWithTangent(t);for(var g=0,p=x.length;g<p;g++){var d=u+s.getOffsetAtTime(x[g]);if(i.indexOf(d)<0)i.push(d)}u+=s.length}return i}}),new function(){function t(u,h,v,f){if(f<=0)return;var s=f/2,x=f-2,g=s-1,p=new Array(6),d,P;function r(o){var w=p[o],S=p[o+1];if(d!=w||P!=S)u.beginPath(),u.moveTo(d,P),u.lineTo(w,S),u.stroke(),u.beginPath(),u.arc(w,S,s,0,Math.PI*2,!0),u.fill()}for(var l=0,_=h.length;l<_;l++){var D=h[l],B=D._selection;if(D._transformCoordinates(v,p),d=p[0],P=p[1],B&2)r(2);if(B&4)r(4);if(u.fillRect(d-s,P-s,f,f),x>0&&!(B&1)){var j=u.fillStyle;u.fillStyle="#ffffff",u.fillRect(d-g,P-g,x,x),u.fillStyle=j}}}function i(u,h,v){var f=h._segments,s=f.length,x=new Array(6),g=!0,p,d,P,r,l,_,D,B;function j(w){if(v)w._transformCoordinates(v,x),p=x[0],d=x[1];else{var S=w._point;p=S._x,d=S._y}if(g)u.moveTo(p,d),g=!1;else{if(v)l=x[2],_=x[3];else{var C=w._handleIn;l=p+C._x,_=d+C._y}if(l===p&&_===d&&D===P&&B===r)u.lineTo(p,d);else u.bezierCurveTo(D,B,l,_,p,d)}if(P=p,r=d,v)D=x[4],B=x[5];else{var C=w._handleOut;D=P+C._x,B=r+C._y}}for(var o=0;o<s;o++)j(f[o]);if(h._closed&&s>0)j(f[0])}return{_draw:function(u,h,v,f){var s=h.dontStart,x=h.dontFinish||h.clip,g=this.getStyle(),p=g.hasFill(),d=g.hasStroke(),P=g.getDashArray(),r=!G0.support.nativeDash&&d&&P&&P.length;if(!s)u.beginPath();if(p||d&&!r||x){if(i(u,this,f),this._closed)u.closePath()}function l(w){return P[(w%r+r)%r]}if(!x&&(p||d)){if(this._setStyles(u,h,v),p)u.fill(g.getFillRule()),u.shadowColor="rgba(0,0,0,0)";if(d){if(r){if(!s)u.beginPath();var _=new n6(this,0.25,32,!1,f),D=_.length,B=-g.getDashOffset(),j,o=0;while(B>0)B-=l(o--)+l(o--);while(B<D){if(j=B+l(o++),B>0||j>0)_.drawPart(u,Math.max(B,0),Math.max(j,0));B=j+l(o++)}}u.stroke()}}},_drawSelected:function(u,h){u.beginPath(),i(u,this,h),u.stroke(),t(u,this._segments,h,G0.settings.handleSize)}}},new function(){function t(i){var u=i._segments;if(!u.length)throw new Error("Use a moveTo() command first");return u[u.length-1]}return{moveTo:function(){var i=this._segments;if(i.length===1)this.removeSegment(0);if(!i.length)this._add([new J(R.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new J(R.read(arguments))])},cubicCurveTo:function(){var i=arguments,u=R.read(i),h=R.read(i),v=R.read(i),f=t(this);f.setHandleOut(u.subtract(f._point)),this._add([new J(v,h.subtract(v))])},quadraticCurveTo:function(){var i=arguments,u=R.read(i),h=R.read(i),v=t(this)._point;this.cubicCurveTo(u.add(v.subtract(u).multiply(0.3333333333333333)),u.add(h.subtract(u).multiply(0.3333333333333333)),h)},curveTo:function(){var i=arguments,u=R.read(i),h=R.read(i),v=k.pick(k.read(i),0.5),f=1-v,s=t(this)._point,x=u.subtract(s.multiply(f*f)).subtract(h.multiply(v*v)).divide(2*v*f);if(x.isNaN())throw new Error("Cannot put a curve through points with parameter = "+v);this.quadraticCurveTo(x,h)},arcTo:function(){var i=arguments,u=Math.abs,h=Math.sqrt,v=t(this),f=v._point,s=R.read(i),_,x=k.peek(i),g=k.pick(x,!0),p,d,P,r;if(typeof g==="boolean")var l=f.add(s).divide(2),_=l.add(l.subtract(f).rotate(g?-90:90));else if(k.remain(i)<=2)_=s,s=R.read(i);else if(!f.equals(s)){var D=i0.read(i),B=t0.isZero;if(B(D.width)||B(D.height))return this.lineTo(s);var j=k.read(i),g=!!k.read(i),o=!!k.read(i),l=f.add(s).divide(2),w=f.subtract(l).rotate(-j),S=w.x,C=w.y,G=u(D.width),L=u(D.height),c=G*G,E=L*L,M=S*S,a=C*C,q=h(M/c+a/E);if(q>1)G*=q,L*=q,c=G*G,E=L*L;if(q=(c*E-c*a-E*M)/(c*a+E*M),u(q)<0.000000000001)q=0;if(q<0)throw new Error("Cannot create an arc with the given arguments");if(p=new R(G*C/L,-L*S/G).multiply((o===g?-1:1)*h(q)).rotate(j).add(l),r=new B0().translate(p).rotate(j).scale(G,L),P=r._inverseTransform(f),d=P.getDirectedAngle(r._inverseTransform(s)),!g&&d>0)d-=360;else if(g&&d<0)d+=360}if(_){var z=new Y0(f.add(_).divide(2),_.subtract(f).rotate(90),!0),O=new Y0(_.add(s).divide(2),s.subtract(_).rotate(90),!0),A=new Y0(f,s),X=A.getSide(_);if(p=z.intersect(O,!0),!p){if(!X)return this.lineTo(s);throw new Error("Cannot create an arc with the given arguments")}P=f.subtract(p),d=P.getDirectedAngle(s.subtract(p));var e=A.getSide(p,!0);if(e===0)d=X*u(d);else if(X===e)d+=d<0?360:-360}if(d){var K=0.00001,Q=u(d),h0=Q>=360?4:Math.ceil((Q-K)/90),p0=d/h0,s0=p0*Math.PI/360,b0=1.3333333333333333*Math.sin(s0)/(1+Math.cos(s0)),v0=[];for(var _0=0;_0<=h0;_0++){var w=s,g0=null;if(_0<h0)if(g0=P.rotate(90).multiply(b0),r)w=r._transformPoint(P),g0=r._transformPoint(P.add(g0)).subtract(w);else w=p.add(P);if(!_0)v.setHandleOut(g0);else{var V0=P.rotate(-90).multiply(b0);if(r)V0=r._transformPoint(P.add(V0)).subtract(w);v0.push(new J(w,V0,g0))}P=P.rotate(p0)}this._add(v0)}},lineBy:function(){var i=R.read(arguments),u=t(this)._point;this.lineTo(u.add(i))},curveBy:function(){var i=arguments,u=R.read(i),h=R.read(i),v=k.read(i),f=t(this)._point;this.curveTo(f.add(u),f.add(h),v)},cubicCurveBy:function(){var i=arguments,u=R.read(i),h=R.read(i),v=R.read(i),f=t(this)._point;this.cubicCurveTo(f.add(u),f.add(h),f.add(v))},quadraticCurveBy:function(){var i=arguments,u=R.read(i),h=R.read(i),v=t(this)._point;this.quadraticCurveTo(v.add(u),v.add(h))},arcBy:function(){var i=arguments,u=t(this)._point,h=u.add(R.read(i)),v=k.pick(k.peek(i),!0);if(typeof v==="boolean")this.arcTo(h,v);else this.arcTo(h,u.add(R.read(i)))},closePath:function(i){this.setClosed(!0),this.join(this,i)}}},{_getBounds:function(t,i){var u=i.handle?"getHandleBounds":i.stroke?"getStrokeBounds":"getBounds";return d0[u](this._segments,this._closed,this,t,i)},statics:{getBounds:function(t,i,u,h,v,f){var s=t[0];if(!s)return new m0;var x=new Array(6),g=s._transformCoordinates(h,new Array(6)),p=g.slice(0,2),d=p.slice(),P=new Array(2);function r(D){D._transformCoordinates(h,x);for(var B=0;B<2;B++)W._addBounds(g[B],g[B+4],x[B+2],x[B],B,f?f[B]:0,p,d,P);var j=g;g=x,x=j}for(var l=1,_=t.length;l<_;l++)r(t[l]);if(i)r(s);return new m0(p[0],p[1],d[0]-p[0],d[1]-p[1])},getStrokeBounds:function(t,i,u,h,v){var f=u.getStyle(),s=f.hasStroke(),x=f.getStrokeWidth(),g=s&&u._getStrokeMatrix(h,v),p=s&&d0._getStrokePadding(x,g),d=d0.getBounds(t,i,u,h,v,p);if(!s)return d;var P=x/2,r=f.getStrokeJoin(),l=f.getStrokeCap(),_=f.getMiterLimit(),D=new m0(new i0(p));function B(G){d=d.include(G)}function j(G){d=d.unite(D.setCenter(G._point.transform(h)))}function o(G,L){if(L==="round"||G.isSmooth())j(G);else d0._addBevelJoin(G,L,P,_,h,g,B)}function w(G,L){if(L==="round")j(G);else d0._addSquareCap(G,L,P,h,g,B)}var S=t.length-(i?0:1);if(S>0){for(var C=1;C<S;C++)o(t[C],r);if(i)o(t[0],r);else w(t[0],l),w(t[t.length-1],l)}return d},_getStrokePadding:function(t,i){if(!i)return[t,t];var u=new R(t,0).transform(i),h=new R(0,t).transform(i),v=u.getAngleInRadians(),f=u.getLength(),s=h.getLength(),x=Math.sin(v),g=Math.cos(v),p=Math.tan(v),d=Math.atan2(s*p,f),P=Math.atan2(s,p*f);return[Math.abs(f*Math.cos(d)*g+s*Math.sin(d)*x),Math.abs(s*Math.sin(P)*g+f*Math.cos(P)*x)]},_addBevelJoin:function(t,i,u,h,v,f,s,x){var g=t.getCurve(),p=g.getPrevious(),d=g.getPoint1().transform(v),P=p.getNormalAtTime(1).multiply(u).transform(f),r=g.getNormalAtTime(0).multiply(u).transform(f),l=P.getDirectedAngle(r);if(l<0||l>=180)P=P.negate(),r=r.negate();if(x)s(d);if(s(d.add(P)),i==="miter"){var _=new Y0(d.add(P),new R(-P.y,P.x),!0).intersect(new Y0(d.add(r),new R(-r.y,r.x),!0),!0);if(_&&d.getDistance(_)<=h*u)s(_)}s(d.add(r))},_addSquareCap:function(t,i,u,h,v,f,s){var x=t._point.transform(h),g=t.getLocation(),p=g.getNormal().multiply(g.getTime()===0?u:-u).transform(v);if(i==="square"){if(s)f(x.subtract(p)),f(x.add(p));x=x.add(p.rotate(-90))}f(x.add(p)),f(x.subtract(p))},getHandleBounds:function(t,i,u,h,v){var f=u.getStyle(),s=v.stroke&&f.hasStroke(),x,g;if(s){var p=u._getStrokeMatrix(h,v),d=f.getStrokeWidth()/2,P=d;if(f.getStrokeJoin()==="miter")P=d*f.getMiterLimit();if(f.getStrokeCap()==="square")P=Math.max(P,d*Math.SQRT2);x=d0._getStrokePadding(d,p),g=d0._getStrokePadding(P,p)}var r=new Array(6),l=Infinity,_=-l,D=l,B=_;for(var j=0,o=t.length;j<o;j++){var w=t[j];w._transformCoordinates(h,r);for(var S=0;S<6;S+=2){var C=!S?g:x,G=C?C[0]:0,L=C?C[1]:0,c=r[S],E=r[S+1],M=c-G,a=c+G,q=E-L,z=E+L;if(M<l)l=M;if(a>_)_=a;if(q<D)D=q;if(z>B)B=z}}return new m0(l,D,_-l,B-D)}}});d0.inject({statics:new function(){var t=0.5522847498307936,i=[new J([-1,0],[0,t],[0,-t]),new J([0,-1],[-t,0],[t,0]),new J([1,0],[0,-t],[0,t]),new J([0,1],[t,0],[-t,0])];function u(v,f,s){var x=k.getNamed(s),g=new d0(x&&(x.insert==!0?l0.INSERT:x.insert==!1?l0.NO_INSERT:null));return g._add(v),g._closed=f,g.set(x,l0.INSERT)}function h(v,f,s){var x=new Array(4);for(var g=0;g<4;g++){var p=i[g];x[g]=new J(p._point.multiply(f).add(v),p._handleIn.multiply(f),p._handleOut.multiply(f))}return u(x,!0,s)}return{Line:function(){var v=arguments;return u([new J(R.readNamed(v,"from")),new J(R.readNamed(v,"to"))],!1,v)},Circle:function(){var v=arguments,f=R.readNamed(v,"center"),s=k.readNamed(v,"radius");return h(f,new i0(s),v)},Rectangle:function(){var v=arguments,f=m0.readNamed(v,"rectangle"),s=i0.readNamed(v,"radius",0,{readNull:!0}),x=f.getBottomLeft(!0),g=f.getTopLeft(!0),p=f.getTopRight(!0),d=f.getBottomRight(!0),P;if(!s||s.isZero())P=[new J(x),new J(g),new J(p),new J(d)];else{s=i0.min(s,f.getSize(!0).divide(2));var{width:r,height:l}=s,_=r*t,D=l*t;P=[new J(x.add(r,0),null,[-_,0]),new J(x.subtract(0,l),[0,D]),new J(g.add(0,l),null,[0,-D]),new J(g.add(r,0),[-_,0],null),new J(p.subtract(r,0),null,[_,0]),new J(p.add(0,l),[0,-D],null),new J(d.subtract(0,l),null,[0,D]),new J(d.subtract(r,0),[_,0])]}return u(P,!0,v)},RoundRectangle:"#Rectangle",Ellipse:function(){var v=arguments,f=n0._readEllipse(v);return h(f.center,f.radius,v)},Oval:"#Ellipse",Arc:function(){var v=arguments,f=R.readNamed(v,"from"),s=R.readNamed(v,"through"),x=R.readNamed(v,"to"),g=k.getNamed(v),p=new d0(g&&g.insert==!1&&l0.NO_INSERT);return p.moveTo(f),p.arcTo(s,x),p.set(g)},RegularPolygon:function(){var v=arguments,f=R.readNamed(v,"center"),s=k.readNamed(v,"sides"),x=k.readNamed(v,"radius"),g=360/s,p=s%3===0,d=new R(0,p?-x:x),P=p?-1:0.5,r=new Array(s);for(var l=0;l<s;l++)r[l]=new J(f.add(d.rotate((l+P)*g)));return u(r,!0,v)},Star:function(){var v=arguments,f=R.readNamed(v,"center"),s=k.readNamed(v,"points")*2,x=k.readNamed(v,"radius1"),g=k.readNamed(v,"radius2"),p=360/s,d=new R(0,-1),P=new Array(s);for(var r=0;r<s;r++)P[r]=new J(f.add(d.rotate(p*r).multiply(r%2?g:x)));return u(P,!0,v)}}}});var T0=t6.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function t(i){if(this._children=[],this._namedChildren={},!this._initialize(i))if(typeof i==="string")this.setPathData(i);else this.addChildren(Array.isArray(i)?i:arguments)},insertChildren:function t(i,u){var h=u,v=h[0];if(v&&typeof v[0]==="number")h=[h];for(var f=u.length-1;f>=0;f--){var s=h[f];if(h===u&&!(s instanceof d0))h=k.slice(h);if(Array.isArray(s))h[f]=new d0({segments:s,insert:!1});else if(s instanceof T0)h.splice.apply(h,[f,1].concat(s.removeChildren())),s.remove()}return t.base.call(this,i,h)},reduce:function t(i){var u=this._children;for(var h=u.length-1;h>=0;h--){var v=u[h].reduce(i);if(v.isEmpty())v.remove()}if(!u.length){var v=new d0(l0.NO_INSERT);return v.copyAttributes(this),v.insertAbove(this),this.remove(),v}return t.base.call(this)},isClosed:function(){var t=this._children;for(var i=0,u=t.length;i<u;i++)if(!t[i]._closed)return!1;return!0},setClosed:function(t){var i=this._children;for(var u=0,h=i.length;u<h;u++)i[u].setClosed(t)},getFirstSegment:function(){var t=this.getFirstChild();return t&&t.getFirstSegment()},getLastSegment:function(){var t=this.getLastChild();return t&&t.getLastSegment()},getCurves:function(){var t=this._children,i=[];for(var u=0,h=t.length;u<h;u++)k.push(i,t[u].getCurves());return i},getFirstCurve:function(){var t=this.getFirstChild();return t&&t.getFirstCurve()},getLastCurve:function(){var t=this.getLastChild();return t&&t.getLastCurve()},getArea:function(){var t=this._children,i=0;for(var u=0,h=t.length;u<h;u++)i+=t[u].getArea();return i},getLength:function(){var t=this._children,i=0;for(var u=0,h=t.length;u<h;u++)i+=t[u].getLength();return i},getPathData:function(t,i){var u=this._children,h=[];for(var v=0,f=u.length;v<f;v++){var s=u[v],x=s._matrix;h.push(s.getPathData(t&&!x.isIdentity()?t.appended(x):t,i))}return h.join("")},_hitTestChildren:function t(i,u,h){return t.base.call(this,i,u.class===d0||u.type==="path"?u:k.set({},u,{fill:!1}),h)},_draw:function(t,i,u,h){var v=this._children;if(!v.length)return;i=i.extend({dontStart:!0,dontFinish:!0}),t.beginPath();for(var f=0,s=v.length;f<s;f++)v[f].draw(t,i,h);if(!i.clip){this._setStyles(t,i,u);var x=this._style;if(x.hasFill())t.fill(x.getFillRule()),t.shadowColor="rgba(0,0,0,0)";if(x.hasStroke())t.stroke()}},_drawSelected:function(t,i,u){var h=this._children;for(var v=0,f=h.length;v<f;v++){var s=h[v],x=s._matrix;if(!u[s._id])s._drawSelected(t,x.isIdentity()?i:i.appended(x))}}},new function(){function t(i,u){var h=i._children;if(u&&!h.length)throw new Error("Use a moveTo() command first");return h[h.length-1]}return k.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(i){this[i]=function(){var u=t(this,!0);u[i].apply(u,arguments)}},{moveTo:function(){var i=t(this),u=i&&i.isEmpty()?i:new d0(l0.NO_INSERT);if(u!==i)this.addChild(u);u.moveTo.apply(u,arguments)},moveBy:function(){var i=t(this,!0),u=i&&i.getLastSegment(),h=R.read(arguments);this.moveTo(u?h.add(u._point):h)},closePath:function(i){t(this,!0).closePath(i)}})},k.each(["reverse","flatten","simplify","smooth"],function(t){this[t]=function(i){var u=this._children,h;for(var v=0,f=u.length;v<f;v++)h=u[v][t](i)||h;return h}},{}));t6.inject(new function(){var{min:t,max:i,abs:u}=Math,h={unite:{"1":!0,"2":!0},intersect:{"2":!0},subtract:{"1":!0},exclude:{"1":!0,"-1":!0}};function v(j){return j._children||[j]}function f(j,o){var w=j.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(o){var S=v(w);for(var C=0,G=S.length;C<G;C++){var j=S[C];if(!j._closed&&!j.isEmpty())j.closePath(0.000000000001),j.getFirstSegment().setHandleIn(0,0),j.getLastSegment().setHandleOut(0,0)}w=w.resolveCrossings().reorient(w.getFillRule()==="nonzero",!0)}return w}function s(j,o,w,S,C){var G=new T0(l0.NO_INSERT);if(G.addChildren(j,!0),G=G.reduce({simplify:o}),!(C&&C.insert==!1))G.insertAbove(S&&w.isSibling(S)&&w.getIndex()<S.getIndex()?S:w);return G.copyAttributes(w,!0),G}function x(j){return j.hasOverlap()||j.isCrossing()}function g(j,o,w,S){if(S&&(S.trace==!1||S.stroke)&&/^(subtract|intersect)$/.test(w))return p(j,o,w);var C=f(j,!0),G=o&&j!==o&&f(o,!0),L=h[w];if(L[w]=!0,G&&(L.subtract||L.exclude)^(G.isClockwise()^C.isClockwise()))G.reverse();var c=l(X0.expand(C.getIntersections(G,x))),E=v(C),M=G&&v(G),a=[],q=[],z;function O(g0){for(var V0=0,j0=g0.length;V0<j0;V0++){var k0=g0[V0];k.push(a,k0._segments),k.push(q,k0.getCurves()),k0._overlapsOnly=!0}}function A(g0){var V0=[];for(var j0=0,k0=g0&&g0.length;j0<k0;j0++)V0.push(q[g0[j0]]);return V0}if(c.length){if(O(E),M)O(M);var X=new Array(q.length);for(var e=0,K=q.length;e<K;e++)X[e]=q[e].getValues();var Q=x0.findCurveBoundsCollisions(X,X,0,!0),h0={};for(var e=0;e<q.length;e++){var p0=q[e],s0=p0._path._id,b0=h0[s0]=h0[s0]||{};b0[p0.getIndex()]={hor:A(Q[e].hor),ver:A(Q[e].ver)}}for(var e=0,K=c.length;e<K;e++)D(c[e]._segment,C,G,h0,L);for(var e=0,K=a.length;e<K;e++){var v0=a[e],_0=v0._intersection;if(!v0._winding)D(v0,C,G,h0,L);if(!(_0&&_0._overlap))v0._path._overlapsOnly=!1}z=B(a,L)}else z=r(M?E.concat(M):E.slice(),function(g0){return!!L[g0]});return s(z,!0,j,o,S)}function p(j,o,w){var S=f(j),C=f(o),G=S.getIntersections(C,x),L=w==="subtract",c=w==="divide",E={},M=[];function a(O){if(!E[O._id]&&(c||C.contains(O.getPointAt(O.getLength()/2))^L))return M.unshift(O),E[O._id]=!0}for(var q=G.length-1;q>=0;q--){var z=G[q].split();if(z){if(a(z))z.getFirstSegment().setHandleIn(0,0);S.getLastSegment().setHandleOut(0,0)}}return a(S),s(M,!1,j,o)}function d(j,o){var w=j;while(w){if(w===o)return;w=w._previous}while(j._next&&j._next!==o)j=j._next;if(!j._next){while(o._previous)o=o._previous;j._next=o,o._previous=j}}function P(j){for(var o=j.length-1;o>=0;o--)j[o].clearHandles()}function r(j,o,w){var S=j&&j.length;if(S){var C=k.each(j,function(Q,h0){this[Q._id]={container:null,winding:Q.isClockwise()?1:-1,index:h0}},{}),G=j.slice().sort(function(Q,h0){return u(h0.getArea())-u(Q.getArea())}),L=G[0],c=x0.findItemBoundsCollisions(G,null,t0.GEOMETRIC_EPSILON);if(w==null)w=L.isClockwise();for(var E=0;E<S;E++){var M=G[E],a=C[M._id],q=0,z=c[E];if(z){var O=null;for(var A=z.length-1;A>=0;A--)if(z[A]<E){O=O||M.getInteriorPoint();var X=G[z[A]];if(X.contains(O)){var e=C[X._id];q=e.winding,a.winding+=q,a.container=e.exclude?e.container:X;break}}}if(o(a.winding)===o(q))a.exclude=!0,j[a.index]=null;else{var K=a.container;M.setClockwise(K?!K.isClockwise():w)}}}return j}function l(j,o,w){var S=o&&[],C=0.00000001,G=1-C,L=!1,c=w||[],E=w&&{},M,a,q;function z(V0){return V0._path._id+"."+V0._segment1._index}for(var O=(w&&w.length)-1;O>=0;O--){var A=w[O];if(A._path)E[z(A)]=!0}for(var O=j.length-1;O>=0;O--){var X=j[O],e=X._time,K=e,Q=o&&!o(X),A=X._curve,h0;if(A){if(A!==a)L=!A.hasHandles()||E&&E[z(A)],M=[],q=null,a=A;else if(q>=C)e/=q}if(Q){if(M)M.push(X);continue}else if(o)S.unshift(X);if(q=K,e<C)h0=A._segment1;else if(e>G)h0=A._segment2;else{var p0=A.divideAtTime(e,!0);if(L)c.push(A,p0);h0=p0._segment1;for(var s0=M.length-1;s0>=0;s0--){var b0=M[s0];b0._time=(b0._time-e)/(1-e)}}X._setSegment(h0);var v0=h0._intersection,_0=X._intersection;if(v0){d(v0,_0);var g0=v0;while(g0)d(g0._intersection,v0),g0=g0._next}else h0._intersection=_0}if(!w)P(c);return S||j}function _(j,o,w,S,C){var G=Array.isArray(o)?o:o[w?"hor":"ver"],L=w?1:0,c=L^1,E=[j.x,j.y],M=E[L],a=E[c],q=0.000000001,z=0.000001,O=M-q,A=M+q,X=0,e=0,K=0,Q=0,h0=!1,p0=!1,s0=1,b0=[],v0,_0;function g0(O0){var $0=O0[c+0],d6=O0[c+6];if(a<t($0,d6)||a>i($0,d6))return;var v6=O0[L+0],k6=O0[L+2],J6=O0[L+4],L6=O0[L+6];if($0===d6){if(v6<A&&L6>O||L6<A&&v6>O)h0=!0;return}var a6=a===$0?0:a===d6?1:O>i(v6,k6,J6,L6)||A<t(v6,k6,J6,L6)?1:W.solveCubic(O0,c,a,b0,0,1)>0?b0[0]:1,r6=a6===0?v6:a6===1?L6:W.getPoint(O0,a6)[w?"y":"x"],S6=$0>d6?1:-1,s4=v0[c]>v0[c+6]?1:-1,O6=v0[L+6];if(a!==$0){if(r6<O)K+=S6;else if(r6>A)Q+=S6;else h0=!0;if(r6>M-z&&r6<M+z)s0/=2}else{if(S6!==s4){if(v6<O)K+=S6;else if(v6>A)Q+=S6}else if(v6!=O6){if(O6<A&&r6>A)Q+=S6,h0=!0;else if(O6>O&&r6<O)K+=S6,h0=!0}s0/=4}return v0=O0,!C&&r6>O&&r6<A&&W.getTangent(O0,a6)[w?"x":"y"]===0&&_(j,o,!w,S,!0)}function V0(O0){var $0=O0[c+0],d6=O0[c+2],v6=O0[c+4],k6=O0[c+6];if(a<=i($0,d6,v6,k6)&&a>=t($0,d6,v6,k6)){var J6=O0[L+0],L6=O0[L+2],a6=O0[L+4],r6=O0[L+6],S6=O>i(J6,L6,a6,r6)||A<t(J6,L6,a6,r6)?[O0]:W.getMonoCurves(O0,w),s4;for(var O6=0,l8=S6.length;O6<l8;O6++)if(s4=g0(S6[O6]))return s4}}for(var j0=0,k0=G.length;j0<k0;j0++){var L0=G[j0],D0=L0._path,u6=L0.getValues(),h6;if(!j0||G[j0-1]._path!==D0){if(v0=null,!D0._closed){if(_0=W.getValues(D0.getLastCurve().getSegment2(),L0.getSegment1(),null,!S),_0[c]!==_0[c+6])v0=_0}if(!v0){v0=u6;var s6=D0.getLastCurve();while(s6&&s6!==L0){var Q0=s6.getValues();if(Q0[c]!==Q0[c+6]){v0=Q0;break}s6=s6.getPrevious()}}}if(h6=V0(u6))return h6;if(j0+1===k0||G[j0+1]._path!==D0){if(_0&&(h6=V0(_0)))return h6;if(h0&&!K&&!Q)K=Q=D0.isClockwise(S)^w?1:-1;if(X+=K,e+=Q,K=Q=0,h0)p0=!0,h0=!1;_0=null}}return X=u(X),e=u(e),{winding:i(X,e),windingL:X,windingR:e,quality:s0,onPath:p0}}function D(j,o,w,S,C){var G=[],L=j,c=0,q;do{var E=j.getCurve();if(E){var M=E.getLength();G.push({segment:j,curve:E,length:M}),c+=M}j=j.getNext()}while(j&&!j._intersection&&j!==L);var a=[0.5,0.25,0.75],q={winding:0,quality:-1},z=0.001,O=1-z;for(var A=0;A<a.length&&q.quality<0.5;A++){var M=c*a[A];for(var X=0,e=G.length;X<e;X++){var K=G[X],Q=K.length;if(M<=Q){var E=K.curve,h0=E._path,p0=h0._parent,s0=p0 instanceof T0?p0:h0,b0=t0.clamp(E.getTimeAt(M),z,O),v0=E.getPointAtTime(b0),_0=u(E.getTangentAtTime(b0).y)<Math.SQRT1_2,g0=null;if(C.subtract&&w){var V0=s0===o?w:o,j0=V0._getWinding(v0,_0,!0);if(s0===o&&j0.winding||s0===w&&!j0.winding)if(j0.quality<1)continue;else g0={winding:0,quality:1}}if(g0=g0||_(v0,S[h0._id][E.getIndex()],_0,!0),g0.quality>q.quality)q=g0;break}M-=Q}}for(var X=G.length-1;X>=0;X--)G[X].segment._winding=q}function B(j,o){var w=[],S;function C(k0){var L0;return!!(k0&&!k0._visited&&(!o||o[(L0=k0._winding||{}).winding]&&!(o.unite&&L0.winding===2&&L0.windingL&&L0.windingR)))}function G(k0){if(k0){for(var L0=0,D0=S.length;L0<D0;L0++)if(k0===S[L0])return!0}return!1}function L(k0){var L0=k0._segments;for(var D0=0,u6=L0.length;D0<u6;D0++)L0[D0]._visited=!0}function c(k0,L0){var D0=k0._intersection,u6=D0,h6=[];if(L0)S=[k0];function s6(Q0,O0){while(Q0&&Q0!==O0){var $0=Q0._segment,d6=$0&&$0._path;if(d6){var v6=$0.getNext()||d6.getFirstSegment(),k6=v6._intersection;if($0!==k0&&(G($0)||G(v6)||v6&&(C($0)&&(C(v6)||k6&&C(k6._segment)))))h6.push($0);if(L0)S.push($0)}Q0=Q0._next}}if(D0){s6(D0);while(D0&&D0._previous)D0=D0._previous;s6(D0,u6)}return h6}j.sort(function(k0,L0){var D0=k0._intersection,u6=L0._intersection,h6=!!(D0&&D0._overlap),s6=!!(u6&&u6._overlap),Q0=k0._path,O0=L0._path;return h6^s6?h6?1:-1:!D0^!u6?D0?1:-1:Q0!==O0?Q0._id-O0._id:k0._index-L0._index});for(var E=0,M=j.length;E<M;E++){var a=j[E],q=C(a),z=null,O=!1,A=!0,X=[],e,K,Q;if(q&&a._path._overlapsOnly){var h0=a._path,p0=a._intersection._segment._path;if(h0.compare(p0)){if(h0.getArea())w.push(h0.clone(!1));L(h0),L(p0),q=!1}}while(q){var s0=!z,b0=c(a,s0),v0=b0.shift(),O=!s0&&(G(a)||G(v0)),_0=!O&&v0;if(s0)z=new d0(l0.NO_INSERT),e=null;if(O){if(a.isFirst()||a.isLast())A=a._path._closed;a._visited=!0;break}if(_0&&e)X.push(e),e=null;if(!e){if(_0)b0.push(a);e={start:z._segments.length,crossings:b0,visited:K=[],handleIn:Q}}if(_0)a=v0;if(!C(a)){z.removeSegments(e.start);for(var g0=0,V0=K.length;g0<V0;g0++)K[g0]._visited=!1;K.length=0;do if(a=e&&e.crossings.shift(),!a||!a._path){if(a=null,e=X.pop(),e)K=e.visited,Q=e.handleIn}while(e&&!C(a));if(!a)break}var j0=a.getNext();z.add(new J(a._point,Q,j0&&a._handleOut)),a._visited=!0,K.push(a),a=j0||a._path.getFirstSegment(),Q=j0&&j0._handleIn}if(O){if(A)z.getFirstSegment().setHandleIn(Q),z.setClosed(A);if(z.getArea()!==0)w.push(z)}}return w}return{_getWinding:function(j,o,w){return _(j,this.getCurves(),o,w)},unite:function(j,o){return g(this,j,"unite",o)},intersect:function(j,o){return g(this,j,"intersect",o)},subtract:function(j,o){return g(this,j,"subtract",o)},exclude:function(j,o){return g(this,j,"exclude",o)},divide:function(j,o){return o&&(o.trace==!1||o.stroke)?p(this,j,"divide"):s([this.subtract(j,o),this.intersect(j,o)],!0,this,j,o)},resolveCrossings:function(){var j=this._children,o=j||[this];function w(e,K){var Q=e&&e._intersection;return Q&&Q._overlap&&Q._path===K}var S=!1,C=!1,G=this.getIntersections(null,function(e){return e.hasOverlap()&&(S=!0)||e.isCrossing()&&(C=!0)}),L=S&&C&&[];if(G=X0.expand(G),S){var c=l(G,function(e){return e.hasOverlap()},L);for(var E=c.length-1;E>=0;E--){var M=c[E],a=M._path,q=M._segment,z=q.getPrevious(),O=q.getNext();if(w(z,a)&&w(O,a)){if(q.remove(),z._handleOut._set(0,0),O._handleIn._set(0,0),z!==q&&!z.getCurve().hasLength())O._handleIn.set(z._handleIn),z.remove()}}}if(C){if(l(G,S&&function(e){var K=e.getCurve(),Q=e.getSegment(),h0=e._intersection,p0=h0._curve,s0=h0._segment;if(K&&p0&&K._path&&p0._path)return!0;if(Q)Q._intersection=null;if(s0)s0._intersection=null},L),L)P(L);o=B(k.each(o,function(e){k.push(this,e._segments)},[]))}var A=o.length,X;if(A>1&&j){if(o!==j)this.setChildren(o);X=this}else if(A===1&&!j){if(o[0]!==this)this.setSegments(o[0].removeSegments());X=this}if(!X)X=new T0(l0.NO_INSERT),X.addChildren(o),X=X.reduce(),X.copyAttributes(this),this.replaceWith(X);return X},reorient:function(j,o){var w=this._children;if(w&&w.length)this.setChildren(r(this.removeChildren(),function(S){return!!(j?S:S&1)},o));else if(o!==N)this.setClockwise(o);return this},getInteriorPoint:function(){var j=this.getBounds(),o=j.getCenter(!0);if(!this.contains(o)){var w=this.getCurves(),S=o.y,C=[],G=[];for(var L=0,c=w.length;L<c;L++){var E=w[L].getValues(),M=E[1],a=E[3],q=E[5],z=E[7];if(S>=t(M,a,q,z)&&S<=i(M,a,q,z)){var O=W.getMonoCurves(E);for(var A=0,X=O.length;A<X;A++){var e=O[A],K=e[1],Q=e[7];if(K!==Q&&(S>=K&&S<=Q||S>=Q&&S<=K)){var h0=S===K?e[0]:S===Q?e[6]:W.solveCubic(e,1,S,G,0,1)===1?W.getPoint(e,G[0]).x:(e[0]+e[6])/2;C.push(h0)}}}}if(C.length>1)C.sort(function(p0,s0){return p0-s0}),o.x=(C[0]+C[1])/2}return o}}});var n6=k.extend({_class:"PathFlattener",initialize:function(t,i,u,h,v){var f=[],s=[],x=0,g=1/(u||32),p=t._segments,d=p[0],P;function r(B,j){var o=W.getValues(B,j,v);f.push(o),l(o,B._index,0,1)}function l(B,j,o,w){if(w-o>g&&!(h&&W.isStraight(B))&&!W.isFlatEnough(B,i||0.25)){var S=W.subdivide(B,0.5),C=(o+w)/2;l(S[0],j,o,C),l(S[1],j,C,w)}else{var G=B[6]-B[0],L=B[7]-B[1],c=Math.sqrt(G*G+L*L);if(c>0)x+=c,s.push({offset:x,curve:B,index:j,time:w})}}for(var _=1,D=p.length;_<D;_++)P=p[_],r(d,P),d=P;if(t._closed)r(P||d,p[0]);this.curves=f,this.parts=s,this.length=x,this.index=0},_get:function(t){var i=this.parts,u=i.length,h,v,f=this.index;for(;;)if(v=f,!f||i[--f].offset<t)break;for(;v<u;v++){var s=i[v];if(s.offset>=t){this.index=v;var x=i[v-1],g=x&&x.index===s.index?x.time:0,p=x?x.offset:0;return{index:s.index,time:g+(s.time-g)*(t-p)/(s.offset-p)}}}return{index:i[u-1].index,time:1}},drawPart:function(t,i,u){var h=this._get(i),v=this._get(u);for(var f=h.index,s=v.index;f<=s;f++){var x=W.getPart(this.curves[f],f===h.index?h.time:0,f===v.index?v.time:1);if(f===h.index)t.moveTo(x[0],x[1]);t.bezierCurveTo.apply(t,x.slice(2))}}},k.each(W._evaluateMethods,function(t){this[t+"At"]=function(i){var u=this._get(i);return W[t](this.curves[u.index],u.time)}},{})),W0=k.extend({initialize:function(t){var i=this.points=[],u=t._segments,h=t._closed;for(var v=0,f,s=u.length;v<s;v++){var x=u[v].point;if(!f||!f.equals(x))i.push(f=x.clone())}if(h)i.unshift(i[i.length-1]),i.push(i[1]);this.closed=h},fit:function(t){var i=this.points,u=i.length,h=null;if(u>0){if(h=[new J(i[0])],u>1){if(this.fitCubic(h,t,0,u-1,i[1].subtract(i[0]),i[u-2].subtract(i[u-1])),this.closed)h.shift(),h.pop()}}return h},fitCubic:function(t,i,u,h,v,f){var s=this.points;if(h-u===1){var x=s[u],g=s[h],p=x.getDistance(g)/3;this.addCurve(t,[x,x.add(v.normalize(p)),g.add(f.normalize(p)),g]);return}var d=this.chordLengthParameterize(u,h),P=Math.max(i,i*i),r,l=!0;for(var _=0;_<=4;_++){var D=this.generateBezier(u,h,d,v,f),B=this.findMaxError(u,h,D,d);if(B.error<i&&l){this.addCurve(t,D);return}if(r=B.index,B.error>=P)break;l=this.reparameterize(u,h,d,D),P=B.error}var j=s[r-1].subtract(s[r+1]);this.fitCubic(t,i,u,r,v,j),this.fitCubic(t,i,r,h,j.negate(),f)},addCurve:function(t,i){var u=t[t.length-1];u.setHandleOut(i[1].subtract(i[0])),t.push(new J(i[3],i[2].subtract(i[3])))},generateBezier:function(t,i,u,h,v){var f=0.000000000001,s=Math.abs,x=this.points,g=x[t],p=x[i],d=[[0,0],[0,0]],P=[0,0];for(var r=0,l=i-t+1;r<l;r++){var _=u[r],D=1-_,B=3*_*D,j=D*D*D,o=B*D,w=B*_,S=_*_*_,C=h.normalize(o),G=v.normalize(w),L=x[t+r].subtract(g.multiply(j+o)).subtract(p.multiply(w+S));d[0][0]+=C.dot(C),d[0][1]+=C.dot(G),d[1][0]=d[0][1],d[1][1]+=G.dot(G),P[0]+=C.dot(L),P[1]+=G.dot(L)}var c=d[0][0]*d[1][1]-d[1][0]*d[0][1],E,M;if(s(c)>f){var a=d[0][0]*P[1]-d[1][0]*P[0],q=P[0]*d[1][1]-P[1]*d[0][1];E=q/c,M=a/c}else{var z=d[0][0]+d[0][1],O=d[1][0]+d[1][1];E=M=s(z)>f?P[0]/z:s(O)>f?P[1]/O:0}var A=p.getDistance(g),X=f*A,e,K;if(E<X||M<X)E=M=A/3;else{var Q=p.subtract(g);if(e=h.normalize(E),K=v.normalize(M),e.dot(Q)-K.dot(Q)>A*A)E=M=A/3,e=K=null}return[g,g.add(e||h.normalize(E)),p.add(K||v.normalize(M)),p]},reparameterize:function(t,i,u,h){for(var v=t;v<=i;v++)u[v-t]=this.findRoot(h,this.points[v],u[v-t]);for(var v=1,f=u.length;v<f;v++)if(u[v]<=u[v-1])return!1;return!0},findRoot:function(t,i,u){var h=[],v=[];for(var f=0;f<=2;f++)h[f]=t[f+1].subtract(t[f]).multiply(3);for(var f=0;f<=1;f++)v[f]=h[f+1].subtract(h[f]).multiply(2);var s=this.evaluate(3,t,u),x=this.evaluate(2,h,u),g=this.evaluate(1,v,u),p=s.subtract(i),d=x.dot(x)+p.dot(g);return t0.isMachineZero(d)?u:u-p.dot(x)/d},evaluate:function(t,i,u){var h=i.slice();for(var v=1;v<=t;v++)for(var f=0;f<=t-v;f++)h[f]=h[f].multiply(1-u).add(h[f+1].multiply(u));return h[0]},chordLengthParameterize:function(t,i){var u=[0];for(var h=t+1;h<=i;h++)u[h-t]=u[h-t-1]+this.points[h].getDistance(this.points[h-1]);for(var h=1,v=i-t;h<=v;h++)u[h]/=u[v];return u},findMaxError:function(t,i,u,h){var v=Math.floor((i-t+1)/2),f=0;for(var s=t+1;s<i;s++){var x=this.evaluate(3,u,h[s-t]),g=x.subtract(this.points[s]),p=g.x*g.x+g.y*g.y;if(p>=f)f=p,v=s}return{error:f,index:v}}}),i6=l0.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function t(i){this._content="",this._lines=[];var u=i&&k.isPlainObject(i)&&i.x===N&&i.y===N;this._initialize(u&&i,!u&&R.read(arguments))},_equals:function(t){return this._content===t._content},copyContent:function(t){this.setContent(t._content)},getContent:function(){return this._content},setContent:function(t){this._content=""+t,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),K0=i6.extend({_class:"PointText",initialize:function t(){i6.apply(this,arguments)},getPoint:function(){var t=this._matrix.getTranslation();return new c0(t.x,t.y,this,"setPoint")},setPoint:function(){var t=R.read(arguments);this.translate(t.subtract(this._matrix.getTranslation()))},_draw:function(t,i,u){if(!this._content)return;this._setStyles(t,i,u);var h=this._lines,v=this._style,f=v.hasFill(),s=v.hasStroke(),x=v.getLeading(),g=t.shadowColor;t.font=v.getFontStyle(),t.textAlign=v.getJustification();for(var p=0,d=h.length;p<d;p++){t.shadowColor=g;var P=h[p];if(f)t.fillText(P,0,0),t.shadowColor="rgba(0,0,0,0)";if(s)t.strokeText(P,0,0);t.translate(0,x)}},_getBounds:function(t,i){var u=this._style,h=this._lines,v=h.length,f=u.getJustification(),s=u.getLeading(),x=this.getView().getTextWidth(u.getFontStyle(),h),g=0;if(f!=="left")g-=x/(f==="center"?2:1);var p=new m0(g,v?-0.75*s:0,x,v*s);return t?t._transformBounds(p,p):p}}),U=k.extend(new function(){var t={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},i={},u={transparent:[0,0,0,0]},h;function v(x){var g=x.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||x.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),p="rgb",d;if(g){var P=g[4]?4:3;d=new Array(P);for(var r=0;r<P;r++){var l=g[r+1];d[r]=parseInt(l.length==1?l+l:l,16)/255}}else if(g=x.match(/^(rgb|hsl)a?\((.*)\)$/)){p=g[1],d=g[2].trim().split(/[,\s]+/g);var _=p==="hsl";for(var r=0,D=Math.min(d.length,4);r<D;r++){var B=d[r],l=parseFloat(B);if(_){if(r===0){var j=B.match(/([a-z]*)$/)[1];l*={turn:360,rad:180/Math.PI,grad:0.9}[j]||1}else if(r<3)l/=100}else if(r<3)l/=/%$/.test(B)?100:255;d[r]=l}}else{var o=u[x];if(!o)if(T){if(!h)h=Z0.getContext(1,1,{willReadFrequently:!0}),h.globalCompositeOperation="copy";h.fillStyle="rgba(0,0,0,0)",h.fillStyle=x,h.fillRect(0,0,1,1);var w=h.getImageData(0,0,1,1).data;o=u[x]=[w[0]/255,w[1]/255,w[2]/255]}else o=[0,0,0];d=o.slice()}return[p,d]}var f=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],s={"rgb-hsb":function(x,g,p){var d=Math.max(x,g,p),P=Math.min(x,g,p),r=d-P,l=r===0?0:(d==x?(g-p)/r+(g<p?6:0):d==g?(p-x)/r+2:(x-g)/r+4)*60;return[l,d===0?0:r/d,d]},"hsb-rgb":function(x,g,p){x=(x/60%6+6)%6;var P=Math.floor(x),d=x-P,P=f[P],r=[p,p*(1-g),p*(1-g*d),p*(1-g*(1-d))];return[r[P[0]],r[P[1]],r[P[2]]]},"rgb-hsl":function(x,g,p){var d=Math.max(x,g,p),P=Math.min(x,g,p),r=d-P,l=r===0,_=l?0:(d==x?(g-p)/r+(g<p?6:0):d==g?(p-x)/r+2:(x-g)/r+4)*60,D=(d+P)/2,B=l?0:D<0.5?r/(d+P):r/(2-d-P);return[_,B,D]},"hsl-rgb":function(x,g,p){if(x=(x/360%1+1)%1,g===0)return[p,p,p];var d=[x+0.3333333333333333,x,x-0.3333333333333333],P=p<0.5?p*(1+g):p+g-p*g,r=2*p-P,l=[];for(var _=0;_<3;_++){var D=d[_];if(D<0)D+=1;if(D>1)D-=1;l[_]=6*D<1?r+(P-r)*6*D:2*D<1?P:3*D<2?r+(P-r)*(0.6666666666666666-D)*6:r}return l},"rgb-gray":function(x,g,p){return[x*0.2989+g*0.587+p*0.114]},"gray-rgb":function(x){return[x,x,x]},"gray-hsb":function(x){return[0,0,x]},"gray-hsl":function(x){return[0,0,x]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return k.each(t,function(x,g){i[g]=[],k.each(x,function(p,d){var P=k.capitalize(p),r=/^(hue|saturation)$/.test(p),l=i[g][d]=g==="gradient"?p==="gradient"?function(_){var D=this._components[0];if(_=o0.read(Array.isArray(_)?_:arguments,0,{readNull:!0}),D!==_){if(D)D._removeOwner(this);if(_)_._addOwner(this)}return _}:function(){return R.read(arguments,0,{readNull:p==="highlight",clone:!0})}:function(_){return _==null||isNaN(_)?0:+_};this["get"+P]=function(){return this._type===g||r&&/^hs[bl]$/.test(this._type)?this._components[d]:this._convert(g)[d]},this["set"+P]=function(_){if(this._type!==g&&!(r&&/^hs[bl]$/.test(this._type)))this._components=this._convert(g),this._properties=t[g],this._type=g;this._components[d]=l.call(this,_),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function x(g){var p=arguments,d=this.__read,P=0,r,l,_,D;if(Array.isArray(g))p=g,g=p[0];var B=g!=null&&typeof g;if(B==="string"&&g in t)if(r=g,g=p[1],Array.isArray(g))l=g,_=p[2];else{if(d)P=1;p=k.slice(p,1),B=typeof g}if(!l){if(D=B==="number"?p:B==="object"&&g.length!=null?g:null,D){if(!r)r=D.length>=3?"rgb":"gray";var j=t[r].length;if(_=D[j],d)P+=D===arguments?j+(_!=null?1:0):1;if(D.length>j)D=k.slice(D,0,j)}else if(B==="string"){var o=v(g);if(r=o[0],l=o[1],l.length===4)_=l[3],l.length--}else if(B==="object")if(g.constructor===x){if(r=g._type,l=g._components.slice(),_=g._alpha,r==="gradient")for(var w=1,S=l.length;w<S;w++){var C=l[w];if(C)l[w]=C.clone()}}else if(g.constructor===o0)r="gradient",D=p;else{r="hue"in g?"lightness"in g?"hsl":"hsb":("gradient"in g)||("stops"in g)||("radial"in g)?"gradient":("gray"in g)?"gray":"rgb";var G=t[r],L=i[r];this._components=l=[];for(var w=0,S=G.length;w<S;w++){var c=g[G[w]];if(c==null&&!w&&r==="gradient"&&"stops"in g)c={stops:g.stops,radial:g.radial};if(c=L[w].call(this,c),c!=null)l[w]=c}_=g.alpha}if(d&&r)P=1}if(this._type=r||"rgb",!l){this._components=l=[];var L=i[this._type];for(var w=0,S=L.length;w<S;w++){var c=L[w].call(this,D&&D[w]);if(c!=null)l[w]=c}}if(this._components=l,this._properties=t[this._type],this._alpha=_,d)this.__read=P;return this},set:"#initialize",_serialize:function(x,g){var p=this.getComponents();return k.serialize(/^(gray|rgb)$/.test(this._type)?p:[this._type].concat(p),x,!0,g)},_changed:function(){if(this._canvasStyle=null,this._owner)if(this._setter)this._owner[this._setter](this);else this._owner._changed(129)},_convert:function(x){var g;return this._type===x?this._components.slice():(g=s[this._type+"-"+x])?g.apply(this,this._components):s["rgb-"+x].apply(this,s[this._type+"-rgb"].apply(this,this._components))},convert:function(x){return new U(x,this._convert(x),this._alpha)},getType:function(){return this._type},setType:function(x){this._components=this._convert(x),this._properties=t[x],this._type=x},getComponents:function(){var x=this._components.slice();if(this._alpha!=null)x.push(this._alpha);return x},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(x){this._alpha=x==null?null:Math.min(Math.max(x,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(x){var g=k.isPlainValue(x,!0)?U.read(arguments):x;return g===this||g&&this._class===g._class&&this._type===g._type&&this.getAlpha()===g.getAlpha()&&k.equals(this._components,g._components)||!1},toString:function(){var x=this._properties,g=[],p=this._type==="gradient",d=y0.instance;for(var P=0,r=x.length;P<r;P++){var l=this._components[P];if(l!=null)g.push(x[P]+": "+(p?l:d.number(l)))}if(this._alpha!=null)g.push("alpha: "+d.number(this._alpha));return"{ "+g.join(", ")+" }"},toCSS:function(x){var g=this._convert("rgb"),p=x||this._alpha==null?1:this._alpha;function d(P){return Math.round((P<0?0:P>1?1:P)*255)}if(g=[d(g[0]),d(g[1]),d(g[2])],p<1)g.push(p<0?0:p);return x?"#"+((1<<24)+(g[0]<<16)+(g[1]<<8)+g[2]).toString(16).slice(1):(g.length==4?"rgba(":"rgb(")+g.join(",")+")"},toCanvasStyle:function(x,g){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var p=this._components,d=p[0],P=d._stops,r=p[1],l=p[2],_=p[3],D=g&&g.inverted(),B;if(D){if(r=D._transformPoint(r),l=D._transformPoint(l),_)_=D._transformPoint(_)}if(d._radial){var j=l.getDistance(r);if(_){var o=_.subtract(r);if(o.getLength()>j)_=r.add(o.normalize(j-0.1))}var w=_||r;B=x.createRadialGradient(w.x,w.y,0,r.x,r.y,j)}else B=x.createLinearGradient(r.x,r.y,l.x,l.y);for(var S=0,C=P.length;S<C;S++){var G=P[S],L=G._offset;B.addColorStop(L==null?S/(C-1):L,G._color.toCanvasStyle())}return this._canvasStyle=B},transform:function(x){if(this._type==="gradient"){var g=this._components;for(var p=1,d=g.length;p<d;p++){var P=g[p];x._transformPoint(P,P,!0)}this._changed()}},statics:{_types:t,random:function(){var x=Math.random;return new U(x(),x(),x())},_setOwner:function(x,g,p){if(x){if(x._owner&&g&&x._owner!==g)x=x.clone();if(!x._owner^!g)x._owner=g||null,x._setter=p||null}return x}}})},new function(){var t={add:function(i,u){return i+u},subtract:function(i,u){return i-u},multiply:function(i,u){return i*u},divide:function(i,u){return i/u}};return k.each(t,function(i,u){this[u]=function(h){h=U.read(arguments);var v=this._type,f=this._components,s=h._convert(v);for(var x=0,g=f.length;x<g;x++)s[x]=i(f[x],s[x]);return new U(v,s,this._alpha!=null?i(this._alpha,h.getAlpha()):null)}},{})}),o0=k.extend({_class:"Gradient",initialize:function t(i,u){if(this._id=P0.get(),i&&k.isPlainObject(i))this.set(i),i=u=null;if(this._stops==null)this.setStops(i||["white","black"]);if(this._radial==null)this.setRadial(typeof u==="string"&&u==="radial"||u||!1)},_serialize:function(t,i){return i.add(this,function(){return k.serialize([this._stops,this._radial],t,!0,i)})},_changed:function(){for(var t=0,i=this._owners&&this._owners.length;t<i;t++)this._owners[t]._changed()},_addOwner:function(t){if(!this._owners)this._owners=[];this._owners.push(t)},_removeOwner:function(t){var i=this._owners?this._owners.indexOf(t):-1;if(i!=-1){if(this._owners.splice(i,1),!this._owners.length)this._owners=N}},clone:function(){var t=[];for(var i=0,u=this._stops.length;i<u;i++)t[i]=this._stops[i].clone();return new o0(t,this._radial)},getStops:function(){return this._stops},setStops:function(t){if(t.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var i=this._stops;if(i)for(var u=0,h=i.length;u<h;u++)i[u]._owner=N;i=this._stops=R0.readList(t,0,{clone:!0});for(var u=0,h=i.length;u<h;u++)i[u]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(t){this._radial=t,this._changed()},equals:function(t){if(t===this)return!0;if(t&&this._class===t._class){var i=this._stops,u=t._stops,h=i.length;if(h===u.length){for(var v=0;v<h;v++)if(!i[v].equals(u[v]))return!1;return!0}}return!1}}),R0=k.extend({_class:"GradientStop",initialize:function t(i,u){var h=i,v=u;if(typeof i==="object"&&u===N){if(Array.isArray(i)&&typeof i[0]!=="number")h=i[0],v=i[1];else if("color"in i||"offset"in i||"rampPoint"in i)h=i.color,v=i.offset||i.rampPoint||0}this.setColor(h),this.setOffset(v)},clone:function(){return new R0(this._color.clone(),this._offset)},_serialize:function(t,i){var u=this._color,h=this._offset;return k.serialize(h==null?[u]:[u,h],t,!0,i)},_changed:function(){if(this._owner)this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(t){this._offset=t,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){U._setOwner(this._color,null),this._color=U._setOwner(U.read(arguments,0),this,"setColor"),this._changed()},equals:function(t){return t===this||t&&this._class===t._class&&this._color.equals(t._color)&&this._offset==t._offset||!1}}),z0=k.extend(new function(){var t={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new R,selectedColor:null},i=k.set({},t,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),u=k.set({},i,{fillColor:new U}),h={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},v={beans:!0},f={_class:"Style",beans:!0,initialize:function s(x,g,p){if(this._values={},this._owner=g,this._project=g&&g._project||p||G0.project,this._defaults=!g||g instanceof J0?i:g instanceof i6?u:t,x)this.set(x)}};return k.each(i,function(s,x){var g=/Color$/.test(x),p=x==="shadowOffset",d=k.capitalize(x),P=h[x],r="set"+d,l="get"+d;f[r]=function(_){var D=this._owner,B=D&&D._children,j=B&&B.length>0&&!(D instanceof T0);if(j)for(var o=0,w=B.length;o<w;o++)B[o]._style[r](_);if((x==="selectedColor"||!j)&&x in this._defaults){var S=this._values[x];if(S!==_){if(g){if(S)U._setOwner(S,null),S._canvasStyle=null;if(_&&_.constructor===U)_=U._setOwner(_,D,j&&r)}if(this._values[x]=_,D)D._changed(P||129)}}},f[l]=function(_){var D=this._owner,B=D&&D._children,j=B&&B.length>0&&!(D instanceof T0),o;if(j&&!_)for(var w=0,S=B.length;w<S;w++){var C=B[w]._style[l]();if(!w)o=C;else if(!k.equals(o,C))return N}else if(x in this._defaults){var o=this._values[x];if(o===N){if(o=this._defaults[x],o&&o.clone)o=o.clone()}else{var G=g?U:p?R:null;if(G&&!(o&&o.constructor===G))this._values[x]=o=G.read([o],0,{readNull:!0,clone:!0})}}if(o&&g)o=U._setOwner(o,D,j&&r);return o},v[l]=function(_){return this._style[l](_)},v[r]=function(_){this._style[r](_)}}),k.each({Font:"FontFamily",WindingRule:"FillRule"},function(s,x){var g="get"+x,p="set"+x;f[g]=v[g]="#get"+s,f[p]=v[p]="#set"+s}),l0.inject(v),f},{set:function(t){var i=t instanceof z0,u=i?t._values:t;if(u){for(var h in u)if(h in this._defaults){var v=u[h];this[h]=v&&i&&v.clone?v.clone():v}}},equals:function(t){function i(u,h,v){var f=u._values,s=h._values,x=h._defaults;for(var g in f){var p=f[g],d=s[g];if(!(v&&(g in s))&&!k.equals(p,d===N?x[g]:d))return!1}return!0}return t===this||t&&this._class===t._class&&i(this,t)&&i(t,this,!0)||!1},_dispose:function(){var t=this.getFillColor();if(t)t._canvasStyle=null;if(t=this.getStrokeColor(),t)t._canvasStyle=null;if(t=this.getShadowColor(),t)t._canvasStyle=null},hasFill:function(){var t=this.getFillColor();return!!t&&t.alpha>0},hasStroke:function(){var t=this.getStrokeColor();return!!t&&t.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var t=this.getShadowColor();return!!t&&t.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var t=this.getFontSize();return this.getFontWeight()+" "+t+(/[a-z]/i.test(t+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function t(){var i=t.base.call(this),u=this.getFontSize();if(/pt|em|%|px/.test(u))u=this.getView().getPixelSize(u);return i!=null?i:u*1.2}}),E0=new function(){function t(i,u,h,v){var f=["","webkit","moz","Moz","ms","o"],s=u[0].toUpperCase()+u.substring(1);for(var x=0;x<6;x++){var g=f[x],p=g?g+s:u;if(p in i){if(h)i[p]=v;else return i[p];break}}}return{getStyles:function(i){var u=i&&i.nodeType!==9?i.ownerDocument:i,h=u&&u.defaultView;return h&&h.getComputedStyle(i,"")},getBounds:function(i,u){var h=i.ownerDocument,v=h.body,f=h.documentElement,s;try{s=i.getBoundingClientRect()}catch(d){s={left:0,top:0,width:0,height:0}}var x=s.left-(f.clientLeft||v.clientLeft||0),g=s.top-(f.clientTop||v.clientTop||0);if(!u){var p=h.defaultView;x+=p.pageXOffset||f.scrollLeft||v.scrollLeft,g+=p.pageYOffset||f.scrollTop||v.scrollTop}return new m0(x,g,s.width,s.height)},getViewportBounds:function(i){var u=i.ownerDocument,h=u.defaultView,v=u.documentElement;return new m0(0,0,h.innerWidth||v.clientWidth,h.innerHeight||v.clientHeight)},getOffset:function(i,u){return E0.getBounds(i,u).getPoint()},getSize:function(i){return E0.getBounds(i,!0).getSize()},isInvisible:function(i){return E0.getSize(i).equals(new i0(0,0))},isInView:function(i){return!E0.isInvisible(i)&&E0.getViewportBounds(i).intersects(E0.getBounds(i,!0))},isInserted:function(i){return F.body.contains(i)},getPrefixed:function(i,u){return i&&t(i,u)},setPrefixed:function(i,u,h){if(typeof u==="object")for(var v in u)t(i,v,!0,u[v]);else t(i,u,!0,h)}}},N0={add:function(t,i){if(t)for(var u in i){var h=i[u],v=u.split(/[\s,]+/g);for(var f=0,s=v.length;f<s;f++){var x=v[f],g=t===F&&(x==="touchstart"||x==="touchmove")?{passive:!1}:!1;t.addEventListener(x,h,g)}}},remove:function(t,i){if(t)for(var u in i){var h=i[u],v=u.split(/[\s,]+/g);for(var f=0,s=v.length;f<s;f++)t.removeEventListener(v[f],h,!1)}},getPoint:function(t){var i=t.targetTouches?t.targetTouches.length?t.targetTouches[0]:t.changedTouches[0]:t;return new R(i.pageX||i.clientX+F.documentElement.scrollLeft,i.pageY||i.clientY+F.documentElement.scrollTop)},getTarget:function(t){return t.target||t.srcElement},getRelatedTarget:function(t){return t.relatedTarget||t.toElement},getOffset:function(t,i){return N0.getPoint(t).subtract(E0.getOffset(i||N0.getTarget(t)))}};N0.requestAnimationFrame=new function(){var t=E0.getPrefixed(T,"requestAnimationFrame"),i=!1,u=[],h;function v(){var f=u;u=[];for(var s=0,x=f.length;s<x;s++)f[s]();if(i=t&&u.length,i)t(v)}return function(f){if(u.push(f),t){if(!i)t(v),i=!0}else if(!h)h=setInterval(v,16.666666666666668)}};var A0=k.extend(Y,{_class:"View",initialize:function t(i,u){function h(P){return u[P]||parseInt(u.getAttribute(P),10)}function v(){var P=E0.getSize(u);return P.isNaN()||P.isZero()?new i0(h("width"),h("height")):P}var f;if(T&&u){if(this._id=u.getAttribute("id"),this._id==null)u.setAttribute("id",this._id="paper-view-"+t._id++);N0.add(u,this._viewEvents);var s="none";if(E0.setPrefixed(u.style,{userDrag:s,userSelect:s,touchCallout:s,contentZooming:s,tapHighlightColor:"rgba(0,0,0,0)"}),H.hasAttribute(u,"resize")){var x=this;N0.add(T,this._windowEvents={resize:function(){x.setViewSize(v())}})}if(f=v(),H.hasAttribute(u,"stats")&&typeof Stats!=="undefined"){this._stats=new Stats;var g=this._stats.domElement,p=g.style,d=E0.getOffset(u);p.position="absolute",p.left=d.x+"px",p.top=d.y+"px",F.body.appendChild(g)}}else f=new i0(u),u=null;if(this._project=i,this._scope=i._scope,this._element=u,!this._pixelRatio)this._pixelRatio=T&&T.devicePixelRatio||1;if(this._setElementSize(f.width,f.height),this._viewSize=f,t._views.push(this),t._viewsById[this._id]=this,(this._matrix=new B0)._owner=this,!t._focused)t._focused=this;this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!G0.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;if(A0._focused===this)A0._focused=null;A0._views.splice(A0._views.indexOf(this),1),delete A0._viewsById[this._id];var t=this._project;if(t._view===this)t._view=null;return N0.remove(this._element,this._viewEvents),N0.remove(T,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:k.each(l0._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(t){this[t]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(t){if(this._autoUpdate=t,t)this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var t=this;N0.requestAnimationFrame(function(){if(t._requested=!1,t._animate){t.requestUpdate();var i=t._element;if((!E0.getPrefixed(F,"hidden")||H.getAttribute(i,"keepalive")==="true")&&E0.isInView(i))t._handleFrame()}if(t._autoUpdate)t.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){G0=this._scope;var t=Date.now()/1000,i=this._last?t-this._last:0;if(this._last=t,this.emit("frame",new k({delta:i,time:this._time+=i,count:this._count++})),this._stats)this._stats.update()},_animateItem:function(t,i){var u=this._frameItems;if(i){if(u[t._id]={item:t,time:0,count:0},++this._frameItemCount===1)this.on("frame",this._handleFrameItems)}else if(delete u[t._id],--this._frameItemCount===0)this.off("frame",this._handleFrameItems)},_handleFrameItems:function(t){for(var i in this._frameItems){var u=this._frameItems[i];u.item.emit("frame",new k(t,{time:u.time+=t.delta,count:u.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=N},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return this._pixelRatio*72},getViewSize:function(){var t=this._viewSize;return new e0(t.width,t.height,this,"setViewSize")},setViewSize:function(){var t=i0.read(arguments),i=t.subtract(this._viewSize);if(i.isZero())return;if(this._setElementSize(t.width,t.height),this._viewSize.set(t),this._changed(),this.emit("resize",{size:t,delta:i}),this._autoUpdate)this.update()},_setElementSize:function(t,i){var u=this._element;if(u){if(u.width!==t)u.width=t;if(u.height!==i)u.height=i}},getBounds:function(){if(!this._bounds)this._bounds=this._matrix.inverted()._transformBounds(new m0(new R,this._viewSize));return this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return E0.isInView(this._element)},isInserted:function(){return E0.isInserted(this._element)},getPixelSize:function(t){var i=this._element,u;if(i){var h=i.parentNode,v=F.createElement("div");v.style.fontSize=t,h.appendChild(v),u=parseFloat(E0.getStyles(v).fontSize),h.removeChild(v)}else u=parseFloat(u);return u},getTextWidth:function(t,i){return 0}},k.each(["rotate","scale","shear","skew"],function(t){var i=t==="rotate";this[t]=function(){var u=arguments,h=(i?k:R).read(u),v=R.read(u,0,{readNull:!0});return this.transform(new B0()[t](h,v||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var t=new B0;return this.transform(t.translate.apply(t,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var t=R.read(arguments);this.translate(this.getCenter().subtract(t))},getZoom:function(){var t=this._decompose().scaling;return(t.x+t.y)/2},setZoom:function(t){this.transform(new B0().scale(t/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(t){var i=this.getRotation();if(i!=null&&t!=null)this.rotate(t-i)},getScaling:function(){var t=this._decompose().scaling;return new c0(t.x,t.y,this,"setScaling")},setScaling:function(){var t=this.getScaling(),i=R.read(arguments,0,{clone:!0,readNull:!0});if(t&&i)this.scale(i.x/t.x,i.y/t.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},transform:function(t){this._matrix.append(t)},scrollBy:function(){this.translate(R.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(R.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(R.read(arguments))},getEventPoint:function(t){return this.viewToProject(N0.getOffset(t,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(t,i){if(F&&typeof i==="string")i=F.getElementById(i);var u=T?T6:A0;return new u(t,i)}}},new function(){if(!T)return;var t,i,u=!1,h=!1;function v(z){var O=N0.getTarget(z);return O.getAttribute&&A0._viewsById[O.getAttribute("id")]}function f(){var z=A0._focused;if(!z||!z.isVisible()){for(var O=0,A=A0._views.length;O<A;O++)if((z=A0._views[O]).isVisible()){A0._focused=i=z;break}}}function s(z,O,A){z._handleMouseEvent("mousemove",O,A)}var x=T.navigator,g,p,d;if(x.pointerEnabled||x.msPointerEnabled)g="pointerdown MSPointerDown",p="pointermove MSPointerMove",d="pointerup pointercancel MSPointerUp MSPointerCancel";else if(g="touchstart",p="touchmove",d="touchend touchcancel",!(("ontouchstart"in T)&&x.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)))g+=" mousedown",p+=" mousemove",d+=" mouseup";var P={},r={mouseout:function(z){var O=A0._focused,A=N0.getRelatedTarget(z);if(O&&(!A||A.nodeName==="HTML")){var X=N0.getOffset(z,O._element),e=X.x,K=Math.abs,Q=K(e),h0=1<<25,p0=Q-h0;X.x=K(p0)<Q?p0*(e<0?-1:1):e,s(O,z,O.viewToProject(X))}},scroll:f};P[g]=function(z){var O=A0._focused=v(z);if(!u)u=!0,O._handleMouseEvent("mousedown",z)},r[p]=function(z){var O=A0._focused;if(!h){var A=v(z);if(A){if(O!==A){if(O)s(O,z);if(!t)t=O;O=A0._focused=i=A}}else if(i&&i===O){if(t&&!t.isInserted())t=null;O=A0._focused=t,t=null,f()}}if(O)s(O,z)},r[g]=function(){h=!0},r[d]=function(z){var O=A0._focused;if(O&&u)O._handleMouseEvent("mouseup",z);h=u=!1},N0.add(F,r),N0.add(T,{load:f});var l=!1,_=!1,D={doubleclick:"click",mousedrag:"mousemove"},B=!1,j,o,w,S,C,G,L,c,E;function M(z,O,A,X,e,K,Q){var h0=!1,p0;function s0(b0,v0){if(b0.responds(v0)){if(!p0)p0=new x4(v0,X,e,O||b0,K?e.subtract(K):null);if(b0.emit(v0,p0)){if(l=!0,p0.prevented)_=!0;if(p0.stopped)return h0=!0}}else{var _0=D[v0];if(_0)return s0(b0,_0)}}while(z&&z!==Q){if(s0(z,A))break;z=z._parent}return h0}function a(z,O,A,X,e,K){return z._project.removeOn(A),_=l=!1,G&&M(G,null,A,X,e,K)||O&&O!==G&&!O.isDescendant(G)&&M(O,null,A==="mousedrag"?"mousemove":A,X,e,K,G)||M(z,G||O||z,A,X,e,K)}var q={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:P,_handleMouseEvent:function(z,O,A){var X=this._itemEvents,e=X.native[z],K=z==="mousemove",Q=this._scope.tool,h0=this;function p0(j0){return X.virtual[j0]||h0.responds(j0)||Q&&Q.responds(j0)}if(K&&u&&p0("mousedrag"))z="mousedrag";if(!A)A=this.getEventPoint(O);var s0=this.getBounds().contains(A),b0=e&&s0&&h0._project.hitTest(A,{tolerance:0,fill:!0,stroke:!0}),v0=b0&&b0.item||null,_0=!1,g0={};if(g0[z.substr(5)]=!0,e&&v0!==C){if(C)M(C,null,"mouseleave",O,A);if(v0)M(v0,null,"mouseenter",O,A);C=v0}if(B^s0)M(this,null,s0?"mouseenter":"mouseleave",O,A),j=s0?this:null,_0=!0;if((s0||g0.drag)&&!A.equals(w))a(this,v0,K?z:"mousemove",O,A,w),_0=!0;if(B=s0,g0.down&&s0||g0.up&&o){if(a(this,v0,z,O,A,o),g0.down){if(E=v0===L&&Date.now()-c<300,S=L=v0,!_&&v0){var V0=v0;while(V0&&!V0.responds("mousedrag"))V0=V0._parent;if(V0)G=v0}o=A}else if(g0.up){if(!_&&v0===S)c=Date.now(),a(this,v0,E?"doubleclick":"click",O,A,o),E=!1;S=G=null}B=!1,_0=!0}if(w=A,_0&&Q)l=Q._handleMouseEvent(z,O,A,g0)||l;if(O.cancelable!==!1&&(l&&!g0.move||g0.down&&p0("mouseup")))O.preventDefault()},_handleKeyEvent:function(z,O,A,X){var e=this._scope,K=e.tool,Q;function h0(p0){if(p0.responds(z))G0=e,p0.emit(z,Q=Q||new m4(z,O,A,X))}if(this.isVisible()){if(h0(this),K&&K.responds(z))h0(K)}},_countItemEvent:function(z,O){var A=this._itemEvents,X=A.native,e=A.virtual;for(var K in q)X[K]=(X[K]||0)+(q[K][z]||0)*O;e[z]=(e[z]||0)+O},statics:{updateFocus:f,_resetState:function(){u=h=l=B=!1,t=i=j=o=w=S=C=G=L=c=E=null}}}}),T6=A0.extend({_class:"CanvasView",initialize:function t(i,u){if(!(u instanceof T.HTMLCanvasElement)){var h=i0.read(arguments,1);if(h.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+k.slice(arguments,1));u=Z0.getCanvas(h)}var v=this._context=u.getContext("2d");if(v.save(),this._pixelRatio=1,!/^off|false$/.test(H.getAttribute(u,"hidpi"))){var f=T.devicePixelRatio||1,s=E0.getPrefixed(v,"backingStorePixelRatio")||1;this._pixelRatio=f/s}A0.call(this,i,u),this._needsUpdate=!0},remove:function t(){return this._context.restore(),t.base.call(this)},_setElementSize:function t(i,u){var h=this._pixelRatio;if(t.base.call(this,i*h,u*h),h!==1){var v=this._element,f=this._context;if(!H.hasAttribute(v,"resize")){var s=v.style;s.width=i+"px",s.height=u+"px"}f.restore(),f.save(),f.scale(h,h)}},getContext:function(){return this._context},getPixelSize:function t(i){var u=G0.agent,h;if(u&&u.firefox)h=t.base.call(this,i);else{var v=this._context,f=v.font;v.font=i+" serif",h=parseFloat(v.font),v.font=f}return h},getTextWidth:function(t,i){var u=this._context,h=u.font,v=0;u.font=t;for(var f=0,s=i.length;f<s;f++)v=Math.max(v,u.measureText(i[f]).width);return u.font=h,v},update:function(){if(!this._needsUpdate)return!1;var t=this._project,i=this._context,u=this._viewSize;if(i.clearRect(0,0,u.width+1,u.height+1),t)t.draw(i,this._matrix,this._pixelRatio);return this._needsUpdate=!1,!0}}),B6=k.extend({_class:"Event",initialize:function t(i){this.event=i,this.type=i&&i.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return Z6.modifiers}}),m4=B6.extend({_class:"KeyEvent",initialize:function t(i,u,h,v){this.type=i,this.event=u,this.key=h,this.character=v},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),Z6=new function(){var t={"\t":"tab"," ":"space","\b":"backspace","\x7F":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},i={tab:"\t",space:" ",enter:"\r"},u={},h={},v,f,s=new k({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var p=G0&&G0.agent;return p&&p.mac?this.meta:this.control}}});function x(p){var d=p.key||p.keyIdentifier;return d=/^U\+/.test(d)?String.fromCharCode(parseInt(d.substr(2),16)):/^Arrow[A-Z]/.test(d)?d.substr(5):d==="Unidentified"||d===N?String.fromCharCode(p.keyCode):d,t[d]||(d.length>1?k.hyphenate(d):d.toLowerCase())}function g(p,d,P,r){var l=p?"keydown":"keyup",_=A0._focused,D;if(u[d]=p,p)h[d]=P;else delete h[d];if(d.length>1&&(D=k.camelize(d))in s){s[D]=p;var B=G0&&G0.agent;if(D==="meta"&&B&&B.mac)if(p)v={};else{for(var j in v)if(j in h)g(!1,j,v[j],r);v=null}}else if(p&&v)v[d]=P;if(_)_._handleKeyEvent(p?"keydown":"keyup",r,d,P)}return N0.add(F,{keydown:function(p){var d=x(p),P=G0&&G0.agent;if(d.length>1||P&&(P.chrome&&(p.altKey||P.mac&&p.metaKey||!P.mac&&p.ctrlKey)))g(!0,d,i[d]||(d.length>1?"":d),p);else f=d},keypress:function(p){if(f){var d=x(p),P=p.charCode,r=P>=32?String.fromCharCode(P):d.length>1?"":d;if(d!==f)d=r.toLowerCase();g(!0,d,r,p),f=null}},keyup:function(p){var d=x(p);if(d in h)g(!1,d,h[d],p)}}),N0.add(T,{blur:function(p){for(var d in h)g(!1,d,h[d],p)}}),{modifiers:s,isDown:function(p){return!!u[p]}}},x4=B6.extend({_class:"MouseEvent",initialize:function t(i,u,h,v,f){this.type=i,this.event=u,this.point=h,this.target=v,this.delta=f},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),p8=B6.extend({_class:"ToolEvent",_item:null,initialize:function t(i,u,h){this.tool=i,this.type=u,this.event=h},_choosePoint:function(t,i){return t?t:i?i.clone():null},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(t){this._point=t},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(t){this._lastPoint=t},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(t){this._downPoint=t},getMiddlePoint:function(){if(!this._middlePoint&&this.tool._lastPoint)return this.tool._point.add(this.tool._lastPoint).divide(2);return this._middlePoint},setMiddlePoint:function(t){this._middlePoint=t},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(t){this._delta=t},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(t){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=t},getItem:function(){if(!this._item){var t=this.tool._scope.project.hitTest(this.getPoint());if(t){var i=t.item,u=i._parent;while(/^(Group|CompoundPath)$/.test(u._class))i=u,u=u._parent;this._item=i}}return this._item},setItem:function(t){this._item=t},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),a7=w0.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function t(i){w0.call(this),this._moveCount=-1,this._downCount=-1,this.set(i)},getMinDistance:function(){return this._minDistance},setMinDistance:function(t){if(this._minDistance=t,t!=null&&this._maxDistance!=null&&t>this._maxDistance)this._maxDistance=t},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(t){if(this._maxDistance=t,this._minDistance!=null&&t!=null&&t<this._minDistance)this._minDistance=t},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(t){this._minDistance=this._maxDistance=t},_handleMouseEvent:function(t,i,u,h){if(G0=this._scope,h.drag&&!this.responds(t))t="mousemove";var v=h.move||h.drag,f=this.responds(t),s=this.minDistance,x=this.maxDistance,g=!1,p=this;function d(r,l){var _=u,D=v?p._point:p._downPoint||_;if(v){if(p._moveCount>=0&&_.equals(D))return!1;if(D&&(r!=null||l!=null)){var B=_.subtract(D),j=B.getLength();if(j<(r||0))return!1;if(l)_=D.add(B.normalize(Math.min(j,l)))}p._moveCount++}if(p._point=_,p._lastPoint=D||_,h.down)p._moveCount=-1,p._downPoint=_,p._downCount++;return!0}function P(){if(f)g=p.emit(t,new p8(p,t,i))||g}if(h.down)d(),P();else if(h.up)d(null,x),P();else if(f)while(d(s,x))P();return g}}),y8=k.extend(Y,{_class:"Tween",statics:{easings:new k({linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<0.5?2*t*t:-1+2*(2-t)*t},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<0.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<0.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<0.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}})},initialize:function t(i,u,h,v,f,s){this.object=i;var x=typeof f,g=x==="function";this.type=g?x:x==="string"?f:"linear",this.easing=g?f:t.easings[this.type],this.duration=v,this.running=!1,this._then=null,this._startTime=null;var p=u||h;if(this._keys=p?Object.keys(p):[],this._parsedKeys=this._parseKeys(this._keys),this._from=p&&this._getState(u),this._to=p&&this._getState(h),s!==!1)this.start()},then:function(t){return this._then=t,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(t){if(this.running){if(t>=1)t=1,this.running=!1;var i=this.easing(t),u=this._keys,h=function(d){return typeof d==="function"?d(i,t):d};for(var v=0,f=u&&u.length;v<f;v++){var s=u[v],x=h(this._from[s]),g=h(this._to[s]),p=x&&g&&x.__add&&g.__add?g.__subtract(x).__multiply(i).__add(x):(g-x)*i+x;this._setProperty(this._parsedKeys[s],p)}if(this.responds("update"))this.emit("update",new k({progress:t,factor:i}));if(!this.running&&this._then)this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(t){var i=this._startTime,u=i?(t-i)/this.duration:0;if(!i)this._startTime=t;this.update(u)},_getState:function(t){var i=this._keys,u={};for(var h=0,v=i.length;h<v;h++){var f=i[h],s=this._parsedKeys[f],x=this._getProperty(s),g;if(t){var p=this._resolveValue(x,t[f]);this._setProperty(s,p),g=this._getProperty(s),g=g&&g.clone?g.clone():g,this._setProperty(s,x)}else g=x&&x.clone?x.clone():x;u[f]=g}return u},_resolveValue:function(t,i){if(i){if(Array.isArray(i)&&i.length===2){var u=i[0];return u&&u.match&&u.match(/^[+\-\*\/]=/)?this._calculate(t,u[0],i[1]):i}else if(typeof i==="string"){var h=i.match(/^[+\-*/]=(.*)/);if(h){var v=JSON.parse(h[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(t,i[0],v)}}}return i},_calculate:function(t,i,u){return G0.PaperScript.calculateBinary(t,i,u)},_parseKeys:function(t){var i={};for(var u=0,h=t.length;u<h;u++){var v=t[u],f=v.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");i[v]=f.split("/")}return i},_getProperty:function(t,i){var u=this.object;for(var h=0,v=t.length-(i||0);h<v&&u;h++)u=u[t[h]];return u},_setProperty:function(t,i){var u=this._getProperty(t,1);if(u)u[t[t.length-1]]=i}}),w8={request:function(t){var i=new V.XMLHttpRequest;if(i.open((t.method||"get").toUpperCase(),t.url,k.pick(t.async,!0)),t.mimeType)i.overrideMimeType(t.mimeType);return i.onload=function(){var u=i.status;if(u===0||u===200){if(t.onLoad)t.onLoad.call(i,i.responseText)}else i.onerror()},i.onerror=function(){var u=i.status,h='Could not load "'+t.url+'" (Status: '+u+")";if(t.onError)t.onError(h,u);else throw new Error(h)},i.send(null)}},Z0=k.exports.CanvasProvider={canvases:[],getCanvas:function(t,i,u){if(!T)return null;var h,v=!0;if(typeof t==="object")i=t.height,t=t.width;if(this.canvases.length)h=this.canvases.pop();else h=F.createElement("canvas"),v=!1;var f=h.getContext("2d",u||{});if(!f)throw new Error("Canvas "+h+" is unable to provide a 2D context.");if(h.width===t&&h.height===i){if(v)f.clearRect(0,0,t+1,i+1)}else h.width=t,h.height=i;return f.save(),h},getContext:function(t,i,u){var h=this.getCanvas(t,i,u);return h?h.getContext("2d",u||{}):null},release:function(t){var i=t&&t.canvas?t.canvas:t;if(i&&i.getContext)i.getContext("2d").restore(),this.canvases.push(i)}},j4=new function(){var{min:t,max:i,abs:u}=Math,h,v,f,s,x,g,p,d,P,r,l;function _(C,G,L){return 0.2989*C+0.587*G+0.114*L}function D(C,G,L,M){var E=M-_(C,G,L);P=C+E,r=G+E,l=L+E;var M=_(P,r,l),a=t(P,r,l),q=i(P,r,l);if(a<0){var z=M-a;P=M+(P-M)*M/z,r=M+(r-M)*M/z,l=M+(l-M)*M/z}if(q>255){var O=255-M,A=q-M;P=M+(P-M)*O/A,r=M+(r-M)*O/A,l=M+(l-M)*O/A}}function B(C,G,L){return i(C,G,L)-t(C,G,L)}function j(C,G,L,c){var E=[C,G,L],M=i(C,G,L),a=t(C,G,L),q;if(a=a===C?0:a===G?1:2,M=M===C?0:M===G?1:2,q=t(a,M)===0?i(a,M)===1?2:1:0,E[M]>E[a])E[q]=(E[q]-E[a])*c/(E[M]-E[a]),E[M]=c;else E[q]=E[M]=0;E[a]=0,P=E[0],r=E[1],l=E[2]}var o={multiply:function(){P=x*h/255,r=g*v/255,l=p*f/255},screen:function(){P=x+h-x*h/255,r=g+v-g*v/255,l=p+f-p*f/255},overlay:function(){P=x<128?2*x*h/255:255-2*(255-x)*(255-h)/255,r=g<128?2*g*v/255:255-2*(255-g)*(255-v)/255,l=p<128?2*p*f/255:255-2*(255-p)*(255-f)/255},"soft-light":function(){var C=h*x/255;P=C+x*(255-(255-x)*(255-h)/255-C)/255,C=v*g/255,r=C+g*(255-(255-g)*(255-v)/255-C)/255,C=f*p/255,l=C+p*(255-(255-p)*(255-f)/255-C)/255},"hard-light":function(){P=h<128?2*h*x/255:255-2*(255-h)*(255-x)/255,r=v<128?2*v*g/255:255-2*(255-v)*(255-g)/255,l=f<128?2*f*p/255:255-2*(255-f)*(255-p)/255},"color-dodge":function(){P=x===0?0:h===255?255:t(255,255*x/(255-h)),r=g===0?0:v===255?255:t(255,255*g/(255-v)),l=p===0?0:f===255?255:t(255,255*p/(255-f))},"color-burn":function(){P=x===255?255:h===0?0:i(0,255-(255-x)*255/h),r=g===255?255:v===0?0:i(0,255-(255-g)*255/v),l=p===255?255:f===0?0:i(0,255-(255-p)*255/f)},darken:function(){P=x<h?x:h,r=g<v?g:v,l=p<f?p:f},lighten:function(){P=x>h?x:h,r=g>v?g:v,l=p>f?p:f},difference:function(){if(P=x-h,P<0)P=-P;if(r=g-v,r<0)r=-r;if(l=p-f,l<0)l=-l},exclusion:function(){P=x+h*(255-x-x)/255,r=g+v*(255-g-g)/255,l=p+f*(255-p-p)/255},hue:function(){j(h,v,f,B(x,g,p)),D(P,r,l,_(x,g,p))},saturation:function(){j(x,g,p,B(h,v,f)),D(P,r,l,_(x,g,p))},luminosity:function(){D(x,g,p,_(h,v,f))},color:function(){D(h,v,f,_(x,g,p))},add:function(){P=t(x+h,255),r=t(g+v,255),l=t(p+f,255)},subtract:function(){P=i(x-h,0),r=i(g-v,0),l=i(p-f,0)},average:function(){P=(x+h)/2,r=(g+v)/2,l=(p+f)/2},negation:function(){P=255-u(255-h-x),r=255-u(255-v-g),l=255-u(255-f-p)}},w=this.nativeModes=k.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(C){this[C]=!0},{}),S=Z0.getContext(1,1,{willReadFrequently:!0});if(S)k.each(o,function(C,G){var L=G==="darken",c=!1;S.save();try{if(S.fillStyle=L?"#300":"#a00",S.fillRect(0,0,1,1),S.globalCompositeOperation=G,S.globalCompositeOperation===G)S.fillStyle=L?"#a00":"#300",S.fillRect(0,0,1,1),c=S.getImageData(0,0,1,1).data[0]!==L?170:51}catch(E){}S.restore(),w[G]=c}),Z0.release(S);this.process=function(C,G,L,c,E){var M=G.canvas,a=C==="normal";if(a||w[C]){if(L.save(),L.setTransform(1,0,0,1,0,0),L.globalAlpha=c,!a)L.globalCompositeOperation=C;L.drawImage(M,E.x,E.y),L.restore()}else{var q=o[C];if(!q)return;var z=L.getImageData(E.x,E.y,M.width,M.height),O=z.data,A=G.getImageData(0,0,M.width,M.height).data;for(var X=0,e=O.length;X<e;X+=4){h=A[X],x=O[X],v=A[X+1],g=O[X+1],f=A[X+2],p=O[X+2],s=A[X+3],d=O[X+3],q();var K=s*c/255,Q=1-K;O[X]=K*P+Q*x,O[X+1]=K*r+Q*g,O[X+2]=K*l+Q*p,O[X+3]=s*c+Q*d}L.putImageData(z,E.x,E.y)}}},H0=new function(){var t="http://www.w3.org/2000/svg",i="http://www.w3.org/2000/xmlns",u="http://www.w3.org/1999/xlink",h={href:u,xlink:i,xmlns:i+"/","xmlns:xlink":i+"/"};function v(x,g,p){return s(F.createElementNS(t,x),g,p)}function f(x,g){var p=h[g],d=p?x.getAttributeNS(p,g):x.getAttribute(g);return d==="null"?null:d}function s(x,g,p){for(var d in g){var P=g[d],r=h[d];if(typeof P==="number"&&p)P=p.number(P);if(r)x.setAttributeNS(r,d,P);else x.setAttribute(d,P)}return x}return{svg:t,xmlns:i,xlink:u,create:v,get:f,set:s}},H4=k.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(t,i){return!i&&(t instanceof t6||t instanceof n0||t instanceof i6)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(t,i){var u=k.capitalize(i),h=t[2];this[i]={type:t[1],property:i,attribute:t[0],toSVG:h,fromSVG:h&&k.each(h,function(v,f){this[v]=f},{}),exportFilter:t[3],get:"get"+u,set:"set"+u}},{});new function(){var t;function i(o,w,S){var C=new k,G=o.getTranslation();if(w){var L;if(o.isInvertible())o=o._shiftless(),L=o._inverseTransform(G),G=null;else L=new R;C[S?"cx":"x"]=L.x,C[S?"cy":"y"]=L.y}if(!o.isIdentity()){var c=o.decompose();if(c){var E=[],M=c.rotation,a=c.scaling,q=c.skewing;if(G&&!G.isZero())E.push("translate("+t.point(G)+")");if(M)E.push("rotate("+t.number(M)+")");if(!t0.isZero(a.x-1)||!t0.isZero(a.y-1))E.push("scale("+t.point(a)+")");if(q.x)E.push("skewX("+t.number(q.x)+")");if(q.y)E.push("skewY("+t.number(q.y)+")");C.transform=E.join(" ")}else C.transform="matrix("+o.getValues().join(",")+")"}return C}function u(o,w){var S=i(o._matrix),C=o._children,G=H0.create("g",S,t);for(var L=0,c=C.length;L<c;L++){var E=C[L],M=B(E,w);if(M)if(E.isClipMask()){var a=H0.create("clipPath");a.appendChild(M),_(E,a,"clip"),H0.set(G,{"clip-path":"url(#"+a.id+")"})}else G.appendChild(M)}return G}function h(o,w){var S=i(o._matrix,!0),C=o.getSize(),G=o.getImage();return S.x-=C.width/2,S.y-=C.height/2,S.width=C.width,S.height=C.height,S.href=w.embedImages==!1&&G&&G.src||o.toDataURL(),H0.create("image",S,t)}function v(o,w){var S=w.matchShapes;if(S){var C=o.toShape(!1);if(C)return f(C,w)}var G=o._segments,L=G.length,c,E=i(o._matrix);if(S&&L>=2&&!o.hasHandles())if(L>2){c=o._closed?"polygon":"polyline";var M=[];for(var a=0;a<L;a++)M.push(t.point(G[a]._point));E.points=M.join(" ")}else{c="line";var q=G[0]._point,z=G[1]._point;E.set({x1:q.x,y1:q.y,x2:z.x,y2:z.y})}else c="path",E.d=o.getPathData(null,w.precision);return H0.create(c,E,t)}function f(o){var{_type:w,_radius:S}=o,C=i(o._matrix,!0,w!=="rectangle");if(w==="rectangle"){w="rect";var G=o._size,L=G.width,c=G.height;if(C.x-=L/2,C.y-=c/2,C.width=L,C.height=c,S.isZero())S=null}if(S)if(w==="circle")C.r=S;else C.rx=S.width,C.ry=S.height;return H0.create(w,C,t)}function s(o,w){var S=i(o._matrix),C=o.getPathData(null,w.precision);if(C)S.d=C;return H0.create("path",S,t)}function x(o,w){var S=i(o._matrix,!0),C=o._definition,G=l(C,"symbol"),L=C._item,c=L.getStrokeBounds();if(!G)G=H0.create("symbol",{viewBox:t.rectangle(c)}),G.appendChild(B(L,w)),_(C,G,"symbol");return S.href="#"+G.id,S.x+=c.x,S.y+=c.y,S.width=c.width,S.height=c.height,S.overflow="visible",H0.create("use",S,t)}function g(o){var w=l(o,"color");if(!w){var S=o.getGradient(),C=S._radial,G=o.getOrigin(),L=o.getDestination(),c;if(C){c={cx:G.x,cy:G.y,r:G.getDistance(L)};var E=o.getHighlight();if(E)c.fx=E.x,c.fy=E.y}else c={x1:G.x,y1:G.y,x2:L.x,y2:L.y};c.gradientUnits="userSpaceOnUse",w=H0.create((C?"radial":"linear")+"Gradient",c,t);var M=S._stops;for(var a=0,q=M.length;a<q;a++){var z=M[a],O=z._color,A=O.getAlpha(),X=z._offset;if(c={offset:X==null?a/(q-1):X},O)c["stop-color"]=O.toCSS(!0);if(A<1)c["stop-opacity"]=A;w.appendChild(H0.create("stop",c,t))}_(o,w,"color")}return"url(#"+w.id+")"}function p(o){var w=H0.create("text",i(o._matrix,!0),t);return w.textContent=o._content,w}var d={Group:u,Layer:u,Raster:h,Path:v,Shape:f,CompoundPath:s,SymbolItem:x,PointText:p};function P(o,w,S){var C={},G=!S&&o.getParent(),L=[];if(o._name!=null)C.id=o._name;if(k.each(H4,function(c){var{get:E,type:M}=c,a=o[E]();if(c.exportFilter?c.exportFilter(o,a):!G||!k.equals(G[E](),a)){if(M==="color"&&a!=null){var q=a.getAlpha();if(q<1)C[c.attribute+"-opacity"]=q}if(M==="style")L.push(c.attribute+": "+a);else C[c.attribute]=a==null?"none":M==="color"?a.gradient?g(a,o):a.toCSS(!0):M==="array"?a.join(","):M==="lookup"?c.toSVG[a]:a}}),L.length)C.style=L.join(";");if(C.opacity===1)delete C.opacity;if(!o._visible)C.visibility="hidden";return H0.set(w,C,t)}var r;function l(o,w){if(!r)r={ids:{},svgs:{}};return o&&r.svgs[w+"-"+(o._id||o.__id||(o.__id=P0.get("svg")))]}function _(o,w,S){if(!r)l();var C=r.ids[S]=(r.ids[S]||0)+1;w.id=S+"-"+C,r.svgs[S+"-"+(o._id||o.__id)]=w}function D(o,w){var S=o,C=null;if(r){S=o.nodeName.toLowerCase()==="svg"&&o;for(var G in r.svgs){if(!C){if(!S)S=H0.create("svg"),S.appendChild(o);C=S.insertBefore(H0.create("defs"),S.firstChild)}C.appendChild(r.svgs[G])}r=null}return w.asString?new V.XMLSerializer().serializeToString(S):S}function B(o,w,S){var C=d[o._class],G=C&&C(o,w);if(G){var L=w.onExport;if(L)G=L(o,G,w)||G;var c=JSON.stringify(o._data);if(c&&c!=="{}"&&c!=="null")G.setAttribute("data-paper-data",c)}return G&&P(o,G,S)}function j(o){if(!o)o={};return t=new y0(o.precision),o}l0.inject({exportSVG:function(o){return o=j(o),D(B(this,o,!0),o)}}),b6.inject({exportSVG:function(o){o=j(o);var w=this._children,S=this.getView(),C=k.pick(o.bounds,"view"),G=o.matrix||C==="view"&&S._matrix,L=G&&B0.read([G]),c=C==="view"?new m0([0,0],S.getViewSize()):C==="content"?l0._getBounds(w,L,{stroke:!0}).rect:m0.read([C],0,{readNull:!0}),E={version:"1.1",xmlns:H0.svg,"xmlns:xlink":H0.xlink};if(c){if(E.width=c.width,E.height=c.height,c.x||c.x===0||c.y||c.y===0)E.viewBox=t.rectangle(c)}var M=H0.create("svg",E,t),a=M;if(L&&!L.isIdentity())a=M.appendChild(H0.create("g",i(L),t));for(var q=0,z=w.length;q<z;q++)a.appendChild(B(w[q],o,!0));return D(M,o)}})},new function(){var t={},i;function u(w,S,C,G,L,c){var E=H0.get(w,S)||c,M=E==null?G?null:C?"":0:C?E:parseFloat(E);return/%\s*$/.test(E)?M/100*(L?1:i[/x|^width/.test(S)?"width":"height"]):M}function h(w,S,C,G,L,c,E){return S=u(w,S||"x",!1,G,L,c),C=u(w,C||"y",!1,G,L,E),G&&(S==null||C==null)?null:new R(S,C)}function v(w,S,C,G,L){return S=u(w,S||"width",!1,G,L),C=u(w,C||"height",!1,G,L),G&&(S==null||C==null)?null:new i0(S,C)}function f(w,S,C){return w==="none"?null:S==="number"?parseFloat(w):S==="array"?w?w.split(/[\s,]+/g).map(parseFloat):[]:S==="color"?B(w)||w:S==="lookup"?C[w]:w}function s(w,S,C,G){var L=w.childNodes,c=S==="clippath",E=S==="defs",M=new J0,a=M._project,q=a._currentStyle,z=[];if(!c&&!E)M=D(M,w,G),a._currentStyle=M._style.clone();if(G){var O=w.querySelectorAll("defs");for(var A=0,X=O.length;A<X;A++)j(O[A],C,!1)}for(var A=0,X=L.length;A<X;A++){var e=L[A],K;if(e.nodeType===1&&!/^defs$/i.test(e.nodeName)&&(K=j(e,C,!1))&&!(K instanceof Z))z.push(K)}if(M.addChildren(z),c)M=D(M.reduce(),w,G);if(a._currentStyle=q,c||E)M.remove(),M=null;return M}function x(w,S){var C=w.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),G=[];for(var L=0,c=C.length;L<c;L+=2)G.push(new R(parseFloat(C[L]),parseFloat(C[L+1])));var E=new d0(G);if(S==="polygon")E.closePath();return E}function g(w){return t6.create(w.getAttribute("d"))}function p(w,S){var C=(u(w,"href",!0)||"").substring(1),G=S==="radialgradient",L;if(C){if(L=t[C].getGradient(),L._radial^G)L=L.clone(),L._radial=G}else{var c=w.childNodes,E=[];for(var M=0,a=c.length;M<a;M++){var q=c[M];if(q.nodeType===1)E.push(D(new R0,q))}L=new o0(E,G)}var z,O,A,X=u(w,"gradientUnits",!0)!=="userSpaceOnUse";if(G)z=h(w,"cx","cy",!1,X,"50%","50%"),O=z.add(u(w,"r",!1,!1,X,"50%"),0),A=h(w,"fx","fy",!0,X);else z=h(w,"x1","y1",!1,X,"0%","0%"),O=h(w,"x2","y2",!1,X,"100%","0%");var e=D(new U(L,z,O,A),w);return e._scaleToBounds=X,null}var d={"#document":function(w,S,C,G){var L=w.childNodes;for(var c=0,E=L.length;c<E;c++){var M=L[c];if(M.nodeType===1)return j(M,C,G)}},g:s,svg:s,clippath:s,polygon:x,polyline:x,path:g,lineargradient:p,radialgradient:p,image:function(w){var S=new $(u(w,"href",!0));return S.on("load",function(){var C=v(w);this.setSize(C);var G=h(w).add(C.divide(2));this._matrix.append(new B0().translate(G))}),S},symbol:function(w,S,C,G){return new Z(s(w,S,C,G),!0)},defs:s,use:function(w){var S=(u(w,"href",!0)||"").substring(1),C=t[S],G=h(w);return C?C instanceof Z?C.place(G):C.clone().translate(G):null},circle:function(w){return new n0.Circle(h(w,"cx","cy"),u(w,"r"))},ellipse:function(w){return new n0.Ellipse({center:h(w,"cx","cy"),radius:v(w,"rx","ry")})},rect:function(w){return new n0.Rectangle(new m0(h(w),v(w)),v(w,"rx","ry"))},line:function(w){return new d0.Line(h(w,"x1","y1"),h(w,"x2","y2"))},text:function(w){var S=new K0(h(w).add(h(w,"dx","dy")));return S.setContent(w.textContent.trim()||""),S},switch:s};function P(w,S,C,G){if(w.transform){var L=(G.getAttribute(C)||"").split(/\)\s*/g),c=new B0;for(var E=0,M=L.length;E<M;E++){var a=L[E];if(!a)break;var q=a.split(/\(\s*/),z=q[0],O=q[1].split(/[\s,]+/g);for(var A=0,X=O.length;A<X;A++)O[A]=parseFloat(O[A]);switch(z){case"matrix":c.append(new B0(O[0],O[1],O[2],O[3],O[4],O[5]));break;case"rotate":c.rotate(O[0],O[1]||0,O[2]||0);break;case"translate":c.translate(O[0],O[1]||0);break;case"scale":c.scale(O);break;case"skewX":c.skew(O[0],0);break;case"skewY":c.skew(0,O[0]);break}}w.transform(c)}}function r(w,S,C){var G=C==="fill-opacity"?"getFillColor":"getStrokeColor",L=w[G]&&w[G]();if(L)L.setAlpha(parseFloat(S))}var l=k.set(k.each(H4,function(w){this[w.attribute]=function(S,C){if(S[w.set]){if(S[w.set](f(C,w.type,w.fromSVG)),w.type==="color"){var G=S[w.get]();if(G){if(G._scaleToBounds){var L=S.getBounds();G.transform(new B0().translate(L.getPoint()).scale(L.getSize()))}}}}}},{}),{id:function(w,S){if(t[S]=w,w.setName)w.setName(S)},"clip-path":function(w,S){var C=B(S);if(C)if(C=C.clone(),C.setClipMask(!0),w instanceof J0)w.insertChild(0,C);else return new J0(C,w)},gradientTransform:P,transform:P,"fill-opacity":r,"stroke-opacity":r,visibility:function(w,S){if(w.setVisible)w.setVisible(S==="visible")},display:function(w,S){if(w.setVisible)w.setVisible(S!==null)},"stop-color":function(w,S){if(w.setColor)w.setColor(S)},"stop-opacity":function(w,S){if(w._color)w._color.setAlpha(parseFloat(S))},offset:function(w,S){if(w.setOffset){var C=S.match(/(.*)%$/);w.setOffset(C?C[1]/100:parseFloat(S))}},viewBox:function(w,S,C,G,L){var c=new m0(f(S,"array")),E=v(G,null,null,!0),M,a;if(w instanceof J0){var q=E?E.divide(c.getSize()):1,a=new B0().scale(q).translate(c.getPoint().negate());M=w}else if(w instanceof Z){if(E)c.setSize(E);M=w._item}if(M){if(_(G,"overflow",L)!=="visible"){var z=new n0.Rectangle(c);z.setClipMask(!0),M.addChild(z)}if(a)M.transform(a)}}});function _(w,S,C){var G=w.attributes[S],L=G&&G.value;if(!L&&w.style){var c=k.camelize(S);if(L=w.style[c],!L&&C.node[c]!==C.parent[c])L=C.node[c]}return!L?N:L==="none"?null:L}function D(w,S,C){var G=S.parentNode,L={node:E0.getStyles(S)||{},parent:!C&&!/^defs$/i.test(G.tagName)&&E0.getStyles(G)||{}};return k.each(l,function(c,E){var M=_(S,E,L);w=M!==N&&c(w,M,E,S,L)||w}),w}function B(w){var S=w&&w.match(/\((?:["'#]*)([^"')]+)/),C=S&&S[1],G=C&&t[T?C.replace(T.location.href.split("#")[0]+"#",""):C];if(G&&G._scaleToBounds)G=G.clone(),G._scaleToBounds=!0;return G}function j(w,S,C){var G=w.nodeName.toLowerCase(),L=G!=="#document",c=F.body,E,M,a;if(C&&L)i=G0.getView().getSize(),i=v(w,null,null,!0)||i,E=H0.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),M=w.parentNode,a=w.nextSibling,E.appendChild(w),c.appendChild(E);var q=G0.settings,z=q.applyMatrix,O=q.insertItems;q.applyMatrix=!1,q.insertItems=!1;var A=d[G],X=A&&A(w,G,S,C)||null;if(q.insertItems=O,q.applyMatrix=z,X){if(L&&!(X instanceof J0))X=D(X,w,C);var e=S.onImport,K=L&&w.getAttribute("data-paper-data");if(e)X=e(w,X,S)||X;if(S.expandShapes&&X instanceof n0)X.remove(),X=X.toPath();if(K)X._data=JSON.parse(K)}if(E){if(c.removeChild(E),M)if(a)M.insertBefore(w,a);else M.appendChild(w)}if(C){if(t={},X&&k.pick(S.applyMatrix,z))X.matrix.apply(!0,!0)}return X}function o(w,S,C){if(!w)return null;S=typeof S==="function"?{onLoad:S}:S||{};var G=G0,L=null;function c(q){try{var z=typeof q==="object"?q:new V.DOMParser().parseFromString(q.trim(),"image/svg+xml");if(!z.nodeName)throw z=null,new Error("Unsupported SVG source: "+w);if(G0=G,L=j(z,S,!0),!S||S.insert!==!1)C._insertItem(N,L);var O=S.onLoad;if(O)O(L,q)}catch(A){E(A)}}function E(q,z){var O=S.onError;if(O)O(q,z);else throw new Error(q)}if(typeof w==="string"&&!/^[\s\S]*</.test(w)){var M=F.getElementById(w);if(M)c(M);else w8.request({url:w,async:!0,onLoad:c,onError:E})}else if(typeof File!=="undefined"&&w instanceof File){var a=new FileReader;return a.onload=function(){c(a.result)},a.onerror=function(){E(a.error)},a.readAsText(w)}else c(w);return L}l0.inject({importSVG:function(w,S){return o(w,S,this)}}),b6.inject({importSVG:function(w,S){return this.activate(),o(w,S,this)}})};var G0=new(H.inject(k.exports,{Base:k,Numerical:t0,Key:Z6,DomEvent:N0,DomElement:E0,document:F,window:T,Symbol:Z,PlacedSymbol:u0}));if(G0.agent.node)(()=>({}))(G0);if(typeof define==="function"&&define.amd)define("paper",G0);else if(typeof m==="object"&&m)m.exports=G0;return G0}.call(n,typeof self==="object"?self:null)}),R3=E4(N4(),1),V4=E4(N4(),1),b=new y6.Generator("JavaScript");b.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(globalThis).join(","));b.ORDER_ATOMIC=0;b.ORDER_NEW=1.1;b.ORDER_MEMBER=1.2;b.ORDER_FUNCTION_CALL=2;b.ORDER_INCREMENT=3;b.ORDER_DECREMENT=3;b.ORDER_BITWISE_NOT=4.1;b.ORDER_UNARY_PLUS=4.2;b.ORDER_UNARY_NEGATION=4.3;b.ORDER_LOGICAL_NOT=4.4;b.ORDER_TYPEOF=4.5;b.ORDER_VOID=4.6;b.ORDER_DELETE=4.7;b.ORDER_DIVISION=5.1;b.ORDER_MULTIPLICATION=5.2;b.ORDER_MODULUS=5.3;b.ORDER_SUBTRACTION=6.1;b.ORDER_ADDITION=6.2;b.ORDER_BITWISE_SHIFT=7;b.ORDER_RELATIONAL=8;b.ORDER_IN=8;b.ORDER_INSTANCEOF=8;b.ORDER_EQUALITY=9;b.ORDER_BITWISE_AND=10;b.ORDER_BITWISE_XOR=11;b.ORDER_BITWISE_OR=12;b.ORDER_LOGICAL_AND=13;b.ORDER_LOGICAL_OR=14;b.ORDER_CONDITIONAL=15;b.ORDER_ASSIGNMENT=16;b.ORDER_COMMA=17;b.ORDER_NONE=99;b.ORDER_OVERRIDES=[[b.ORDER_FUNCTION_CALL,b.ORDER_MEMBER],[b.ORDER_FUNCTION_CALL,b.ORDER_FUNCTION_CALL],[b.ORDER_MEMBER,b.ORDER_MEMBER],[b.ORDER_MEMBER,b.ORDER_FUNCTION_CALL],[b.ORDER_LOGICAL_NOT,b.ORDER_LOGICAL_NOT],[b.ORDER_MULTIPLICATION,b.ORDER_MULTIPLICATION],[b.ORDER_ADDITION,b.ORDER_ADDITION],[b.ORDER_LOGICAL_AND,b.ORDER_LOGICAL_AND],[b.ORDER_LOGICAL_OR,b.ORDER_LOGICAL_OR]];b.init=function(n){if(b.definitions_=Object.create(null),b.functionNames_=Object.create(null),!b.variableDB_)b.variableDB_=new y6.Names(b.RESERVED_WORDS_);else b.variableDB_.reset();b.variableDB_.setVariableMap(n.getVariableMap());var m=[],y=n.getAllVariables();for(var V=0;V<y.length;V++){if(y[V].type===y6.BROADCAST_MESSAGE_VARIABLE_TYPE)continue;const T=b.variableDB_.getName(y[V].getId(),y6.Variables.NAME_TYPE);if(y[V].type===y6.LIST_VARIABLE_TYPE)m.push(`let ${T}${y6.LIST_VARIABLE_TYPE} = [];`);else m.push(`let ${T} = 0;`)}var N=y6.Variables.allDeveloperVariables(n);for(var V=0;V<N.length;V++){const F=b.variableDB_.getName(N[V],y6.Names.DEVELOPER_VARIABLE_TYPE);if(y[V].type===y6.LIST_VARIABLE_TYPE)m.push(`let ${F}${y6.LIST_VARIABLE_TYPE} = [];`);else m.push(`let ${F} = 0;`)}if(m.length)b.definitions_.variables=m.join("\n")};b.finish=function(n){var m=[];for(var y in b.definitions_)m.push(b.definitions_[y]);return delete b.definitions_,delete b.functionNames_,b.variableDB_.reset(),m.join("\n\n")+"\n\n\n"+n};b.scrubNakedValue=function(n){return n+";\n"};b.quote_=function(n){return n=n.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"),"'"+n+"'"};b.HAT_CODE="/* HatCode */";b.scrub_=function(n,m){var y="";if(!n.outputConnection?.targetConnection){var V=n.getCommentText();if(V=y6.utils.wrap(V,b.COMMENT_WRAP-3),V)if(n.getProcedureDef)y+="/**\n"+b.prefixLines(V+"\n"," * ")+" */\n";else y+=b.prefixLines(V+"\n","// ");for(var N=0;N<n.inputList.length;N++)if(n.inputList[N].type==y6.INPUT_VALUE){var T=n.inputList[N].connection.targetBlock();if(T){var V=b.allNestedComments(T);if(V)y+=b.prefixLines(V,"// ")}}}if(n.startHat_){const F=n.nextConnection&&n.nextConnection.targetBlock();let k=b.blockToCode(F);if(k)k=b.prefixLines(k,b.INDENT),m=m.replace(b.HAT_CODE,k);return y+m}if(n.parentBlock_){const F=n.nextConnection&&n.nextConnection.targetBlock(),k=b.blockToCode(F);return y+m+k}return""};b.getAdjusted=function(n,m,y,V,N){var T=y||0,F=N||b.ORDER_NONE;if(n.workspace.options.oneBasedIndex)T--;var k=n.workspace.options.oneBasedIndex?"1":"0";if(T>0)var Y=b.valueToCode(n,m,b.ORDER_ADDITION)||k;else if(T<0)var Y=b.valueToCode(n,m,b.ORDER_SUBTRACTION)||k;else if(V)var Y=b.valueToCode(n,m,b.ORDER_UNARY_NEGATION)||k;else var Y=b.valueToCode(n,m,F)||k;if(y6.isNumber(Y)){if(Y=parseFloat(Y)+T,V)Y=-Y}else{if(T>0){Y=Y+" + "+T;var H=b.ORDER_ADDITION}else if(T<0){Y=Y+" - "+-T;var H=b.ORDER_SUBTRACTION}if(V){if(T)Y="-("+Y+")";else Y="-"+Y;var H=b.ORDER_UNARY_NEGATION}if(H=Math.floor(H),F=Math.floor(F),H&&F>=H)Y="("+Y+")"}return Y};b.colour_picker=(n)=>{return[b.quote_(n.getFieldValue("COLOUR")),b.ORDER_ATOMIC]};var F6="if (abort || !runtime.running) break;\n",t4=`  await runtime.nextFrame();\n  ${F6}`;b.control_wait=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const y=b.valueToCode(n,"DURATION",b.ORDER_NONE)||0;return m+=`await runtime.sleep(runtime.number(${y}));\n${F6}`,m};b.control_repeat=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);let y=b.statementToCode(n,"SUBSTACK")||"";if(b.STATEMENT_SUFFIX)y=b.prefixLines(b.injectId(b.STATEMENT_SUFFIX,n),b.INDENT)+y;const V=b.valueToCode(n,"TIMES",b.ORDER_NONE)||0;return m+=`for (let _ = 0; _ < runtime.number(${V}); _++) {\n${y}${t4}}\n${F6}`,m};b.control_forever=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);let y=b.statementToCode(n,"SUBSTACK")||"";if(b.STATEMENT_SUFFIX)y=b.prefixLines(b.injectId(b.STATEMENT_SUFFIX,n),b.INDENT)+y;return m+=`while (true) {\n${y}${t4}}\n${F6}`,m};b.control_if=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);let y=b.statementToCode(n,"SUBSTACK")||"";if(b.STATEMENT_SUFFIX)y=b.prefixLines(b.injectId(b.STATEMENT_SUFFIX,n),b.INDENT)+y;const V=b.valueToCode(n,"CONDITION",b.ORDER_NONE)||"false";if(m+=`if (${V}) {\n${y}}\n`,n.getInput("SUBSTACK2")){if(y=b.statementToCode(n,"SUBSTACK2")||"",b.STATEMENT_SUFFIX)y=b.prefixLines(b.injectId(b.STATEMENT_SUFFIX,n),b.INDENT)+y;m+=`else {\n${y}}\n`}return m};b.control_if_else=b.control_if;b.control_wait_until=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const y=b.valueToCode(n,"CONDITION",b.ORDER_NONE)||"false";return m+=`while (!(${y})) {\n${t4}}\n${F6}`,m};b.control_repeat_until=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);let y=b.statementToCode(n,"SUBSTACK")||"";if(b.STATEMENT_SUFFIX)y=b.prefixLines(b.injectId(b.STATEMENT_SUFFIX,n),b.INDENT)+y;const V=b.valueToCode(n,"CONDITION",b.ORDER_NONE)||"false";return m+=`while (!(${V})) {\n${y}${t4}}\n${F6}`,m};b.control_while=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);let y=b.statementToCode(n,"SUBSTACK")||"";if(b.STATEMENT_SUFFIX)y=b.prefixLines(b.injectId(b.STATEMENT_SUFFIX,n),b.INDENT)+y;const V=b.valueToCode(n,"CONDITION",b.ORDER_NONE)||"false";return m+=`while (${V}) {\n${y}${t4}}\n${F6}`,m};b.control_stop=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);switch(n.getFieldValue("STOP_OPTION")){case"all":m+="runtime.stop();\n";break;case"this script":m+="return done();\n";break;case"other scripts in sprite":m+="abort = true;\n";break}return m};b.data_variable=(n)=>{return[b.variableDB_.getName(n.getFieldValue("VARIABLE"),F0.Variables.NAME_TYPE),b.ORDER_CONDITIONAL]};b.data_setvariableto=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const y=b.variableDB_.getName(n.getFieldValue("VARIABLE"),F0.Variables.NAME_TYPE),V=b.valueToCode(n,"VALUE",b.ORDER_NONE)||'""';return m+=`${y} = ${V};\n`,m};b.data_changevariableby=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const y=b.variableDB_.getName(n.getFieldValue("VARIABLE"),F0.Variables.NAME_TYPE),V=b.valueToCode(n,"VALUE",b.ORDER_NONE)||0;return m+=`${y} = runtime.number(${y}) + runtime.number(${V});\n`,m};b.data_listcontents=(n)=>{return[b.variableDB_.getName(n.getFieldValue("LIST"),F0.Variables.NAME_TYPE)+F0.LIST_VARIABLE_TYPE,b.ORDER_ATOMIC]};b.data_addtolist=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const y=b.variableDB_.getName(n.getFieldValue("LIST"),F0.Variables.NAME_TYPE)+F0.LIST_VARIABLE_TYPE,V=b.valueToCode(n,"ITEM",b.ORDER_NONE)||'""';return m+=`${y}.push(${V});\n`,m};b.data_deleteoflist=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const y=b.variableDB_.getName(n.getFieldValue("LIST"),F0.Variables.NAME_TYPE)+F0.LIST_VARIABLE_TYPE,V=b.valueToCode(n,"INDEX",b.ORDER_NONE)||1;return m+=`${y}.splice(runtime.index(${V}, ${y}.length), 1);\n`,m};b.data_deletealloflist=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const y=b.variableDB_.getName(n.getFieldValue("LIST"),F0.Variables.NAME_TYPE)+F0.LIST_VARIABLE_TYPE;return m+=`${y}.length = 0;\n`,m};b.data_insertatlist=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const y=b.variableDB_.getName(n.getFieldValue("LIST"),F0.Variables.NAME_TYPE)+F0.LIST_VARIABLE_TYPE,V=b.valueToCode(n,"INDEX",b.ORDER_NONE)||1,N=b.valueToCode(n,"ITEM",b.ORDER_NONE)||'""';return m+=`${y}.splice(runtime.index(${V}, ${y}.length), 0, ${N});\n`,m};b.data_replaceitemoflist=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const y=b.variableDB_.getName(n.getFieldValue("LIST"),F0.Variables.NAME_TYPE)+F0.LIST_VARIABLE_TYPE,V=b.valueToCode(n,"INDEX",b.ORDER_NONE)||1,N=b.valueToCode(n,"ITEM",b.ORDER_NONE)||'""';return m+=`${y}.splice(runtime.index(${V}, ${y}.length), 1, ${N});\n`,m};b.data_itemoflist=(n)=>{const m=b.variableDB_.getName(n.getFieldValue("LIST"),F0.Variables.NAME_TYPE)+F0.LIST_VARIABLE_TYPE,y=b.valueToCode(n,"INDEX",b.ORDER_NONE)||1;return[`(${m}[runtime.index(${y}, ${m}.length)] || '""')`,b.ORDER_CONDITIONAL]};b.data_itemnumoflist=(n)=>{const m=b.variableDB_.getName(n.getFieldValue("LIST"),F0.Variables.NAME_TYPE)+F0.LIST_VARIABLE_TYPE,y=b.valueToCode(n,"ITEM",b.ORDER_NONE)||'""';return[`(${m}.indexOf(${y}) + 1)`,b.ORDER_NONE]};b.data_lengthoflist=(n)=>{return[`${b.variableDB_.getName(n.getFieldValue("LIST"),F0.Variables.NAME_TYPE)+F0.LIST_VARIABLE_TYPE}.length`,b.ORDER_MEMBER]};b.data_listcontainsitem=(n)=>{const m=b.variableDB_.getName(n.getFieldValue("LIST"),F0.Variables.NAME_TYPE)+F0.LIST_VARIABLE_TYPE,y=b.valueToCode(n,"ITEM",b.ORDER_NONE)||'""';return[`${m}.includes(${y})`,b.ORDER_FUNCTION_CALL]};var A3="if (abort || !runtime.running) break;\n",M4=`async (done) => {\ndo {\n${b.HAT_CODE}} while (false);\ndone();\n}`;b.event_whenflagclicked=()=>{return`runtime.when('start', ${M4});\n`};b.event_whengreaterthan=(n)=>{const m=n.getFieldValue("WHENGREATERTHANMENU"),y=b.valueToCode(n,"VALUE",b.ORDER_NONE)||10;return`runtime.whenGreaterThen('${m}', runtime.number(${y}), ${M4});\n`};b.event_whenbroadcastreceived=(n)=>{return`runtime.when('message:${b.variableDB_.getName(n.getFieldValue("BROADCAST_OPTION"),k5.Variables.NAME_TYPE)}', ${M4});\n`};b.event_broadcast_menu=(n)=>{return[b.variableDB_.getName(n.getFieldValue("BROADCAST_OPTION"),k5.Variables.NAME_TYPE),b.ORDER_ATOMIC]};b.event_broadcast=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const y=b.valueToCode(n,"BROADCAST_INPUT",b.ORDER_NONE)||"message1";return m+=`runtime.fire('message:${y}')\n`,m};b.event_broadcastandwait=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const y=b.valueToCode(n,"BROADCAST_INPUT",b.ORDER_NONE)||"message1";return m+=`await runtime.fire('message:${y}')\n${A3}`,m};b.math_number=(n)=>{let m=parseFloat(n.getFieldValue("NUM")),y;if(m===Infinity)m="Infinity",y=b.ORDER_FUNCTION_CALL;else if(m===(-Infinity))m="-Infinity",y=b.ORDER_UNARY_SIGN;else if(Number.isNaN(m))m="NaN",y=b.ORDER_UNARY_SIGN;else y=m<0?b.ORDER_UNARY_SIGN:b.ORDER_ATOMIC;return[m,y]};b.math_integer=(n)=>{const m=parseInt(n.getFieldValue("NUM")),y=m<0?b.ORDER_UNARY_SIGN:b.ORDER_ATOMIC;return[m,y]};b.math_whole_number=(n)=>{return[Math.abs(parseInt(n.getFieldValue("NUM"))),b.ORDER_ATOMIC]};b.math_positive_number=(n)=>{let m=parseFloat(n.getFieldValue("NUM")),y;if(m===Infinity)m="Infinity",y=b.ORDER_FUNCTION_CALL;else if(m===(-Infinity))m="-Infinity",y=b.ORDER_FUNCTION_CALL;else if(Number.isNaN(m))m="NaN",y=b.ORDER_FUNCTION_CALL;else m=m<0?0:m,y=b.ORDER_ATOMIC;return[m,y]};b.math_angle=(n)=>{let m=parseFloat(n.getFieldValue("NUM")),y;if(m==Infinity)m="Infinity",y=b.ORDER_FUNCTION_CALL;else if(m==(-Infinity))m="-Infinity",y=b.ORDER_UNARY_SIGN;else m=m%360,m=m<0?m+360:m,y=b.ORDER_ATOMIC;return[m,y]};b.operator_add=(n)=>{const m=b.valueToCode(n,"NUM1",b.ORDER_NONE)||0,y=b.valueToCode(n,"NUM2",b.ORDER_NONE)||0;return[`(runtime.number(${m}) + runtime.number(${y}))`,b.ORDER_SUBTRACTION]};b.operator_subtract=(n)=>{const m=b.valueToCode(n,"NUM1",b.ORDER_NONE)||0,y=b.valueToCode(n,"NUM2",b.ORDER_NONE)||0;return[`(runtime.number(${m}) - runtime.number(${y}))`,b.ORDER_ADDITION]};b.operator_multiply=(n)=>{const m=b.valueToCode(n,"NUM1",b.ORDER_NONE)||0,y=b.valueToCode(n,"NUM2",b.ORDER_NONE)||0;return[`(runtime.number(${m}) * runtime.number(${y}))`,b.ORDER_MULTIPLICATION]};b.operator_divide=(n)=>{const m=b.valueToCode(n,"NUM1",b.ORDER_NONE)||0,y=b.valueToCode(n,"NUM2",b.ORDER_NONE)||0;return[`(runtime.number(${m}) / runtime.number(${y}))`,b.ORDER_DIVISION]};b.operator_random=(n)=>{const m=b.valueToCode(n,"FROM",b.ORDER_NONE)||0,y=b.valueToCode(n,"TO",b.ORDER_NONE)||0;return[`runtime.random(${m}, ${y})`,b.ORDER_FUNCTION_CALL]};b.operator_gt=(n)=>{const m=b.valueToCode(n,"OPERAND1",b.ORDER_NONE)||0,y=b.valueToCode(n,"OPERAND2",b.ORDER_NONE)||0;return[`(runtime.number(${m}) > runtime.number(${y}))`,b.ORDER_RELATIONAL]};b.operator_lt=(n)=>{const m=b.valueToCode(n,"OPERAND1",b.ORDER_NONE)||0,y=b.valueToCode(n,"OPERAND2",b.ORDER_NONE)||0;return[`(runtime.number(${m}) < runtime.number(${y}))`,b.ORDER_RELATIONAL]};b.operator_equals=(n)=>{const m=b.valueToCode(n,"OPERAND1",b.ORDER_NONE)||0,y=b.valueToCode(n,"OPERAND2",b.ORDER_NONE)||0;return[`(${m} == ${y})`,b.ORDER_RELATIONAL]};b.operator_and=(n)=>{const m=b.valueToCode(n,"OPERAND1",b.ORDER_NONE)||0,y=b.valueToCode(n,"OPERAND2",b.ORDER_NONE)||0;return[`(${m} && ${y})`,b.ORDER_LOGICAL_AND]};b.operator_or=(n)=>{const m=b.valueToCode(n,"OPERAND1",b.ORDER_NONE)||0,y=b.valueToCode(n,"OPERAND2",b.ORDER_NONE)||0;return[`(${m} || ${y})`,b.ORDER_LOGICAL_OR]};b.operator_not=(n)=>{return[`!(${b.valueToCode(n,"OPERAND",b.ORDER_NONE)||0})`,b.ORDER_LOGICAL_NOT]};b.operator_join=(n)=>{const m=b.valueToCode(n,"STRING1",b.ORDER_NONE)||'""',y=b.valueToCode(n,"STRING2",b.ORDER_NONE)||'""';return[`(String(${m}) + String(${y}))`,b.ORDER_ATOMIC]};b.operator_letter_of=(n)=>{const m=b.valueToCode(n,"LETTER",b.ORDER_NONE)||0;return[`(String(${b.valueToCode(n,"STRING",b.ORDER_NONE)||'""'}).at(${m} - 1) || '')`,b.ORDER_ATOMIC]};b.operator_length=(n)=>{return[`String(${b.valueToCode(n,"STRING",b.ORDER_NONE)||'""'}).length`,b.ORDER_MEMBER]};b.operator_contains=(n)=>{const m=b.valueToCode(n,"STRING1",b.ORDER_NONE)||'""',y=b.valueToCode(n,"STRING2",b.ORDER_NONE)||'""';return[`String(${m}).includes(String(${y}))`,b.ORDER_FUNCTION_CALL]};b.operator_mod=(n)=>{const m=b.valueToCode(n,"NUM1",b.ORDER_NONE)||0,y=b.valueToCode(n,"NUM2",b.ORDER_NONE)||0;return[`(runtime.number(${m}) % runtime.number(${y}))`,b.ORDER_MODULUS]};b.operator_round=(n)=>{return[`Math.round(${b.valueToCode(n,"NUM",b.ORDER_NONE)||0})`,b.ORDER_FUNCTION_CALL]};b.operator_mathop=(n)=>{const m=b.valueToCode(n,"NUM",b.ORDER_NONE)||0,y=n.getFieldValue("OPERATOR");let V="";if(y==="ceiling")V+=`Math.ceil(runtime.number(${m}))`;else if(y==="sin"||y==="cos"||y==="tan")V+=`Math.${y}(Math.PI * runtime.number(${m}) / 180)`;else if(y==="asin"||y==="acos"||y==="atan")V+=`(Math.${y}(runtime.number(${m})) * 180 / Math.PI)`;else if(y==="ln")V+=`Math.log(runtime.number(${m}))`;else if(y==="log")V+=`Math.log10(runtime.number(${m}))`;else if(y==="e ^")V+=`Math.exp(runtime.number(${m}))`;else if(y==="10 ^")V+=`Math.pow(10, runtime.number(${m}))`;else V+=`Math.${y}(runtime.number(${m}))`;return[V,b.ORDER_FUNCTION_CALL]};b.procedures_definition=(n)=>{};b.procedures_call=(n)=>{};b.procedures_prototype=(n)=>{};b.procedures_declaration=(n)=>{};b.argument_reporter_boolean=(n)=>{};b.argument_reporter_string_number=(n)=>{};b.argument_editor_boolean=(n)=>{};b.argument_editor_string_number=(n)=>{};b.sensing_timer=(n)=>{return["runtime.time",b.ORDER_FUNCTION_CALL]};b.sensing_resettimer=(n)=>{return"runtime.resetTimer()\n"};b.text=(n)=>{const m=n.getFieldValue("TEXT");return[m.length===0||isNaN(m)?b.quote_(m):+m,b.ORDER_ATOMIC]};var F3=new Set([g6.Events.BLOCK_CHANGE,g6.Events.BLOCK_CREATE,g6.Events.BLOCK_DELETE,g6.Events.BLOCK_MOVE,g6.Events.COMMENT_CHANGE,g6.Events.COMMENT_CREATE,g6.Events.COMMENT_DELETE,g6.Events.COMMENT_MOVE,g6.Events.VAR_CREATE,g6.Events.VAR_DELETE,g6.Events.VAR_RENAME]),X3=function(n){console&&console.warn&&console.warn(n)},M0=function(){M0.init.call(this)},l4=function(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)},c5=function(n){return n._maxListeners===void 0?M0.defaultMaxListeners:n._maxListeners},V5=function(n,m,y,V){var N,T,F;if(l4(y),T=n._events,T===void 0?(T=n._events=Object.create(null),n._eventsCount=0):(T.newListener!==void 0&&(n.emit("newListener",m,y.listener?y.listener:y),T=n._events),F=T[m]),F===void 0)F=T[m]=y,++n._eventsCount;else if(typeof F=="function"?F=T[m]=V?[y,F]:[F,y]:V?F.unshift(y):F.push(y),N=c5(n),N>0&&F.length>N&&!F.warned){F.warned=!0;var k=new Error("Possible EventEmitter memory leak detected. "+F.length+" "+String(m)+" listeners added. Use emitter.setMaxListeners() to increase limit");k.name="MaxListenersExceededWarning",k.emitter=n,k.type=m,k.count=F.length,X3(k)}return n},e3=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)},E5=function(n,m,y){var V={fired:!1,wrapFn:void 0,target:n,type:m,listener:y},N=e3.bind(V);return N.listener=y,V.wrapFn=N,N},N5=function(n,m,y){var V=n._events;if(V===void 0)return[];var N=V[m];return N===void 0?[]:typeof N=="function"?y?[N.listener||N]:[N]:y?W3(N):R5(N,N.length)},M5=function(n){var m=this._events;if(m!==void 0){var y=m[n];if(typeof y=="function")return 1;if(y!==void 0)return y.length}return 0},R5=function(n,m){for(var y=new Array(m),V=0;V<m;++V)y[V]=n[V];return y},T3=function(n,m){for(;m+1<n.length;m++)n[m]=n[m+1];n.pop()},W3=function(n){for(var m=new Array(n.length),y=0;y<m.length;++y)m[y]=n[y].listener||n[y];return m},Y6=typeof Reflect=="object"?Reflect:null,D5=Y6&&typeof Y6.apply=="function"?Y6.apply:function(n,m,y){return Function.prototype.apply.call(n,m,y)},w4;Y6&&typeof Y6.ownKeys=="function"?w4=Y6.ownKeys:Object.getOwnPropertySymbols?w4=function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:w4=function(n){return Object.getOwnPropertyNames(n)};var a5=Number.isNaN||function(n){return n!==n};M0.EventEmitter=M0;M0.prototype._events=void 0;M0.prototype._eventsCount=0;M0.prototype._maxListeners=void 0;var G5=10;Object.defineProperty(M0,"defaultMaxListeners",{enumerable:!0,get:function(){return G5},set:function(n){if(typeof n!="number"||n<0||a5(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");G5=n}});M0.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};M0.prototype.setMaxListeners=function(n){if(typeof n!="number"||n<0||a5(n))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+n+".");return this._maxListeners=n,this};M0.prototype.getMaxListeners=function(){return c5(this)};M0.prototype.emit=function(n){for(var m=[],y=1;y<arguments.length;y++)m.push(arguments[y]);var V=n==="error",N=this._events;if(N!==void 0)V=V&&N.error===void 0;else if(!V)return!1;if(V){var T;if(m.length>0&&(T=m[0]),T instanceof Error)throw T;var F=new Error("Unhandled error."+(T?" ("+T.message+")":""));throw F.context=T,F}var k=N[n];if(k===void 0)return!1;if(typeof k=="function")D5(k,this,m);else for(var Y=k.length,H=R5(k,Y),y=0;y<Y;++y)D5(H[y],this,m);return!0};M0.prototype.addListener=function(n,m){return V5(this,n,m,!1)};M0.prototype.on=M0.prototype.addListener;M0.prototype.prependListener=function(n,m){return V5(this,n,m,!0)};M0.prototype.once=function(n,m){return l4(m),this.on(n,E5(this,n,m)),this};M0.prototype.prependOnceListener=function(n,m){return l4(m),this.prependListener(n,E5(this,n,m)),this};M0.prototype.removeListener=function(n,m){var y,V,N,T,F;if(l4(m),V=this._events,V===void 0)return this;if(y=V[n],y===void 0)return this;if(y===m||y.listener===m)--this._eventsCount===0?this._events=Object.create(null):(delete V[n],V.removeListener&&this.emit("removeListener",n,y.listener||m));else if(typeof y!="function"){for(N=-1,T=y.length-1;T>=0;T--)if(y[T]===m||y[T].listener===m){F=y[T].listener,N=T;break}if(N<0)return this;N===0?y.shift():T3(y,N),y.length===1&&(V[n]=y[0]),V.removeListener!==void 0&&this.emit("removeListener",n,F||m)}return this};M0.prototype.off=M0.prototype.removeListener;M0.prototype.removeAllListeners=function(n){var m,y,V;if(y=this._events,y===void 0)return this;if(y.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):y[n]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete y[n]),this;if(arguments.length===0){var N=Object.keys(y),T;for(V=0;V<N.length;++V)T=N[V],T!=="removeListener"&&this.removeAllListeners(T);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(m=y[n],typeof m=="function")this.removeListener(n,m);else if(m!==void 0)for(V=m.length-1;V>=0;V--)this.removeListener(n,m[V]);return this};M0.prototype.listeners=function(n){return N5(this,n,!0)};M0.prototype.rawListeners=function(n){return N5(this,n,!1)};M0.listenerCount=function(n,m){return typeof n.listenerCount=="function"?n.listenerCount(m):M5.call(n,m)};M0.prototype.listenerCount=M5;M0.prototype.eventNames=function(){return this._eventsCount>0?w4(this._events):[]};var Nt=M0.prototype,B5=E4(N4(),1);class d4 extends M0{static DEFAULT_FPS=24;constructor(n,m=d4.DEFAULT_FPS){super();this._fps=m,this._frame_sec=1/m,this._running=!1,this._requestStop=n,this._timer=0,this._timers=[],this._data={},this._greaterThen={},this._eventsHappening={}}launch(n){new Function("runtime",n)(this)}get core(){return B5.default}get data(){return this._data}get running(){return this._running}get time(){return(Date.now()-this._timer)/1000}resetTimer(){this._timer=Date.now()}when(n,m){this._eventsHappening[n]=this._eventsHappening[n]||[],this._eventsHappening[n].push(!1);const y=this._eventsHappening[n].length-1;this.on(`${n}_${y}`,m)}whenGreaterThen(n,m,y){const V=`${n}>${m}`;this._greaterThen[V]=!1,this.when(`greaterthen:${V}`,y)}emit(...n){return new Promise((m)=>{if(this.running)super.emit(...n,m)})}fire(n,...m){if(this.emit(n,...m),this._eventsHappening[n]=this._eventsHappening[n]||[],this._eventsHappening[n].length>0)return Promise.race(this._eventsHappening[n].map(async(y,V)=>{if(!y)this._eventsHappening[n][V]=!0,await this.emit(`${n}_${V}`,...m),this._eventsHappening[n][V]=!1}));return Promise.resolve()}_handleFrameForGreaterThen(n){const m=Object.keys(this._greaterThen);for(let y of m){const[V,N]=y.split(">");if(V==="TIMER"){const T=this.time>parseFloat(N);if(T&&!this._greaterThen[y])this.fire(`greaterthen:${y}`);this._greaterThen[y]=T}}n()}async _handleStart(){while(this.running){if(!B5.default.project){this.stop();break}await this.nextFrame(),this.fire("frame")}}start(){this._running=!0,this.on("frame",this._handleFrameForGreaterThen.bind(this)),this.on("start",this._handleStart.bind(this)),this.fire("start"),this.resetTimer()}async stop(){this.emit("stop"),this._running=!1,await this.nextFrame(),this._timers.forEach(clearTimeout),this._timers.length=0,this._requestStop()}sleep(n){return new Promise((m)=>this._timers.push(setTimeout(m,n*1000)))}nextFrame(){return this.sleep(this._frame_sec)}random(n=1,m=10){const y=Math.ceil(Math.min(n,m)),V=Math.floor(Math.max(n,m));return Math.floor(Math.random()*(V-y+1))+y}number(n,m=0){return isNaN(n)?m:+n}index(n,m){let y=this.number(n)-1;return y%=m,y+=m,y%m}clamp(n,m,y){return Math.min(Math.max(n,m),y)}}var r0=R3.default;var i4="if (abort || !runtime.running) break;\n";b.motion_attack=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const y=b.valueToCode(n,"DIRECTION",b.ORDER_NONE)||0,V=b.valueToCode(n,"DISTANCE",b.ORDER_NONE)||100;return m+=`await tank.util.attack(${y}, ${V});\n${i4}`,m};b.motion_move=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const y=b.valueToCode(n,"DIRECTION",b.ORDER_NONE)||0,V=b.valueToCode(n,"SPEED",b.ORDER_NONE)||100;return m+=`await tank.util.move(${y}, ${V});\n${i4}`,m};b.motion_turnright=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const y=b.valueToCode(n,"DEGREES",b.ORDER_NONE)||0;return m+=`await tank.util.turnRight(${y});\n${i4}`,m};b.motion_turnleft=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const y=b.valueToCode(n,"DEGREES",b.ORDER_NONE)||0;return m+=`await tank.util.turnLeft(${y});\n${i4}`,m};b.motion_pointindirection=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const y=b.valueToCode(n,"DIRECTION",b.ORDER_NONE)||0;return m+=`await tank.util.setDirection(+${y});\n${i4}`,m};b.motion_setspeed=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const y=b.valueToCode(n,"SPEED",b.ORDER_NONE)||0;return m+=`tank.util.speed = ${y};\n`,m};b.motion_stop=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);return m+="tank.util.speed = 0;\n",m};b.motion_xposition=(n)=>{return["tank.util.x",b.ORDER_ATOMIC]};b.motion_yposition=(n)=>{return["tank.util.y",b.ORDER_ATOMIC]};b.motion_speed=(n)=>{return["tank.util.currentSpeed",b.ORDER_ATOMIC]};b.motion_direction=(n)=>{return["tank.util.direction",b.ORDER_ATOMIC]};b.sensing_scanwidth=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const y=b.valueToCode(n,"WIDTH",b.ORDER_NONE)||5;return m+=`tank.util.scanWidth = ${y};\n`,m};b.sensing_scan=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const y=b.valueToCode(n,"DIRECTION",b.ORDER_NONE)||0;return m+=`(await tank.util.scan(${y}) !== Infinity)`,[m,b.ORDER_EQUALITY]};b.sensing_scandistance=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const y=b.valueToCode(n,"DIRECTION",b.ORDER_NONE)||0;return m+=`(await tank.util.scan(${y}))`,[m,b.ORDER_FUNCTION_CALL]};b.sensing_health=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);return m+="tank.util.health",[m,b.ORDER_FUNCTION_CALL]};var H3=()=>`
  <category name="%{BKY_CATEGORY_MOTION}" id="motion" colour="#4C97FF" secondaryColour="#3373CC">
    <block type="motion_attack">
      <value name="DIRECTION">
        <shadow type="math_angle">
          <field name="NUM">90</field>
        </shadow>
      </value>
      <value name="DISTANCE">
        <shadow type="math_number">
          <field name="NUM">200</field>
        </shadow>
      </value>
    </block>
    <block type="motion_move">
      <value name="DIRECTION">
        <shadow type="math_angle">
          <field name="NUM">90</field>
        </shadow>
      </value>
      <value name="SPEED">
        <shadow type="math_number">
          <field name="NUM">100</field>
        </shadow>
      </value>
    </block>
    ${o6}
    <block type="motion_turnright">
      <value name="DEGREES">
        <shadow type="math_number">
          <field name="NUM">15</field>
        </shadow>
      </value>
    </block>
    <block type="motion_turnleft">
      <value name="DEGREES">
        <shadow type="math_number">
          <field name="NUM">15</field>
        </shadow>
      </value>
    </block>
    <block type="motion_pointindirection">
      <value name="DIRECTION">
        <shadow type="math_angle">
          <field name="NUM">90</field>
        </shadow>
      </value>
    </block>
    ${o6}
    <block type="motion_setspeed">
      <value name="SPEED">
        <shadow type="math_number">
          <field name="NUM">50</field>
        </shadow>
      </value>
    </block>
    <block type="motion_stop"/>
    ${o6}
    <block type="motion_speed"/>
    <block type="motion_direction"/>
    ${R4}
  </category>
`,Y3=()=>`
  <category name="%{BKY_CATEGORY_SENSING}" id="sensing" colour="#4CBFE6" secondaryColour="#2E8EB8">
    <block type="sensing_scanwidth">
      <value name="WIDTH">
        <shadow type="math_number">
          <field name="NUM">5</field>
        </shadow>
      </value>
    </block>
    <block type="sensing_scan">
      <value name="DIRECTION">
        <shadow type="math_angle">
          <field name="NUM">90</field>
        </shadow>
      </value>
    </block>
    <block type="sensing_scandistance">
      <value name="DIRECTION">
        <shadow type="math_angle">
          <field name="NUM">90</field>
        </shadow>
      </value>
    </block>
    ${o6}
    <block type="sensing_health"/>
    ${o6}
    <block id="timer" type="sensing_timer"/>
    <block type="sensing_resettimer"/>
    ${R4}
  </category>
`,U3=()=>`
  <category name="%{BKY_CATEGORY_OPERATORS}" id="operators" colour="#40BF4A" secondaryColour="#389438">
    <block type="operator_add">
      <value name="NUM1">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
      <value name="NUM2">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    <block type="operator_subtract">
      <value name="NUM1">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
      <value name="NUM2">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    <block type="operator_multiply">
      <value name="NUM1">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
      <value name="NUM2">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    <block type="operator_divide">
      <value name="NUM1">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
      <value name="NUM2">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    ${o6}
    <block type="operator_random">
      <value name="FROM">
        <shadow type="math_number">
          <field name="NUM">1</field>
        </shadow>
      </value>
      <value name="TO">
        <shadow type="math_number">
          <field name="NUM">10</field>
        </shadow>
      </value>
    </block>
    ${o6}
    <block type="operator_gt">
      <value name="OPERAND1">
        <shadow type="text">
          <field name="TEXT"/>
        </shadow>
      </value>
      <value name="OPERAND2">
        <shadow type="text">
          <field name="TEXT">50</field>
        </shadow>
      </value>
    </block>
    <block type="operator_lt">
      <value name="OPERAND1">
        <shadow type="text">
          <field name="TEXT"/>
        </shadow>
      </value>
      <value name="OPERAND2">
        <shadow type="text">
          <field name="TEXT">50</field>
        </shadow>
      </value>
    </block>
    <block type="operator_equals">
      <value name="OPERAND1">
        <shadow type="text">
          <field name="TEXT"/>
        </shadow>
      </value>
      <value name="OPERAND2">
        <shadow type="text">
          <field name="TEXT">50</field>
        </shadow>
      </value>
    </block>
    ${o6}
    <block type="operator_and"/>
    <block type="operator_or"/>
    <block type="operator_not"/>
    ${o6}
    <block type="operator_mod">
      <value name="NUM1">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
      <value name="NUM2">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    <block type="operator_round">
      <value name="NUM">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    ${o6}
    <block type="operator_mathop">
      <value name="NUM">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    ${R4}
  </category>
`;function a4(){return K3([{id:"motion",xml:H3()},{id:"sensing",xml:Y3()},{id:"operators",xml:U3()}])}import{jsx as Q3} from"preact/jsx-runtime";var J3=p4.Content;function O4(){const{getText:n}=Z3(),m={MOTION_ATTACK:n("tankwar.blocks.motion_attack","fire in direction %1 at %2 steps"),MOTION_MOVE:n("tankwar.blocks.motion_move","forward in direction %1 at %2 % speed"),MOTION_SETSPEED:n("tankwar.blocks.motion_setspeed","set speed to %1 %"),MOTION_STOP:n("tankwar.blocks.motion_stop","stop"),MOTION_SPEED:n("tankwar.blocks.motion_speed","speed"),SENSING_SCANWIDTH:n("tankwar.blocks.sensing_scanwidth","set scan width to %1"),SENSING_SCAN:n("tankwar.blocks.sensing_scan","scan for enemy in direction %1?"),SENSING_DISTANCE:n("tankwar.blocks.sensing_distance","measure distance of enemy in direction %1"),SENSING_HEALTH:n("tankwar.blocks.sensing_health","health")},y=a4();return Q3(J3,{disableGenerator:!0,disableExtension:!0,messages:m,toolbox:y})}import{useState as _4} from"preact/hooks";import{classNames as G7} from"@blockcode/ui";import{useState as t8} from"preact/hooks";import{useEditor as j7} from"@blockcode/core";var O5="./assets/background-81dedab007c311a5.png";function U6(n){return new Promise((m)=>{const y=new Image;y.src=n,y.addEventListener("load",()=>m(y))})}var z5="./assets/tank_1-5797dcf7b198a48d.png";var A5="./assets/turret_1-26017ccc46b87689.png";var q5="./assets/tank_2-337708f7538d8787.png";var F5="./assets/turret_2-5c4bb2c458561ace.png";var X5="./assets/tank_3-1d999a2c9dacc246.png";var e5="./assets/turret_3-956bfba650c81c57.png";var T5="./assets/tank_4-f93afcfd2c3d1734.png";var W5="./assets/turret_4-d6c2200ed4ca50b0.png";var K5="./assets/broken-2d9779d033bbcdb5.png";var H5="./assets/bullet-80854a0e7090b0fc.png";var Y5="./assets/boom1-65b37ddc26db4cbd.png";var U5="./assets/boom2-82ff355a8e0177ba.png";var Z5="./assets/boom3-703bd7bb6580e4d9.png";var w7=20,l7=4,d7=40,r4=500,r7=70,b7=400,u4=10,z4=50,A4=1000,J5=(n,m)=>Math.sqrt((n.x-m.x)**2+(n.y-m.y)**2),N6=(n)=>isNaN(n)?0:+n,h4=(n,m,y)=>Math.min(Math.max(n,m),y),v4=(n)=>n*Math.PI/180,M6=(n)=>parseInt((n%360+360)%360),Q5=(n,m)=>M6(n)===M6(m);class a0{static PLACE={LEFT:{get position(){return new r0.Point(r0.view.center.x-300,r0.view.center.y)},rotation:90},RIGHT:{get position(){return new r0.Point(r0.view.center.x+300,r0.view.center.y)},rotation:-90},LEFT_TOP:{get position(){return new r0.Point(r0.view.center.x-300,r0.view.center.y-300)},rotation:135},RIGHT_TOP:{get position(){return new r0.Point(r0.view.center.x+300,r0.view.center.y-300)},rotation:-135},LEFT_BOTTOM:{get position(){return new r0.Point(r0.view.center.x-300,r0.view.center.y+300)},rotation:45},RIGHT_BOTTOM:{get position(){return new r0.Point(r0.view.center.x+300,r0.view.center.y+300)},rotation:-45}};static STYLE={PLAYER:{tank:z5,turret:A5},ENEMY_A:{tank:q5,turret:F5},ENEMY_B:{tank:X5,turret:e5},ENEMY_C:{tank:T5,turret:W5}};constructor(n,m=a0.STYLE.PLAYER,y=a0.PLACE.LEFT){this.raster=new r0.Raster({name:n,scaling:0.2,source:m.tank,position:y.position,rotation:y.rotation,visible:m===a0.STYLE.PLAYER}),this.turretRaster=new r0.Raster({scaling:0.2,source:m.turret,position:y.position,rotation:y.rotation,visible:m===a0.STYLE.PLAYER}),this.raster.util=this,this.turretRaster.owner=this,this._hidden=!0,this._lastScanDistance=0,this._imageCache={},this._timers=[],this.reset()}sleep(n){return new Promise((m)=>this._timers.push(setTimeout(m,n)))}reset(){if(this._speed=0,this._currentSpeed=0,this._health=100,this._scanWidth=l7,this._turretReady=null,this._scanShape)this._scanShape.remove(),this._scanShape=null;if(this._bulletRaster)this._bulletRaster.remove(),this._bulletRaster=null;if(this._boomRaster)this._boomRaster.remove(),this._boomRaster=null;if(this._collideTester)this._collideTester.remove(),this._collideTester=null;clearTimeout(this._turretReady),this._timers.forEach(clearTimeout),this._timers.length=0}bringToFront(){this.raster.bringToFront(),this.turretRaster.bringToFront()}get running(){return this._running}set running(n){if(this.reset(),this._running=n,n){const m=this.raster.scaling.x*this.raster.width-5;this._collideTester=new r0.Path.Rectangle({point:[this.raster.position.x-m/2,this.raster.position.y-5],size:[m,10],applyMatrix:!1})}}get bullseye(){if(!this._bullseye)this._bullseye=Math.min(this.raster.width,this.raster.height)*this.raster.scaling.x/4;return this._bullseye}get enemies(){if(!this._enemies)this._enemies=["red","yellow","green","player"].filter((n)=>n!==this.raster.name).map((n)=>r0.project.activeLayer.children[n]);return this._enemies}set place(n){if(this.running)return;this.raster.position=this.turretRaster.position=n.position,this.raster.rotation=this.turretRaster.rotation=n.rotation,this.hidden=!1}get hidden(){return this._hidden}set hidden(n){this._hidden=n,this.raster.visible=this.turretRaster.visible=!n}async _turn(n,m){if(!Q5(n.rotation,m)){let y=M6(m)-M6(n.rotation);if(y>180)y-=360;if(y<-180)y+=360;await n.tween({rotation:n.rotation+y},A4*(Math.abs(y)/360))}}async attack(n,m){if(!this.running)return;if(this._bulletRaster||this.death)return;n=Math.round(N6(n)),m=N6(m)-z4,clearTimeout(this._turretReady),this._turretReady=null,await this._turn(this.turretRaster,n);const y=M6(n),V=v4(90-y);if(!this._imageCache.buttet)this._imageCache.buttet=await U6(H5);if(this._bulletRaster)this._bulletRaster.remove(),this._bulletRaster=null;this._bulletRaster=new r0.Raster({image:this._imageCache.buttet,position:new r0.Point(this.raster.position.x+z4*Math.cos(V),this.raster.position.y-z4*Math.sin(V)),rotation:this.raster.rotation,scaling:this.raster.scaling}),m=h4(m,r7,b7);const N=m/2,T=u4/m/2;let F=u4*Math.cos(V),k=u4*Math.sin(V);while(m>0){if(await this.sleep(15),m<u4)F=m*Math.cos(V),k=m*Math.sin(V);if(m-=u4,this._bulletRaster.position.x+=F,this._bulletRaster.position.y-=k,this._bulletRaster.scaling.x+=m>N?T:-T,this._bulletRaster.scaling.y=this._bulletRaster.scaling.x,this._bulletRaster.scaling.x<this.raster.scaling.x)this._bulletRaster.scaling=this.raster.scaling}this._boom(this._bulletRaster.position),this._collide(this._bulletRaster,(Y)=>{if(J5(Y.position,this._bulletRaster.position)<Y.util.bullseye)Y.util.hurt(10);else Y.util.hurt(5)}),this._bulletRaster.remove(),this._bulletRaster=null,this._turretReady=setTimeout(()=>{this._turn(this.turretRaster,this.raster.rotation),this._turretReady=null},1000)}async _boom(n){if(!this.running)return;if(!this._imageCache.booms)this._imageCache.booms=[await U6(Y5),await U6(U5),await U6(Z5)];if(this._boomRaster)this._boomRaster.remove(),this._boomRaster=null;this._boomRaster=new r0.Raster({image:this._imageCache.booms[0],position:n}),await this.sleep(30),this._boomRaster.image=this._imageCache.booms[1],await this.sleep(50),this._boomRaster.image=this._imageCache.booms[2],await this.sleep(90),this._boomRaster.remove(),this._boomRaster=null}_intersectsOrContains(n,m){return n.intersects(m)||m.contains(n.position)}_collide(n,m){if(this.running&&!this.death)this.enemies.forEach((y)=>{if(y.util.death||y.util.hidden)return;if(this._intersectsOrContains(n,y))m(y)})}async move(n,m){if(!this.running)return;if(this.death)return;await this.setDirection(n),this.speed=N6(m)}drive(){if(!this.running)return;if(this.speed===0)return;if(this.hidden||this.death)return;let n=this.speed;const m=v4(90-this.direction),y=this.raster.scaling.y*this.raster.height;this._collideTester.rotation=this.raster.rotation,this._collideTester.position.x=this.raster.position.x+(y/2+5)*Math.cos(m),this._collideTester.position.y=this.raster.position.y-(y/2+5)*Math.sin(m),this.enemies.forEach((V)=>{if(V.util.hidden)return;if(this._intersectsOrContains(this.raster,V)&&this._intersectsOrContains(this._collideTester,V))n=0}),this._currentSpeed=n,n/=w7,this.raster.position.x+=n*Math.cos(m),this.raster.position.y-=n*Math.sin(m),this.turretRaster.position=this.raster.position}get x(){return this.raster.position.x-r0.view.center.x}get y(){return r0.view.center.y-this.raster.position.y}get currentSpeed(){return h4(this._currentSpeed,-100,100)}get speed(){return h4(this._speed,-100,100)}set speed(n){if(!this.running)return;this._speed=h4(n,-100,100)}get speedVelocity(){const n=M6(this.speed<0?180+this.direction:this.direction),m=v4(90-n),y=Math.abs(this.speed);return new r0.Point(y*Math.cos(m),y*Math.sin(m))}get direction(){let n=this.raster.rotation%360;if(n>180)n-=360;if(n<=-180)n+=360;return n}async setDirection(n){if(!this.running)return;if(n=Math.round(N6(n)),!this._turretReady)this._turn(this.turretRaster,n);await this._turn(this.raster,n)}turnRight(n){let m=this.raster.rotation;return m+=N6(n),this.setDirection(m)}turnLeft(n){return this.turnRight(-N6(n))}hurt(n){if(!this.running)return;if(this._health-=Math.abs(n),this.death)this.raster.visible=this.turretRaster.visible=!1,new r0.Raster({source:K5,scaling:this.raster.scaling,position:this.raster.position,rotation:this.raster.rotation}).insertAbove(r0.project.activeLayer.children.background)}get health(){if(this._health<0)return 0;return this._health}get death(){return this.health<=0}get scanWidth(){return this._scanWidth}set scanWidth(n){n=N6(n),this._scanWidth=h4(n,1,d7)}async scan(n){if(!this.running)return Infinity;if(this._scanShape||this.death)return Infinity;if(n=N6(n),!Q5(this._lastScanDistance,n)){let w0=M6(n)-M6(this._lastScanDistance);if(w0>180)w0-=360;if(w0<-180)w0+=360;await this.sleep(A4*(Math.abs(w0)/360)),this._lastScanDistance=n}const m=v4(90-(n-this.scanWidth/2)),y=r4*Math.cos(m),V=r4*Math.sin(m),N=new r0.Point(this.raster.position.x+y,this.raster.position.y-V),T=v4(90-(n+this.scanWidth/2)),F=r4*Math.cos(T),k=r4*Math.sin(T),Y=new r0.Point(this.raster.position.x+F,this.raster.position.y-k);if(this._scanShape)this._scanShape.remove(),this._scanShape=null;this._scanShape=new r0.Path({segments:[this.raster.position,N,Y],closed:!0,fillColor:{gradient:{stops:[["rgb(255 0 0 0.4)",0],["rgb(255 0 0 0)",0.7]],radial:!0},origin:this.raster.position,destination:N}}),await this.sleep(A4*(this.scanWidth/360));let H=Infinity;return this._collide(this._scanShape,(w0)=>{const x0=J5(this.raster.position,w0.position);if(x0<H)H=x0}),this._scanShape.remove(),this._scanShape=null,H}}class b4 extends d4{get player(){return r0.project.activeLayer.children.player}get redTank(){return r0.project.activeLayer.children.red}get yellowTank(){return r0.project.activeLayer.children.yellow}get greenTank(){return r0.project.activeLayer.children.green}start(){this.player.util.running=!0,this.redTank.util.running=!0,this.yellowTank.util.running=!0,this.greenTank.util.running=!0,super.start()}stop(){return this.player.util.running=!1,this.redTank.util.running=!1,this.yellowTank.util.running=!1,this.greenTank.util.running=!1,super.stop()}}var $5=(n="",m=[])=>`
${m.join("\n")}

((tank) => {
let abort = false;
${n||""}
})(runtime.player);

runtime.on('frame', () => {
  runtime.player.util.drive();
  runtime.redTank.util.drive();
  runtime.yellowTank.util.drive();
  runtime.greenTank.util.drive();
});

runtime.player.util.bringToFront();
runtime.start();
`;var n4={};r8(n4,{simple:()=>{{return P7}},senior:()=>{{return _7}},medium:()=>{{return S7}}});var P7=(n,m)=>`
((tank) => {
  let abort = false;

  runtime.when('start', async function (done) {
    await tank.util.turnRight(45);
    tank.util.speed = 100;
    await runtime.sleep(2.5);
    tank.util.speed = 0;
    await tank.util.turnLeft(90);
    runtime.fire('@ai_simple_${n}_${m}_message_1');
    while (true) {
      tank.util.speed = 100;
      await runtime.sleep(5.5);
      tank.util.speed = 0;
      await tank.util.turnLeft(180);
      if (abort || !runtime.running) {
        break;
      };
      await runtime.nextFrame();
    }
    done();
  });

  runtime.when('@ai_simple_${n}_${m}_message_1', async function anonymous(done) {
    while (true) {
      if ((await tank.util.scan(0) !== Infinity)) {
        await tank.util.attack(0, (await tank.util.scan(0)));
      }
      if ((await tank.util.scan(45) !== Infinity)) {
        await tank.util.attack(45, (await tank.util.scan(45)));
      }
      if ((await tank.util.scan(90) !== Infinity)) {
        await tank.util.attack(90, (await tank.util.scan(90)));
      }
      if ((await tank.util.scan(135) !== Infinity)) {
        await tank.util.attack(135, (await tank.util.scan(135)));
      }
      if ((await tank.util.scan(180) !== Infinity)) {
        await tank.util.attack(180, (await tank.util.scan(180)));
      }
      if ((await tank.util.scan(225) !== Infinity)) {
        await tank.util.attack(225, (await tank.util.scan(225)));
      }
      if ((await tank.util.scan(270) !== Infinity)) {
        await tank.util.attack(270, (await tank.util.scan(270)));
      }
      if ((await tank.util.scan(315) !== Infinity)) {
        await tank.util.attack(315, (await tank.util.scan(315)));
      }
      if (abort || !runtime.running) {
        break;
      };
      await runtime.nextFrame();
    }
    done();
  });


})(runtime.${n}Tank);
`,S7=(n,m)=>`
((tank) => {
  let abort = false;

  let _health_ = 0;
  let _angle_ = 0;

  runtime.when('start', async function anonymous() {
    _angle_ = runtime.random(1, 360);
    runtime.fire('@ai_medium_${n}_${m}_start')
  });

  runtime.when('start', async function anonymous() {
    while (true) {
      _health_ = tank.util.health;
      while (!((tank.util.health < _health_))) {
        if (abort || !runtime.running) {
          break;
        };
        await runtime.nextFrame();
      }
      abort = false;
      tank.util.move(runtime.random(1, 360), 100);
      await runtime.sleep(1);
      tank.util.speed = 0;
      runtime.fire('@ai_medium_${n}_${m}_start')
      if (abort || !runtime.running) {
        break;
      };
      await runtime.nextFrame();
    }
  });

  runtime.when('@ai_medium_${n}_${m}_start', async function anonymous(done) {
    while (true) {
      while (!((await tank.util.scan(_angle_) !== Infinity))) {
        _angle_ = (isNaN(_angle_) ? 0 : +_angle_) + +(10);

        if (abort || !runtime.running) {
          break;
        };
        await runtime.nextFrame();
      }
      while (((await tank.util.scan(_angle_) !== Infinity) && ((await tank.util.scan(_angle_)) > '400'))) {
        tank.util.move(_angle_, 100);

        if (abort || !runtime.running) {
          break;
        };
        await runtime.nextFrame();
      }
      tank.util.speed = 0;
      if (((await tank.util.scan(_angle_)) < '400') && ((await tank.util.scan(_angle_)) > '100')) {
        await tank.util.attack((_angle_ + 1), (await tank.util.scan(_angle_)));
      }
      _angle_ = (isNaN(_angle_) ? 0 : +_angle_) + +(-10);

      if (abort || !runtime.running) {
        break;
      };
      await runtime.nextFrame();
    }
    done()
  });


})(runtime.${n}Tank);
`,_7=(n,m)=>`
((tank) => {
  let abort = false;

  let _angle_ = 0;
  let _health_ = 0;


  runtime.when('start', async function anonymous() {
    if (((tank.util.y < '5') && (tank.util.y > '-5'))) {
      await tank.util.turnLeft(104);
    }
    else {
      await tank.util.turnLeft(180);
    }
    tank.util.speed = 100;
    while (!(((Math.abs(tank.util.x) > '400') && (Math.abs(tank.util.y) > '400')))) {

    if (abort || !runtime.running) {
      break;
    };
      await runtime.nextFrame();
    }
    tank.util.speed = 0;
    runtime.fire('@ai_senior_${n}_${m}_start')
  });

  runtime.when('@ai_senior_${n}_${m}_start', async function anonymous(done) {
    if ((tank.util.x < '0')) {
      if ((tank.util.y < '0')) {
        _angle_ = '45';
      }
      else {
        _angle_ = '135';
      }
    }
    else {
      if ((tank.util.y < '0')) {
        _angle_ = '-45';
      }
      else {
        _angle_ = '-135';
      }
    }
    await tank.util.setDirection(_angle_);
    runtime.fire('@ai_senior_${n}_${m}_watch_health');
    _angle_ = (isNaN(_angle_) ? 0 : +_angle_) + +(-60);
    for (let _ = 0; _ < 78; _++) {
      if (((await tank.util.scan(_angle_)) < '400') && ((await tank.util.scan(_angle_)) > '100')) {
        await tank.util.attack((_angle_ + 1), (await tank.util.scan(_angle_)));
        _angle_ = (isNaN(_angle_) ? 0 : +_angle_) + +(-10);
      }
      _angle_ = (isNaN(_angle_) ? 0 : +_angle_) + +(10);

      if (abort || !runtime.running) {
        break;
      };
      await runtime.nextFrame();
    }
    runtime.fire('@ai_senior_${n}_${m}_next_place');
    done();
  });

  runtime.when('@ai_senior_${n}_${m}_next_place', async function anonymous(done) {
    abort = false;
    if ((runtime.random(1, 3) == '1')) {
      await tank.util.turnLeft(45);
    }
    else {
      await tank.util.turnRight(45);
    }
    tank.util.speed = 100;
    await runtime.sleep(1);
    if (((tank.util.direction > '-5') && (tank.util.direction < '5'))) {
      while (!((tank.util.y > '400'))) {

      if (abort || !runtime.running) {
        break;
      };
        await runtime.nextFrame();
      }
    }
    else {
      if (((tank.util.direction > '85') && (tank.util.direction < '95'))) {
        while (!((tank.util.x > '400'))) {

        if (abort || !runtime.running) {
          break;
        };
          await runtime.nextFrame();
        }
      }
      else {
        if (((tank.util.direction > '-95') && (tank.util.direction < '-85'))) {
          while (!((tank.util.x < '-400'))) {

          if (abort || !runtime.running) {
            break;
          };
            await runtime.nextFrame();
          }
        }
        else {
          while (!((tank.util.y < '-400'))) {

          if (abort || !runtime.running) {
            break;
          };
            await runtime.nextFrame();
          }
        }
      }
    }
    tank.util.speed = 0;
    runtime.fire('@ai_senior_${n}_${m}_start')
    done()
  });

  runtime.when('@ai_senior_${n}_${m}_watch_health', async function anonymous(done) {
    _health_ = tank.util.health;
    while (!((tank.util.health < _health_))) {

    if (abort || !runtime.running) {
      break;
    };
      await runtime.nextFrame();
    }
    runtime.fire('@ai_senior_${n}_${m}_next_place')
    done()
  });


})(runtime.${n}Tank);
`;function i8({playing:n,enemies:m,enemiesAI:y,onRequestStop:V,onChangeHealth:N}){const[T,F]=t8(null),[k,Y]=t8(!1),{fileList:H,selectedIndex:w0}=j7(),x0=H[w0];if(T){const t0=r0.project.activeLayer.children;if(n){if(!k){const P0=[];if(m>0)P0.push(n4[y.red]("red",Date.now().toString(36)));if(m>1)P0.push(n4[y.yellow]("yellow",Date.now().toString(36)));if(m>2)P0.push(n4[y.green]("green",Date.now().toString(36)));const R=new b4(V);R.launch($5(x0.script,P0)),R.on("frame",()=>{N({player:t0.player.util.health,red:t0.red.util.health,yellow:t0.yellow.util.health,green:t0.green.util.health})}),Y(R)}}else if(k)k.stop().then(()=>{N({player:100,red:100,yellow:100,green:100}),r0.project.activeLayer.children.forEach((P0)=>{if(P0.name==="background")return;if(P0.util instanceof a0||P0.owner instanceof a0)return;P0.remove()}),Y(!1)});else{if(t0.player.util.place=a0.PLACE.LEFT_TOP,m>0)t0.red.util.place=a0.PLACE.RIGHT_BOTTOM;else t0.red.util.hidden=!0;if(m>2)t0.yellow.util.place=a0.PLACE.RIGHT_TOP,t0.green.util.place=a0.PLACE.LEFT_BOTTOM;else t0.yellow.util.hidden=!0,t0.green.util.hidden=!0;r0.project.activeLayer.children.forEach((P0)=>{if(P0.name==="background")return;if(P0.util instanceof a0||P0.owner instanceof a0)return;P0.remove()})}}return o7(L5,{width:"480px",height:"480px",onSetup:(t0)=>{F(t0),r0.view.zoom=0.5,new r0.Raster({name:"background",source:O5,position:r0.view.center}),new a0("player",a0.STYLE.PLAYER,a0.PLACE.LEFT),new a0("red",a0.STYLE.ENEMY_A,a0.PLACE.RIGHT),new a0("yellow",a0.STYLE.ENEMY_B,a0.PLACE.RIGHT_BOTTOM),new a0("green",a0.STYLE.ENEMY_C,a0.PLACE.LEFT_BOTTOM)}})}import{jsx as o7} from"preact/jsx-runtime";import{useLocale as D7} from"@blockcode/core";import{classNames as v8} from"@blockcode/ui";function I6(n){const m=globalThis.document,y=m.createElement("style");y.appendChild(m.createTextNode(n)),m.head.append(y)}I6("._1mbyQG_toolbar-wrapper{height:var(--tool-bar-height);padding:var(--space)0;flex-shrink:0;justify-content:space-between;align-items:center;display:flex}._1mbyQG_green-flag,._1mbyQG_stop-all{user-select:none;cursor:pointer;border:0;border-radius:.25rem;width:2rem;height:2rem;padding:.375rem}._1mbyQG_green-flag:hover,._1mbyQG_stop-all:hover{background:var(--motion-light-transparent)}._1mbyQG_green-flag._1mbyQG_actived{background:var(--motion-transparent)}._1mbyQG_stop-all{opacity:.5}._1mbyQG_stop-all._1mbyQG_actived{opacity:1}._1mbyQG_green-flag._1mbyQG_disabled,._1mbyQG_stop-all._1mbyQG_disabled{opacity:.5}._1mbyQG_toolbar-button{width:calc(2rem + 2px);height:calc(2rem + 2px);padding:.375rem!important}._1mbyQG_space{margin-left:.2rem}._1mbyQG_toolbar-buttons-group{display:flex}._1mbyQG_group-button-first{border-top-right-radius:0;border-bottom-right-radius:0}._1mbyQG_group-button{border-left:none;border-radius:0}._1mbyQG_group-button-last{border-left:none;border-top-left-radius:0;border-bottom-left-radius:0}");var X6={toolbarButtonsGroup:"_1mbyQG_toolbar-buttons-group",stopAll:"_1mbyQG_stop-all",greenFlag:"_1mbyQG_green-flag",groupButtonLast:"_1mbyQG_group-button-last",toolbarButton:"_1mbyQG_toolbar-button",disabled:"_1mbyQG_disabled",groupButtonFirst:"_1mbyQG_group-button-first",groupButton:"_1mbyQG_group-button",actived:"_1mbyQG_actived",space:"_1mbyQG_space",toolbarWrapper:"_1mbyQG_toolbar-wrapper"};var u8="./assets/icon-green-flag-8eb2c7e7b0a15fba.svg";var h8="./assets/icon-stop-all-21d83d10e3dd785f.svg";import{jsx as P4} from"preact/jsx-runtime";function q4({playing:n,onPlay:m,onStop:y}){const{getText:V}=D7();return P4("div",{className:X6.toolbarWrapper,children:P4("div",{className:X6.toolbarButtonsGroup,children:[P4("img",{className:v8(X6.greenFlag,{[X6.actived]:n}),src:u8,title:V("tankwar.player.greenFlag","Go"),onClick:m}),P4("img",{className:v8(X6.stopAll,{[X6.actived]:n}),src:h8,title:V("tankwar.player.stopAll","Stop"),onClick:y})]})})}I6(".b0DZEW_stage-wrapper{position:relative}.b0DZEW_stage{border:1px solid var(--ui-black-transparent);border-radius:var(--space);background:var(--ui-white);width:482px;height:482px;position:relative;overflow:hidden}");var F4={stageWrapper:"b0DZEW_stage-wrapper",stage:"b0DZEW_stage"};import{jsx as S4} from"preact/jsx-runtime";function X4({playing:n,enemies:m,enemiesAI:y,onChangePlaying:V,onChangeHealth:N}){const T=()=>V(!0),F=()=>V(!1);return S4("div",{className:F4.stageWrapper,children:[S4(q4,{playing:n,onPlay:T,onStop:F}),S4("div",{className:G7(F4.stage),children:S4(i8,{playing:n,enemies:m,enemiesAI:y,onRequestStop:F,onChangeHealth:N})})]})}import{useLocale as c7,useEditor as V7} from"@blockcode/core";import{classNames as D6,Text as f4,Button as R6,Label as e6,BufferedInput as E7,ComingSoon as N7} from"@blockcode/ui";I6('.MaJ6dq_stage-info-wrapper{margin-top:var(--space);background:var(--ui-white);color:var(--text-primary);border-radius:var(--space);border:1px solid var(--ui-black-transparent);padding:1rem}.MaJ6dq_row{justify-content:space-between;margin-top:.5rem;display:flex}.MaJ6dq_row-primary{margin-top:0}.MaJ6dq_group{flex-direction:row;align-items:center;display:inline-flex}.MaJ6dq_full-input{flex:1}.MaJ6dq_name-input{width:8rem}.MaJ6dq_button{min-width:calc(2rem + 2px);height:calc(2rem + 2px);padding:.375rem!important}.MaJ6dq_button-icon{margin:auto}.MaJ6dq_space{margin-left:.2rem}.MaJ6dq_toolbar-button-group{display:flex}.MaJ6dq_group-button-first{border-top-right-radius:0;border-bottom-right-radius:0}.MaJ6dq_group-button{border-left:none;border-radius:0}.MaJ6dq_group-button-last{border-left:none;border-top-left-radius:0;border-bottom-left-radius:0}.MaJ6dq_button-text{flex:auto}.MaJ6dq_group-button-toggled-on .MaJ6dq_button-text{color:#4c97ff}.MaJ6dq_tank-image{width:1.65rem}.MaJ6dq_health-progress{background:#f5f5f5;border-radius:10px;width:12rem;height:20px}.MaJ6dq_health-progress:before{counter-reset:progress var(--percent,0);content:counter(progress)"%\u2002";width:calc(12rem*var(--percent,0)/100);color:var(--ui-white);text-align:right;white-space:nowrap;background:#ff6680;border-radius:10px;height:20px;font-size:12px;line-height:20px;display:block;overflow:hidden}');var S0={groupButtonLast:"MaJ6dq_group-button-last",nameInput:"MaJ6dq_name-input",groupButton:"MaJ6dq_group-button",space:"MaJ6dq_space",groupButtonToggledOn:"MaJ6dq_group-button-toggled-on",buttonText:"MaJ6dq_button-text",stageInfoWrapper:"MaJ6dq_stage-info-wrapper",rowPrimary:"MaJ6dq_row-primary",tankImage:"MaJ6dq_tank-image",buttonIcon:"MaJ6dq_button-icon",groupButtonFirst:"MaJ6dq_group-button-first",row:"MaJ6dq_row",group:"MaJ6dq_group",button:"MaJ6dq_button",fullInput:"MaJ6dq_full-input",toolbarButtonGroup:"MaJ6dq_toolbar-button-group",healthProgress:"MaJ6dq_health-progress"};var n8="./assets/tank-2-95f1944eace1f71a.png";var f8="./assets/tank-3-fc6d9534c6d7bba5.png";var m8="./assets/tank-4-79e2f163c902d864.png";import{jsx as C0} from"preact/jsx-runtime";var M7=[n8,f8,m8];function e4({playing:n,enemies:m,enemiesAI:y,health:V,onChangeEnemies:N,onChangeEnemyAI:T}){const{getText:F}=c7(),{fileList:k,modifyFile:Y}=V7(),H=k[0],w0=(x0,y0)=>{Y({[x0]:y0})};return C0("div",{className:S0.stageInfoWrapper,children:[C0("div",{className:D6(S0.row,S0.rowPrimary),children:[C0(e6,{text:F("tankwar.stageInfo.player","Player"),children:C0(E7,{disabled:n,className:S0.nameInput,placeholder:F("tankwar.stageInfo.nickname","Nickname"),onSubmit:(x0)=>w0("name",x0),value:H.name})}),C0(e6,{secondary:!0,className:S0.health,text:F("tankwar.stageInfo.health","Health"),children:C0("div",{className:S0.healthProgress,style:`--percent:${V.player||0}`})})]}),C0("div",{className:S0.row,children:[C0(e6,{secondary:!0,text:F("tankwar.stageInfo.enemies","Enemies"),children:[C0(R6,{disabled:n,className:D6(S0.button,S0.groupButtonFirst,{[S0.groupButtonToggledOn]:m===0}),onClick:()=>N(0),children:C0("div",{className:S0.buttonText,children:"0"})}),C0(R6,{disabled:n,className:D6(S0.button,S0.groupButton,{[S0.groupButtonToggledOn]:m===1}),onClick:()=>N(1),children:C0("div",{className:S0.buttonText,children:"1"})}),C0(R6,{disabled:n,className:D6(S0.button,S0.groupButtonLast,{[S0.groupButtonToggledOn]:m===3}),onClick:()=>N(3),children:C0("div",{className:S0.buttonText,children:"3"})})]}),m>0&&C0(e6,{secondary:!0,children:[C0(R6,{disabled:n,className:D6(S0.button,S0.groupButtonFirst,{[S0.groupButtonToggledOn]:!0}),children:C0("div",{className:S0.buttonText,children:C0(f4,{id:"tankwar.stageInfo.mode.local",defaultMessage:"Local AI"})})}),C0(N7,{placement:"bottom",children:C0(R6,{disabled:n,className:D6(S0.button,S0.groupButtonLast,{[S0.groupButtonToggledOn]:!1}),children:C0("div",{className:S0.buttonText,children:C0(f4,{id:"tankwar.stageInfo.mode.remote",defaultMessage:"Remote Players"})})})})]})]}),["red","yellow","green"].slice(0,m).map((x0,y0)=>C0("div",{className:S0.row,children:[C0(e6,{secondary:!0,children:C0("img",{className:S0.tankImage,src:M7[y0],alt:F(`tankwar.stageInfo.enemy.${x0}`,x0.replace(x0[0],x0[0].toUpperCase())),title:F(`tankwar.stageInfo.enemy.${x0}`,x0.replace(x0[0],x0[0].toUpperCase()))})}),C0(e6,{secondary:!0,children:C0("div",{className:S0.healthProgress,style:`--percent:${V[x0]||0}`})}),C0(e6,{secondary:!0,text:F("tankwar.stageInfo.ai","AI"),children:[C0(R6,{disabled:n,className:D6(S0.button,S0.groupButtonFirst,{[S0.groupButtonToggledOn]:y[x0]==="simple"}),onClick:()=>T(x0,"simple"),children:C0("div",{className:S0.buttonText,children:C0(f4,{id:"tankwar.stageInfo.ai.simple",defaultMessage:"Simple"})})}),C0(R6,{disabled:n,className:D6(S0.button,S0.groupButton,{[S0.groupButtonToggledOn]:y[x0]==="medium"}),onClick:()=>T(x0,"medium"),children:C0("div",{className:S0.buttonText,children:C0(f4,{id:"tankwar.stageInfo.ai.medium",defaultMessage:"Medium"})})}),C0(R6,{disabled:n,className:D6(S0.button,S0.groupButtonLast,{[S0.groupButtonToggledOn]:y[x0]==="senior"}),onClick:()=>T(x0,"senior"),children:C0("div",{className:S0.buttonText,children:C0(f4,{id:"tankwar.stageInfo.ai.senior",defaultMessage:"Senior"})})})]})]},y0))]})}I6(".FMSzyW_sidebar-wrapper{flex-direction:column;height:100%;display:flex}.FMSzyW_stage-wrapper{display:flex}.FMSzyW_selector-wrapper{margin-top:var(--space);flex-direction:row;height:100%;display:flex}");var T4={sidebarWrapper:"FMSzyW_sidebar-wrapper",stageWrapper:"FMSzyW_stage-wrapper",selectorWrapper:"FMSzyW_selector-wrapper"};import{jsx as W4} from"preact/jsx-runtime";function K4(){const[n,m]=_4(!1),[y,V]=_4(1),[N,T]=_4({red:"simple",yellow:"medium",green:"senior"}),[F,k]=_4({player:100,red:100,yellow:100,green:100});return W4("div",{className:T4.sidebarWrapper,children:[W4(X4,{className:T4.stageWrapper,playing:n,enemies:y,enemiesAI:N,onChangePlaying:m,onChangeHealth:k}),W4(e4,{playing:n,enemies:y,enemiesAI:N,health:F,onChangeEnemies:V,onChangeEnemyAI:(Y,H)=>T({...N,[Y]:H})})]})}var x8={fileList:[{id:"player",name:"player"}]};var s8={"tankwar.player.greenFlag":"Go","tankwar.player.stopAll":"Stop","tankwar.stageInfo.player":"Player","tankwar.stageInfo.nickname":"Nickname","tankwar.stageInfo.enemies":"Enemies","tankwar.stageInfo.health":"Health","tankwar.stageInfo.enemy.red":"Red","tankwar.stageInfo.enemy.yellow":"Yellow","tankwar.stageInfo.enemy.green":"Green","tankwar.stageInfo.mode.local":"Local AI","tankwar.stageInfo.mode.remote":"Remote Players","tankwar.stageInfo.ai":"AI","tankwar.stageInfo.ai.simple":"Simple","tankwar.stageInfo.ai.medium":"Medium","tankwar.stageInfo.ai.senior":"Senior","tankwar.blocks.motion_attack":"fire in direction %1 at %2 steps","tankwar.blocks.motion_move":"forward in direction %1 at %2 % speed","tankwar.blocks.motion_setspeed":"set speed to %1 %","tankwar.blocks.motion_stop":"stop","tankwar.blocks.motion_speed":"speed","tankwar.blocks.sensing_scanwidth":"set scan width to %1","tankwar.blocks.sensing_scan":"scan for enemy in direction %1?","tankwar.blocks.sensing_distance":"measure distance of enemy in direction %1","tankwar.blocks.sensing_health":"health"};var g8={"tankwar.player.greenFlag":"\u8FD0\u884C","tankwar.player.stopAll":"\u505C\u6B62","tankwar.stageInfo.player":"\u73A9\u5BB6","tankwar.stageInfo.nickname":"\u6635\u79F0","tankwar.stageInfo.enemies":"\u654C\u65B9\u6570\u91CF","tankwar.stageInfo.health":"\u751F\u547D\u503C","tankwar.stageInfo.enemy.red":"\u7EA2","tankwar.stageInfo.enemy.yellow":"\u9EC4","tankwar.stageInfo.enemy.green":"\u7EFF","tankwar.stageInfo.mode.local":"\u672C\u673A AI","tankwar.stageInfo.mode.remote":"\u8054\u7F51\u73A9\u5BB6","tankwar.stageInfo.ai":"AI \u7B56\u7565","tankwar.stageInfo.ai.simple":"\u7B80\u5355","tankwar.stageInfo.ai.medium":"\u4E2D\u7B49","tankwar.stageInfo.ai.senior":"\u9AD8\u7EA7","tankwar.blocks.motion_attack":"\u671D\u5411 %1 \u65B9\u5411\u8DDD\u79BB %2 \u6B65\u53D1\u5C04\u70AE\u5F39","tankwar.blocks.motion_move":"\u4EE5 %2 % \u901F\u5EA6\u9762\u5411 %1 \u65B9\u5411\u524D\u8FDB","tankwar.blocks.motion_setspeed":"\u5C06\u901F\u5EA6\u8BBE\u4E3A %1 %","tankwar.blocks.motion_stop":"\u505C\u6B62\u524D\u8FDB","tankwar.blocks.motion_speed":"\u901F\u5EA6","tankwar.blocks.sensing_scanwidth":"\u5C06\u96F7\u8FBE\u626B\u63CF\u5BBD\u5EA6\u8BBE\u4E3A %1","tankwar.blocks.sensing_scan":"\u96F7\u8FBE\u626B\u63CF %1 \u65B9\u5411\u6709\u654C\u4EBA\uFF1F","tankwar.blocks.sensing_distance":"\u96F7\u8FBE\u6D4B\u91CF %1 \u65B9\u5411\u654C\u4EBA\u7684\u8DDD\u79BB","tankwar.blocks.sensing_health":"\u751F\u547D\u503C"};function R7({addLocaleData:n,createLayout:m,openProject:y,project:V}){n(C5),n({en:s8,"zh-Hans":g8});const N=(F)=>{y(Object.assign({selectedIndex:0},F||x8))};N(V),m({mainMenu:P5({createDefaultProject:N,saveCurrentProject:()=>{return{thumb:document.querySelector("#blockcode-blocks-player").toDataURL()}}}).slice(0,2),tabs:[{...p4,Content:O4}],sidebars:[{expand:"right",Content:K4}],pane:!1,tutorials:!1,canEditProjectName:!0})}export{R7 as default};
