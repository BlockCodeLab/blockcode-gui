var Q5=Object.defineProperty;var $5=(n,m)=>{for(var l in m)Q5(n,l,{get:m[l],enumerable:!0,configurable:!0,set:(E)=>m[l]=()=>E})};var E6=((n)=>typeof require!=="undefined"?require:typeof Proxy!=="undefined"?new Proxy(n,{get:(m,l)=>(typeof require!=="undefined"?require:m)[l]}):n)(function(n){if(typeof require!=="undefined")return require.apply(this,arguments);throw Error('Dynamic require of "'+n+'" is not supported')});import{Text as i5} from"@blockcode/ui";import{Keys as $0} from"@blockcode/core";import{Text as t6,Spinner as p8} from"@blockcode/ui";import{ScratchBlocks as R6} from"@blockcode/blocks-editor";import{Serial as t8,sleep as P4} from"@blockcode/core";var i8=function(n,m){const l=`data:${n};base64,${m}`;return fetch(l).then((E)=>E.arrayBuffer())},e4=function(n){return n.replaceAll("\r\n","\n")},F4=function(n){return n.slice(2,-3)},u8="\x01",T4="\x02",l4="\x03",b4="\x04",_4=128;class H4{constructor(){this.serial=null,this._connected=!1,this._encoder=new TextEncoder,this._decoder=new TextDecoder}requestPort(n=[]){return navigator.serial.requestPort({filters:n}).then((m)=>{if(m._serial){this.serial=m._serial,this.serial.on("connect",()=>this._connected=!0),this.serial.on("disconnect",()=>this._connected=!1);return}this.serial=new t8(m),this.serial.on("connect",()=>this._connected=!0),this.serial.on("disconnect",()=>this._connected=!1)})}connect(n={}){return new Promise((m,l)=>{if(this.serial)this.serial.open({baudRate:115200,...n}).then(()=>m()).catch((E)=>{if(E.name==="InvalidStateError")this._connected=!0,m();l(E)});else l(new Error("No device specified"))})}get connected(){return this._connected}disconnect(){return this.serial.close()}get deviceInfo(){return this.serial.getInfo()}readUntil(n,m){return new Promise((l)=>{let E="";const M=async(F)=>{if(F){if(E+=this._decoder.decode(F),m)m(F)}if(E.indexOf(n)!==-1)this.serial.off("data",M),l(E)};this.serial.on("data",M)})}writeAndReadUntil(n,m,l){return new Promise(async(E)=>{if(m)this.readUntil(m,l).then(E);for(let M=0;M<n.length;M+=_4)await this.serial.write(n.slice(M,M+_4)),await P4(10);if(!m)E()})}async getPrompt(){return await P4(150),await this.stop(),await P4(150),await this.writeAndReadUntil(`\r${l4}${T4}`,"\r\n>>>")}async enterRawRepl(){return await this.writeAndReadUntil(u8,"raw REPL; CTRL-B to exit")}async exitRawRepl(){return await this.writeAndReadUntil(T4,"\r\n>>>")}async execRaw(n,m){return await this.writeAndReadUntil(n),await this.writeAndReadUntil(b4,`${b4}>`,m)}async execFile(n,m){if(m=m||function(){},n){await this.enterRawRepl();const l=await this.execRaw(n,m);return await this.exitRawRepl(),l}return Promise.reject()}async run(n,m){return m=m||function(){},new Promise(async(l,E)=>{if(this.rejectRun)this.rejectRun(new Error("re-run")),this.rejectRun=null;this.rejectRun=E;try{await this.enterRawRepl();const M=await this.execRaw(n||"#",m);return await this.exitRawRepl(),l(M)}catch(M){E(M),this.rejectRun=null}})}async eval(n){await this.serial.write(n)}async stop(){if(this.rejectRun)this.rejectRun(new Error("pre stop")),this.rejectRun=null;await this.serial.write(l4)}async reset(){if(this.rejectRun)this.rejectRun(new Error("pre reset")),this.rejectRun=null;await this.serial.write(l4),await this.serial.write(b4)}async exists(n){n=n||"";let m="";m+="try:\n",m+=`  f = open('${n}', 'r')\n`,m+="  print(1)\n",m+="except OSError:\n",m+="  print(0)\n",await this.enterRawRepl();const l=await this.execRaw(m);return await this.exitRawRepl(),l[2]=="1"}async listdir(n){n=n||"";let m="";m+="import os\n",m+="try:\n",m+=`  print(os.listdir('${n}'))\n`,m+="except OSError:\n",m+="  print([])\n",await this.enterRawRepl();let l=await this.execRaw(m);return await this.exitRawRepl(),l=F4(l),l=l.replace(/'/g,'"'),JSON.parse(l)}async mkdir(n){if(n){await this.enterRawRepl();const m=await this.execRaw(`import os\nos.mkdir('${n}')`);return await this.exitRawRepl(),m}return Promise.reject(new Error("Path to file was not specified"))}async rmdir(n){if(n){let m="";m+="import os\n",m+="try:\n",m+=`  os.rmdir("${n}")\n`,m+="except OSError:\n",m+="  print(0)\n",await this.enterRawRepl();const l=await this.execRaw(m);return await this.exitRawRepl(),l}return Promise.reject(new Error("Path to file was not specified"))}async remove(n){if(n){let m="";m+="import os\n",m+="try:\n",m+=`  os.remove("${n}")\n`,m+="except OSError:\n",m+="  print(0)\n",await this.enterRawRepl();const l=await this.execRaw(m);return this.exitRawRepl(),l}return Promise.reject(new Error("Path to file was not specified"))}async rename(n,m){if(n&&m){await this.enterRawRepl();const l=await this.execRaw(`import os\nos.rename('${n}', '${m}')`);return this.exitRawRepl(),l}return Promise.reject(new Error("Path to file was not specified"))}async cat(n){if(n){await this.enterRawRepl();let m=await this.execRaw(`with open('${n}','r') as f:\n while 1:\n  b=f.read(256)\n  if not b:break\n  print(b,end='')`);return await this.exitRawRepl(),m=F4(m),e4(m)}return Promise.reject(new Error("Path to file was not specified"))}async checkHash(n,m){if(n){let l="";l+="import os\n",l+="import hashlib\n",l+="import binascii\n",l+="hash = hashlib.sha256()\n",l+=`with open('${n}', 'rb') as f:\n`,l+="  while True:\n",l+=`    c = f.read(${_4})\n`,l+="    if not c: break\n",l+="    hash.update(c)\n",l+="print(binascii.hexlify(hash.digest()).decode())\n",await this.enterRawRepl();let E=await this.execRaw(l);return await this.exitRawRepl(),E=E.slice(2,E.indexOf("\n")-1),m===E}return Promise.reject(new Error("Path to file was not specified"))}async put(n,m,l){if(!m){Promise.reject(new Error("Must specify content and destination path"));return}let E;if(typeof n==="string")E=this._encoder.encode(e4(n));else if(n instanceof ArrayBuffer)E=new Uint8Array(n);else if(n instanceof Uint8Array)E=n;else Promise.reject(new Error(`${n} must string, Uint8Array or ArrayBuffer`));if(l=l||function(){},await this.exists(m)){const k=await crypto.subtle.digest("SHA-256",E),u0=Array.from(new Uint8Array(k)).map((i0)=>i0.toString(16).padStart(2,"0")).join("");if(await this.checkHash(m,u0)){l(100);return}}const M=Array.from(E).map((k)=>k.toString(16).padStart(2,"0"));let F="";F+=await this.enterRawRepl(),F+=await this.execRaw(`f=open('${m}','w')\nw=f.write`);const H=48;for(let k=0;k<M.length;k+=H){let u0=`w(bytes([${M.slice(k,k+H).map((i0)=>`0x${i0}`).join(",")}]))`;F+=await this.execRaw(u0),l(parseInt(k/M.length*100))}return F+=await this.execRaw("f.close()"),F+=await this.exitRawRepl(),l(100),F}}var S4=async(n,m)=>{const l=new H4;await l.requestPort(n),await l.connect(),await l.stop(),m(l);const E=()=>setTimeout(async()=>{if(l.connected)E();else m(null)},1000);return E(),l},K4=async(n,m)=>{await n.disconnect(),m(null)},Y4=async(n,m,l)=>{await n.stop();const E=m.length;let M=0;const F=(H)=>{l(parseInt((M+1/E*(H/100))*100))};for(let H of m){let{id:k,content:u0}=H;if(H.type==="text/x-python")k+=".py";else if(H.type.startsWith("image/")&&!u0)u0=await i8(H.type,H.data);await n.put(u0||"",k,F),M+=1/E}l(100),await n.reset()};import{jsx as q0,Fragment as r4} from"preact/jsx-runtime";var h5=function({newProject:n,openStoreLibrary:m,setPrompt:l,setAlert:E,removeAlert:M,extendsMenu:F,deviceFilters:H,onSave:k,onDownload:u0=async(...i0)=>Promise.all([].concat(...i0).map((P0)=>Promise.resolve(P0)))}={}){let i0=()=>{},P0=()=>{},m0=()=>{};const S0=()=>{const K=R6.getMainWorkspace();if(K){K.addChangeListener(()=>{i0(K.undoStack_.length===0),P0(K.redoStack_.length===0)}),i0(K.undoStack_.length===0),P0(K.redoStack_.length===0);return}setTimeout(S0)};S0();const Q=(K)=>{if(!Q.id)Q.id=`download.${Date.now()}`,m0(!0);if(K<100){if(E)E({id:Q.id,icon:q0(p8,{level:"success"}),message:q0(t6,{id:"blocks.alert.downloading",defaultMessage:"Downloading...{progress}%",progress:K})})}else{if(E)E({id:Q.id,icon:null,message:q0(t6,{id:"blocks.alert.downloadCompleted",defaultMessage:"Download completed."})});setTimeout(()=>{if(M)M(Q.id);m0(!1),delete Q.id},1000)}},x0=async(K,G0,r0)=>{const D0=await u0(G0,r0);try{Y4(K,D0,Q)}catch(Z0){console.error(Z0)}},O={label:q0(r4,{children:[q0("img",{src:y8}),q0(t6,{id:"blocks.menu.file",defaultMessage:"File"})]}),menuItems:[[{label:q0(t6,{id:"blocks.menu.file.newProject",defaultMessage:"New"}),hotkey:[H6?$0.COMMAND:$0.CONTROL,$0.N],onClick({context:K}){if(K.modified)l({title:q0(t6,{id:"gui.projects.notSaved",defaultMessage:"Not saved"}),label:q0(t6,{id:"gui.projects.replaceProject",defaultMessage:"Replace contents of the current project?"}),onSubmit:n});else n()}}],[{label:q0(t6,{id:"blocks.menu.file.openProject",defaultMessage:"Open"}),hotkey:[H6?$0.COMMAND:$0.CONTROL,$0.O],onClick(){m()}},{label:q0(t6,{id:"blocks.menu.file.saveProject",defaultMessage:"Save"}),hotkey:[H6?$0.COMMAND:$0.CONTROL,$0.S],async onClick({context:K}){let G0;const r0=R6.getMainWorkspace();if(r0)G0=await s8.svgAsDataUri(r0.getCanvas(),{});if(K.saveNow((D0)=>{const Z0={thumb:G0,...D0,...k()};return Z0.fileList=Z0.fileList.map((d0)=>({...d0,script:void 0,content:void 0})),Z0}),Q.id)return;if(K.device&&K.editor.autoDownload)await x0(K.device,K.fileList,K.assetList)}}],[{label:q0(t6,{id:"blocks.menu.file.uploadProject",defaultMessage:"Load from your computer"}),disabled:!0},{label:q0(t6,{id:"blocks.menu.file.downloadProject",defaultMessage:"save to your computer"}),disabled:!0}]]},M0={label:q0(r4,{children:[q0("img",{src:w8}),q0(t6,{id:"blocks.menu.edit",defaultMessage:"Edit"})]}),menuItems:[[{label:q0(t6,{id:"blocks.menu.edit.undo",defaultMessage:"Undo"}),hotkey:[H6?$0.COMMAND:$0.CONTROL,$0.Z],onDisable({setDisable:K}){i0=K;const G0=R6.getMainWorkspace();if(G0)i0(G0.undoStack_.length===0)},async onClick(K){const G0=R6.getMainWorkspace();if(K instanceof MouseEvent&&G0)G0.undo(!1)}},{label:q0(t6,{id:"blocks.menu.edit.redo",defaultMessage:"Redo"}),hotkey:H6?[$0.SHIFT,$0.COMMAND,$0.Z]:[$0.CONTROL,$0.Y],onDisable({setDisable:K}){P0=K;const G0=R6.getMainWorkspace();if(G0)P0(G0.redoStack_.length===0)},async onClick(K){const G0=R6.getMainWorkspace();if(K instanceof MouseEvent&&G0)G0.undo(!0)}}]]},f0={label:q0(r4,{children:[q0("img",{src:d8}),q0(t6,{id:"blocks.menu.device",defaultMessage:"Device"})]}),menuItems:[[{label:q0(t6,{id:"blocks.menu.device.connect",defaultMessage:"Connect your device"}),onLabel({locale:K,context:G0}){if(G0.device)return K.getText("blocks.menu.device.disconnect","Disconnect this device");return K.getText("blocks.menu.device.connect","Connect your device")},onClick({context:K}){if(K.device){if(K4(K.device,K.connectDevice),Q.id){if(M)M(Q.id);delete Q.id}}else S4(H||U4,K.connectDevice)}},{label:q0(t6,{id:"blocks.menu.device.download",defaultMessage:"Download program"}),onDisable({setDisable:K}){m0=K,m0(!!Q.id)},async onClick({context:K}){if(Q.id)return;let{device:G0}=K;if(!G0)G0=await S4(H||U4,K.connectDevice);await x0(G0,K.fileList,K.assetList)}}],[{label:q0(t6,{id:"blocks.menu.device.turnOnAutoDownload",defaultMessage:"Turn on auto download"}),onLabel({locale:K,context:G0}){if(G0.editor.autoDownload)return K.getText("blocks.menu.device.turnOffAutoDownload","Turn off auto download");return K.getText("blocks.menu.device.turnOnAutoDownload","Turn on auto download")},onDisable({context:K,setDisable:G0}){if(!K.device&&K.editor.autoDownload)K.setEditor({autoDownload:!1});G0(!K.device)},async onClick({context:K}){K.setEditor({autoDownload:!K.editor.autoDownload})}}]]};F=F||[];const y6=(K,G0)=>{const r0=F.findIndex((D0)=>D0.id===G0);if(r0>=0){const[D0]=F.splice(r0,1);if(D0.hidden)return[];if(D0.label)K.label=D0.label;K.menuItems=[].concat(K.menuItems,D0.menuItems)}return K};return[].concat(y6(O,"file"),y6(M0,"edit"),y6(f0,"device"),F)};import{ScratchBlocks as w6} from"@blockcode/blocks-editor";import{ScratchBlocks as D4} from"@blockcode/blocks-editor";import{ScratchBlocks as f5} from"@blockcode/blocks-editor";import{useState as j4} from"preact/hooks";import{useLocale as P8,useEditor as l8} from"@blockcode/core";import{classNames as b8} from"@blockcode/ui";import{BlocksEditor as _8,ScratchBlocks as r6,makeToolboxXML as S8} from"@blockcode/blocks-editor";import{ScratchBlocks as r8,blockSeparator as j8} from"@blockcode/blocks-editor";var I8=function(n,m){const{id:l}=n,E=h4(n.name,m);let M=`<category name="${j6(E)}" id="${j6(l)}"`;if(M+=` colour="${j6(n.themeColor||Z4)}"`,M+=` secondaryColour="${j6(n.inputColor||J4)}"`,n.iconURI)M+=` iconURI="${j6(n.iconURI)}"`;return M+=">\n",n.blocks.forEach((F)=>{if(F==="---")return M+=`${j8}\n`,M;const H=`${l}_${F.id.toLowerCase()}`,k={message0:h4(F.text,m),category:l,outputShape:C8,colour:n.themeColor||Z4,colourSecondary:n.inputColor||J4,colourTertiary:n.otherColor||G8};let u0=1;if(n.iconURI)k.message0=`%1 %2 ${k.message0}`,k.args0=[{type:"field_image",src:n.iconURI,width:40,height:40},{type:"field_vertical_separator"}],k.extensions=["scratch_extension"],u0+=2;if(F.hat)k.nextStatement=null;else if(F.output)if(F.output==="boolean")k.output="Boolean",k.outputShape=o8;else k.output="String",k.outputShape=D8;else k.previousStatement=null,k.nextStatement=null;let i0=`<block type="${j6(H)}">\n`;if(F.inputs)k.args0=[].concat(k.args0||[],Object.entries(F.inputs).map(([P0,m0])=>{const S0={name:P0,type:"input_value"};if(m0.menu)S0.type="field_dropdown",S0.options=m0.menu.map(([Q,x0])=>[h4(Q,m),x0]);else if(m0.type==="boolean")S0.check="Boolean";else{if(i0+=`<value name="${j6(P0)}">\n`,m0.type==="number")i0+='<shadow type="math_number">\n',i0+='<field name="NUM">';else if(m0.type==="angle")i0+='<shadow type="math_angle">\n',i0+='<field name="NUM">';else i0+=`<shadow type="${j6(m0.type)}">\n`,i0+=`<field name="${j6(m0.type.toUpperCase())}">`;i0+=`${j6(m0.default)}</field>\n`,i0+="</shadow>\n",i0+="</value>"}return k.message0=k.message0.replace(`[${P0}]`,`%${u0++}`),S0}));if(r8.Blocks[H]={init(){this.jsonInit(k)}},F.python)I[H]=F.python.bind(I);else I[H]=()=>"";i0+="</block>\n",M+=i0}),M+="</category>\n",M};import{useRef as B8,useEffect as k8,useState as Q4} from"preact/hooks";import{classNames as c8,Text as q6,Button as $4,Modal as L8,BufferedInput as z8} from"@blockcode/ui";var C4=function(n){const m=globalThis.document,l=m.createElement("style");l.appendChild(m.createTextNode(n)),m.head.append(l)};import{jsx as K0} from"preact/jsx-runtime";var V8=function({title:n,label:m,defaultValue:l,enableLocalVariable:E,showListMessage:M,showVariableOptions:F,showCloudOption:H,onClose:k,onSubmit:u0}){const i0=B8(null),[P0,m0]=Q4(l),[S0,Q]=Q4({scope:"global",isCloud:!1}),x0=()=>{u0(P0,S0)},O=(M0)=>{if(M0.key==="Escape")k();if(M0.key==="Enter")u0(i0.current.base.value,S0)};return k8(()=>{if(i0.current)i0.current.base.focus(),window.addEventListener("keydown",O);return()=>{window.removeEventListener("keydown",O)}},[i0]),K0(L8,{title:n,className:o6.promptModal,onClose:k,children:K0("div",{className:o6.promptContent,children:[K0("div",{className:o6.label,children:m}),K0(z8,{autoFocus:!0,forceFocus:!0,ref:i0,className:o6.variableNameTextInput,defaultValue:P0,onSubmit:m0}),F&&K0("div",{children:E?K0("div",{className:o6.options,children:[K0("label",{children:[K0("input",{checked:S0.scope==="global",name:"variableScopeOption",type:"radio",value:"global",onChange:()=>Q({...S0,scope:"global"})}),K0(q6,{id:"blocks.dataPrompt.forAllTargets",defaultMessage:"For all targets"})]}),K0("label",{children:[K0("input",{checked:S0.scope==="local",name:"variableScopeOption",type:"radio",value:"local",onChange:()=>Q({...S0,scope:"local"})}),K0(q6,{id:"blocks.dataPrompt.forThisTarget",defaultMessage:"For this target only"})]})]}):K0("div",{className:o6.infoMessage,children:M?K0(q6,{id:"blocks.dataPrompt.listAvailableToAllTargets",defaultMessage:"This list will be available to all targets."}):K0(q6,{id:"blocks.dataPrompt.availableToAllTargets",defaultMessage:"This variable will be available to all targets."})})}),K0("div",{className:o6.buttonRow,children:[K0($4,{className:o6.button,onClick:k,children:K0(q6,{id:"blocks.dataPrompt.cancel",defaultMessage:"Cancel"})}),K0($4,{className:c8(o6.button,o6.okButton),onClick:x0,children:K0(q6,{id:"blocks.dataPrompt.ok",defaultMessage:"OK"})})]})]})})};import{useEffect as M8,useState as t5} from"preact/hooks";import{useLocale as E8,useEditor as G3} from"@blockcode/core";import{Library as N8} from"@blockcode/ui";import{jsx as O8} from"preact/jsx-runtime";var R8=function({onSelect:n,onClose:m,onFilter:l,onShowPrompt:E,onShowAlert:M,onHideAlert:F}){const[H,k]=t5([]),[u0,i0]=t5(!1),{language:P0,getText:m0}=E8(),S0=(Q)=>{if(l){const x0=Q.tags||[],O=l(x0);if(Array.isArray(O))return O.every((M0)=>{if(Array.isArray(M0))return M0.some((f0)=>x0.includes(f0));return x0.includes(M0)});return O}return!0};return M8(()=>{A8.then((Q)=>{k(Q.filter(S0).map((x0)=>Object.assign({...x0,featured:!0,onSelect:async()=>{M("importing",{id:x0.id});const{default:O}=await import(`@blockcode/extension-${x0.id}/blocks`);O.id=x0.id,n(O),F(x0.id),m()}},x0.translations&&x0.translations[P0]?{name:x0.translations[P0].name||x0.name,description:x0.translations[P0].description||x0.description,collaborator:x0.translations[P0].collaborator||x0.collaborator}:{}))),i0(!1)})},[]),O8(N8,{loading:u0,items:H,title:m0("blocks.extensions.addExtension","Add Extension"),emptyText:m0("blocks.extensions.empty","No extension!"),onClose:m})};import{jsx as N6} from"preact/jsx-runtime";var X8=function({toolbox:n,messages:m,enableMultiTargets:l,enableLocalVariable:E,disableGenerator:M,disableExtension:F,onChange:H,onExtensionsFilter:k,onLoadExtension:u0,onShowPrompt:i0,onShowAlert:P0,onHideAlert:m0,onReady:S0}){const{addLocaleData:Q,getText:x0}=P8(),{editor:O,fileList:M0,selectedIndex:f0,openFile:y6,modifyFile:K}=l8(),[G0,r0]=j4(),[D0,Z0]=j4(!1),[d0,v6]=j4(!1);if(O.splash){let T=!0;if(M0.length>1){for(let c0=0;c0>-M0.length;c0--)if(!M0.at(c0).content){T=!1,setTimeout(()=>{y6((c0+M0.length)%M0.length)},100);break}}if(T&&typeof O.splash==="boolean")O.splash=setTimeout(S0,100)}m={EVENT_WHENPROGRAMSTART:x0("blocks.event.programStart","when program start"),CONTROL_STOP_OTHER:x0("blocks.control.stopOther","other scripts"),...m||[]},r6.prompt=(T,c0,e0,w0,O0)=>{const F0={callback:e0,message:T,defaultValue:c0};F0.title=w0?w0:r6.Msg.VARIABLE_MODAL_TITLE,F0.varType=typeof O0==="string"?O0:r6.SCALAR_VARIABLE_TYPE,F0.showVariableOptions=l&&O0!==r6.BROADCAST_MESSAGE_VARIABLE_TYPE&&F0.title!==r6.Msg.RENAME_VARIABLE_MODAL_TITLE&&F0.title!==r6.Msg.RENAME_LIST_MODAL_TITLE,F0.showCloudOption=O0===r6.SCALAR_VARIABLE_TYPE&&this.props.canUseCloud,Z0(F0)};let l6;if(G0)l6=G0.getAllVariables().filter((T)=>{if(T.isLocal)return!1;if(T.type===r6.BROADCAST_MESSAGE_VARIABLE_TYPE){if(T.name===r6.Msg.DEFAULT_BROADCAST_MESSAGE_NAME)return!1;const c0=T.id_.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),e0=new RegExp(`<field name="BROADCAST_OPTION" id="${c0}"[^>]+>[^<]+</field>`,"g");for(let w0 of M0)if(e0.test(w0.xml))return!0;return!1}return!0});let g0=n||S8();u5.forEach((T)=>{g0+=I8(T,x0)});const J=(T,c0)=>{let e0;if(!M)e0=I.workspaceToCode(c0);if(K({xml:T,content:e0}),H)H(T,c0)},$=(T,c0)=>{D0.callback(T,[],c0),Z0(!1)},W=()=>Z0(!1),n0=()=>v6(!0),Z=()=>v6(!1),B0=(T)=>{if(Q(T.translations),u0)u0(T);u5.set(T.id,T),setTimeout(()=>{G0.toolbox_.setSelectedCategoryById(T.id)},10)};return N6("div",{className:o4.editorWrapper,children:[N6(_8,{toolbox:g0,messages:m,globalVariables:l6,onWorkspaceCreated:r0,onChange:f0!==-1?J:null}),F?null:N6("div",{className:b8("scratchCategoryMenu",o4.extensionButton),children:N6("button",{className:o4.addButton,title:x0("blocks.extensions.addExtension","Add Extension"),onClick:n0,children:N6("img",{src:q8,title:"Add Extension"})})}),D0&&N6(V8,{title:D0.title,label:D0.message,defaultValue:D0.defaultValue,enableLocalVariable:E,showListMessage:D0.varType===r6.LIST_VARIABLE_TYPE,showVariableOptions:D0.showVariableOptions,showCloudOption:D0.showCloudOption,onClose:W,onSubmit:$}),d0&&N6(R8,{onFilter:k,onSelect:B0,onClose:Z,onShowPrompt:i0,onShowAlert:P0,onHideAlert:m0})]})};import{jsx as F8} from"preact/jsx-runtime";var T8=function(){return F8("div",{className:e8.pane})};import{jsx as n5} from"preact/jsx-runtime";var h8=Object.create,{defineProperty:W4,getPrototypeOf:f8,getOwnPropertyNames:n8}=Object,g8=Object.prototype.hasOwnProperty,v8=(n,m,l)=>{l=n!=null?h8(f8(n)):{};const E=m||!n||!n.__esModule?W4(l,"default",{value:n,enumerable:!0}):l;for(let M of n8(n))if(!g8.call(E,M))W4(E,M,{get:()=>n[M],enumerable:!0});return E},m8=(n,m)=>()=>(m||n((m={exports:{}}).exports,m),m.exports),x8=m8((n)=>{(function(){var m=typeof n!="undefined"&&n||typeof define!="undefined"&&{}||this||window;if(typeof define!=="undefined")define("save-svg-as-png",[],function(){return m});m.default=m;var l="http://www.w3.org/2000/xmlns/",E="http://www.w3.org/1999/xhtml",M="http://www.w3.org/2000/svg",F='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd" [<!ENTITY nbsp "&#160;">]>',H=/url\(["']?(.+?)["']?\)/,k={woff2:"font/woff2",woff:"font/woff",otf:"application/x-font-opentype",ttf:"application/x-font-ttf",eot:"application/vnd.ms-fontobject",sfnt:"application/font-sfnt",svg:"image/svg+xml"},u0=function g0(J){return J instanceof HTMLElement||J instanceof SVGElement},i0=function g0(J){if(!u0(J))throw new Error("an HTMLElement or SVGElement is required; got "+J)},P0=function g0(J){return new Promise(function($,W){if(u0(J))$(J);else W(new Error("an HTMLElement or SVGElement is required; got "+J))})},m0=function g0(J){return J&&J.lastIndexOf("http",0)===0&&J.lastIndexOf(window.location.host)===-1},S0=function g0(J){var $=Object.keys(k).filter(function(W){return J.indexOf("."+W)>0}).map(function(W){return k[W]});if($)return $[0];return console.error("Unknown font format for "+J+". Fonts may not be working correctly."),"application/octet-stream"},Q=function g0(J){var $="",W=new Uint8Array(J);for(var n0=0;n0<W.byteLength;n0++)$+=String.fromCharCode(W[n0]);return window.btoa($)},x0=function g0(J,$,W){var n0=J.viewBox&&J.viewBox.baseVal&&J.viewBox.baseVal[W]||$.getAttribute(W)!==null&&!$.getAttribute(W).match(/%$/)&&parseInt($.getAttribute(W))||J.getBoundingClientRect()[W]||parseInt($.style[W])||parseInt(window.getComputedStyle(J).getPropertyValue(W));return typeof n0==="undefined"||n0===null||isNaN(parseFloat(n0))?0:n0},O=function g0(J,$,W,n0){if(J.tagName==="svg")return{width:W||x0(J,$,"width"),height:n0||x0(J,$,"height")};else if(J.getBBox){var Z=J.getBBox(),B0=Z.x,T=Z.y,c0=Z.width,e0=Z.height;return{width:B0+c0,height:T+e0}}},M0=function g0(J){return decodeURIComponent(encodeURIComponent(J).replace(/%([0-9A-F]{2})/g,function($,W){var n0=String.fromCharCode("0x"+W);return n0==="%"?"%25":n0}))},f0=function g0(J){var $=window.atob(J.split(",")[1]),W=J.split(",")[0].split(":")[1].split(";")[0],n0=new ArrayBuffer($.length),Z=new Uint8Array(n0);for(var B0=0;B0<$.length;B0++)Z[B0]=$.charCodeAt(B0);return new Blob([n0],{type:W})},y6=function g0(J,$){if(!$)return;try{return J.querySelector($)||J.parentNode&&J.parentNode.querySelector($)}catch(W){console.warn('Invalid CSS selector "'+$+'"',W)}},K=function g0(J,$){var W=J.cssText.match(H),n0=W&&W[1]||"";if(!n0||n0.match(/^data:/)||n0==="about:blank")return;var Z=n0.startsWith("../")?$+"/../"+n0:n0.startsWith("./")?$+"/."+n0:n0;return{text:J.cssText,format:S0(Z),url:Z}},G0=function g0(J){return Promise.all(Array.from(J.querySelectorAll("image")).map(function($){var W=$.getAttributeNS("http://www.w3.org/1999/xlink","href")||$.getAttribute("href");if(!W)return Promise.resolve(null);if(m0(W))W+=(W.indexOf("?")===-1?"?":"&")+"t="+(new Date()).valueOf();return new Promise(function(n0,Z){var B0=document.createElement("canvas"),T=new Image;T.crossOrigin="anonymous",T.src=W,T.onerror=function(){return Z(new Error("Could not load "+W))},T.onload=function(){B0.width=T.width,B0.height=T.height,B0.getContext("2d").drawImage(T,0,0),$.setAttributeNS("http://www.w3.org/1999/xlink","href",B0.toDataURL("image/png")),n0(!0)}})}))},r0={},D0=function g0(J){return Promise.all(J.map(function($){return new Promise(function(W,n0){if(r0[$.url])return W(r0[$.url]);var Z=new XMLHttpRequest;Z.addEventListener("load",function(){var B0=Q(Z.response),T=$.text.replace(H,'url("data:'+$.format+";base64,"+B0+'")')+"\n";r0[$.url]=T,W(T)}),Z.addEventListener("error",function(B0){console.warn("Failed to load font from: "+$.url,B0),r0[$.url]=null,W(null)}),Z.addEventListener("abort",function(B0){console.warn("Aborted loading font from: "+$.url,B0),W(null)}),Z.open("GET",$.url),Z.responseType="arraybuffer",Z.send()})})).then(function($){return $.filter(function(W){return W}).join("")})},Z0=null,d0=function g0(){if(Z0)return Z0;return Z0=Array.from(document.styleSheets).map(function(J){try{return{rules:J.cssRules,href:J.href}}catch($){return console.warn("Stylesheet could not be loaded: "+J.href,$),{}}})},v6=function g0(J,$){var W=$||{},n0=W.selectorRemap,Z=W.modifyStyle,B0=W.modifyCss,T=W.fonts,c0=W.excludeUnusedCss,e0=B0||function(Y0,f6){var W0=n0?n0(Y0):Y0,s0=Z?Z(f6):f6;return W0+"{"+s0+"}\n"},w0=[],O0=typeof T==="undefined",F0=T||[];return d0().forEach(function(Y0){var{rules:f6,href:W0}=Y0;if(!f6)return;Array.from(f6).forEach(function(s0){if(typeof s0.style!="undefined"){if(y6(J,s0.selectorText))w0.push(e0(s0.selectorText,s0.style.cssText));else if(O0&&s0.cssText.match(/^@font-face/)){var n6=K(s0,W0);if(n6)F0.push(n6)}else if(!c0)w0.push(s0.cssText)}})}),D0(F0).then(function(Y0){return w0.join("\n")+Y0})},l6=function g0(){if(!navigator.msSaveOrOpenBlob&&!("download"in document.createElement("a")))return{popup:window.open()}};m.prepareSvg=function(g0,J,$){i0(g0);var W=J||{},n0=W.left,Z=n0===void 0?0:n0,B0=W.top,T=B0===void 0?0:B0,c0=W.width,e0=W.height,w0=W.scale,O0=w0===void 0?1:w0,F0=W.responsive,Y0=F0===void 0?!1:F0,f6=W.excludeCss,W0=f6===void 0?!1:f6;return G0(g0).then(function(){var s0=g0.cloneNode(!0);s0.style.backgroundColor=(J||{}).backgroundColor||g0.style.backgroundColor;var n6=O(g0,s0,c0,e0),m6=n6.width,x6=n6.height;if(g0.tagName!=="svg")if(g0.getBBox){if(s0.getAttribute("transform")!=null)s0.setAttribute("transform",s0.getAttribute("transform").replace(/translate\(.*?\)/,""));var A0=document.createElementNS("http://www.w3.org/2000/svg","svg");A0.appendChild(s0),s0=A0}else{console.error("Attempted to render non-SVG element",g0);return}if(s0.setAttribute("version","1.1"),s0.setAttribute("viewBox",[Z,T,m6,x6].join(" ")),!s0.getAttribute("xmlns"))s0.setAttributeNS(l,"xmlns",M);if(!s0.getAttribute("xmlns:xlink"))s0.setAttributeNS(l,"xmlns:xlink","http://www.w3.org/1999/xlink");if(Y0)s0.removeAttribute("width"),s0.removeAttribute("height"),s0.setAttribute("preserveAspectRatio","xMinYMin meet");else s0.setAttribute("width",m6*O0),s0.setAttribute("height",x6*O0);if(Array.from(s0.querySelectorAll("foreignObject > *")).forEach(function(A6){A6.setAttributeNS(l,"xmlns",A6.tagName==="svg"?M:E)}),W0){var T0=document.createElement("div");T0.appendChild(s0);var R0=T0.innerHTML;if(typeof $==="function")$(R0,m6,x6);else return{src:R0,width:m6,height:x6}}else return v6(g0,J).then(function(A6){var I6=document.createElement("style");I6.setAttribute("type","text/css"),I6.innerHTML="<![CDATA[\n"+A6+"\n]]>";var t4=document.createElement("defs");t4.appendChild(I6),s0.insertBefore(t4,s0.firstChild);var F6=document.createElement("div");F6.appendChild(s0);var u4=F6.innerHTML.replace(/NS\d+:href/gi,'xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href');if(typeof $==="function")$(u4,m6,x6);else return{src:u4,width:m6,height:x6}})})},m.svgAsDataUri=function(g0,J,$){return i0(g0),m.prepareSvg(g0,J).then(function(W){var{src:n0,width:Z,height:B0}=W,T="data:image/svg+xml;base64,"+window.btoa(M0(F+n0));if(typeof $==="function")$(T,Z,B0);return T})},m.svgAsPngUri=function(g0,J,$){i0(g0);var W=J||{},n0=W.encoderType,Z=n0===void 0?"image/png":n0,B0=W.encoderOptions,T=B0===void 0?0.8:B0,c0=W.canvg,e0=function w0(O0){var{src:F0,width:Y0,height:f6}=O0,W0=document.createElement("canvas"),s0=W0.getContext("2d"),n6=window.devicePixelRatio||1;if(W0.width=Y0*n6,W0.height=f6*n6,W0.style.width=W0.width+"px",W0.style.height=W0.height+"px",s0.setTransform(n6,0,0,n6,0,0),c0)c0(W0,F0);else s0.drawImage(F0,0,0);var m6=void 0;try{m6=W0.toDataURL(Z,T)}catch(x6){if(typeof SecurityError!=="undefined"&&x6 instanceof SecurityError||x6.name==="SecurityError"){console.error("Rendered SVG images cannot be downloaded in this browser.");return}else throw x6}if(typeof $==="function")$(m6,W0.width,W0.height);return Promise.resolve(m6)};if(c0)return m.prepareSvg(g0,J).then(e0);else return m.svgAsDataUri(g0,J).then(function(w0){return new Promise(function(O0,F0){var Y0=new Image;Y0.onload=function(){return O0(e0({src:Y0,width:Y0.width,height:Y0.height}))},Y0.onerror=function(){F0("There was an error loading the data URI as an image on the following SVG\n"+window.atob(w0.slice(26))+"Open the following link to see browser\'s diagnosis\n"+w0)},Y0.src=w0})})},m.download=function(g0,J,$){if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(f0(J),g0);else{var W=document.createElement("a");if("download"in W){W.download=g0,W.style.display="none",document.body.appendChild(W);try{var n0=f0(J),Z=URL.createObjectURL(n0);W.href=Z,W.onclick=function(){return requestAnimationFrame(function(){return URL.revokeObjectURL(Z)})}}catch(B0){console.error(B0),console.warn("Error while getting object URL. Falling back to string URL."),W.href=J}W.click(),document.body.removeChild(W)}else if($&&$.popup)$.popup.document.title=g0,$.popup.location.replace(J)}},m.saveSvg=function(g0,J,$){var W=l6();return P0(g0).then(function(n0){return m.svgAsDataUri(n0,$||{})}).then(function(n0){return m.download(J,n0,W)})},m.saveSvgAsPng=function(g0,J,$){var W=l6();return P0(g0).then(function(n0){return m.svgAsPngUri(n0,$||{})}).then(function(n0){return m.download(J,n0,W)})}})()}),s8=v8(x8(),1),U4=[{usbVendorId:12346},{usbVendorId:11914}],y8="./assets/icon-file-1def53419f4ad0ae.svg",w8="./assets/icon-edit-2b1e47b495524ed2.svg",d8="./assets/icon-device-c2fafab2eaccf043.svg",H6=/Mac/i.test(navigator.platform||navigator.userAgent);var I=new w6.Generator("Python");I.addReservedWords("False,None,True,and,as,assert,break,class,continue,def,del,elif,else,except,exec,finally,for,from,global,if,import,in,is,lambda,nonlocal,not,or,pass,print,raise,return,try,while,with,yield,NotImplemented,Ellipsis,__debug__,quit,exit,copyright,license,credits,ArithmeticError,AssertionError,AttributeError,BaseException,BlockingIOError,BrokenPipeError,BufferError,BytesWarning,ChildProcessError,ConnectionAbortedError,ConnectionError,ConnectionRefusedError,ConnectionResetError,DeprecationWarning,EOFError,Ellipsis,EnvironmentError,Exception,FileExistsError,FileNotFoundError,FloatingPointError,FutureWarning,GeneratorExit,IOError,ImportError,ImportWarning,IndentationError,IndexError,InterruptedError,IsADirectoryError,KeyError,KeyboardInterrupt,LookupError,MemoryError,ModuleNotFoundError,NameError,NotADirectoryError,NotImplemented,NotImplementedError,OSError,OverflowError,PendingDeprecationWarning,PermissionError,ProcessLookupError,RecursionError,ReferenceError,ResourceWarning,RuntimeError,RuntimeWarning,StandardError,StopAsyncIteration,StopIteration,SyntaxError,SyntaxWarning,SystemError,SystemExit,TabError,TimeoutError,TypeError,UnboundLocalError,UnicodeDecodeError,UnicodeEncodeError,UnicodeError,UnicodeTranslateError,UnicodeWarning,UserWarning,ValueError,Warning,ZeroDivisionError,_,__build_class__,__debug__,__doc__,__import__,__loader__,__name__,__package__,__spec__,abs,all,any,apply,ascii,basestring,bin,bool,buffer,bytearray,bytes,callable,chr,classmethod,cmp,coerce,compile,complex,copyright,credits,delattr,dict,dir,divmod,enumerate,eval,exec,execfile,exit,file,filter,float,format,frozenset,getattr,globals,hasattr,hash,help,hex,id,input,int,intern,isinstance,issubclass,iter,len,license,list,locals,long,map,max,memoryview,min,next,object,oct,open,ord,pow,print,property,quit,range,raw_input,reduce,reload,repr,reversed,round,set,setattr,slice,sorted,staticmethod,str,sum,super,tuple,type,unichr,unicode,vars,xrange,zip");I.ORDER_ATOMIC=0;I.ORDER_COLLECTION=1;I.ORDER_STRING_CONVERSION=1;I.ORDER_MEMBER=2.1;I.ORDER_FUNCTION_CALL=2.2;I.ORDER_EXPONENTIATION=3;I.ORDER_UNARY_SIGN=4;I.ORDER_BITWISE_NOT=4;I.ORDER_MULTIPLICATIVE=5;I.ORDER_ADDITIVE=6;I.ORDER_BITWISE_SHIFT=7;I.ORDER_BITWISE_AND=8;I.ORDER_BITWISE_XOR=9;I.ORDER_BITWISE_OR=10;I.ORDER_RELATIONAL=11;I.ORDER_LOGICAL_NOT=12;I.ORDER_LOGICAL_AND=13;I.ORDER_LOGICAL_OR=14;I.ORDER_CONDITIONAL=15;I.ORDER_LAMBDA=16;I.ORDER_NONE=99;I.ORDER_OVERRIDES=[[I.ORDER_FUNCTION_CALL,I.ORDER_MEMBER],[I.ORDER_FUNCTION_CALL,I.ORDER_FUNCTION_CALL],[I.ORDER_MEMBER,I.ORDER_MEMBER],[I.ORDER_MEMBER,I.ORDER_FUNCTION_CALL],[I.ORDER_LOGICAL_NOT,I.ORDER_LOGICAL_NOT],[I.ORDER_LOGICAL_AND,I.ORDER_LOGICAL_AND],[I.ORDER_LOGICAL_OR,I.ORDER_LOGICAL_OR]];I.init=(n)=>{if(I.PASS=I.INDENT+"pass\n",I.definitions_=Object.create(null),I.functionNames_=Object.create(null),!I.variableDB_)I.variableDB_=new w6.Names(I.RESERVED_WORDS_);else I.variableDB_.reset();I.variableDB_.setVariableMap(n.getVariableMap());const m=[],l=n.getAllVariables();for(let M=0;M<l.length;M++){if(l[M].type===w6.BROADCAST_MESSAGE_VARIABLE_TYPE)continue;let F=I.variableDB_.getName(l[M].getId(),w6.Variables.NAME_TYPE),H="";if(l[M].type===w6.LIST_VARIABLE_TYPE)F=`${F}_${w6.LIST_VARIABLE_TYPE}`,H="[]";m.push(`${F} = ${H}`)}const E=w6.Variables.allDeveloperVariables(n);for(let M=0;M<E.length;M++){let F=I.variableDB_.getName(E[M],w6.Names.DEVELOPER_VARIABLE_TYPE),H="";if(l[M].type===w6.LIST_VARIABLE_TYPE)F=`${F}_${w6.LIST_VARIABLE_TYPE}`,H="[]";m.push(`${F} = ${H}`)}if(m.length)I.definitions_.variables=m.join("\n");I.definitions_.import_blocks="from blocks import *"};I.finish=(n)=>{const m=[],l=[];for(let E in I.definitions_){const M=I.definitions_[E];if(M.match(/^(from\s+\S+\s+)?import\s+\S+/))m.push(M);else l.push(M)}return delete I.definitions_,delete I.functionNames_,I.variableDB_.reset(),(m.join("\n")+"\n\n"+l.join("\n\n")).replace(/\n\n+/g,"\n\n").replace(/\n*$/,"\n\n\n")+n};I.scrubNakedValue=(n)=>{return n+"\n"};I.quote_=(n)=>{n=n.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/\%/g,"\\%");let m='"';if(n.indexOf('"')!==-1)if(n.indexOf("'")===-1)m="'";else n=n.replace(/"/g,'\\"');return m+n+m};I.scrub_=(n,m)=>{let l="";if(!n.outputConnection||!n.outputConnection.targetConnection){let E=n.getCommentText();if(E=w6.utils.wrap(E,I.COMMENT_WRAP-3),E)if(n.getProcedureDef)l+='"""'+E+'\n"""\n';else l+=I.prefixLines(E+"\n","# ");for(let M=0;M<n.inputList.length;M++)if(n.inputList[M].type==w6.INPUT_VALUE){const F=n.inputList[M].connection.targetBlock();if(F){const H=I.allNestedComments(F);if(H)l+=I.prefixLines(H,"# ")}}}if(n.startHat_){const E=n.nextConnection&&n.nextConnection.targetBlock();let M=I.blockToCode(E);if(M)M=I.prefixLines(M,I.INDENT),m=m.replace(`\n${I.PASS}`,`\n${M}`);return l+m}if(n.parentBlock_){const E=n.nextConnection&&n.nextConnection.targetBlock(),M=I.blockToCode(E);return l+m+M}};I.getAdjustedInt=(n,m,l,E)=>{let M=l||0;if(n.workspace.options.oneBasedIndex)M--;const F=n.workspace.options.oneBasedIndex?"1":"0",H=M?I.ORDER_ADDITIVE:I.ORDER_NONE;let k=I.valueToCode(n,m,H)||F;if(w6.isNumber(k)){if(k=parseInt(k,10)+M,E)k=-k}else{if(M>0)k="int("+k+" + "+M+")";else if(M<0)k="int("+k+" - "+-M+")";else k="int("+k+")";if(E)k="-"+k}return k};I.hatToCode=(n="",...m)=>{if(!I.functionNames_[n])I.functionNames_[n]=0;I.functionNames_[n]+=1;const l=`${n}_${I.functionNames_[n]}`;return I.HAT_FUNCTION_PLACEHOLDER=l,`async def ${l}(${m.join(", ")}):\n  this_func = ${l}\n${I.PASS}\n`};var K6="  await runtime.next_frame()\n";I.control_wait=(n)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,n);const l=I.valueToCode(n,"DURATION",I.ORDER_NONE)||0;return m+=`await runtime.wait_for(num(${l}))\n`,m};I.control_repeat=(n)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,n);let l=I.statementToCode(n,"SUBSTACK")||I.PASS;if(I.STATEMENT_SUFFIX)l=I.prefixLines(I.injectId(I.STATEMENT_SUFFIX,n),I.INDENT)+l;const E=I.valueToCode(n,"TIMES",I.ORDER_NONE)||10;return m+=`for _ in range(num(${E})):\n${l}${K6}`,m};I.control_forever=(n)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,n);let l=I.statementToCode(n,"SUBSTACK")||I.PASS;if(I.STATEMENT_SUFFIX)l=I.prefixLines(I.injectId(I.STATEMENT_SUFFIX,n),I.INDENT)+l;return m+=`while True:\n${l}${K6}`,m};I.control_if=(n)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,n);let l=I.statementToCode(n,"SUBSTACK")||I.PASS;if(I.STATEMENT_SUFFIX)l=I.prefixLines(I.injectId(I.STATEMENT_SUFFIX,n),I.INDENT)+l;const E=I.valueToCode(n,"CONDITION",I.ORDER_NONE)||"False";if(m+=`if ${E}:\n${l}`,n.getInput("SUBSTACK2")){if(l=I.statementToCode(n,"SUBSTACK2")||I.PASS,I.STATEMENT_SUFFIX)l=I.prefixLines(I.injectId(I.STATEMENT_SUFFIX,n),I.INDENT)+l;m+=`else:\n${l}`}return m};I.control_if_else=I.control_if;I.control_wait_until=(n)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,n);const l=I.valueToCode(n,"CONDITION",I.ORDER_NONE)||"False";return m+=`while not ${l}:${K6}`,m};I.control_repeat_until=(n)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,n);let l=I.statementToCode(n,"SUBSTACK")||I.PASS;if(I.STATEMENT_SUFFIX)l=I.prefixLines(I.injectId(I.STATEMENT_SUFFIX,n),I.INDENT)+l;const E=I.valueToCode(n,"CONDITION",I.ORDER_NONE)||"False";return m+=`while not ${E}:\n${l}${K6}`,m};I.control_while=(n)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,n);let l=I.statementToCode(n,"SUBSTACK")||I.PASS;if(I.STATEMENT_SUFFIX)l=I.prefixLines(I.injectId(I.STATEMENT_SUFFIX,n),I.INDENT)+l;const E=I.valueToCode(n,"CONDITION",I.ORDER_NONE)||"False";return m+=`while ${E}:\n${l}${K6}`,m};I.control_stop=(n)=>{let m="";if(I.STATEMENT_PREFIX)m+=I.injectId(I.STATEMENT_PREFIX,n);switch(n.getFieldValue("STOP_OPTION")){case"all":m+="runtime.stop()\n";break;case"this script":m+="return\n";break;case"other scripts in sprite":m+="runtime.stop_tasks(this_func)\n";break}return m};I.data_variable=(n)=>{return[I.variableDB_.getName(n.getFieldValue("VARIABLE"),D4.Variables.NAME_TYPE),I.ORDER_ATOMIC]};I.data_setvariableto=(n)=>{let m="";if(javascriptGenerator.STATEMENT_PREFIX)m+=javascriptGenerator.injectId(javascriptGenerator.STATEMENT_PREFIX,n);const l=I.variableDB_.getName(n.getFieldValue("VARIABLE"),D4.Variables.NAME_TYPE),E=I.valueToCode(n,"VALUE",I.ORDER_NONE)||'""';return m+=`${l} = ${E}\n`,m};I.data_changevariableby=(n)=>{let m="";if(javascriptGenerator.STATEMENT_PREFIX)m+=javascriptGenerator.injectId(javascriptGenerator.STATEMENT_PREFIX,n);const l=I.variableDB_.getName(n.getFieldValue("VARIABLE"),D4.Variables.NAME_TYPE),E=I.valueToCode(n,"VALUE",I.ORDER_NONE)||0;return m+=`${l} = num(${l}) + num(${E})\n`,m};I.data_listcontents=(n)=>{};I.data_addtolist=(n)=>{};I.data_deleteoflist=(n)=>{};I.data_deletealloflist=(n)=>{};I.data_insertatlist=(n)=>{};I.data_replaceitemoflist=(n)=>{};I.data_itemoflist=(n)=>{};I.data_itemnumoflist=(n)=>{};I.data_lengthoflist=(n)=>{};I.data_listcontainsitem=(n)=>{};I.event_whenflagclicked=(n)=>{return`${I.hatToCode("start")}runtime.when_start(${I.HAT_FUNCTION_PLACEHOLDER})\n`};I.event_whengreaterthan=(n)=>{const m=n.getFieldValue("WHENGREATERTHANMENU"),l=I.valueToCode(n,"VALUE",I.ORDER_NONE)||0;return`${I.hatToCode("greaterthen")}runtime.when_greaterthen("${m}", num(${l}), ${I.HAT_FUNCTION_PLACEHOLDER})\n`};I.event_whenbroadcastreceived=(n)=>{const m=I.variableDB_.getName(n.getFieldValue("BROADCAST_OPTION"),f5.Variables.NAME_TYPE);return`${I.hatToCode("broadcastreceived")}runtime.when_broadcastreceived("${m}", ${I.HAT_FUNCTION_PLACEHOLDER})\n`};I.event_broadcast_menu=(n)=>{return[I.variableDB_.getName(n.getFieldValue("BROADCAST_OPTION"),f5.Variables.NAME_TYPE),I.ORDER_ATOMIC]};I.event_broadcast=(n)=>{return`runtime.broadcast("${I.valueToCode(n,"BROADCAST_INPUT",I.ORDER_NONE)||'"message1"'}")\n`};I.event_broadcastandwait=(n)=>{return`await runtime.broadcast("${I.valueToCode(n,"BROADCAST_INPUT",I.ORDER_NONE)||'"message1"'}")\n`};I.addReservedWords("math,random,Number");I.math_number=(n)=>{let m=parseFloat(n.getFieldValue("NUM")),l;if(m===Infinity)m='float("inf")',l=I.ORDER_FUNCTION_CALL;else if(m===(-Infinity))m='-float("inf")',l=I.ORDER_UNARY_SIGN;else if(Number.isNaN(m))m='float("nan")',l=I.ORDER_UNARY_SIGN;else l=m<0?I.ORDER_UNARY_SIGN:I.ORDER_ATOMIC;return[m,l]};I.math_integer=(n)=>{const m=parseInt(n.getFieldValue("NUM")),l=m<0?I.ORDER_UNARY_SIGN:I.ORDER_ATOMIC;return[m,l]};I.math_whole_number=(n)=>{return[Math.abs(parseInt(n.getFieldValue("NUM"))),I.ORDER_ATOMIC]};I.math_positive_number=(n)=>{let m=parseFloat(n.getFieldValue("NUM")),l;if(m===Infinity)m='float("inf")',l=I.ORDER_FUNCTION_CALL;else if(m===(-Infinity))m='-float("inf")',l=I.ORDER_FUNCTION_CALL;else if(Number.isNaN(m))m='float("nan")',l=I.ORDER_FUNCTION_CALL;else m=m<0?0:m,l=I.ORDER_ATOMIC;return[m,l]};I.math_angle=(n)=>{let m=parseFloat(n.getFieldValue("NUM")),l;if(m==Infinity)m='float("inf")',l=I.ORDER_FUNCTION_CALL;else if(m==(-Infinity))m='-float("inf")',l=I.ORDER_UNARY_SIGN;else m=m%360,m=m<0?m+360:m,l=I.ORDER_ATOMIC;return[m,l]};I.operator_add=(n)=>{const m=I.valueToCode(n,"NUM1",I.ORDER_NONE)||0,l=I.valueToCode(n,"NUM2",I.ORDER_NONE)||0;return[`(num(${m}) + num(${l}))`,I.ORDER_SUBTRACTION]};I.operator_subtract=(n)=>{const m=I.valueToCode(n,"NUM1",I.ORDER_NONE)||0,l=I.valueToCode(n,"NUM2",I.ORDER_NONE)||0;return[`(num(${m}) - num(${l}))`,I.ORDER_SUBTRACTION]};I.operator_multiply=(n)=>{const m=I.valueToCode(n,"NUM1",I.ORDER_NONE)||0,l=I.valueToCode(n,"NUM2",I.ORDER_NONE)||0;return[`(num(${m}) * num(${l}))`,I.ORDER_SUBTRACTION]};I.operator_divide=(n)=>{const m=I.valueToCode(n,"NUM1",I.ORDER_NONE)||0,l=I.valueToCode(n,"NUM2",I.ORDER_NONE)||0;return[`(num(${m}) / num(${l}))`,I.ORDER_SUBTRACTION]};I.operator_random=(n)=>{const m=I.valueToCode(n,"FROM",I.ORDER_NONE)||0,l=I.valueToCode(n,"TO",I.ORDER_NONE)||0;return[`runtime.random(${m}, ${l})`,I.ORDER_FUNCTION_CALL]};I.operator_gt=(n)=>{const m=I.valueToCode(n,"OPERAND1",I.ORDER_NONE)||0,l=I.valueToCode(n,"OPERAND2",I.ORDER_NONE)||0;return[`(num(${m}) > num(${l}))`,I.ORDER_RELATIONAL]};I.operator_lt=(n)=>{const m=I.valueToCode(n,"OPERAND1",I.ORDER_NONE)||0,l=I.valueToCode(n,"OPERAND2",I.ORDER_NONE)||0;return[`(num(${m}) < num(${l}))`,I.ORDER_RELATIONAL]};I.operator_equals=(n)=>{const m=I.valueToCode(n,"OPERAND1",I.ORDER_NONE)||0,l=I.valueToCode(n,"OPERAND2",I.ORDER_NONE)||0;return[`(num(${m}) == num(${l}) or str(${m}) == str(${l}))`,I.ORDER_RELATIONAL]};I.operator_and=(n)=>{const m=I.valueToCode(n,"OPERAND1",I.ORDER_NONE)||"False",l=I.valueToCode(n,"OPERAND2",I.ORDER_NONE)||"False";return[`(${m} and ${l})`,I.ORDER_LOGICAL_AND]};I.operator_or=(n)=>{const m=I.valueToCode(n,"OPERAND1",I.ORDER_NONE)||"False",l=I.valueToCode(n,"OPERAND2",I.ORDER_NONE)||"False";return[`(${m} or ${l})`,I.ORDER_LOGICAL_OR]};I.operator_not=(n)=>{return[`(not ${I.valueToCode(n,"OPERAND",I.ORDER_NONE)||"False"})`,I.ORDER_LOGICAL_NOT]};I.operator_join=(n)=>{const m=I.valueToCode(n,"STRING1",I.ORDER_NONE)||'""',l=I.valueToCode(n,"STRING2",I.ORDER_NONE)||'""';return[`(str(${m}) + str(${l}))`,I.ORDER_ATOMIC]};I.operator_letter_of=(n)=>{const m=I.valueToCode(n,"LETTER",I.ORDER_NONE)||0;return[`(str(${I.valueToCode(n,"STRING",I.ORDER_NONE)||'""'})[num(${m}) - 1] || "")`,I.ORDER_MEMBER]};I.operator_length=(n)=>{return[`len(str(${I.valueToCode(n,"STRING",I.ORDER_NONE)||'""'}))`,I.ORDER_FUNCTION_CALL]};I.operator_contains=(n)=>{const m=I.valueToCode(n,"STRING1",I.ORDER_NONE)||'""',l=I.valueToCode(n,"STRING2",I.ORDER_NONE)||'""';return[`(str(${m}).count(str(${l})) > 0)`,I.ORDER_FUNCTION_CALL]};I.operator_mod=(n)=>{const m=I.valueToCode(n,"NUM1",I.ORDER_NONE)||0,l=I.valueToCode(n,"NUM2",I.ORDER_NONE)||0;return[`(num(${m}) % num(${l}))`,I.ORDER_MODULUS]};I.operator_round=(n)=>{return I.definitions_.import_math="import math",[`math.round(num(${I.valueToCode(n,"NUM",I.ORDER_NONE)||0}))`,I.ORDER_FUNCTION_CALL]};I.operator_mathop=(n)=>{I.definitions_.import_math="import math";const m=I.valueToCode(n,"NUM",I.ORDER_NONE)||0,l=n.getFieldValue("OPERATOR");let E="";if(l==="ceiling")E+=`math.ceil(num(${m}))`;else if(l==="sin"||l==="cos"||l==="tan")E+=`math.${l}(math.radians(num(${m})))`;else if(l==="asin"||l==="acos"||l==="atan")E+=`math.degrees(math.${l}(num(${m})))`;else if(l==="ln")E+=`(math.log(num(${m}))`;else if(l==="log")E+=`(math.log10(num(${m}))`;else if(l==="e ^")E+=`math.exp(num(${m}))`;else if(l==="10 ^")E+=`math.pow(10, num(${m}))`;else E+=`math.${l}(num(${m}))`;return[E,I.ORDER_FUNCTION_CALL]};I.procedures_definition=(n)=>{};I.procedures_call=(n)=>{};I.procedures_prototype=(n)=>{};I.procedures_declaration=(n)=>{};I.argument_reporter_boolean=(n)=>{};I.argument_reporter_string_number=(n)=>{};I.argument_editor_boolean=(n)=>{};I.argument_editor_string_number=(n)=>{};I.sensing_timer=(n)=>{return["runtime.time",I.ORDER_MEMBER]};I.sensing_resettimer=(n)=>{return"runtime.reset_timer()\n"};I.text=(n)=>{const m=n.getFieldValue("TEXT");return[isNaN(m)?I.quote_(m):+m,I.ORDER_ATOMIC]};var o8=1,D8=2,C8=3,Z4="#0FBD8C",J4="#0DA57A",G8="#0B8E69",h4=(n,m)=>{if(typeof n==="string")return n;if(n.props.children)return n.props.children.map((l)=>h4(l,m)).join(" ");return m(n.props.id,n.props)},j6=(n)=>{if(typeof n!=="string")if(Array.isArray(n))n=String(n);else return n;return n.replace(/[<>&'"]/g,(m)=>{switch(m){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;"}})};C4(".R1cW-q_prompt-modal{width:360px}.R1cW-q_prompt-content{background:var(--ui-white);padding:1.5rem 2.25rem}.R1cW-q_prompt-content input[type=checkbox],.R1cW-q_prompt-content input[type=radio]{margin:3px}.R1cW-q_label{margin:0 0 .75rem;font-weight:500}.R1cW-q_variable-name-text-input{border:1px solid var(--ui-black-transparent);color:var(--text-primary-transparent);border-radius:5px;width:100%;height:3rem;margin-bottom:1.5rem;padding:0 1rem;font-size:.875rem}.R1cW-q_info-message{text-align:center;margin-bottom:1.5rem;font-size:.875rem;font-weight:400}.R1cW-q_options{justify-content:space-between;margin-bottom:1.5rem;font-weight:400;display:flex}.R1cW-q_button-row{text-align:right;font-weight:bolder}.R1cW-q_button{padding:.75rem 1rem;font-size:.85rem;font-weight:600}.R1cW-q_ok-button{background:var(--motion-primary);border:var(--motion-primary);color:var(--ui-white);margin-left:var(--space)}");var o6={infoMessage:"R1cW-q_info-message",variableNameTextInput:"R1cW-q_variable-name-text-input",label:"R1cW-q_label",promptContent:"R1cW-q_prompt-content",options:"R1cW-q_options",promptModal:"R1cW-q_prompt-modal",button:"R1cW-q_button",okButton:"R1cW-q_ok-button",buttonRow:"R1cW-q_button-row"},a8=["servo","pen","request","text"].map(async(n)=>{const{default:m}=await import(`@blockcode/extension-${n}`);return m.id=n,m}),A8=Promise.all(a8);C4(".OF790G_editor-wrapper{border-radius:inherit;width:100%;height:100%;position:relative}.OF790G_extension-button{z-index:var(--z-index-extension-button);background:var(--motion-primary);border:1px solid var(--motion-primary);box-sizing:content-box;border-bottom-left-radius:inherit;border-top:0;height:3.25rem;position:absolute;bottom:-1px;left:-1px}.OF790G_extension-button:before{--fade-out-distance:15px;content:\"\";top:calc(calc(-1*var(--fade-out-distance)));height:var(--fade-out-distance);background:linear-gradient(#0000,#00000026);position:absolute;left:0;right:0}.OF790G_add-button{cursor:pointer;background:0 0;border:none;outline:none;width:100%;height:100%}.OF790G_add-button img{width:1.75rem;height:1.75rem}");var o4={editorWrapper:"OF790G_editor-wrapper",extensionButton:"OF790G_extension-button",addButton:"OF790G_add-button"},q8="./assets/icon-extension-5ec2ee35b87b4126.svg",u5=new Map;C4(".GS2oYa_pane{height:8rem}");var e8={pane:"GS2oYa_pane"},H8="./assets/icon-blocks-d7e4a3a3eb74d0fb.svg",K8={"blocks.menu.file":"File","blocks.menu.file.newProject":"New","blocks.menu.file.openProject":"Open","blocks.menu.file.saveProject":"Save","blocks.menu.file.uploadProject":"Load from your computer","blocks.menu.file.downloadProject":"Save to your computer","blocks.menu.edit":"Edit","blocks.menu.edit.undo":"Undo","blocks.menu.edit.redo":"Redo","blocks.menu.device":"Device","blocks.menu.device.connect":"Connect to your device","blocks.menu.device.disconnect":"Disconnect this device","blocks.menu.device.download":"Download program","blocks.menu.device.turnOnAutoDownload":"Turn on Auto Download","blocks.menu.device.turnOffAutoDownload":"Turn off Auto Download","blocks.alert.downloading":"Downloading...{progress}%","blocks.alert.downloadCompleted":"Download completed.","blocks.codeTab":"Code","blocks.backpackPane.title":"Backpack","blocks.downloadToDevice":"Download","blocks.extensions.addExtension":"Add Extension","blocks.extensions.empty":"No extension!","blocks.dataPrompt.forAllTargets":"For all targets","blocks.dataPrompt.forThisTarget":"For this target only","blocks.dataPrompt.availableToAllTargets":"This variable will be available to all targets.","blocks.dataPrompt.listAvailableToAllTargets":"This list will be available to all targets.","blocks.dataPrompt.cancel":"Cancel","blocks.dataPrompt.ok":"OK","blocks.event.programStart":"when program start","blocks.control.stopOther":"other scripts"},Y8={"blocks.menu.file":"\u6587\u4EF6","blocks.menu.file.newProject":"\u65B0\u4F5C\u54C1","blocks.menu.file.openProject":"\u6253\u5F00","blocks.menu.file.saveProject":"\u4FDD\u5B58","blocks.menu.file.uploadProject":"\u4ECE\u7535\u8111\u4E2D\u6253\u5F00","blocks.menu.file.downloadProject":"\u4FDD\u5B58\u5230\u7535\u8111","blocks.menu.edit":"\u7F16\u8F91","blocks.menu.edit.undo":"\u64A4\u9500","blocks.menu.edit.redo":"\u6062\u590D","blocks.menu.device":"\u8BBE\u5907","blocks.menu.device.connect":"\u8FDE\u63A5\u8BBE\u5907","blocks.menu.device.disconnect":"\u65AD\u5F00\u8BBE\u5907\u8FDE\u63A5","blocks.menu.device.download":"\u4E0B\u8F7D\u7A0B\u5E8F","blocks.menu.device.turnOnAutoDownload":"\u6253\u5F00\u81EA\u52A8\u4E0B\u8F7D","blocks.menu.device.turnOffAutoDownload":"\u5173\u95ED\u81EA\u52A8\u4E0B\u8F7D","blocks.alert.downloading":"\u6B63\u5728\u4E0B\u8F7D\u2026{progress}%","blocks.alert.downloadCompleted":"\u4E0B\u8F7D\u5B8C\u6210\u3002","blocks.codeTab":"\u4EE3\u7801","blocks.backpackPane.title":"\u4E66\u5305","blocks.downloadToDevice":"\u4E0B\u8F7D","blocks.extensions.addExtension":"\u6DFB\u52A0\u6269\u5C55","blocks.extensions.empty":"\u6CA1\u6709\u6269\u5C55\uFF01","blocks.dataPrompt.forAllTargets":"\u9002\u7528\u4E8E\u5168\u5C40","blocks.dataPrompt.forThisTarget":"\u4EC5\u9002\u7528\u4E8E\u5F53\u524D","blocks.dataPrompt.availableToAllTargets":"\u5168\u5C40\u90FD\u53EF\u4F7F\u7528\u8BE5\u53D8\u91CF\u3002","blocks.dataPrompt.listAvailableToAllTargets":"\u5168\u5C40\u90FD\u53EF\u4F7F\u7528\u8BE5\u5217\u8868\u3002","blocks.dataPrompt.cancel":"\u53D6\u6D88","blocks.dataPrompt.ok":"\u786E\u5B9A","blocks.event.programStart":"\u5F53\u7A0B\u5E8F\u5F00\u59CB\u8FD0\u884C","blocks.control.stopOther":"\u5176\u4ED6\u811A\u672C"},g5={en:K8,"zh-Hans":Y8},f4={icon:H8,label:n5(i5,{id:"blocks.codeTab",defaultMessage:"Code"}),Content:X8},z3={label:n5(i5,{id:"blocks.backpackPane.title",defaultMessage:"Backpack"}),Content:T8};import{useLocale as P7} from"@blockcode/core";import{ScratchBlocks as Q3,makeToolboxXML as p7,blockSeparator as D6,categorySeparator as c4} from"@blockcode/blocks-editor";import{ScratchBlocks as n4} from"@blockcode/blocks-editor";n4.Blocks.event_whenflagclicked={init(){this.jsonInit({message0:n4.Msg.EVENT_WHENFLAGCLICKED,args0:[{type:"field_image",src:n4.mainWorkspace.options.pathToMedia+"green-flag.svg",width:24,height:24,alt:"flag"}],category:n4.Categories.event,extensions:["colours_event","shape_hat"]})}};import{ScratchBlocks as g6} from"@blockcode/blocks-editor";g6.Blocks.motion_attack={init(){this.jsonInit({message0:g6.Msg.MOTION_ATTACK,args0:[{type:"input_value",name:"DIRECTION"},{type:"input_value",name:"DISTANCE"}],category:g6.Categories.motion,extensions:["colours_motion","shape_statement"]})}};g6.Blocks.motion_move={init(){this.jsonInit({message0:g6.Msg.MOTION_MOVE,args0:[{type:"input_value",name:"DIRECTION"},{type:"input_value",name:"SPEED"}],category:g6.Categories.motion,extensions:["colours_motion","shape_statement"]})}};g6.Blocks.motion_setspeed={init(){this.jsonInit({message0:g6.Msg.MOTION_SETSPEED,args0:[{type:"input_value",name:"SPEED"}],category:g6.Categories.motion,extensions:["colours_motion","shape_statement"]})}};g6.Blocks.motion_stop={init(){this.jsonInit({message0:g6.Msg.MOTION_STOP,category:g6.Categories.motion,extensions:["colours_motion","shape_statement"]})}};g6.Blocks.motion_speed={init(){this.jsonInit({message0:g6.Msg.MOTION_SPEED,category:g6.Categories.motion,checkboxInFlyout:!0,extensions:["colours_motion","output_number"]})}};import{ScratchBlocks as P6} from"@blockcode/blocks-editor";P6.Blocks.sensing_scanwidth={init(){this.jsonInit({message0:P6.Msg.SENSING_SCANWIDTH,args0:[{type:"input_value",name:"WIDTH"}],category:P6.Categories.sensing,extensions:["colours_sensing","shape_statement"]})}};P6.Blocks.sensing_scan={init(){this.jsonInit({message0:P6.Msg.SENSING_SCAN,args0:[{type:"input_value",name:"DIRECTION"}],category:P6.Categories.sensing,extensions:["colours_sensing","output_boolean"]})}};P6.Blocks.sensing_scandistance={init(){this.jsonInit({message0:P6.Msg.SENSING_DISTANCE,args0:[{type:"input_value",name:"DIRECTION"}],category:P6.Categories.sensing,extensions:["colours_sensing","output_number"]})}};P6.Blocks.sensing_health={init(){this.jsonInit({message0:P6.Msg.SENSING_HEALTH,category:P6.Categories.sensing,checkboxInFlyout:!0,extensions:["colours_sensing","output_number"]})}};import{useRef as t7,useEffect as u7} from"preact/hooks";import{useEditor as i7} from"@blockcode/core";import{ScratchBlocks as p6} from"@blockcode/blocks-editor";import{ScratchBlocks as d6} from"@blockcode/blocks-editor";import{ScratchBlocks as X0} from"@blockcode/blocks-editor";import{ScratchBlocks as p5} from"@blockcode/blocks-editor";var y5=function({width:n,height:m,onSetup:l,...E}){const M=t7(null),{fileList:F,selectedIndex:H,modifyFile:k}=i7(),u0=F[H];return M.script=u0.script,M.xml=u0.xml,u7(()=>{if(M.current){if(G4.default.setup(M.current),l)l(M.current);const i0=()=>{const P0=p6.getMainWorkspace();if(P0){P0.addChangeListener((m0)=>{if(P0.isDragging())return;if(!n7.has(m0.type))return;const S0=p6.Xml.workspaceToDom(P0),Q=p6.Xml.domToText(S0).replace(/<variable type="broadcast_msg"[^>]+>[^<]+<\/variable>/gi,"");if(!M.script||M.xml!==Q){const x0=b.workspaceToCode(P0);if(M.script!==x0)k({script:x0})}});return}setTimeout(i0)};i0()}return()=>{G4.default.project.clear(),G4.default.project.remove()}},[M]),f7("canvas",{id:"blockcode-blocks-player",ref:M,style:{width:n,height:m},...E})};import{jsx as f7} from"preact/jsx-runtime";var W8=Object.create,{defineProperty:v5,getPrototypeOf:U8,getOwnPropertyNames:Z8}=Object,J8=Object.prototype.hasOwnProperty,I4=(n,m,l)=>{l=n!=null?W8(U8(n)):{};const E=m||!n||!n.__esModule?v5(l,"default",{value:n,enumerable:!0}):l;for(let M of Z8(n))if(!J8.call(E,M))v5(E,M,{get:()=>n[M],enumerable:!0});return E},Q8=(n,m)=>()=>(m||n((m={exports:{}}).exports,m),m.exports),a3=((n)=>typeof E6!=="undefined"?E6:typeof Proxy!=="undefined"?new Proxy(n,{get:(m,l)=>(typeof E6!=="undefined"?E6:m)[l]}):n)(function(n){if(typeof E6!=="undefined")return E6.apply(this,arguments);throw Error('Dynamic require of "'+n+'" is not supported')}),B4=Q8((n,m)=>{/*!
 * Paper.js v0.12.17 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, Jürg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Thu Nov 3 21:15:36 2022 +0100
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 Jürg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */var l=function(E,M){E=E||(()=>({}));var{window:F,document:H}=E,k=new function(){var t=/^(statics|enumerable|beans|preserve)$/,u=[],i=u.slice,h=Object.create,f=Object.getOwnPropertyDescriptor,g=Object.defineProperty,x=u.forEach||function(P,w){for(var r=0,C=this.length;r<C;r++)P.call(w,this[r],r,this)},v=function(P,w){for(var r in this)if(this.hasOwnProperty(r))P.call(w,this[r],r,this)},s=Object.assign||function(P){for(var w=1,r=arguments.length;w<r;w++){var C=arguments[w];for(var B in C)if(C.hasOwnProperty(B))P[B]=C[B]}return P},p=function(P,w,r){if(P){var C=f(P,"length");(C&&typeof C.value==="number"?x:v).call(P,w,r=r||P)}return r};function d(P,w,r,C,B){var j={};function o(c,L){if(L=L||(L=f(w,c))&&(L.get?L:L.value),typeof L==="string"&&L[0]==="#")L=P[L.substring(1)]||L;var z=typeof L==="function",V=L,N=B||z&&!L.base?L&&L.get?c in P:P[c]:null,q;if(!B||!N){if(z&&N)L.base=N;if(z&&C!==!1&&(q=c.match(/^([gs]et|is)(([A-Z])(.*))$/)))j[q[3].toLowerCase()+q[4]]=q[2];if(!V||z||!V.get||typeof V.get!=="function"||!_.isPlainObject(V))V={value:V,writable:!0};if((f(P,c)||{configurable:!0}).configurable)V.configurable=!0,V.enumerable=r!=null?r:!q;g(P,c,V)}}if(w){for(var y in w)if(w.hasOwnProperty(y)&&!t.test(y))o(y);for(var y in j){var S=j[y],D=P["set"+S],G=P["get"+S]||D&&P["is"+S];if(G&&(C===!0||G.length===0))o(y,{get:G,set:D})}}return P}function _(){for(var P=0,w=arguments.length;P<w;P++){var r=arguments[P];if(r)s(this,r)}return this}return d(_,{inject:function(P){if(P){var w=P.statics===!0?P:P.statics,r=P.beans,C=P.preserve;if(w!==P)d(this.prototype,P,P.enumerable,r,C);d(this,w,null,r,C)}for(var B=1,j=arguments.length;B<j;B++)this.inject(arguments[B]);return this},extend:function(){var P=this,w,r;for(var C=0,B,j=arguments.length;C<j&&!(w&&r);C++)B=arguments[C],w=w||B.initialize,r=r||B.prototype;if(w=w||function(){P.apply(this,arguments)},r=w.prototype=r||h(this.prototype),g(r,"constructor",{value:w,writable:!0,configurable:!0}),d(w,this),arguments.length)this.inject.apply(w,arguments);return w.base=P,w}}).inject({enumerable:!1,initialize:_,set:_,inject:function(){for(var P=0,w=arguments.length;P<w;P++){var r=arguments[P];if(r)d(this,r,r.enumerable,r.beans,r.preserve)}return this},extend:function(){var P=h(this);return P.inject.apply(P,arguments)},each:function(P,w){return p(this,P,w)},clone:function(){return new this.constructor(this)},statics:{set:s,each:p,create:h,define:g,describe:f,clone:function(P){return s(new P.constructor,P)},isPlainObject:function(P){var w=P!=null&&P.constructor;return w&&(w===Object||w===_||w.name==="Object")},pick:function(P,w){return P!==M?P:w},slice:function(P,w,r){return i.call(P,w,r)}}})};if(typeof m!=="undefined")m.exports=k;k.inject({enumerable:!1,toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+k.each(this,function(t,u){if(!/^_/.test(u)){var i=typeof t;this.push(u+": "+(i==="number"?S0.instance.number(t):i==="string"?"'"+t+"'":t))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(t){return k.importJSON(t,this)},exportJSON:function(t){return k.exportJSON(this,t)},toJSON:function(){return k.serialize(this)},set:function(t,u){if(t)k.filter(this,t,u,this._prioritize);return this}},{beans:!1,statics:{exports:{},extend:function t(){var u=t.base.apply(this,arguments),i=u.prototype._class;if(i&&!k.exports[i])k.exports[i]=u;return u},equals:function(t,u){if(t===u)return!0;if(t&&t.equals)return t.equals(u);if(u&&u.equals)return u.equals(t);if(t&&u&&typeof t==="object"&&typeof u==="object"){if(Array.isArray(t)&&Array.isArray(u)){var i=t.length;if(i!==u.length)return!1;while(i--)if(!k.equals(t[i],u[i]))return!1}else{var h=Object.keys(t),i=h.length;if(i!==Object.keys(u).length)return!1;while(i--){var f=h[i];if(!(u.hasOwnProperty(f)&&k.equals(t[f],u[f])))return!1}}return!0}return!1},read:function(t,u,i,h){if(this===k){var f=this.peek(t,u);return t.__index++,f}var g=this.prototype,x=g._readIndex,v=u||x&&t.__index||0,s=t.length,p=t[v];if(h=h||s-v,p instanceof this||i&&i.readNull&&p==null&&h<=1){if(x)t.__index=v+1;return p&&i&&i.clone?p.clone():p}if(p=k.create(g),x)p.__read=!0;if(p=p.initialize.apply(p,v>0||v+h<s?k.slice(t,v,v+h):t)||p,x){t.__index=v+p.__read;var d=p.__filtered;if(d)t.__filtered=d,p.__filtered=M;p.__read=M}return p},peek:function(t,u){return t[t.__index=u||t.__index||0]},remain:function(t){return t.length-(t.__index||0)},readList:function(t,u,i,h){var f=[],g,x=u||0,v=h?x+h:t.length;for(var s=x;s<v;s++)f.push(Array.isArray(g=t[s])?this.read(g,0,i):this.read(t,s,i,1));return f},readNamed:function(t,u,i,h,f){var g=this.getNamed(t,u),x=g!==M;if(x){var v=t.__filtered;if(!v){var s=this.getSource(t);v=t.__filtered=k.create(s),v.__unfiltered=s}v[u]=M}return this.read(x?[g]:t,i,h,f)},readSupported:function(t,u){var i=this.getSource(t),h=this,f=!1;if(i)Object.keys(i).forEach(function(g){if(g in u){var x=h.readNamed(t,g);if(x!==M)u[g]=x;f=!0}});return f},getSource:function(t){var u=t.__source;if(u===M){var i=t.length===1&&t[0];u=t.__source=i&&k.isPlainObject(i)?i:null}return u},getNamed:function(t,u){var i=this.getSource(t);if(i)return u?i[u]:t.__filtered||i},hasNamed:function(t,u){return!!this.getNamed(t,u)},filter:function(t,u,i,h){var f;function g(d){if(!(i&&(d in i))&&!(f&&(d in f))){var _=u[d];if(_!==M)t[d]=_}}if(h){var x={};for(var v=0,s,p=h.length;v<p;v++)if((s=h[v])in u)g(s),x[s]=!0;f=x}return Object.keys(u.__unfiltered||u).forEach(g),t},isPlainValue:function(t,u){return k.isPlainObject(t)||Array.isArray(t)||u&&typeof t==="string"},serialize:function(t,u,i,h){u=u||{};var f=!h,g;if(f)u.formatter=new S0(u.precision),h={length:0,definitions:{},references:{},add:function(_,P){var w="#"+_._id,r=this.references[w];if(!r){this.length++;var C=P.call(_),B=_._class;if(B&&C[0]!==B)C.unshift(B);this.definitions[w]=C,r=this.references[w]=[w]}return r}};if(t&&t._serialize){g=t._serialize(u,h);var x=t._class;if(x&&!t._compactSerialize&&(f||!i)&&g[0]!==x)g.unshift(x)}else if(Array.isArray(t)){g=[];for(var v=0,s=t.length;v<s;v++)g[v]=k.serialize(t[v],u,i,h)}else if(k.isPlainObject(t)){g={};var p=Object.keys(t);for(var v=0,s=p.length;v<s;v++){var d=p[v];g[d]=k.serialize(t[d],u,i,h)}}else if(typeof t==="number")g=u.formatter.number(t,u.precision);else g=t;return f&&h.length>0?[["dictionary",h.definitions],g]:g},deserialize:function(t,u,i,h,f){var g=t,x=!i,v=x&&t&&t.length&&t[0][0]==="dictionary";if(i=i||{},Array.isArray(t)){var s=t[0],p=s==="dictionary";if(t.length==1&&/^#/.test(s))return i.dictionary[s];s=k.exports[s],g=[];for(var d=s?1:0,_=t.length;d<_;d++)g.push(k.deserialize(t[d],u,i,p,v));if(s){var P=g;if(u)g=u(s,P,x||f);else g=new s(P)}}else if(k.isPlainObject(t)){if(g={},h)i.dictionary=g;for(var w in t)g[w]=k.deserialize(t[w],u,i)}return v?g[1]:g},exportJSON:function(t,u){var i=k.serialize(t,u);return u&&u.asString==!1?i:JSON.stringify(i)},importJSON:function(t,u){return k.deserialize(typeof t==="string"?JSON.parse(t):t,function(i,h,f){var g=f&&u&&u.constructor===i,x=g?u:k.create(i.prototype);if(h.length===1&&x instanceof d0&&(g||!(x instanceof l6))){var v=h[0];if(k.isPlainObject(v)){if(v.insert=!1,g)h=h.concat([d0.INSERT])}}if((g?x.set:i).apply(x,h),g)u=null;return x})},push:function(t,u){var i=u.length;if(i<4096)t.push.apply(t,u);else{var h=t.length;t.length+=i;for(var f=0;f<i;f++)t[h+f]=u[f]}return t},splice:function(t,u,i,h){var f=u&&u.length,g=i===M;if(i=g?t.length:i,i>t.length)i=t.length;for(var x=0;x<f;x++)u[x]._index=i+x;if(g)return k.push(t,u),[];else{var v=[i,h];if(u)k.push(v,u);var s=t.splice.apply(t,v);for(var x=0,p=s.length;x<p;x++)s[x]._index=M;for(var x=i+f,p=t.length;x<p;x++)t[x]._index=x;return s}},capitalize:function(t){return t.replace(/\b[a-z]/g,function(u){return u.toUpperCase()})},camelize:function(t){return t.replace(/-(.)/g,function(u,i){return i.toUpperCase()})},hyphenate:function(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var u0={on:function(t,u){if(typeof t!=="string")k.each(t,function(g,x){this.on(x,g)},this);else{var i=this._eventTypes,h=i&&i[t],f=this._callbacks=this._callbacks||{};if(f=f[t]=f[t]||[],f.indexOf(u)===-1){if(f.push(u),h&&h.install&&f.length===1)h.install.call(this,t)}}return this},off:function(t,u){if(typeof t!=="string"){k.each(t,function(x,v){this.off(v,x)},this);return}var i=this._eventTypes,h=i&&i[t],f=this._callbacks&&this._callbacks[t],g;if(f){if(!u||(g=f.indexOf(u))!==-1&&f.length===1){if(h&&h.uninstall)h.uninstall.call(this,t);delete this._callbacks[t]}else if(g!==-1)f.splice(g,1)}return this},once:function(t,u){return this.on(t,function i(){u.apply(this,arguments),this.off(t,i)})},emit:function(t,u){var i=this._callbacks&&this._callbacks[t];if(!i)return!1;var h=k.slice(arguments,1),f=u&&u.target&&!u.currentTarget;if(i=i.slice(),f)u.currentTarget=this;for(var g=0,x=i.length;g<x;g++)if(i[g].apply(this,h)==!1){if(u&&u.stop)u.stop();break}if(f)delete u.currentTarget;return!0},responds:function(t){return!!(this._callbacks&&this._callbacks[t])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(t){var u=this._eventTypes,i=this._callbacks,h=t?"install":"uninstall";if(u){for(var f in i)if(i[f].length>0){var g=u[f],x=g&&g[h];if(x)x.call(this,f)}}},statics:{inject:function t(u){var i=u._events;if(i){var h={};k.each(i,function(f,g){var x=typeof f==="string",v=x?f:g,s=k.capitalize(v),p=v.substring(2).toLowerCase();h[p]=x?{}:f,v="_"+v,u["get"+s]=function(){return this[v]},u["set"+s]=function(d){var _=this[v];if(_)this.off(p,_);if(d)this.on(p,d);this[v]=d}}),u._eventTypes=h}return t.base.apply(this,arguments)}}},i0=k.extend({_class:"PaperScope",initialize:function t(){k0=this,this.settings=new k({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=t._id++,t._scopes[this._id]=this;var u=t.prototype;if(!this.support){var i=U0.getContext(1,1)||{};u.support={nativeDash:"setLineDash"in i||"mozDash"in i,nativeBlendModes:d4.nativeModes},U0.release(i)}if(!this.agent){var h=E.navigator.userAgent.toLowerCase(),f=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(h)||[])[0],g=f==="darwin"?"mac":f,x=u.agent=u.browser={platform:g};if(g)x[g]=!0;if(h.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(v,s,p,d,_){if(!x.chrome){var P=s==="opera"?d:/^(node|trident)$/.test(s)?_:p;x.version=P,x.versionNumber=parseFloat(P),s={trident:"msie",jsdom:"node"}[s]||s,x.name=s,x[s]=!0}}),x.chrome)delete x.webkit;if(x.atom)delete x.chrome}},version:"0.12.17",getView:function(){var t=this.project;return t&&t._view},getPaper:function(){return this},execute:function(t,u){},install:function(t){var u=this;k.each(["project","view","tool"],function(h){k.define(t,h,{configurable:!0,get:function(){return u[h]}})});for(var i in this)if(!/^_/.test(i)&&this[i])t[i]=this[i]},setup:function(t){return k0=this,this.project=new Z0(t),this},createCanvas:function(t,u){return U0.getCanvas(t,u)},activate:function(){k0=this},clear:function(){var t=this.projects,u=this.tools;for(var i=t.length-1;i>=0;i--)t[i].remove();for(var i=u.length-1;i>=0;i--)u[i].remove()},remove:function(){this.clear(),delete i0._scopes[this._id]},statics:new function(){function t(u){return u+="Attribute",function(i,h){return i[u](h)||i[u]("data-paper-"+h)}}return{_scopes:{},_id:0,get:function(u){return this._scopes[u]||null},getAttribute:t("get"),hasAttribute:t("has")}}}),P0=k.extend(u0,{initialize:function(t){if(this._scope=k0,this._index=this._scope[this._list].push(this)-1,t||!this._scope[this._reference])this.activate()},activate:function(){if(!this._scope)return!1;var t=this._scope[this._reference];if(t&&t!==this)t.emit("deactivate");return this._scope[this._reference]=this,this.emit("activate",t),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){if(this._index==null)return!1;if(k.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this)this._scope[this._reference]=null;return this._scope=null,!0},getView:function(){return this._scope.getView()}}),m0={findItemBoundsCollisions:function(t,u,i){function h(x){var v=new Array(x.length);for(var s=0;s<x.length;s++){var p=x[s].getBounds();v[s]=[p.left,p.top,p.right,p.bottom]}return v}var f=h(t),g=!u||u===t?f:h(u);return this.findBoundsCollisions(f,g,i||0)},findCurveBoundsCollisions:function(t,u,i,h){function f(P){var{min:w,max:r}=Math,C=new Array(P.length);for(var B=0;B<P.length;B++){var j=P[B];C[B]=[w(j[0],j[2],j[4],j[6]),w(j[1],j[3],j[5],j[7]),r(j[0],j[2],j[4],j[6]),r(j[1],j[3],j[5],j[7])]}return C}var g=f(t),x=!u||u===t?g:f(u);if(h){var v=this.findBoundsCollisions(g,x,i||0,!1,!0),s=this.findBoundsCollisions(g,x,i||0,!0,!0),p=[];for(var d=0,_=v.length;d<_;d++)p[d]={hor:v[d],ver:s[d]};return p}return this.findBoundsCollisions(g,x,i||0)},findBoundsCollisions:function(t,u,i,h,f){var g=!u||t===u,x=g?t:t.concat(u),v=t.length,s=x.length;function p(U,t0,y0){var v0=0,b0=U.length;while(v0<b0){var h0=b0+v0>>>1;if(x[U[h0]][t0]<y0)v0=h0+1;else b0=h0}return v0-1}var d=h?1:0,_=d+2,P=h?0:1,w=P+2,r=new Array(s);for(var C=0;C<s;C++)r[C]=C;r.sort(function(U,t0){return x[U][d]-x[t0][d]});var B=[],j=new Array(v);for(var C=0;C<s;C++){var o=r[C],y=x[o],S=g?o:o-v,D=o<v,G=g||!D,c=D?[]:null;if(B.length){var L=p(B,_,y[d]-i)+1;if(B.splice(0,L),g&&f){c=c.concat(B);for(var z=0;z<B.length;z++){var V=B[z];j[V].push(S)}}else{var N=y[w],q=y[P];for(var z=0;z<B.length;z++){var V=B[z],A=x[V],a=V<v,R=g||V>=v;if(f||(D&&R||G&&a)&&(N>=A[P]-i&&q<=A[w]+i)){if(D&&R)c.push(g?V:V-v);if(G&&a)j[V].push(S)}}}}if(D){if(t===u)c.push(o);j[o]=c}if(B.length){var X=y[_],e=p(B,_,X);B.splice(e+1,0,o)}else B.push(o)}for(var C=0;C<j.length;C++){var Y=j[C];if(Y)Y.sort(function(t0,y0){return t0-y0})}return j}},S0=k.extend({initialize:function(t){this.precision=k.pick(t,5),this.multiplier=Math.pow(10,this.precision)},number:function(t){return this.precision<16?Math.round(t*this.multiplier)/this.multiplier:t},pair:function(t,u,i){return this.number(t)+(i||",")+this.number(u)},point:function(t,u){return this.number(t.x)+(u||",")+this.number(t.y)},size:function(t,u){return this.number(t.width)+(u||",")+this.number(t.height)},rectangle:function(t,u){return this.point(t,u)+(u||",")+this.size(t,u)}});S0.instance=new S0;var Q=new function(){var t=[[0.5773502691896257],[0,0.7745966692414834],[0.33998104358485626,0.8611363115940526],[0,0.5384693101056831,0.906179845938664],[0.2386191860831969,0.6612093864662645,0.932469514203152],[0,0.4058451513773972,0.7415311855993945,0.9491079123427585],[0.1834346424956498,0.525532409916329,0.7966664774136267,0.9602898564975363],[0,0.3242534234038089,0.6133714327005904,0.8360311073266358,0.9681602395076261],[0.14887433898163122,0.4333953941292472,0.6794095682990244,0.8650633666889845,0.9739065285171717],[0,0.26954315595234496,0.5190961292068118,0.7301520055740494,0.8870625997680953,0.978228658146057],[0.1252334085114689,0.3678314989981802,0.5873179542866175,0.7699026741943047,0.9041172563704749,0.9815606342467192],[0,0.2304583159551348,0.44849275103644687,0.6423493394403402,0.8015780907333099,0.9175983992229779,0.9841830547185881],[0.10805494870734367,0.31911236892788974,0.5152486363581541,0.6872929048116855,0.827201315069765,0.9284348836635735,0.9862838086968123],[0,0.20119409399743451,0.3941513470775634,0.5709721726085388,0.7244177313601701,0.8482065834104272,0.937273392400706,0.9879925180204854],[0.09501250983763744,0.2816035507792589,0.45801677765722737,0.6178762444026438,0.755404408355003,0.8656312023878318,0.9445750230732326,0.9894009349916499]],u=[[1],[0.8888888888888888,0.5555555555555556],[0.6521451548625461,0.34785484513745385],[0.5688888888888889,0.47862867049936647,0.23692688505618908],[0.46791393457269104,0.3607615730481386,0.17132449237917036],[0.4179591836734694,0.3818300505051189,0.27970539148927664,0.1294849661688697],[0.362683783378362,0.31370664587788727,0.22238103445337448,0.10122853629037626],[0.3302393550012598,0.31234707704000286,0.26061069640293544,0.1806481606948574,0.08127438836157441],[0.29552422471475287,0.26926671930999635,0.21908636251598204,0.1494513491505806,0.06667134430868814],[0.2729250867779006,0.26280454451024665,0.23319376459199048,0.18629021092773426,0.1255803694649046,0.05566856711617366],[0.24914704581340277,0.2334925365383548,0.20316742672306592,0.16007832854334622,0.10693932599531843,0.04717533638651183],[0.2325515532308739,0.22628318026289723,0.2078160475368885,0.17814598076194574,0.13887351021978725,0.09212149983772845,0.04048400476531588],[0.2152638534631578,0.2051984637212956,0.18553839747793782,0.15720316715819355,0.12151857068790319,0.08015808715976021,0.03511946033175186],[0.2025782419255613,0.19843148532711158,0.1861610000155622,0.16626920581699392,0.13957067792615432,0.10715922046717194,0.07036604748810812,0.03075324199611727],[0.1894506104550685,0.18260341504492358,0.16915651939500254,0.14959598881657674,0.12462897125553388,0.09515851168249279,0.062253523938647894,0.027152459411754096]],i=Math.abs,h=Math.sqrt,f=Math.pow,g=Math.log2||function(_){return Math.log(_)*Math.LOG2E},x=0.000000000001,v=0.000000000000000112;function s(_,P,w){return _<P?P:_>w?w:_}function p(_,P,w){function r(L){var z=L*134217729,V=L-z,N=V+z,q=L-N;return[N,q]}var C=P*P-_*w,B=P*P+_*w;if(i(C)*3<B){var j=r(_),o=r(P),y=r(w),S=P*P,D=o[0]*o[0]-S+2*o[0]*o[1]+o[1]*o[1],G=_*w,c=j[0]*y[0]-G+j[0]*y[1]+j[1]*y[0]+j[1]*y[1];C=S-G+(D-c)}return C}function d(){var _=Math.max.apply(Math,arguments);return _&&(_<0.00000001||_>1e8)?f(2,-Math.round(g(_))):0}return{EPSILON:x,MACHINE_EPSILON:v,CURVETIME_EPSILON:0.00000001,GEOMETRIC_EPSILON:0.0000001,TRIGONOMETRIC_EPSILON:0.00000001,ANGULAR_EPSILON:0.00001,KAPPA:4*(h(2)-1)/3,isZero:function(_){return _>=-x&&_<=x},isMachineZero:function(_){return _>=-v&&_<=v},clamp:s,integrate:function(_,P,w,r){var C=t[r-2],B=u[r-2],j=(w-P)*0.5,o=j+P,y=0,S=r+1>>1,D=r&1?B[y++]*_(o):0;while(y<S){var G=j*C[y];D+=B[y++]*(_(o+G)+_(o-G))}return j*D},findRoot:function(_,P,w,r,C,B,j){for(var o=0;o<B;o++){var y=_(w),S=y/P(w),D=w-S;if(i(S)<j){w=D;break}if(y>0)C=w,w=D<=r?(r+C)*0.5:D;else r=w,w=D>=C?(r+C)*0.5:D}return s(w,r,C)},solveQuadratic:function(_,P,w,r,C,B){var j,o=Infinity;if(i(_)<x){if(i(P)<x)return i(w)<x?-1:0;j=-w/P}else{P*=-0.5;var y=p(_,P,w);if(y&&i(y)<v){var S=d(i(_),i(P),i(w));if(S)_*=S,P*=S,w*=S,y=p(_,P,w)}if(y>=-v){var D=y<0?0:h(y),G=P+(P<0?-D:D);if(G===0)j=w/_,o=-j;else j=G/_,o=w/G}}var c=0,L=C==null,z=C-x,V=B+x;if(isFinite(j)&&(L||j>z&&j<V))r[c++]=L?j:s(j,C,B);if(o!==j&&isFinite(o)&&(L||o>z&&o<V))r[c++]=L?o:s(o,C,B);return c},solveCubic:function(_,P,w,r,C,B,j){var o=d(i(_),i(P),i(w),i(r)),y,S,D,G,c;if(o)_*=o,P*=o,w*=o,r*=o;function L(e){y=e;var Y=_*y;S=Y+P,D=S*y+w,G=(Y+S)*y+D,c=D*y+r}if(i(_)<x)_=P,S=w,D=r,y=Infinity;else if(i(r)<x)S=P,D=w,y=0;else{L(-(P/_)/3);var z=c/_,V=f(i(z),0.3333333333333333),N=z<0?-1:1,q=-G/_,A=q>0?1.324717957244746*Math.max(V,h(q)):V,a=y-N*A;if(a!==y){do L(a),a=G===0?y:y-c/G/(1+v);while(N*a>N*y);if(i(_)*y*y>i(r/y))D=-r/y,S=(D-w)/y}}var R=Q.solveQuadratic(_,S,D,C,B,j),X=B==null;if(isFinite(y)&&(R===0||R>0&&y!==C[0]&&y!==C[1])&&(X||y>B-x&&y<j+x))C[R++]=X?y:s(y,B,j);return R}}},x0={_id:1,_pools:{},get:function(t){if(t){var u=this._pools[t];if(!u)u=this._pools[t]={_id:1};return u._id++}else return this._id++}},O=k.extend({_class:"Point",_readIndex:!0,initialize:function t(u,i){var h=typeof u,f=this.__read,g=0;if(h==="number"){var x=typeof i==="number";if(this._set(u,x?i:u),f)g=x?2:1}else if(h==="undefined"||u===null){if(this._set(0,0),f)g=u===null?1:0}else{var v=h==="string"?u.split(/[\s,]+/)||[]:u;if(g=1,Array.isArray(v))this._set(+v[0],+(v.length>1?v[1]:v[0]));else if("x"in v)this._set(v.x||0,v.y||0);else if("width"in v)this._set(v.width||0,v.height||0);else if("angle"in v)this._set(v.length||0,0),this.setAngle(v.angle||0);else this._set(0,0),g=0}if(f)this.__read=g;return this},set:"#initialize",_set:function(t,u){return this.x=t,this.y=u,this},equals:function(t){return this===t||t&&(this.x===t.x&&this.y===t.y||Array.isArray(t)&&this.x===t[0]&&this.y===t[1])||!1},clone:function(){return new O(this.x,this.y)},toString:function(){var t=S0.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+" }"},_serialize:function(t){var u=t.formatter;return[u.number(this.x),u.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(t){if(this.isZero()){var u=this._angle||0;this._set(Math.cos(u)*t,Math.sin(u)*t)}else{var i=t/this.getLength();if(Q.isZero(i))this.getAngle();this._set(this.x*i,this.y*i)}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180/Math.PI},setAngle:function(t){this.setAngleInRadians.call(this,t*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(!arguments.length)return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x);else{var t=O.read(arguments),u=this.getLength()*t.getLength();if(Q.isZero(u))return NaN;else{var i=this.dot(t)/u;return Math.acos(i<-1?-1:i>1?1:i)}}},setAngleInRadians:function(t){if(this._angle=t,!this.isZero()){var u=this.getLength();this._set(Math.cos(t)*u,Math.sin(t)*u)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var t=O.read(arguments);return Math.atan2(this.cross(t),this.dot(t))*180/Math.PI},getDistance:function(){var t=arguments,u=O.read(t),i=u.x-this.x,h=u.y-this.y,f=i*i+h*h,g=k.read(t);return g?f:Math.sqrt(f)},normalize:function(t){if(t===M)t=1;var u=this.getLength(),i=u!==0?t/u:0,h=new O(this.x*i,this.y*i);if(i>=0)h._angle=this._angle;return h},rotate:function(t,u){if(t===0)return this.clone();t=t*Math.PI/180;var i=u?this.subtract(u):this,h=Math.sin(t),f=Math.cos(t);return i=new O(i.x*f-i.y*h,i.x*h+i.y*f),u?i.add(u):i},transform:function(t){return t?t._transformPoint(this):this},add:function(){var t=O.read(arguments);return new O(this.x+t.x,this.y+t.y)},subtract:function(){var t=O.read(arguments);return new O(this.x-t.x,this.y-t.y)},multiply:function(){var t=O.read(arguments);return new O(this.x*t.x,this.y*t.y)},divide:function(){var t=O.read(arguments);return new O(this.x/t.x,this.y/t.y)},modulo:function(){var t=O.read(arguments);return new O(this.x%t.x,this.y%t.y)},negate:function(){return new O(-this.x,-this.y)},isInside:function(){return K.read(arguments).contains(this)},isClose:function(){var t=arguments,u=O.read(t),i=k.read(t);return this.getDistance(u)<=i},isCollinear:function(){var t=O.read(arguments);return O.isCollinear(this.x,this.y,t.x,t.y)},isColinear:"#isCollinear",isOrthogonal:function(){var t=O.read(arguments);return O.isOrthogonal(this.x,this.y,t.x,t.y)},isZero:function(){var t=Q.isZero;return t(this.x)&&t(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(t){return this.x*(t>1&&t<4?-1:1)>=0&&this.y*(t>2?-1:1)>=0},dot:function(){var t=O.read(arguments);return this.x*t.x+this.y*t.y},cross:function(){var t=O.read(arguments);return this.x*t.y-this.y*t.x},project:function(){var t=O.read(arguments),u=t.isZero()?0:this.dot(t)/t.dot(t);return new O(t.x*u,t.y*u)},statics:{min:function(){var t=arguments,u=O.read(t),i=O.read(t);return new O(Math.min(u.x,i.x),Math.min(u.y,i.y))},max:function(){var t=arguments,u=O.read(t),i=O.read(t);return new O(Math.max(u.x,i.x),Math.max(u.y,i.y))},random:function(){return new O(Math.random(),Math.random())},isCollinear:function(t,u,i,h){return Math.abs(t*h-u*i)<=Math.sqrt((t*t+u*u)*(i*i+h*h))*0.00000001},isOrthogonal:function(t,u,i,h){return Math.abs(t*i+u*h)<=Math.sqrt((t*t+u*u)*(i*i+h*h))*0.00000001}}},k.each(["round","ceil","floor","abs"],function(t){var u=Math[t];this[t]=function(){return new O(u(this.x),u(this.y))}},{})),M0=O.extend({initialize:function t(u,i,h,f){this._x=u,this._y=i,this._owner=h,this._setter=f},_set:function(t,u,i){if(this._x=t,this._y=u,!i)this._owner[this._setter](this);return this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){return this._setter==="setPosition"?4:0}}),f0=k.extend({_class:"Size",_readIndex:!0,initialize:function t(u,i){var h=typeof u,f=this.__read,g=0;if(h==="number"){var x=typeof i==="number";if(this._set(u,x?i:u),f)g=x?2:1}else if(h==="undefined"||u===null){if(this._set(0,0),f)g=u===null?1:0}else{var v=h==="string"?u.split(/[\s,]+/)||[]:u;if(g=1,Array.isArray(v))this._set(+v[0],+(v.length>1?v[1]:v[0]));else if("width"in v)this._set(v.width||0,v.height||0);else if("x"in v)this._set(v.x||0,v.y||0);else this._set(0,0),g=0}if(f)this.__read=g;return this},set:"#initialize",_set:function(t,u){return this.width=t,this.height=u,this},equals:function(t){return t===this||t&&(this.width===t.width&&this.height===t.height||Array.isArray(t)&&this.width===t[0]&&this.height===t[1])||!1},clone:function(){return new f0(this.width,this.height)},toString:function(){var t=S0.instance;return"{ width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var u=t.formatter;return[u.number(this.width),u.number(this.height)]},add:function(){var t=f0.read(arguments);return new f0(this.width+t.width,this.height+t.height)},subtract:function(){var t=f0.read(arguments);return new f0(this.width-t.width,this.height-t.height)},multiply:function(){var t=f0.read(arguments);return new f0(this.width*t.width,this.height*t.height)},divide:function(){var t=f0.read(arguments);return new f0(this.width/t.width,this.height/t.height)},modulo:function(){var t=f0.read(arguments);return new f0(this.width%t.width,this.height%t.height)},negate:function(){return new f0(-this.width,-this.height)},isZero:function(){var t=Q.isZero;return t(this.width)&&t(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(t,u){return new f0(Math.min(t.width,u.width),Math.min(t.height,u.height))},max:function(t,u){return new f0(Math.max(t.width,u.width),Math.max(t.height,u.height))},random:function(){return new f0(Math.random(),Math.random())}}},k.each(["round","ceil","floor","abs"],function(t){var u=Math[t];this[t]=function(){return new f0(u(this.width),u(this.height))}},{})),y6=f0.extend({initialize:function t(u,i,h,f){this._width=u,this._height=i,this._owner=h,this._setter=f},_set:function(t,u,i){if(this._width=t,this._height=u,!i)this._owner[this._setter](this);return this},getWidth:function(){return this._width},setWidth:function(t){this._width=t,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(t){this._height=t,this._owner[this._setter](this)}}),K=k.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function t(u,i,h,f){var g=arguments,x=typeof u,v;if(x==="number")this._set(u,i,h,f),v=4;else if(x==="undefined"||u===null)this._set(0,0,0,0),v=u===null?1:0;else if(g.length===1){if(Array.isArray(u))this._set.apply(this,u),v=1;else if(u.x!==M||u.width!==M)this._set(u.x||0,u.y||0,u.width||0,u.height||0),v=1;else if(u.from===M&&u.to===M){if(this._set(0,0,0,0),k.readSupported(g,this))v=1}}if(v===M){var s=O.readNamed(g,"from"),p=k.peek(g),d=s.x,_=s.y,P,w;if(p&&p.x!==M||k.hasNamed(g,"to")){var r=O.readNamed(g,"to");if(P=r.x-d,w=r.y-_,P<0)d=r.x,P=-P;if(w<0)_=r.y,w=-w}else{var C=f0.read(g);P=C.width,w=C.height}this._set(d,_,P,w),v=g.__index}var B=g.__filtered;if(B)this.__filtered=B;if(this.__read)this.__read=v;return this},set:"#initialize",_set:function(t,u,i,h){return this.x=t,this.y=u,this.width=i,this.height=h,this},clone:function(){return new K(this.x,this.y,this.width,this.height)},equals:function(t){var u=k.isPlainValue(t)?K.read(arguments):t;return u===this||u&&this.x===u.x&&this.y===u.y&&this.width===u.width&&this.height===u.height||!1},toString:function(){var t=S0.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+", width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var u=t.formatter;return[u.number(this.x),u.number(this.y),u.number(this.width),u.number(this.height)]},getPoint:function(t){var u=t?O:M0;return new u(this.x,this.y,this,"setPoint")},setPoint:function(){var t=O.read(arguments);this.x=t.x,this.y=t.y},getSize:function(t){var u=t?f0:y6;return new u(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var t=f0.read(arguments),u=this._sx,i=this._sy,h=t.width,f=t.height;if(u)this.x+=(this.width-h)*u;if(i)this.y+=(this.height-f)*i;this.width=h,this.height=f,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(t){if(!this._fw){var u=t-this.x;this.width-=this._sx===0.5?u*2:u}this.x=t,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(t){if(!this._fh){var u=t-this.y;this.height-=this._sy===0.5?u*2:u}this.y=t,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(t){if(!this._fw){var u=t-this.x;this.width=this._sx===0.5?u*2:u}this.x=t-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(t){if(!this._fh){var u=t-this.y;this.height=this._sy===0.5?u*2:u}this.y=t-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(t){if(this._fw||this._sx===0.5)this.x=t-this.width/2;else{if(this._sx)this.x+=(t-this.x)*2*this._sx;this.width=(t-this.x)*2}this._sx=0.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(t){if(this._fh||this._sy===0.5)this.y=t-this.height/2;else{if(this._sy)this.y+=(t-this.y)*2*this._sy;this.height=(t-this.y)*2}this._sy=0.5,this._fh=0},getCenter:function(t){var u=t?O:M0;return new u(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var t=O.read(arguments);return this.setCenterX(t.x),this.setCenterY(t.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return this.width===0||this.height===0},contains:function(t){return t&&t.width!==M||(Array.isArray(t)?t:arguments).length===4?this._containsRectangle(K.read(arguments)):this._containsPoint(O.read(arguments))},_containsPoint:function(t){var{x:u,y:i}=t;return u>=this.x&&i>=this.y&&u<=this.x+this.width&&i<=this.y+this.height},_containsRectangle:function(t){var{x:u,y:i}=t;return u>=this.x&&i>=this.y&&u+t.width<=this.x+this.width&&i+t.height<=this.y+this.height},intersects:function(){var t=K.read(arguments),u=k.read(arguments)||0;return t.x+t.width>this.x-u&&t.y+t.height>this.y-u&&t.x<this.x+this.width+u&&t.y<this.y+this.height+u},intersect:function(){var t=K.read(arguments),u=Math.max(this.x,t.x),i=Math.max(this.y,t.y),h=Math.min(this.x+this.width,t.x+t.width),f=Math.min(this.y+this.height,t.y+t.height);return new K(u,i,h-u,f-i)},unite:function(){var t=K.read(arguments),u=Math.min(this.x,t.x),i=Math.min(this.y,t.y),h=Math.max(this.x+this.width,t.x+t.width),f=Math.max(this.y+this.height,t.y+t.height);return new K(u,i,h-u,f-i)},include:function(){var t=O.read(arguments),u=Math.min(this.x,t.x),i=Math.min(this.y,t.y),h=Math.max(this.x+this.width,t.x),f=Math.max(this.y+this.height,t.y);return new K(u,i,h-u,f-i)},expand:function(){var t=f0.read(arguments),u=t.width,i=t.height;return new K(this.x-u/2,this.y-i/2,this.width+u,this.height+i)},scale:function(t,u){return this.expand(this.width*t-this.width,this.height*(u===M?t:u)-this.height)}},k.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(t,u){var i=t.join(""),h=/^[RL]/.test(i);if(u>=4)t[1]+=h?"Y":"X";var f=t[h?0:1],g=t[h?1:0],x="get"+f,v="get"+g,s="set"+f,p="set"+g,d="get"+i,_="set"+i;this[d]=function(P){var w=P?O:M0;return new w(this[x](),this[v](),this,_)},this[_]=function(){var P=O.read(arguments);this[s](P.x),this[p](P.y)}},{beans:!0})),G0=K.extend({initialize:function t(u,i,h,f,g,x){this._set(u,i,h,f,!0),this._owner=g,this._setter=x},_set:function(t,u,i,h,f){if(this._x=t,this._y=u,this._width=i,this._height=h,!f)this._owner[this._setter](this);return this}},new function(){var t=K.prototype;return k.each(["x","y","width","height"],function(u){var i=k.capitalize(u),h="_"+u;this["get"+i]=function(){return this[h]},this["set"+i]=function(f){if(this[h]=f,!this._dontNotify)this._owner[this._setter](this)}},k.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(u){var i="set"+u;this[i]=function(){this._dontNotify=!0,t[i].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(u){var i=this._owner;if(i._changeSelection)i._changeSelection(2,u)}}))}),r0=k.extend({_class:"Matrix",initialize:function t(u,i){var h=arguments,f=h.length,g=!0;if(f>=6)this._set.apply(this,h);else if(f===1||f===2)if(u instanceof t)this._set(u._a,u._b,u._c,u._d,u._tx,u._ty,i);else if(Array.isArray(u))this._set.apply(this,i?u.concat([i]):u);else g=!1;else if(!f)this.reset();else g=!1;if(!g)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(t,u,i,h,f,g,x){if(this._a=t,this._b=u,this._c=i,this._d=h,this._tx=f,this._ty=g,!x)this._changed();return this},_serialize:function(t,u){return k.serialize(this.getValues(),t,!0,u)},_changed:function(){var t=this._owner;if(t)if(t._applyMatrix)t.transform(null,!0);else t._changed(25)},clone:function(){return new r0(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(t){return t===this||t&&this._a===t._a&&this._b===t._b&&this._c===t._c&&this._d===t._d&&this._tx===t._tx&&this._ty===t._ty},toString:function(){var t=S0.instance;return"[["+[t.number(this._a),t.number(this._c),t.number(this._tx)].join(", ")+"], ["+[t.number(this._b),t.number(this._d),t.number(this._ty)].join(", ")+"]]"},reset:function(t){if(this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,!t)this._changed();return this},apply:function(t,u){var i=this._owner;if(i)return i.transform(null,k.pick(t,!0),u),this.isIdentity();return!1},translate:function(){var t=O.read(arguments),u=t.x,i=t.y;return this._tx+=u*this._a+i*this._c,this._ty+=u*this._b+i*this._d,this._changed(),this},scale:function(){var t=arguments,u=O.read(t),i=O.read(t,0,{readNull:!0});if(i)this.translate(i);if(this._a*=u.x,this._b*=u.x,this._c*=u.y,this._d*=u.y,i)this.translate(i.negate());return this._changed(),this},rotate:function(t){t*=Math.PI/180;var u=O.read(arguments,1),i=u.x,h=u.y,f=Math.cos(t),g=Math.sin(t),x=i-i*f+h*g,v=h-i*g-h*f,s=this._a,p=this._b,d=this._c,_=this._d;return this._a=f*s+g*d,this._b=f*p+g*_,this._c=-g*s+f*d,this._d=-g*p+f*_,this._tx+=x*s+v*d,this._ty+=x*p+v*_,this._changed(),this},shear:function(){var t=arguments,u=O.read(t),i=O.read(t,0,{readNull:!0});if(i)this.translate(i);var h=this._a,f=this._b;if(this._a+=u.y*this._c,this._b+=u.y*this._d,this._c+=u.x*h,this._d+=u.x*f,i)this.translate(i.negate());return this._changed(),this},skew:function(){var t=arguments,u=O.read(t),i=O.read(t,0,{readNull:!0}),h=Math.PI/180,f=new O(Math.tan(u.x*h),Math.tan(u.y*h));return this.shear(f,i)},append:function(t,u){if(t){var i=this._a,h=this._b,f=this._c,g=this._d,x=t._a,v=t._c,s=t._b,p=t._d,d=t._tx,_=t._ty;if(this._a=x*i+s*f,this._c=v*i+p*f,this._b=x*h+s*g,this._d=v*h+p*g,this._tx+=d*i+_*f,this._ty+=d*h+_*g,!u)this._changed()}return this},prepend:function(t,u){if(t){var i=this._a,h=this._b,f=this._c,g=this._d,x=this._tx,v=this._ty,s=t._a,p=t._c,d=t._b,_=t._d,P=t._tx,w=t._ty;if(this._a=s*i+p*h,this._c=s*f+p*g,this._b=d*i+_*h,this._d=d*f+_*g,this._tx=s*x+p*v+P,this._ty=d*x+_*v+w,!u)this._changed()}return this},appended:function(t){return this.clone().append(t)},prepended:function(t){return this.clone().prepend(t)},invert:function(){var t=this._a,u=this._b,i=this._c,h=this._d,f=this._tx,g=this._ty,x=t*h-u*i,v=null;if(x&&!isNaN(x)&&isFinite(f)&&isFinite(g))this._a=h/x,this._b=-u/x,this._c=-i/x,this._d=t/x,this._tx=(i*g-h*f)/x,this._ty=(u*f-t*g)/x,v=this;return v},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new r0(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0},isInvertible:function(){var t=this._a*this._d-this._c*this._b;return t&&!isNaN(t)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(t,u,i){return arguments.length<3?this._transformPoint(O.read(arguments)):this._transformCoordinates(t,u,i)},_transformPoint:function(t,u,i){var{x:h,y:f}=t;if(!u)u=new O;return u._set(h*this._a+f*this._c+this._tx,h*this._b+f*this._d+this._ty,i)},_transformCoordinates:function(t,u,i){for(var h=0,f=2*i;h<f;h+=2){var g=t[h],x=t[h+1];u[h]=g*this._a+x*this._c+this._tx,u[h+1]=g*this._b+x*this._d+this._ty}return u},_transformCorners:function(t){var{x:u,y:i}=t,h=u+t.width,f=i+t.height,g=[u,i,h,i,h,f,u,f];return this._transformCoordinates(g,g,4)},_transformBounds:function(t,u,i){var h=this._transformCorners(t),f=h.slice(0,2),g=f.slice();for(var x=2;x<8;x++){var v=h[x],s=x&1;if(v<f[s])f[s]=v;else if(v>g[s])g[s]=v}if(!u)u=new K;return u._set(f[0],f[1],g[0]-f[0],g[1]-f[1],i)},inverseTransform:function(){return this._inverseTransform(O.read(arguments))},_inverseTransform:function(t,u,i){var h=this._a,f=this._b,g=this._c,x=this._d,v=this._tx,s=this._ty,p=h*x-f*g,d=null;if(p&&!isNaN(p)&&isFinite(v)&&isFinite(s)){var _=t.x-this._tx,P=t.y-this._ty;if(!u)u=new O;d=u._set((_*x-P*g)/p,(P*h-_*f)/p,i)}return d},decompose:function(){var t=this._a,u=this._b,i=this._c,h=this._d,f=t*h-u*i,g=Math.sqrt,x=Math.atan2,v=180/Math.PI,s,p,d;if(t!==0||u!==0){var _=g(t*t+u*u);s=Math.acos(t/_)*(u>0?1:-1),p=[_,f/_],d=[x(t*i+u*h,_*_),0]}else if(i!==0||h!==0){var P=g(i*i+h*h);s=Math.asin(i/P)*(h>0?1:-1),p=[f/P,P],d=[0,x(t*i+u*h,P*P)]}else s=0,d=p=[0,0];return{translation:this.getTranslation(),rotation:s*v,scaling:new O(p),skewing:new O(d[0]*v,d[1]*v)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new O(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(t){if(!this.isIdentity())t.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},k.each(["a","b","c","d","tx","ty"],function(t){var u=k.capitalize(t),i="_"+t;this["get"+u]=function(){return this[i]},this["set"+u]=function(h){this[i]=h,this._changed()}},{})),D0=k.extend({_class:"Line",initialize:function t(u,i,h,f,g){var x=!1;if(arguments.length>=4)this._px=u,this._py=i,this._vx=h,this._vy=f,x=g;else this._px=u.x,this._py=u.y,this._vx=i.x,this._vy=i.y,x=h;if(!x)this._vx-=this._px,this._vy-=this._py},getPoint:function(){return new O(this._px,this._py)},getVector:function(){return new O(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(t,u){return D0.intersect(this._px,this._py,this._vx,this._vy,t._px,t._py,t._vx,t._vy,!0,u)},getSide:function(t,u){return D0.getSide(this._px,this._py,this._vx,this._vy,t.x,t.y,!0,u)},getDistance:function(t){return Math.abs(this.getSignedDistance(t))},getSignedDistance:function(t){return D0.getSignedDistance(this._px,this._py,this._vx,this._vy,t.x,t.y,!0)},isCollinear:function(t){return O.isCollinear(this._vx,this._vy,t._vx,t._vy)},isOrthogonal:function(t){return O.isOrthogonal(this._vx,this._vy,t._vx,t._vy)},statics:{intersect:function(t,u,i,h,f,g,x,v,s,p){if(!s)i-=t,h-=u,x-=f,v-=g;var d=i*v-h*x;if(!Q.isMachineZero(d)){var _=t-f,P=u-g,w=(x*P-v*_)/d,r=(i*P-h*_)/d,C=0.000000000001,B=-C,j=1+C;if(p||B<w&&w<j&&B<r&&r<j){if(!p)w=w<=0?0:w>=1?1:w;return new O(t+w*i,u+w*h)}}},getSide:function(t,u,i,h,f,g,x,v){if(!x)i-=t,h-=u;var s=f-t,p=g-u,d=s*h-p*i;if(!v&&Q.isMachineZero(d)){if(d=(s*i+s*i)/(i*i+h*h),d>=0&&d<=1)d=0}return d<0?-1:d>0?1:0},getSignedDistance:function(t,u,i,h,f,g,x){if(!x)i-=t,h-=u;return i===0?h>0?f-t:t-f:h===0?i<0?g-u:u-g:((f-t)*h-(g-u)*i)/(h>i?h*Math.sqrt(1+i*i/(h*h)):i*Math.sqrt(1+h*h/(i*i)))},getDistance:function(t,u,i,h,f,g,x){return Math.abs(D0.getSignedDistance(t,u,i,h,f,g,x))}}}),Z0=P0.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function t(u){P0.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new x6(null,null,this),this._view=R0.create(this,u||U0.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(t,u){return k.serialize(this._children,t,!0,u)},_changed:function(t,u){if(t&1){var i=this._view;if(i){if(i._needsUpdate=!0,!i._requested&&i._autoUpdate)i.requestUpdate()}}var h=this._changes;if(h&&u){var f=this._changesById,g=u._id,x=f[g];if(x)x.flags|=t;else h.push(f[g]={item:u,flags:t})}},clear:function(){var t=this._children;for(var u=t.length-1;u>=0;u--)t[u].remove()},isEmpty:function(){return!this._children.length},remove:function t(){if(!t.base.call(this))return!1;if(this._view)this._view.remove();return!0},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(t){this._currentStyle.set(t)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new l6({project:this,insert:!0})},getSymbolDefinitions:function(){var t=[],u={};return this.getItems({class:$,match:function(i){var h=i._definition,f=h._id;if(!u[f])u[f]=!0,t.push(h);return!1}}),t},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var t=this._selectionItems,u=[];for(var i in t){var h=t[i],f=h._selection;if(f&1&&h.isInserted())u.push(h);else if(!f)this._updateSelection(h)}return u},_updateSelection:function(t){var u=t._id,i=this._selectionItems;if(t._selection){if(i[u]!==t)this._selectionCount++,i[u]=t}else if(i[u]===t)this._selectionCount--,delete i[u]},selectAll:function(){var t=this._children;for(var u=0,i=t.length;u<i;u++)t[u].setFullySelected(!0)},deselectAll:function(){var t=this._selectionItems;for(var u in t)t[u].setFullySelected(!1)},addLayer:function(t){return this.insertLayer(M,t)},insertLayer:function(t,u){if(u instanceof l6){u._remove(!1,!0),k.splice(this._children,[u],t,0),u._setProject(this,!0);var i=u._name;if(i)u.setName(i);if(this._changes)u._changed(5);if(!this._activeLayer)this._activeLayer=u}else u=null;return u},_insertItem:function(t,u,i){if(u=this.insertLayer(t,u)||(this._activeLayer||this._insertItem(M,new l6(d0.NO_INSERT),!0)).insertChild(t,u),i&&u.activate)u.activate();return u},getItems:function(t){return d0._getItems(this,t)},getItem:function(t){return d0._getItems(this,t,null,null,!0)[0]||null},importJSON:function(t){this.activate();var u=this._activeLayer;return k.importJSON(t,u&&u.isEmpty()&&u)},removeOn:function(t){var u=this._removeSets;if(u){if(t==="mouseup")u.mousedrag=null;var i=u[t];if(i){for(var h in i){var f=i[h];for(var g in u){var x=u[g];if(x&&x!=i)delete x[f._id]}f.remove()}u[t]=null}}},draw:function(t,u,i){this._updateVersion++,t.save(),u.applyToContext(t);var h=this._children,f=new k({offset:new O(0,0),pixelRatio:i,viewMatrix:u.isIdentity()?null:u,matrices:[new r0],updateMatrix:!0});for(var g=0,x=h.length;g<x;g++)h[g].draw(t,f);if(t.restore(),this._selectionCount>0){t.save(),t.strokeWidth=1;var v=this._selectionItems,s=this._scope.settings.handleSize,p=this._updateVersion;for(var d in v)v[d]._drawSelection(t,u,s,v,p);t.restore()}}}),d0=k.extend(u0,{statics:{extend:function t(u){if(u._serializeFields)u._serializeFields=k.set({},this.prototype._serializeFields,u._serializeFields);return t.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new r0,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var t=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return k.each(t,function(u){this._events[u]={install:function(i){this.getView()._countItemEvent(i,1)},uninstall:function(i){this.getView()._countItemEvent(i,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:t}})},{initialize:function t(){},_initialize:function(t,u){var i=t&&k.isPlainObject(t),h=i&&t.internal===!0,f=this._matrix=new r0,g=i&&t.project||k0.project,x=k0.settings;if(this._id=h?null:x0.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&x.applyMatrix,u)f.translate(u);if(f._owner=this,this._style=new x6(g._currentStyle,this,g),h||i&&t.insert==!1||!x.insertItems&&!(i&&t.insert==!0))this._setProject(g);else(i&&t.parent||g)._insertItem(M,this,!0);if(i&&t!==d0.NO_INSERT&&t!==d0.INSERT)this.set(t,{internal:!0,insert:!0,project:!0,parent:!0});return i},_serialize:function(t,u){var i={},h=this;function f(g){for(var x in g){var v=h[x];if(!k.equals(v,x==="leading"?g.fontSize*1.2:g[x]))i[x]=k.serialize(v,t,x!=="data",u)}}if(f(this._serializeFields),!(this instanceof v6))f(this._style._defaults);return[this._class,i]},_changed:function(t){var u=this._symbol,i=this._parent||u,h=this._project;if(t&8)this._bounds=this._position=this._decomposed=M;if(t&16)this._globalMatrix=M;if(i&&t&72)d0._clearBoundsCache(i);if(t&2)d0._clearBoundsCache(this);if(h)h._changed(t,this);if(u)u._changed(t)},getId:function(){return this._id},getName:function(){return this._name},setName:function(t){if(this._name)this._removeNamed();if(t===+t+"")throw new Error("Names consisting only of numbers are not supported.");var u=this._getOwner();if(t&&u){var{_children:i,_namedChildren:h}=u;if((h[t]=h[t]||[]).push(this),!(t in i))i[t]=this}this._name=t||M,this._changed(256)},getStyle:function(){return this._style},setStyle:function(t){this.getStyle().set(t)}},k.each(["locked","visible","blendMode","opacity","guide"],function(t){var u=k.capitalize(t),i="_"+t,h={locked:256,visible:265};this["get"+u]=function(){return this[i]},this["set"+u]=function(f){if(f!=this[i])this[i]=f,this._changed(h[t]||257)}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(t){if(t!==this._selection){this._selection=t;var u=this._project;if(u)u._updateSelection(this),this._changed(257)}},_changeSelection:function(t,u){var i=this._selection;this.setSelection(u?i|t:i&~t)},isSelected:function(){if(this._selectChildren){var t=this._children;for(var u=0,i=t.length;u<i;u++)if(t[u].isSelected())return!0}return!!(this._selection&1)},setSelected:function(t){if(this._selectChildren){var u=this._children;for(var i=0,h=u.length;i<h;i++)u[i].setSelected(t)}this._changeSelection(1,t)},isFullySelected:function(){var t=this._children,u=!!(this._selection&1);if(t&&u){for(var i=0,h=t.length;i<h;i++)if(!t[i].isFullySelected())return!1;return!0}return u},setFullySelected:function(t){var u=this._children;if(u)for(var i=0,h=u.length;i<h;i++)u[i].setFullySelected(t);this._changeSelection(1,t)},isClipMask:function(){return this._clipMask},setClipMask:function(t){if(this._clipMask!=(t=!!t)){if(this._clipMask=t,t)this.setFillColor(null),this.setStrokeColor(null);if(this._changed(257),this._parent)this._parent._changed(2048)}},getData:function(){if(!this._data)this._data={};return this._data},setData:function(t){this._data=t},getPosition:function(t){var u=t?O:M0,i=this._position||(this._position=this._getPositionFromBounds());return new u(i.x,i.y,this,"setPosition")},setPosition:function(){this.translate(O.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(t){return this._pivot?this._matrix._transformPoint(this._pivot):(t||this.getBounds()).getCenter(!0)},getPivot:function(){var t=this._pivot;return t?new M0(t.x,t.y,this,"setPivot"):null},setPivot:function(){this._pivot=O.read(arguments,0,{clone:!0,readNull:!0}),this._position=M}},k.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(t,u){this[u]=function(i){return this.getBounds(i,t)}},{beans:!0,getBounds:function(t,u){var i=u||t instanceof r0,h=k.set({},i?u:t,this._boundsOptions);if(!h.stroke||this.getStrokeScaling())h.cacheItem=this;var f=this._getCachedBounds(i&&t,h).rect;return!arguments.length?new G0(f.x,f.y,f.width,f.height,this,"setBounds"):f},setBounds:function(){var t=K.read(arguments),u=this.getBounds(),i=this._matrix,h=new r0,f=t.getCenter();if(h.translate(f),t.width!=u.width||t.height!=u.height){if(!i.isInvertible())i.set(i._backup||new r0().translate(i.getTranslation())),u=this.getBounds();h.scale(u.width!==0?t.width/u.width:0,u.height!==0?t.height/u.height:0)}f=u.getCenter(),h.translate(-f.x,-f.y),this.transform(h)},_getBounds:function(t,u){var i=this._children;if(!i||!i.length)return new K;return d0._updateBoundsCache(this,u.cacheItem),d0._getBounds(i,t,u)},_getBoundsCacheKey:function(t,u){return[t.stroke?1:0,t.handle?1:0,u?1:0].join("")},_getCachedBounds:function(t,u,i){t=t&&t._orNullIfIdentity();var h=u.internal&&!i,f=u.cacheItem,g=h?null:this._matrix._orNullIfIdentity(),x=f&&(!t||t.equals(g))&&this._getBoundsCacheKey(u,h),v=this._bounds;if(d0._updateBoundsCache(this._parent||this._symbol,f),x&&v&&x in v){var s=v[x];return{rect:s.rect.clone(),nonscaling:s.nonscaling}}var p=this._getBounds(t||g,u),d=p.rect||p,_=this._style,P=p.nonscaling||_.hasStroke()&&!_.getStrokeScaling();if(x){if(!v)this._bounds=v={};var s=v[x]={rect:d.clone(),nonscaling:P,internal:h}}return{rect:d,nonscaling:P}},_getStrokeMatrix:function(t,u){var i=this.getStrokeScaling()?null:u&&u.internal?this:this._parent||this._symbol&&this._symbol._item,h=i?i.getViewMatrix().invert():t;return h&&h._shiftless()},statics:{_updateBoundsCache:function(t,u){if(t&&u){var i=u._id,h=t._boundsCache=t._boundsCache||{ids:{},list:[]};if(!h.ids[i])h.list.push(u),h.ids[i]=u}},_clearBoundsCache:function(t){var u=t._boundsCache;if(u){t._bounds=t._position=t._boundsCache=M;for(var i=0,h=u.list,f=h.length;i<f;i++){var g=h[i];if(g!==t){if(g._bounds=g._position=M,g._boundsCache)d0._clearBoundsCache(g)}}}},_getBounds:function(t,u,i){var h=Infinity,f=-h,g=h,x=f,v=!1;i=i||{};for(var s=0,p=t.length;s<p;s++){var d=t[s];if(d._visible&&!d.isEmpty(!0)){var _=d._getCachedBounds(u&&u.appended(d._matrix),i,!0),P=_.rect;if(h=Math.min(P.x,h),g=Math.min(P.y,g),f=Math.max(P.x+P.width,f),x=Math.max(P.y+P.height,x),_.nonscaling)v=!0}}return{rect:isFinite(h)?new K(h,g,f-h,x-g):new K,nonscaling:v}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var t=this._decompose();return t?t.rotation:0},setRotation:function(t){var u=this.getRotation();if(u!=null&&t!=null){var i=this._decomposed;if(this.rotate(t-u),i)i.rotation=t,this._decomposed=i}},getScaling:function(){var t=this._decompose(),u=t&&t.scaling;return new M0(u?u.x:1,u?u.y:1,this,"setScaling")},setScaling:function(){var t=this.getScaling(),u=O.read(arguments,0,{clone:!0,readNull:!0});if(t&&u&&!t.equals(u)){var i=this.getRotation(),h=this._decomposed,f=new r0,g=Q.isZero;if(g(t.x)||g(t.y)){if(f.translate(h.translation),i)f.rotate(i);f.scale(u.x,u.y),this._matrix.set(f)}else{var x=this.getPosition(!0);if(f.translate(x),i)f.rotate(i);if(f.scale(u.x/t.x,u.y/t.y),i)f.rotate(-i);f.translate(x.negate()),this.transform(f)}if(h)h.scaling=u,this._decomposed=h}},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},getGlobalMatrix:function(t){var u=this._globalMatrix;if(u){var i=this._parent,h=[];while(i){if(!i._globalMatrix){u=null;for(var f=0,g=h.length;f<g;f++)h[f]._globalMatrix=null;break}h.push(i),i=i._parent}}if(!u){u=this._globalMatrix=this._matrix.clone();var i=this._parent;if(i)u.prepend(i.getGlobalMatrix(!0))}return t?u:u.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(t){if(this._applyMatrix=this._canApplyMatrix&&!!t)this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(t,u){if(this._project!==t){if(this._project)this._installEvents(!1);this._project=t;var i=this._children;for(var h=0,f=i&&i.length;h<f;h++)i[h]._setProject(t);u=!0}if(u)this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function t(u){t.base.call(this,u);var i=this._children;for(var h=0,f=i&&i.length;h<f;h++)i[h]._installEvents(u)},getLayer:function(){var t=this;while(t=t._parent)if(t instanceof l6)return t;return null},getParent:function(){return this._parent},setParent:function(t){return t.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(t){this.removeChildren(),this.addChildren(t)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var t=this._getOwner();return t&&t._children[this._index+1]||null},getPreviousSibling:function(){var t=this._getOwner();return t&&t._children[this._index-1]||null},getIndex:function(){return this._index},equals:function(t){return t===this||t&&this._class===t._class&&this._style.equals(t._style)&&this._matrix.equals(t._matrix)&&this._locked===t._locked&&this._visible===t._visible&&this._blendMode===t._blendMode&&this._opacity===t._opacity&&this._clipMask===t._clipMask&&this._guide===t._guide&&this._equals(t)||!1},_equals:function(t){return k.equals(this._children,t._children)},clone:function(t){var u=new this.constructor(d0.NO_INSERT),i=this._children,h=k.pick(t?t.insert:M,t===M||t===!0),f=k.pick(t?t.deep:M,!0);if(i)u.copyAttributes(this);if(!i||f)u.copyContent(this);if(!i)u.copyAttributes(this);if(h)u.insertAbove(this);var g=this._name,x=this._parent;if(g&&x){var i=x._children,v=g,s=1;while(i[g])g=v+" "+s++;if(g!==v)u.setName(g)}return u},copyContent:function(t){var u=t._children;for(var i=0,h=u&&u.length;i<h;i++)this.addChild(u[i].clone(!1),!0)},copyAttributes:function(t,u){this.setStyle(t._style);var i=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"];for(var h=0,f=i.length;h<f;h++){var g=i[h];if(t.hasOwnProperty(g))this[g]=t[g]}if(!u)this._matrix.set(t._matrix,!0);this.setApplyMatrix(t._applyMatrix),this.setPivot(t._pivot),this.setSelection(t._selection);var{_data:x,_name:v}=t;if(this._data=x?k.clone(x):null,v)this.setName(v)},rasterize:function(t,u){var i,h,f;if(k.isPlainObject(t))i=t.resolution,h=t.insert,f=t.raster;else i=t,h=u;if(!f)f=new J(d0.NO_INSERT);var g=this.getStrokeBounds(),x=(i||this.getView().getResolution())/72,v=g.getTopLeft().floor(),s=g.getBottomRight().ceil(),p=new f0(s.subtract(v)),d=p.multiply(x);if(f.setSize(d,!0),!d.isZero()){var _=f.getContext(!0),P=new r0().scale(x).translate(v.negate());_.save(),P.applyToContext(_),this.draw(_,new k({matrices:[P]})),_.restore()}if(f._matrix.set(new r0().translate(v.add(p.divide(2))).scale(1/x)),h===M||h)f.insertAbove(this);return f},contains:function(){var t=this._matrix;return t.isInvertible()&&!!this._contains(t._inverseTransform(O.read(arguments)))},_contains:function(t){var u=this._children;if(u){for(var i=u.length-1;i>=0;i--)if(u[i].contains(t))return!0;return!1}return t.isInside(this.getInternalBounds())},isInside:function(){return K.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new w0.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(t,u){if(!(t instanceof d0))return!1;return this._asPathItem().getIntersections(t._asPathItem(),null,u,!0).length>0}},new function(){function t(){var h=arguments;return this._hitTest(O.read(h),n0.getOptions(h))}function u(){var h=arguments,f=O.read(h),g=n0.getOptions(h),x=[];return this._hitTest(f,new k({all:x},g)),x}function i(h,f,g,x){var v=this._children;if(v)for(var s=v.length-1;s>=0;s--){var p=v[s],d=p!==x&&p._hitTest(h,f,g);if(d&&!f.all)return d}return null}return Z0.inject({hitTest:t,hitTestAll:u,_hitTest:i}),{hitTest:t,hitTestAll:u,_hitTestChildren:i}},{_hitTest:function(t,u,i){if(this._locked||!this._visible||this._guide&&!u.guides||this.isEmpty())return null;var h=this._matrix,f=i?i.appended(h):this.getGlobalMatrix().prepend(this.getView()._matrix),g=Math.max(u.tolerance,0.000000000001),x=u._tolerancePadding=new f0(w0._getStrokePadding(g,h._shiftless().invert()));if(t=h._inverseTransform(t),!t||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(x.multiply(2))._containsPoint(t))return null;var v=!(u.guides&&!this._guide||u.selected&&!this.isSelected()||u.type&&u.type!==k.hyphenate(this._class)||u.class&&!(this instanceof u.class)),s=u.match,p=this,d,_;function P(y){if(y&&s&&!s(y))y=null;if(y&&u.all)u.all.push(y);return y}function w(y,S){var D=S?d["get"+S]():p.getPosition();if(t.subtract(D).divide(x).length<=1)return new n0(y,p,{name:S?k.hyphenate(S):y,point:D})}var{position:r,center:C,bounds:B}=u;if(v&&this._parent&&(r||C||B)){if(C||B)d=this.getInternalBounds();if(_=r&&w("position")||C&&w("center","Center"),!_&&B){var j=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"];for(var o=0;o<8&&!_;o++)_=w("bounds",j[o])}_=P(_)}if(!_)_=this._hitTestChildren(t,u,f)||v&&P(this._hitTestSelf(t,u,f,this.getStrokeScaling()?null:f._shiftless().invert()))||null;if(_&&_.point)_.point=h.transform(_.point);return _},_hitTestSelf:function(t,u){if(u.fill&&this.hasFill()&&this._contains(t))return new n0("fill",this)},matches:function(t,u){function i(x,v){for(var s in x)if(x.hasOwnProperty(s)){var p=x[s],d=v[s];if(k.isPlainObject(p)&&k.isPlainObject(d)){if(!i(p,d))return!1}else if(!k.equals(p,d))return!1}return!0}var h=typeof t;if(h==="object"){for(var f in t)if(t.hasOwnProperty(f)&&!this.matches(f,t[f]))return!1;return!0}else if(h==="function")return t(this);else if(t==="match")return u(this);else{var g=/^(empty|editable)$/.test(t)?this["is"+k.capitalize(t)]():t==="type"?k.hyphenate(this._class):this[t];if(t==="class"){if(typeof u==="function")return this instanceof u;g=this._class}if(typeof u==="function")return!!u(g);else if(u){if(u.test)return u.test(g);else if(k.isPlainObject(u))return i(u,g)}return k.equals(g,u)}},getItems:function(t){return d0._getItems(this,t,this._matrix)},getItem:function(t){return d0._getItems(this,t,this._matrix,null,!0)[0]||null},statics:{_getItems:function t(u,i,h,f,g){if(!f){var x=typeof i==="object"&&i,v=x&&x.overlapping,s=x&&x.inside,p=v||s,P=p&&K.read([p]);if(f={items:[],recursive:x&&x.recursive!==!1,inside:!!s,overlapping:!!v,rect:P,path:v&&new w0.Rectangle({rectangle:P,insert:!1})},x)i=k.filter({},i,{recursive:!0,inside:!0,overlapping:!0})}var d=u._children,_=f.items,P=f.rect;h=P&&(h||new r0);for(var w=0,r=d&&d.length;w<r;w++){var C=d[w],B=h&&h.appended(C._matrix),j=!0;if(P){var p=C.getBounds(B);if(!P.intersects(p))continue;if(!(P.contains(p)||f.overlapping&&(p.contains(P)||f.path.intersects(C,B))))j=!1}if(j&&C.matches(i)){if(_.push(C),g)break}if(f.recursive!==!1)t(C,i,B,f,g);if(g&&_.length>0)break}return _}}},{importJSON:function(t){var u=k.importJSON(t,this);return u!==this?this.addChild(u):u},addChild:function(t){return this.insertChild(M,t)},insertChild:function(t,u){var i=u?this.insertChildren(t,[u]):null;return i&&i[0]},addChildren:function(t){return this.insertChildren(this._children.length,t)},insertChildren:function(t,u){var i=this._children;if(i&&u&&u.length>0){u=k.slice(u);var h={};for(var f=u.length-1;f>=0;f--){var g=u[f],x=g&&g._id;if(!g||h[x])u.splice(f,1);else g._remove(!1,!0),h[x]=!0}k.splice(i,u,t,0);var v=this._project,s=v._changes;for(var f=0,p=u.length;f<p;f++){var g=u[f],d=g._name;if(g._parent=this,g._setProject(v,!0),d)g.setName(d);if(s)g._changed(5)}this._changed(11)}else u=null;return u},_insertItem:"#insertChild",_insertAt:function(t,u){var i=t&&t._getOwner(),h=t!==this&&i?this:null;if(h)h._remove(!1,!0),i._insertItem(t._index+u,h);return h},insertAbove:function(t){return this._insertAt(t,1)},insertBelow:function(t){return this._insertAt(t,0)},sendToBack:function(){var t=this._getOwner();return t?t._insertItem(0,this):null},bringToFront:function(){var t=this._getOwner();return t?t._insertItem(M,this):null},appendTop:"#addChild",appendBottom:function(t){return this.insertChild(0,t)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(t){return t._insertItem(M,this)},copyTo:function(t){return this.clone(!1).addTo(t)},reduce:function(t){var u=this._children;if(u&&u.length===1){var i=u[0].reduce(t);if(this._parent)i.insertAbove(this),this.remove();else i.remove();return i}return this},_removeNamed:function(){var t=this._getOwner();if(t){var{_children:u,_namedChildren:i}=t,h=this._name,f=i[h],g=f?f.indexOf(this):-1;if(g!==-1){if(u[h]==this)delete u[h];if(f.splice(g,1),f.length)u[h]=f[0];else delete i[h]}}},_remove:function(t,u){var i=this._getOwner(),h=this._project,f=this._index;if(this._style)this._style._dispose();if(i){if(this._name)this._removeNamed();if(f!=null){if(h._activeLayer===this)h._activeLayer=this.getNextSibling()||this.getPreviousSibling();k.splice(i._children,null,f,1)}if(this._installEvents(!1),t&&h._changes)this._changed(5);if(u)i._changed(11,this);return this._parent=null,!0}return!1},remove:function(){return this._remove(!0,!0)},replaceWith:function(t){var u=t&&t.insertBelow(this);if(u)this.remove();return u},removeChildren:function(t,u){if(!this._children)return null;t=t||0,u=k.pick(u,this._children.length);var i=k.splice(this._children,null,t,u-t);for(var h=i.length-1;h>=0;h--)i[h]._remove(!0,!1);if(i.length>0)this._changed(11);return i},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var t=0,u=this._children.length;t<u;t++)this._children[t]._index=t;this._changed(11)}},isEmpty:function(t){var u=this._children,i=u?u.length:0;if(t){for(var h=0;h<i;h++)if(!u[h].isEmpty(t))return!1;return!0}return!i},isEditable:function(){var t=this;while(t){if(!t._visible||t._locked)return!1;t=t._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(t){function u(x){var v=[];do v.unshift(x);while(x=x._parent);return v}var i=u(this),h=u(t);for(var f=0,g=Math.min(i.length,h.length);f<g;f++)if(i[f]!=h[f])return i[f]._index<h[f]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return this._parent?this._parent.isInserted():!1},isAbove:function(t){return this._getOrder(t)===-1},isBelow:function(t){return this._getOrder(t)===1},isParent:function(t){return this._parent===t},isChild:function(t){return t&&t._parent===this},isDescendant:function(t){var u=this;while(u=u._parent)if(u===t)return!0;return!1},isAncestor:function(t){return t?t.isDescendant(this):!1},isSibling:function(t){return this._parent===t._parent},isGroupedWith:function(t){var u=this._parent;while(u){if(u._parent&&/^(Group|Layer|CompoundPath)$/.test(u._class)&&t.isDescendant(u))return!0;u=u._parent}return!1}},k.each(["rotate","scale","shear","skew"],function(t){var u=t==="rotate";this[t]=function(){var i=arguments,h=(u?k:O).read(i),f=O.read(i,0,{readNull:!0});return this.transform(new r0()[t](h,f||this.getPosition(!0)))}},{translate:function(){var t=new r0;return this.transform(t.translate.apply(t,arguments))},transform:function(t,u,i){var h=this._matrix,f=t&&!t.isIdentity(),g=i&&this._canApplyMatrix||this._applyMatrix&&(f||!h.isIdentity()||u&&this._children);if(!f&&!g)return this;if(f){if(!t.isInvertible()&&h.isInvertible())h._backup=h.getValues();h.prepend(t,!0);var x=this._style,v=x.getFillColor(!0),s=x.getStrokeColor(!0);if(v)v.transform(t);if(s)s.transform(t)}if(g&&(g=this._transformContent(h,u,i))){var p=this._pivot;if(p)h._transformPoint(p,p,!0);if(h.reset(!0),i&&this._canApplyMatrix)this._applyMatrix=!0}var d=this._bounds,_=this._position;if(f||g)this._changed(25);var P=f&&d&&t.decompose();if(P&&P.skewing.isZero()&&P.rotation%90===0){for(var w in d){var r=d[w];if(r.nonscaling)delete d[w];else if(g||!r.internal){var C=r.rect;t._transformBounds(C,C)}}this._bounds=d;var B=d[this._getBoundsCacheKey(this._boundsOptions||{})];if(B)this._position=this._getPositionFromBounds(B.rect)}else if(f&&_&&this._pivot)this._position=t._transformPoint(_,_);return this},_transformContent:function(t,u,i){var h=this._children;if(h){for(var f=0,g=h.length;f<g;f++)h[f].transform(t,u,i);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(O.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(O.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(O.read(arguments))},localToParent:function(){return this._matrix._transformPoint(O.read(arguments))},fitBounds:function(t,u){t=K.read(arguments);var i=this.getBounds(),h=i.height/i.width,f=t.height/t.width,g=(u?h>f:h<f)?t.width/i.width:t.height/i.height,x=new K(new O,new f0(i.width*g,i.height*g));x.setCenter(t.getCenter()),this.setBounds(x)}}),{_setStyles:function(t,u,i){var h=this._style,f=this._matrix;if(h.hasFill())t.fillStyle=h.getFillColor().toCanvasStyle(t,f);if(h.hasStroke()){t.strokeStyle=h.getStrokeColor().toCanvasStyle(t,f),t.lineWidth=h.getStrokeWidth();var g=h.getStrokeJoin(),x=h.getStrokeCap(),v=h.getMiterLimit();if(g)t.lineJoin=g;if(x)t.lineCap=x;if(v)t.miterLimit=v;if(k0.support.nativeDash){var s=h.getDashArray(),p=h.getDashOffset();if(s&&s.length)if("setLineDash"in t)t.setLineDash(s),t.lineDashOffset=p;else t.mozDash=s,t.mozDashOffset=p}}if(h.hasShadow()){var d=u.pixelRatio||1,_=i._shiftless().prepend(new r0().scale(d,d)),P=_.transform(new O(h.getShadowBlur(),0)),w=_.transform(this.getShadowOffset());t.shadowColor=h.getShadowColor().toCanvasStyle(t),t.shadowBlur=P.getLength(),t.shadowOffsetX=w.x,t.shadowOffsetY=w.y}},draw:function(t,u,i){var h=this._updateVersion=this._project._updateVersion;if(!this._visible||this._opacity===0)return;var{matrices:f,viewMatrix:g}=u,x=this._matrix,v=f[f.length-1].appended(x);if(!v.isInvertible())return;if(g=g?g.appended(v):v,f.push(v),u.updateMatrix)this._globalMatrix=v;var s=this._blendMode,p=Q.clamp(this._opacity,0,1),d=s==="normal",_=d4.nativeModes[s],P=d&&p===1||u.dontStart||u.clip||(_||d&&p<1)&&this._canComposite(),w=u.pixelRatio||1,r,C,B;if(!P){var j=this.getStrokeBounds(g);if(!j.width||!j.height){f.pop();return}if(B=u.offset,C=u.offset=j.getTopLeft().floor(),r=t,t=U0.getContext(j.getSize().ceil().add(1).multiply(w)),w!==1)t.scale(w,w)}t.save();var o=i?i.appended(x):this._canScaleStroke&&!this.getStrokeScaling(!0)&&g,y=!P&&u.clipItem,S=!o||y;if(P){if(t.globalAlpha=p,_)t.globalCompositeOperation=s}else if(S)t.translate(-C.x,-C.y);if(S)(P?x:g).applyToContext(t);if(y)u.clipItem.draw(t,u.extend({clip:!0}));if(o){t.setTransform(w,0,0,w,0,0);var D=u.offset;if(D)t.translate(-D.x,-D.y)}if(this._draw(t,u,g,o),t.restore(),f.pop(),u.clip&&!u.dontFinish)t.clip(this.getFillRule());if(!P)d4.process(s,t,r,p,C.subtract(B).multiply(w)),U0.release(t),u.offset=B},_isUpdated:function(t){var u=this._parent;if(u instanceof O0)return u._isUpdated(t);var i=this._updateVersion===t;if(!i&&u&&u._visible&&u._isUpdated(t))this._updateVersion=t,i=!0;return i},_drawSelection:function(t,u,i,h,f){var g=this._selection,x=g&1,v=g&2||x&&this._selectBounds,s=g&4;if(!this._drawSelected)x=!1;if((x||v||s)&&this._isUpdated(f)){var p,d=this.getSelectedColor(!0)||(p=this.getLayer())&&p.getSelectedColor(!0),_=u.appended(this.getGlobalMatrix(!0)),P=i/2;if(t.strokeStyle=t.fillStyle=d?d.toCanvasStyle(t):"#009dec",x)this._drawSelected(t,_,h);if(s){var w=this.getPosition(!0),r=this._parent,C=r?r.localToGlobal(w):w,B=C.x,j=C.y;t.beginPath(),t.arc(B,j,P,0,Math.PI*2,!0),t.stroke();var o=[[0,-1],[1,0],[0,1],[-1,0]],y=P,S=i+1;for(var D=0;D<4;D++){var G=o[D],c=G[0],L=G[1];t.moveTo(B+c*y,j+L*y),t.lineTo(B+c*S,j+L*S),t.stroke()}}if(v){var z=_._transformCorners(this.getInternalBounds());t.beginPath();for(var D=0;D<8;D++)t[!D?"moveTo":"lineTo"](z[D],z[++D]);t.closePath(),t.stroke();for(var D=0;D<8;D++)t.fillRect(z[D]-P,z[++D]-P,i,i)}}},_canComposite:function(){return!1}},k.each(["down","drag","up","move"],function(t){this["removeOn"+k.capitalize(t)]=function(){var u={};return u[t]=!0,this.removeOn(u)}},{removeOn:function(t){for(var u in t)if(t[u]){var i="mouse"+u,h=this._project,f=h._removeSets=h._removeSets||{};f[i]=f[i]||{},f[i][this._id]=this}return this}}),{tween:function(t,u,i){if(!i){if(i=u,u=t,t=null,!i)i=u,u=null}var h=i&&i.easing,f=i&&i.start,g=i!=null&&(typeof i==="number"?i:i.duration),x=new U5(this,t,u,g,h,f);function v(s){if(x._handleFrame(s.time*1000),!x.running)this.off("frame",v)}if(g)this.on("frame",v);return x},tweenTo:function(t,u){return this.tween(null,t,u)},tweenFrom:function(t,u){return this.tween(t,null,u)}}),v6=d0.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function t(u){if(this._children=[],this._namedChildren={},!this._initialize(u))this.addChildren(Array.isArray(u)?u:arguments)},_changed:function t(u){if(t.base.call(this,u),u&2050)this._clipItem=M},_getClipItem:function(){var t=this._clipItem;if(t===M){t=null;var u=this._children;for(var i=0,h=u.length;i<h;i++)if(u[i]._clipMask){t=u[i];break}this._clipItem=t}return t},isClipped:function(){return!!this._getClipItem()},setClipped:function(t){var u=this.getFirstChild();if(u)u.setClipMask(t)},_getBounds:function t(u,i){var h=this._getClipItem();return h?h._getCachedBounds(h._matrix.prepended(u),k.set({},i,{stroke:!1})):t.base.call(this,u,i)},_hitTestChildren:function t(u,i,h){var f=this._getClipItem();return(!f||f.contains(u))&&t.base.call(this,u,i,h,f)},_draw:function(t,u){var i=u.clip,h=!i&&this._getClipItem();if(u=u.extend({clipItem:h,clip:!1}),i)t.beginPath(),u.dontStart=u.dontFinish=!0;else if(h)h.draw(t,u.extend({clip:!0}));var f=this._children;for(var g=0,x=f.length;g<x;g++){var v=f[g];if(v!==h)v.draw(t,u)}}}),l6=v6.extend({_class:"Layer",initialize:function t(){v6.apply(this,arguments)},_getOwner:function(){return this._parent||this._index!=null&&this._project},isInserted:function t(){return this._parent?t.base.call(this):this._index!=null},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),g0=d0.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function t(u,i){this._initialize(u,i)},_equals:function(t){return this._type===t._type&&this._size.equals(t._size)&&k.equals(this._radius,t._radius)},copyContent:function(t){this.setType(t._type),this.setSize(t._size),this.setRadius(t._radius)},getType:function(){return this._type},setType:function(t){this._type=t},getShape:"#getType",setShape:"#setType",getSize:function(){var t=this._size;return new y6(t.width,t.height,this,"setSize")},setSize:function(){var t=f0.read(arguments);if(!this._size)this._size=t.clone();else if(!this._size.equals(t)){var u=this._type,i=t.width,h=t.height;if(u==="rectangle")this._radius.set(f0.min(this._radius,t.divide(2).abs()));else if(u==="circle")i=h=(i+h)/2,this._radius=i/2;else if(u==="ellipse")this._radius._set(i/2,h/2);this._size._set(i,h),this._changed(9)}},getRadius:function(){var t=this._radius;return this._type==="circle"?t:new y6(t.width,t.height,this,"setRadius")},setRadius:function(t){var u=this._type;if(u==="circle"){if(t===this._radius)return;var i=t*2;this._radius=t,this._size._set(i,i)}else if(t=f0.read(arguments),!this._radius)this._radius=t.clone();else{if(this._radius.equals(t))return;if(this._radius.set(t),u==="rectangle"){var i=f0.max(this._size,t.multiply(2));this._size.set(i)}else if(u==="ellipse")this._size._set(t.width*2,t.height*2)}this._changed(9)},isEmpty:function(){return!1},toPath:function(t){var u=new w0[k.capitalize(this._type)]({center:new O,size:this._size,radius:this._radius,insert:!1});if(u.copyAttributes(this),k0.settings.applyMatrix)u.setApplyMatrix(!0);if(t===M||t)u.insertAbove(this);return u},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(t,u,i,h){var f=this._style,g=f.hasFill(),x=f.hasStroke(),v=u.dontFinish||u.clip,s=!h;if(g||x||v){var p=this._type,d=this._radius,_=p==="circle";if(!u.dontStart)t.beginPath();if(s&&_)t.arc(0,0,d,0,Math.PI*2,!0);else{var P=_?d:d.width,w=_?d:d.height,r=this._size,C=r.width,B=r.height;if(s&&p==="rectangle"&&P===0&&w===0)t.rect(-C/2,-B/2,C,B);else{var j=C/2,o=B/2,y=0.44771525016920644,S=P*y,D=w*y,G=[-j,-o+w,-j,-o+D,-j+S,-o,-j+P,-o,j-P,-o,j-S,-o,j,-o+D,j,-o+w,j,o-w,j,o-D,j-S,o,j-P,o,-j+P,o,-j+S,o,-j,o-D,-j,o-w];if(h)h.transform(G,G,32);if(t.moveTo(G[0],G[1]),t.bezierCurveTo(G[2],G[3],G[4],G[5],G[6],G[7]),j!==P)t.lineTo(G[8],G[9]);if(t.bezierCurveTo(G[10],G[11],G[12],G[13],G[14],G[15]),o!==w)t.lineTo(G[16],G[17]);if(t.bezierCurveTo(G[18],G[19],G[20],G[21],G[22],G[23]),j!==P)t.lineTo(G[24],G[25]);t.bezierCurveTo(G[26],G[27],G[28],G[29],G[30],G[31])}}t.closePath()}if(!v&&(g||x)){if(this._setStyles(t,u,i),g)t.fill(f.getFillRule()),t.shadowColor="rgba(0,0,0,0)";if(x)t.stroke()}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(t,u){var i=new K(this._size).setCenter(0,0),h=this._style,f=u.stroke&&h.hasStroke()&&h.getStrokeWidth();if(t)i=t._transformBounds(i);return f?i.expand(w0._getStrokePadding(f,this._getStrokeMatrix(t,u))):i}},new function(){function t(i,h,f){var g=i._radius;if(!g.isZero()){var x=i._size.divide(2);for(var v=1;v<=4;v++){var s=new O(v>1&&v<4?-1:1,v>2?-1:1),p=s.multiply(x),d=p.subtract(s.multiply(g)),_=new K(f?p.add(s.multiply(f)):p,d);if(_.contains(h))return{point:d,quadrant:v}}}}function u(i,h,f,g){var x=i.divide(h);return(!g||x.isInQuadrant(g))&&x.subtract(x.normalize()).multiply(h).divide(f).length<=1}return{_contains:function i(h){if(this._type==="rectangle"){var f=t(this,h);return f?h.subtract(f.point).divide(this._radius).getLength()<=1:i.base.call(this,h)}else return h.divide(this.size).getLength()<=0.5},_hitTestSelf:function i(h,f,g,x){var v=!1,s=this._style,p=f.stroke&&s.hasStroke(),d=f.fill&&s.hasFill();if(p||d){var _=this._type,P=this._radius,w=p?s.getStrokeWidth()/2:0,r=f._tolerancePadding.add(w0._getStrokePadding(w,!s.getStrokeScaling()&&x));if(_==="rectangle"){var C=r.multiply(2),B=t(this,h,C);if(B)v=u(h.subtract(B.point),P,r,B.quadrant);else{var j=new K(this._size).setCenter(0,0),o=j.expand(C),y=j.expand(C.negate());v=o._containsPoint(h)&&!y._containsPoint(h)}}else v=u(h,P,r)}return v?new n0(p?"stroke":"fill",this):i.base.apply(this,arguments)}}},{statics:new function(){function t(u,i,h,f,g){var x=k.create(g0.prototype);return x._type=u,x._size=h,x._radius=f,x._initialize(k.getNamed(g),i),x}return{Circle:function(){var u=arguments,i=O.readNamed(u,"center"),h=k.readNamed(u,"radius");return t("circle",i,new f0(h*2),h,u)},Rectangle:function(){var u=arguments,i=K.readNamed(u,"rectangle"),h=f0.min(f0.readNamed(u,"radius"),i.getSize(!0).divide(2));return t("rectangle",i.getCenter(!0),i.getSize(!0),h,u)},Ellipse:function(){var u=arguments,i=g0._readEllipse(u),h=i.radius;return t("ellipse",i.center,h.multiply(2),h,u)},_readEllipse:function(u){var i,h;if(k.hasNamed(u,"radius"))i=O.readNamed(u,"center"),h=f0.readNamed(u,"radius");else{var f=K.readNamed(u,"rectangle");i=f.getCenter(!0),h=f.getSize(!0).divide(2)}return{center:i,radius:h}}}}}),J=d0.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function t(u,i){if(!this._initialize(u,i!==M&&O.read(arguments))){var h,f=typeof u,g=f==="string"?H.getElementById(u):f==="object"?u:null;if(g&&g!==d0.NO_INSERT){if(g.getContext||g.naturalHeight!=null)h=g;else if(g){var x=f0.read(arguments);if(!x.isZero())h=U0.getCanvas(x)}}if(h)this.setImage(h);else this.setSource(u)}if(!this._size)this._size=new f0,this._loaded=!1},_equals:function(t){return this.getSource()===t.getSource()},copyContent:function(t){var{_image:u,_canvas:i}=t;if(u)this._setImage(u);else if(i){var h=U0.getCanvas(t._size);h.getContext("2d").drawImage(i,0,0),this._setImage(h)}this._crossOrigin=t._crossOrigin},getSize:function(){var t=this._size;return new y6(t?t.width:0,t?t.height:0,this,"setSize")},setSize:function(t,u){var i=f0.read(arguments);if(!i.equals(this._size))if(i.width>0&&i.height>0){var h=!u&&this.getElement();if(this._setImage(U0.getCanvas(i)),h)this.getContext(!0).drawImage(h,0,0,i.width,i.height)}else{if(this._canvas)U0.release(this._canvas);this._size=i.clone()}else if(u)this.clear()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(t){this.setSize(t,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(t){this.setSize(this.getWidth(),t)},getLoaded:function(){return this._loaded},isEmpty:function(){var t=this._size;return!t||t.width===0&&t.height===0},getResolution:function(){var t=this._matrix,u=new O(0,0).transform(t),i=new O(1,0).transform(t).subtract(u),h=new O(0,1).transform(t).subtract(u);return new f0(72/i.getLength(),72/h.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(t){var u=this;function i(h){var f=u.getView(),g=h&&h.type||"load";if(f&&u.responds(g))k0=f._scope,u.emit(g,new I6(h))}if(this._setImage(t),this._loaded)setTimeout(i,0);else if(t)T0.add(t,{load:function(h){u._setImage(t),i(h)},error:i})},_setImage:function(t){if(this._canvas)U0.release(this._canvas);if(t&&t.getContext)this._image=null,this._canvas=t,this._loaded=!0;else this._image=t,this._canvas=null,this._loaded=!!(t&&t.src&&t.complete);this._size=new f0(t?t.naturalWidth||t.width:0,t?t.naturalHeight||t.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var t=U0.getContext(this._size);try{if(this._image)t.drawImage(this._image,0,0);this._canvas=t.canvas}catch(u){U0.release(t)}}return this._canvas},setCanvas:"#setImage",getContext:function(t){if(!this._context)this._context=this.getCanvas().getContext("2d");if(t)this._image=null,this._changed(1025);return this._context},setContext:function(t){this._context=t},getSource:function(){var t=this._image;return t&&t.src||this.toDataURL()},setSource:function(t){var u=new E.Image,i=this._crossOrigin;if(i)u.crossOrigin=i;if(t)u.src=t;this.setImage(u)},getCrossOrigin:function(){var t=this._image;return t&&t.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(t){this._crossOrigin=t;var u=this._image;if(u)u.crossOrigin=t},getSmoothing:function(){return this._smoothing},setSmoothing:function(t){this._smoothing=typeof t==="string"?t:t?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var t=K.read(arguments),u=U0.getContext(t.getSize());return u.drawImage(this.getCanvas(),t.x,t.y,t.width,t.height,0,0,t.width,t.height),u.canvas},getSubRaster:function(){var t=K.read(arguments),u=new J(d0.NO_INSERT);return u._setImage(this.getSubCanvas(t)),u.translate(t.getCenter().subtract(this.getSize().divide(2))),u._matrix.prepend(this._matrix),u.insertAbove(this),u},toDataURL:function(){var t=this._image,u=t&&t.src;if(/^data:/.test(u))return u;var i=this.getCanvas();return i?i.toDataURL.apply(i,arguments):null},drawImage:function(t){var u=O.read(arguments,1);this.getContext(!0).drawImage(t,u.x,u.y)},getAverageColor:function(t){var u,i;if(!t)u=this.getBounds();else if(t instanceof e0)i=t,u=t.getBounds();else if(typeof t==="object"){if("width"in t)u=new K(t);else if("x"in t)u=new K(t.x-0.5,t.y-0.5,1,1)}if(!u)return null;var h=32,f=Math.min(u.width,h),g=Math.min(u.height,h),x=J._sampleContext;if(!x)x=J._sampleContext=U0.getContext(new f0(h));else x.clearRect(0,0,h+1,h+1);x.save();var v=new r0().scale(f/u.width,g/u.height).translate(-u.x,-u.y);if(v.applyToContext(x),i)i.draw(x,new k({clip:!0,matrices:[v]}));this._matrix.applyToContext(x);var s=this.getElement(),p=this._size;if(s)x.drawImage(s,-p.width/2,-p.height/2);x.restore();var d=x.getImageData(0.5,0.5,Math.ceil(f),Math.ceil(g)).data,_=[0,0,0],P=0;for(var w=0,r=d.length;w<r;w+=4){var C=d[w+3];P+=C,C/=255,_[0]+=d[w]*C,_[1]+=d[w+1]*C,_[2]+=d[w+2]*C}for(var w=0;w<3;w++)_[w]/=P;return P?s0.read(_):null},getPixel:function(){var t=O.read(arguments),u=this.getContext().getImageData(t.x,t.y,1,1).data;return new s0("rgb",[u[0]/255,u[1]/255,u[2]/255],u[3]/255)},setPixel:function(){var t=arguments,u=O.read(t),i=s0.read(t),h=i._convert("rgb"),f=i._alpha,g=this.getContext(!0),x=g.createImageData(1,1),v=x.data;v[0]=h[0]*255,v[1]=h[1]*255,v[2]=h[2]*255,v[3]=f!=null?f*255:255,g.putImageData(x,u.x,u.y)},clear:function(){var t=this._size;this.getContext(!0).clearRect(0,0,t.width+1,t.height+1)},createImageData:function(){var t=f0.read(arguments);return this.getContext().createImageData(t.width,t.height)},getImageData:function(){var t=K.read(arguments);if(t.isEmpty())t=new K(this._size);return this.getContext().getImageData(t.x,t.y,t.width,t.height)},putImageData:function(t){var u=O.read(arguments,1);this.getContext(!0).putImageData(t,u.x,u.y)},setImageData:function(t){this.setSize(t),this.getContext(!0).putImageData(t,0,0)},_getBounds:function(t,u){var i=new K(this._size).setCenter(0,0);return t?t._transformBounds(i):i},_hitTestSelf:function(t){if(this._contains(t)){var u=this;return new n0("pixel",u,{offset:t.add(u._size.divide(2)).round(),color:{get:function(){return u.getPixel(this.offset)}}})}},_draw:function(t,u,i){var h=this.getElement();if(h&&h.width>0&&h.height>0){t.globalAlpha=Q.clamp(this._opacity,0,1),this._setStyles(t,u,i);var f=this._smoothing,g=f==="off";A0.setPrefixed(t,g?"imageSmoothingEnabled":"imageSmoothingQuality",g?!1:f),t.drawImage(h,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),$=d0.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function t(u,i){if(!this._initialize(u,i!==M&&O.read(arguments,1)))this.setDefinition(u instanceof W?u:new W(u))},_equals:function(t){return this._definition===t._definition},copyContent:function(t){this.setDefinition(t._definition)},getDefinition:function(){return this._definition},setDefinition:function(t){this._definition=t,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(t,u){var i=this._definition._item;return i._getCachedBounds(i._matrix.prepended(t),u)},_hitTestSelf:function(t,u,i){var h=u.extend({all:!1}),f=this._definition._item._hitTest(t,h,i);if(f)f.item=this;return f},_draw:function(t,u){this._definition._item.draw(t,u)}}),W=k.extend({_class:"SymbolDefinition",initialize:function t(u,i){if(this._id=x0.get(),this.project=k0.project,u)this.setItem(u,i)},_serialize:function(t,u){return u.add(this,function(){return k.serialize([this._class,this._item],t,!1,u)})},_changed:function(t){if(t&8)d0._clearBoundsCache(this);if(t&1)this.project._changed(t)},getItem:function(){return this._item},setItem:function(t,u){if(t._symbol)t=t.clone();if(this._item)this._item._symbol=null;if(this._item=t,t.remove(),t.setSelected(!1),!u)t.setPosition(new O);t._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(t){return new $(this,t)},clone:function(){return new W(this._item.clone(!1))},equals:function(t){return t===this||t&&this._item.equals(t._item)||!1}}),n0=k.extend({_class:"HitResult",initialize:function t(u,i,h){if(this.type=u,this.item=i,h)this.inject(h)},statics:{getOptions:function(t){var u=t&&k.read(t);return new k({type:null,tolerance:k0.settings.hitTolerance,fill:!u,stroke:!u,segments:!u,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},u)}}}),Z=k.extend({_class:"Segment",beans:!0,_selection:0,initialize:function t(u,i,h,f,g,x){var v=arguments.length,s,p,d,_;if(v>0)if(u==null||typeof u==="object")if(v===1&&u&&"point"in u)s=u.point,p=u.handleIn,d=u.handleOut,_=u.selection;else s=u,p=i,d=h,_=f;else s=[u,i],p=h!==M?[h,f]:null,d=g!==M?[g,x]:null;if(new B0(s,this,"_point"),new B0(p,this,"_handleIn"),new B0(d,this,"_handleOut"),_)this.setSelection(_)},_serialize:function(t,u){var i=this._point,h=this._selection,f=h||this.hasHandles()?[i,this._handleIn,this._handleOut]:i;if(h)f.push(h);return k.serialize(f,t,!0,u)},_changed:function(t){var u=this._path;if(!u)return;var i=u._curves,h=this._index,f;if(i){if((!t||t===this._point||t===this._handleIn)&&(f=h>0?i[h-1]:u._closed?i[i.length-1]:null))f._changed();if((!t||t===this._point||t===this._handleOut)&&(f=i[h]))f._changed()}u._changed(41)},getPoint:function(){return this._point},setPoint:function(){this._point.set(O.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(O.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(O.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var t=this._handleIn,u=this._handleOut;return!t.isZero()&&!u.isZero()&&t.isCollinear(u)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(t){var u=this._selection,i=this._path;if(this._selection=t=t||0,i&&t!==u)i._updateSelection(this,u,t),i._changed(257)},_changeSelection:function(t,u){var i=this._selection;this.setSelection(u?i|t:i&~t)},isSelected:function(){return!!(this._selection&7)},setSelected:function(t){this._changeSelection(7,t)},getIndex:function(){return this._index!==M?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var t=this._path,u=this._index;if(t){if(u>0&&!t._closed&&u===t._segments.length-1)u--;return t.getCurves()[u]||null}return null},getLocation:function(){var t=this.getCurve();return t?new c0(t,this===t._segment1?0:1):null},getNext:function(){var t=this._path&&this._path._segments;return t&&(t[this._index+1]||this._path._closed&&t[0])||null},smooth:function(t,u,i){var h=t||{},f=h.type,g=h.factor,x=this.getPrevious(),v=this.getNext(),s=(x||this)._point,p=this._point,d=(v||this)._point,_=s.getDistance(p),P=p.getDistance(d);if(!f||f==="catmull-rom"){var w=g===M?0.5:g,r=Math.pow(_,w),C=r*r,B=Math.pow(P,w),j=B*B;if(!u&&x){var o=2*j+3*B*r+C,y=3*B*(B+r);this.setHandleIn(y!==0?new O((j*s._x+o*p._x-C*d._x)/y-p._x,(j*s._y+o*p._y-C*d._y)/y-p._y):new O)}if(!i&&v){var o=2*C+3*r*B+j,y=3*r*(r+B);this.setHandleOut(y!==0?new O((C*d._x+o*p._x-j*s._x)/y-p._x,(C*d._y+o*p._y-j*s._y)/y-p._y):new O)}}else if(f==="geometric"){if(x&&v){var S=s.subtract(d),D=g===M?0.4:g,G=D*_/(_+P);if(!u)this.setHandleIn(S.multiply(G));if(!i)this.setHandleOut(S.multiply(G-D))}}else throw new Error("Smoothing method \'"+f+"\' not supported.")},getPrevious:function(){var t=this._path&&this._path._segments;return t&&(t[this._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var t=this._path;return t&&this._index===t._segments.length-1||!1},reverse:function(){var t=this._handleIn,u=this._handleOut,i=t.clone();t.set(u),u.set(i)},reversed:function(){return new Z(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new Z(this._point,this._handleIn,this._handleOut)},equals:function(t){return t===this||t&&this._class===t._class&&this._point.equals(t._point)&&this._handleIn.equals(t._handleIn)&&this._handleOut.equals(t._handleOut)||!1},toString:function(){var t=["point: "+this._point];if(!this._handleIn.isZero())t.push("handleIn: "+this._handleIn);if(!this._handleOut.isZero())t.push("handleOut: "+this._handleOut);return"{ "+t.join(", ")+" }"},transform:function(t){this._transformCoordinates(t,new Array(6),!0),this._changed()},interpolate:function(t,u,i){var h=1-i,f=i,g=t._point,x=u._point,v=t._handleIn,s=u._handleIn,p=u._handleOut,d=t._handleOut;this._point._set(h*g._x+f*x._x,h*g._y+f*x._y,!0),this._handleIn._set(h*v._x+f*s._x,h*v._y+f*s._y,!0),this._handleOut._set(h*d._x+f*p._x,h*d._y+f*p._y,!0),this._changed()},_transformCoordinates:function(t,u,i){var h=this._point,f=!i||!this._handleIn.isZero()?this._handleIn:null,g=!i||!this._handleOut.isZero()?this._handleOut:null,x=h._x,v=h._y,s=2;if(u[0]=x,u[1]=v,f)u[s++]=f._x+x,u[s++]=f._y+v;if(g)u[s++]=g._x+x,u[s++]=g._y+v;if(t)if(t._transformCoordinates(u,u,s/2),x=u[0],v=u[1],i){if(h._x=x,h._y=v,s=2,f)f._x=u[s++]-x,f._y=u[s++]-v;if(g)g._x=u[s++]-x,g._y=u[s++]-v}else{if(!f)u[s++]=x,u[s++]=v;if(!g)u[s++]=x,u[s++]=v}return u}}),B0=O.extend({initialize:function t(u,i,h){var f,g,x;if(!u)f=g=0;else if((f=u[0])!==M)g=u[1];else{var v=u;if((f=v.x)===M)v=O.read(arguments),f=v.x;g=v.y,x=v.selected}if(this._x=f,this._y=g,this._owner=i,i[h]=this,x)this.setSelected(!0)},_set:function(t,u){return this._x=t,this._y=u,this._owner._changed(this),this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner._changed(this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner._changed(this)},isZero:function(){var t=Q.isZero;return t(this._x)&&t(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){var t=this._owner;return this===t._point?1:this===t._handleIn?2:this===t._handleOut?4:0}}),T=k.extend({_class:"Curve",beans:!0,initialize:function t(u,i,h,f,g,x,v,s){var p=arguments.length,d,_,P,w,r,C;if(p===3)this._path=u,d=i,_=h;else if(!p)d=new Z,_=new Z;else if(p===1){if("segment1"in u)d=new Z(u.segment1),_=new Z(u.segment2);else if("point1"in u)P=u.point1,r=u.handle1,C=u.handle2,w=u.point2;else if(Array.isArray(u))P=[u[0],u[1]],w=[u[6],u[7]],r=[u[2]-u[0],u[3]-u[1]],C=[u[4]-u[6],u[5]-u[7]]}else if(p===2)d=new Z(u),_=new Z(i);else if(p===4)P=u,r=i,C=h,w=f;else if(p===8)P=[u,i],w=[v,s],r=[h-u,f-i],C=[g-v,x-s];this._segment1=d||new Z(P,null,r),this._segment2=_||new Z(w,C,null)},_serialize:function(t,u){return k.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],t,!0,u)},_changed:function(){this._length=this._bounds=M},clone:function(){return new T(this._segment1,this._segment2)},toString:function(){var t=["point1: "+this._segment1._point];if(!this._segment1._handleOut.isZero())t.push("handle1: "+this._segment1._handleOut);if(!this._segment2._handleIn.isZero())t.push("handle2: "+this._segment2._handleIn);return t.push("point2: "+this._segment2._point),"{ "+t.join(", ")+" }"},classify:function(){return T.classify(this.getValues())},remove:function(){var t=!1;if(this._path){var u=this._segment2,i=u._handleOut;if(t=u.remove(),t)this._segment1._handleOut.set(i)}return t},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(O.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(O.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(O.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(O.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index+1]||this._path._closed&&t[0])||null},getPrevious:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var t=this._path;return t&&this._segment1._index===t._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(t){this.getPoint1().setSelected(t),this.getHandle1().setSelected(t),this.getHandle2().setSelected(t),this.getPoint2().setSelected(t)},getValues:function(t){return T.getValues(this._segment1,this._segment2,t)},getPoints:function(){var t=this.getValues(),u=[];for(var i=0;i<8;i+=2)u.push(new O(t[i],t[i+1]));return u}},{getLength:function(){if(this._length==null)this._length=T.getLength(this.getValues(),0,1);return this._length},getArea:function(){return T.getArea(this.getValues())},getLine:function(){return new D0(this._segment1._point,this._segment2._point)},getPart:function(t,u){return new T(T.getPart(this.getValues(),t,u))},getPartLength:function(t,u){return T.getLength(this.getValues(),t,u)},divideAt:function(t){return this.divideAtTime(t&&t.curve===this?t.time:this.getTimeAt(t))},divideAtTime:function(t,u){var i=0.00000001,h=1-i,f=null;if(t>=i&&t<=h){var g=T.subdivide(this.getValues(),t),x=g[0],v=g[1],s=u||this.hasHandles(),p=this._segment1,d=this._segment2,_=this._path;if(s)p._handleOut._set(x[2]-x[0],x[3]-x[1]),d._handleIn._set(v[4]-v[6],v[5]-v[7]);var P=x[6],w=x[7],r=new Z(new O(P,w),s&&new O(x[4]-P,x[5]-w),s&&new O(v[2]-P,v[3]-w));if(_)_.insert(p._index+1,r),f=this.getNext();else this._segment2=r,this._changed(),f=new T(r,d)}return f},splitAt:function(t){var u=this._path;return u?u.splitAt(t):null},splitAtTime:function(t){return this.splitAt(this.getLocationAtTime(t))},divide:function(t,u){return this.divideAtTime(t===M?0.5:u?t:this.getTimeAt(t))},split:function(t,u){return this.splitAtTime(t===M?0.5:u?t:this.getTimeAt(t))},reversed:function(){return new T(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(t,u,i,h){var{_point:f,_handleOut:g}=t,x=u._handleIn,v=u._point,s=f.x,p=f.y,d=v.x,_=v.y,P=h?[s,p,s,p,d,_,d,_]:[s,p,s+g._x,p+g._y,d+x._x,_+x._y,d,_];if(i)i._transformCoordinates(P,P,4);return P},subdivide:function(t,u){var i=t[0],h=t[1],f=t[2],g=t[3],x=t[4],v=t[5],s=t[6],p=t[7];if(u===M)u=0.5;var d=1-u,_=d*i+u*f,P=d*h+u*g,w=d*f+u*x,r=d*g+u*v,C=d*x+u*s,B=d*v+u*p,j=d*_+u*w,o=d*P+u*r,y=d*w+u*C,S=d*r+u*B,D=d*j+u*y,G=d*o+u*S;return[[i,h,_,P,j,o,D,G],[D,G,y,S,C,B,s,p]]},getMonoCurves:function(t,u){var i=[],h=u?0:1,f=t[h+0],g=t[h+2],x=t[h+4],v=t[h+6];if(f>=g===g>=x&&g>=x===x>=v||T.isStraight(t))i.push(t);else{var s=3*(g-x)-f+v,p=2*(f+x)-4*g,d=g-f,_=0.00000001,P=1-_,w=[],r=Q.solveQuadratic(s,p,d,w,_,P);if(!r)i.push(t);else{w.sort();var C=w[0],B=T.subdivide(t,C);if(i.push(B[0]),r>1)C=(w[1]-C)/(1-C),B=T.subdivide(B[1],C),i.push(B[0]);i.push(B[1])}}return i},solveCubic:function(t,u,i,h,f,g){var x=t[u],v=t[u+2],s=t[u+4],p=t[u+6],d=0;if(!(x<i&&p<i&&v<i&&s<i||x>i&&p>i&&v>i&&s>i)){var _=3*(v-x),P=3*(s-v)-_,w=p-x-_-P;d=Q.solveCubic(w,P,_,x-i,h,f,g)}return d},getTimeOf:function(t,u){var i=new O(t[0],t[1]),h=new O(t[6],t[7]),f=0.000000000001,g=0.0000001,x=u.isClose(i,f)?0:u.isClose(h,f)?1:null;if(x===null){var v=[u.x,u.y],s=[];for(var p=0;p<2;p++){var d=T.solveCubic(t,p,v[p],s,0,1);for(var _=0;_<d;_++){var P=s[_];if(u.isClose(T.getPoint(t,P),g))return P}}}return u.isClose(i,g)?0:u.isClose(h,g)?1:null},getNearestTime:function(t,u){if(T.isStraight(t)){var i=t[0],h=t[1],f=t[6],g=t[7],x=f-i,v=g-h,s=x*x+v*v;if(s===0)return 0;var p=((u.x-i)*x+(u.y-h)*v)/s;return p<0.000000000001?0:p>0.999999999999?1:T.getTimeOf(t,new O(i+p*x,h+p*v))}var d=100,_=Infinity,P=0;function w(B){if(B>=0&&B<=1){var j=u.getDistance(T.getPoint(t,B),!0);if(j<_)return _=j,P=B,!0}}for(var r=0;r<=d;r++)w(r/d);var C=1/(d*2);while(C>0.00000001)if(!w(P-C)&&!w(P+C))C/=2;return P},getPart:function(t,u,i){var h=u>i;if(h){var f=u;u=i,i=f}if(u>0)t=T.subdivide(t,u)[1];if(i<1)t=T.subdivide(t,(i-u)/(1-u))[0];return h?[t[6],t[7],t[4],t[5],t[2],t[3],t[0],t[1]]:t},isFlatEnough:function(t,u){var i=t[0],h=t[1],f=t[2],g=t[3],x=t[4],v=t[5],s=t[6],p=t[7],d=3*f-2*i-s,_=3*g-2*h-p,P=3*x-2*s-i,w=3*v-2*p-h;return Math.max(d*d,P*P)+Math.max(_*_,w*w)<=16*u*u},getArea:function(t){var u=t[0],i=t[1],h=t[2],f=t[3],g=t[4],x=t[5],v=t[6],s=t[7];return 3*((s-i)*(h+g)-(v-u)*(f+x)+f*(u-g)-h*(i-x)+s*(g+u/3)-v*(x+i/3))/20},getBounds:function(t){var u=t.slice(0,2),i=u.slice(),h=[0,0];for(var f=0;f<2;f++)T._addBounds(t[f],t[f+2],t[f+4],t[f+6],f,0,u,i,h);return new K(u[0],u[1],i[0]-u[0],i[1]-u[1])},_addBounds:function(t,u,i,h,f,g,x,v,s){function p(D,G){var c=D-G,L=D+G;if(c<x[f])x[f]=c;if(L>v[f])v[f]=L}g/=2;var d=x[f]+g,_=v[f]-g;if(t<d||u<d||i<d||h<d||t>_||u>_||i>_||h>_)if(u<t!=u<h&&i<t!=i<h)p(t,0),p(h,0);else{var P=3*(u-i)-t+h,w=2*(t+i)-4*u,r=u-t,C=Q.solveQuadratic(P,w,r,s),B=0.00000001,j=1-B;p(h,0);for(var o=0;o<C;o++){var y=s[o],S=1-y;if(B<=y&&y<=j)p(S*S*S*t+3*S*S*y*u+3*S*y*y*i+y*y*y*h,g)}}}}},k.each(["getBounds","getStrokeBounds","getHandleBounds"],function(t){this[t]=function(){if(!this._bounds)this._bounds={};var u=this._bounds[t];if(!u)u=this._bounds[t]=w0[t]([this._segment1,this._segment2],!1,this._path);return u.clone()}},{}),k.each({isStraight:function(t,u,i,h){if(u.isZero()&&i.isZero())return!0;else{var f=h.subtract(t);if(f.isZero())return!1;else if(f.isCollinear(u)&&f.isCollinear(i)){var g=new D0(t,h),x=0.0000001;if(g.getDistance(t.add(u))<x&&g.getDistance(h.add(i))<x){var v=f.dot(f),s=f.dot(u)/v,p=f.dot(i)/v;return s>=0&&s<=1&&p<=0&&p>=-1}}}return!1},isLinear:function(t,u,i,h){var f=h.subtract(t).divide(3);return u.equals(f)&&i.negate().equals(f)}},function(t,u){this[u]=function(i){var h=this._segment1,f=this._segment2;return t(h._point,h._handleOut,f._handleIn,f._point,i)},this.statics[u]=function(i,h){var f=i[0],g=i[1],x=i[6],v=i[7];return t(new O(f,g),new O(i[2]-f,i[3]-g),new O(i[4]-x,i[5]-v),new O(x,v),h)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(t){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(t||0)},isCollinear:function(t){return t&&this.isStraight()&&t.isStraight()&&this.getLine().isCollinear(t.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(0.5).y)<0.00000001},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(0.5).x)<0.00000001}}),{beans:!1,getLocationAt:function(t,u){return this.getLocationAtTime(u?t:this.getTimeAt(t))},getLocationAtTime:function(t){return t!=null&&t>=0&&t<=1?new c0(this,t):null},getTimeAt:function(t,u){return T.getTimeAt(this.getValues(),t,u)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var t=O.read(arguments);return t.isZero()?[]:T.getTimesWithTangent(this.getValues(),t)},getOffsetAtTime:function(t){return this.getPartLength(0,t)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(O.read(arguments)))},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getTimeOf:function(){return T.getTimeOf(this.getValues(),O.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var t=O.read(arguments),u=this.getValues(),i=T.getNearestTime(u,t),h=T.getPoint(u,i);return new c0(this,i,h,null,t.getDistance(h))},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t?t.getPoint():t}},new function(){var t=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return k.each(t,function(u){this[u+"At"]=function(i,h){var f=this.getValues();return T[u](f,h?i:T.getTimeAt(f,i))},this[u+"AtTime"]=function(i){return T[u](this.getValues(),i)}},{statics:{_evaluateMethods:t}})},new function(){function t(h){var f=h[0],g=h[1],x=h[2],v=h[3],s=h[4],p=h[5],d=h[6],_=h[7],P=9*(x-s)+3*(d-f),w=6*(f+s)-12*x,r=3*(x-f),C=9*(v-p)+3*(_-g),B=6*(g+p)-12*v,j=3*(v-g);return function(o){var y=(P*o+w)*o+r,S=(C*o+B)*o+j;return Math.sqrt(y*y+S*S)}}function u(h,f){return Math.max(2,Math.min(16,Math.ceil(Math.abs(f-h)*32)))}function i(h,f,g,x){if(f==null||f<0||f>1)return null;var v=h[0],s=h[1],p=h[2],d=h[3],_=h[4],P=h[5],w=h[6],r=h[7],C=Q.isZero;if(C(p-v)&&C(d-s))p=v,d=s;if(C(_-w)&&C(P-r))_=w,P=r;var B=3*(p-v),j=3*(_-p)-B,o=w-v-B-j,y=3*(d-s),S=3*(P-d)-y,D=r-s-y-S,G,c;if(g===0)G=f===0?v:f===1?w:((o*f+j)*f+B)*f+v,c=f===0?s:f===1?r:((D*f+S)*f+y)*f+s;else{var L=0.00000001,z=1-L;if(f<L)G=B,c=y;else if(f>z)G=3*(w-_),c=3*(r-P);else G=(3*o*f+2*j)*f+B,c=(3*D*f+2*S)*f+y;if(x){if(G===0&&c===0&&(f<L||f>z))G=_-p,c=P-d;var V=Math.sqrt(G*G+c*c);if(V)G/=V,c/=V}if(g===3){var _=6*o*f+2*j,P=6*D*f+2*S,N=Math.pow(G*G+c*c,1.5);G=N!==0?(G*P-c*_)/N:0,c=0}}return g===2?new O(c,-G):new O(G,c)}return{statics:{classify:function(h){var f=h[0],g=h[1],x=h[2],v=h[3],s=h[4],p=h[5],d=h[6],_=h[7],P=f*(_-p)+g*(s-d)+d*p-_*s,w=x*(g-_)+v*(d-f)+f*_-g*d,r=s*(v-g)+p*(f-x)+x*g-v*f,C=3*r,B=C-w,j=B-w+P,o=Math.sqrt(j*j+B*B+C*C),y=o!==0?1/o:0,S=Q.isZero,D="serpentine";j*=y,B*=y,C*=y;function G(V,N,q){var A=N!==M,a=A&&N>0&&N<1,R=A&&q>0&&q<1;if(A&&(!(a||R)||V==="loop"&&!(a&&R)))V="arch",a=R=!1;return{type:V,roots:a||R?a&&R?N<q?[N,q]:[q,N]:[a?N:q]:null}}if(S(j))return S(B)?G(S(C)?"line":"quadratic"):G(D,C/(3*B));var c=3*B*B-4*j*C;if(S(c))return G("cusp",B/(2*j));var L=c>0?Math.sqrt(c/3):Math.sqrt(-c),z=2*j;return G(c>0?D:"loop",(B+L)/z,(B-L)/z)},getLength:function(h,f,g,x){if(f===M)f=0;if(g===M)g=1;if(T.isStraight(h)){var v=h;if(g<1)v=T.subdivide(v,g)[0],f/=g;if(f>0)v=T.subdivide(v,f)[1];var s=v[6]-v[0],p=v[7]-v[1];return Math.sqrt(s*s+p*p)}return Q.integrate(x||t(h),f,g,u(f,g))},getTimeAt:function(h,f,g){if(g===M)g=f<0?1:0;if(f===0)return g;var x=Math.abs,v=0.000000000001,s=f>0,p=s?g:0,d=s?1:g,_=t(h),P=T.getLength(h,p,d,_),w=x(f)-P;if(x(w)<v)return s?d:p;else if(w>v)return null;var r=f/P,C=0;function B(j){return C+=Q.integrate(_,g,j,u(g,j)),g=j,C-f}return Q.findRoot(B,_,g+r,p,d,32,0.000000000001)},getPoint:function(h,f){return i(h,f,0,!1)},getTangent:function(h,f){return i(h,f,1,!0)},getWeightedTangent:function(h,f){return i(h,f,1,!1)},getNormal:function(h,f){return i(h,f,2,!0)},getWeightedNormal:function(h,f){return i(h,f,2,!1)},getCurvature:function(h,f){return i(h,f,3,!1).x},getPeaks:function(h){var f=h[0],g=h[1],x=h[2],v=h[3],s=h[4],p=h[5],d=h[6],_=h[7],P=-f+3*x-3*s+d,w=3*f-6*x+3*s,r=-3*f+3*x,C=-g+3*v-3*p+_,B=3*g-6*v+3*p,j=-3*g+3*v,o=0.00000001,y=1-o,S=[];return Q.solveCubic(9*(P*P+C*C),9*(P*w+B*C),2*(w*w+B*B)+3*(r*P+j*C),r*w+B*j,S,o,y),S.sort()}}}},new function(){function t(w,r,C,B,j,o,y){var S=!y&&C.getPrevious()===j,D=!y&&C!==j&&C.getNext()===j,G=0.00000001,c=1-G;if(B!==null&&B>=(S?G:0)&&B<=(D?c:1)){if(o!==null&&o>=(D?G:0)&&o<=(S?c:1)){var L=new c0(C,B,null,y),z=new c0(j,o,null,y);if(L._intersection=z,z._intersection=L,!r||r(L))c0.insert(w,L,!0)}}}function u(w,r,C,B,j,o,y,S,D,G,c,L,z){if(++D>=4096||++S>=40)return D;var V=0.000000001,N=r[0],q=r[1],A=r[6],a=r[7],R=D0.getSignedDistance,X=R(N,q,A,a,r[2],r[3]),e=R(N,q,A,a,r[4],r[5]),Y=X*e>0?0.75:0.4444444444444444,U=Y*Math.min(0,X,e),t0=Y*Math.max(0,X,e),y0=R(N,q,A,a,w[0],w[1]),v0=R(N,q,A,a,w[2],w[3]),b0=R(N,q,A,a,w[4],w[5]),h0=R(N,q,A,a,w[6],w[7]),j0=i(y0,v0,b0,h0),p0=j0[0],V0=j0[1],o0,L0;if(X===0&&e===0&&y0===0&&v0===0&&b0===0&&h0===0||(o0=h(p0,V0,U,t0))==null||(L0=h(p0.reverse(),V0.reverse(),U,t0))==null)return D;var z0=G+(c-G)*o0,I0=G+(c-G)*L0;if(Math.max(z-L,I0-z0)<V){var u6=(z0+I0)/2,i6=(L+z)/2;t(j,o,y?B:C,y?i6:u6,y?C:B,y?u6:i6)}else{w=T.getPart(w,o0,L0);var s6=z-L;if(L0-o0>0.8)if(I0-z0>s6){var J0=T.subdivide(w,0.5),u6=(z0+I0)/2;D=u(r,J0[0],B,C,j,o,!y,S,D,L,z,z0,u6),D=u(r,J0[1],B,C,j,o,!y,S,D,L,z,u6,I0)}else{var J0=T.subdivide(r,0.5),i6=(L+z)/2;D=u(J0[0],w,B,C,j,o,!y,S,D,L,i6,z0,I0),D=u(J0[1],w,B,C,j,o,!y,S,D,i6,z,z0,I0)}else if(s6===0||s6>=V)D=u(r,w,B,C,j,o,!y,S,D,L,z,z0,I0);else D=u(w,r,C,B,j,o,y,S,D,z0,I0,L,z)}return D}function i(w,r,C,B){var j=[0,w],o=[0.3333333333333333,r],y=[0.6666666666666666,C],S=[1,B],D=r-(2*w+B)/3,G=C-(w+2*B)/3,c;if(D*G<0)c=[[j,o,S],[j,y,S]];else{var L=D/G;c=[L>=2?[j,o,S]:L<=0.5?[j,y,S]:[j,o,y,S],[j,S]]}return(D||G)<0?c.reverse():c}function h(w,r,C,B){if(w[0][1]<C)return f(w,!0,C);else if(r[0][1]>B)return f(r,!1,B);else return w[0][0]}function f(w,r,C){var B=w[0][0],j=w[0][1];for(var o=1,y=w.length;o<y;o++){var S=w[o][0],D=w[o][1];if(r?D>=C:D<=C)return D===C?S:B+(C-j)*(S-B)/(D-j);B=S,j=D}return null}function g(w,r,C,B,j){var o=Q.isZero;if(o(B)&&o(j)){var y=T.getTimeOf(w,new O(r,C));return y===null?[]:[y]}var S=Math.atan2(-j,B),D=Math.sin(S),G=Math.cos(S),c=[],L=[];for(var z=0;z<8;z+=2){var V=w[z]-r,N=w[z+1]-C;c.push(V*G-N*D,V*D+N*G)}return T.solveCubic(c,1,0,L,0,1),L}function x(w,r,C,B,j,o,y){var S=r[0],D=r[1],G=r[6],c=r[7],L=g(w,S,D,G-S,c-D);for(var z=0,V=L.length;z<V;z++){var N=L[z],q=T.getPoint(w,N),A=T.getTimeOf(r,q);if(A!==null)t(j,o,y?B:C,y?A:N,y?C:B,y?N:A)}}function v(w,r,C,B,j,o){var y=D0.intersect(w[0],w[1],w[6],w[7],r[0],r[1],r[6],r[7]);if(y)t(j,o,C,T.getTimeOf(w,y),B,T.getTimeOf(r,y))}function s(w,r,C,B,j,o){var y=0.000000000001,S=Math.min,D=Math.max;if(D(w[0],w[2],w[4],w[6])+y>S(r[0],r[2],r[4],r[6])&&S(w[0],w[2],w[4],w[6])-y<D(r[0],r[2],r[4],r[6])&&D(w[1],w[3],w[5],w[7])+y>S(r[1],r[3],r[5],r[7])&&S(w[1],w[3],w[5],w[7])-y<D(r[1],r[3],r[5],r[7])){var G=_(w,r);if(G)for(var c=0;c<2;c++){var L=G[c];t(j,o,C,L[0],B,L[1],!0)}else{var z=T.isStraight(w),V=T.isStraight(r),N=z&&V,q=z&&!V,A=j.length;if((N?v:z||V?x:u)(q?r:w,q?w:r,q?B:C,q?C:B,j,o,q,0,0,0,1,0,1),!N||j.length===A)for(var c=0;c<4;c++){var a=c>>1,R=c&1,X=a*6,e=R*6,Y=new O(w[X],w[X+1]),U=new O(r[e],r[e+1]);if(Y.isClose(U,y))t(j,o,C,a,B,R)}}}return j}function p(w,r,C,B){var j=T.classify(w);if(j.type==="loop"){var o=j.roots;t(C,B,r,o[0],r,o[1])}return C}function d(w,r,C,B,j,o){var y=0.0000001,S=!r;if(S)r=w;var D=w.length,G=r.length,c=new Array(D),L=S?c:new Array(G),z=[];for(var V=0;V<D;V++)c[V]=w[V].getValues(B);if(!S)for(var V=0;V<G;V++)L[V]=r[V].getValues(j);var N=m0.findCurveBoundsCollisions(c,L,y);for(var q=0;q<D;q++){var A=w[q],a=c[q];if(S)p(a,A,z,C);var R=N[q];if(R)for(var X=0;X<R.length;X++){if(o&&z.length)return z;var e=R[X];if(!S||e>q){var Y=r[e],U=L[e];s(a,U,A,Y,z,C)}}}return z}function _(w,r){function C(h0){var j0=h0[6]-h0[0],p0=h0[7]-h0[1];return j0*j0+p0*p0}var B=Math.abs,j=D0.getDistance,o=0.00000001,y=0.0000001,S=T.isStraight(w),D=T.isStraight(r),G=S&&D,c=C(w)<C(r),L=c?r:w,z=c?w:r,V=L[0],N=L[1],q=L[6]-V,A=L[7]-N;if(j(V,N,q,A,z[0],z[1],!0)<y&&j(V,N,q,A,z[6],z[7],!0)<y){if(!G&&j(V,N,q,A,L[2],L[3],!0)<y&&j(V,N,q,A,L[4],L[5],!0)<y&&j(V,N,q,A,z[2],z[3],!0)<y&&j(V,N,q,A,z[4],z[5],!0)<y)S=D=G=!0}else if(G)return null;if(S^D)return null;var a=[w,r],R=[];for(var X=0;X<4&&R.length<2;X++){var e=X&1,Y=e^1,U=X>>1,t0=T.getTimeOf(a[e],new O(a[Y][U?6:0],a[Y][U?7:1]));if(t0!=null){var y0=e?[U,t0]:[t0,U];if(!R.length||B(y0[0]-R[0][0])>o&&B(y0[1]-R[0][1])>o)R.push(y0)}if(X>2&&!R.length)break}if(R.length!==2)R=null;else if(!G){var v0=T.getPart(w,R[0][0],R[1][0]),b0=T.getPart(r,R[0][1],R[1][1]);if(B(b0[2]-v0[2])>y||B(b0[3]-v0[3])>y||B(b0[4]-v0[4])>y||B(b0[5]-v0[5])>y)R=null}return R}function P(w,r){var C=w[0],B=w[1],j=w[2],o=w[3],y=w[4],S=w[5],D=w[6],G=w[7],c=r.normalize(),L=c.x,z=c.y,V=3*D-9*y+9*j-3*C,N=3*G-9*S+9*o-3*B,q=6*y-12*j+6*C,A=6*S-12*o+6*B,a=3*j-3*C,R=3*o-3*B,X=2*V*z-2*N*L,e=[];if(Math.abs(X)<Q.CURVETIME_EPSILON){var Y=V*R-N*a,X=V*A-N*q;if(X!=0){var U=-Y/X;if(U>=0&&U<=1)e.push(U)}}else{var t0=(q*q-4*V*a)*z*z+(-2*q*A+4*N*a+4*V*R)*L*z+(A*A-4*N*R)*L*L,y0=q*z-A*L;if(t0>=0&&X!=0){var v0=Math.sqrt(t0),b0=-(y0+v0)/X,h0=(-y0+v0)/X;if(b0>=0&&b0<=1)e.push(b0);if(h0>=0&&h0<=1)e.push(h0)}}return e}return{getIntersections:function(w){var r=this.getValues(),C=w&&w!==this&&w.getValues();return C?s(r,C,this,w,[]):p(r,this,[])},statics:{getOverlaps:_,getIntersections:d,getCurveLineIntersections:g,getTimesWithTangent:P}}}),c0=k.extend({_class:"CurveLocation",initialize:function t(u,i,h,f,g){if(i>=0.99999999){var x=u.getNext();if(x)i=0,u=x}this._setCurve(u),this._time=i,this._point=h||u.getPointAtTime(i),this._overlap=f,this._distance=g,this._intersection=this._next=this._previous=null},_setPath:function(t){this._path=t,this._version=t?t._version:0},_setCurve:function(t){this._setPath(t._path),this._curve=t,this._segment=null,this._segment1=t._segment1,this._segment2=t._segment2},_setSegment:function(t){var u=t.getCurve();if(u)this._setCurve(u);else this._setPath(t._path),this._segment1=t,this._segment2=null;this._segment=t,this._time=t===this._segment1?0:1,this._point=t._point.clone()},getSegment:function(){var t=this._segment;if(!t){var u=this.getCurve(),i=this.getTime();if(i===0)t=u._segment1;else if(i===1)t=u._segment2;else if(i!=null)t=u.getPartLength(0,i)<u.getPartLength(i,1)?u._segment1:u._segment2;this._segment=t}return t},getCurve:function(){var t=this._path,u=this;if(t&&t._version!==this._version)this._time=this._offset=this._curveOffset=this._curve=null;function i(h){var f=h&&h.getCurve();if(f&&(u._time=f.getTimeOf(u._point))!=null)return u._setCurve(f),f}return this._curve||i(this._segment)||i(this._segment1)||i(this._segment2.getPrevious())},getPath:function(){var t=this.getCurve();return t&&t._path},getIndex:function(){var t=this.getCurve();return t&&t.getIndex()},getTime:function(){var t=this.getCurve(),u=this._time;return t&&u==null?this._time=t.getTimeOf(this._point):u},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var t=this._offset;if(t==null){t=0;var u=this.getPath(),i=this.getIndex();if(u&&i!=null){var h=u.getCurves();for(var f=0;f<i;f++)t+=h[f].getLength()}this._offset=t+=this.getCurveOffset()}return t},getCurveOffset:function(){var t=this._curveOffset;if(t==null){var u=this.getCurve(),i=this.getTime();this._curveOffset=t=i!=null&&u&&u.getPartLength(0,i)}return t},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var t=this.getCurve(),u=t&&t.divideAtTime(this.getTime());if(u)this._setSegment(u._segment1);return u},split:function(){var t=this.getCurve(),u=t._path,i=t&&t.splitAtTime(this.getTime());if(i)this._setSegment(u.getLastSegment());return i},equals:function(t,u){var i=this===t;if(!i&&t instanceof c0){var h=this.getCurve(),f=t.getCurve(),g=h._path,x=f._path;if(g===x){var v=Math.abs,s=0.0000001,p=v(this.getOffset()-t.getOffset()),d=!u&&this._intersection,_=!u&&t._intersection;i=(p<s||g&&v(g.getLength()-p)<s)&&(!d&&!_||d&&_&&d.equals(_,!0))}}return i},toString:function(){var t=[],u=this.getPoint(),i=S0.instance;if(u)t.push("point: "+u);var h=this.getIndex();if(h!=null)t.push("index: "+h);var f=this.getTime();if(f!=null)t.push("time: "+i.number(f));if(this._distance!=null)t.push("distance: "+i.number(this._distance));return"{ "+t.join(", ")+" }"},isTouching:function(){var t=this._intersection;if(t&&this.getTangent().isCollinear(t.getTangent())){var u=this.getCurve(),i=t.getCurve();return!(u.isStraight()&&i.isStraight()&&u.getLine().intersect(i.getLine()))}return!1},isCrossing:function(){var t=this._intersection;if(!t)return!1;var u=this.getTime(),i=t.getTime(),h=0.00000001,f=1-h,g=u>=h&&u<=f,x=i>=h&&i<=f;if(g&&x)return!this.isTouching();var v=this.getCurve(),s=v&&u<h?v.getPrevious():v,p=t.getCurve(),d=p&&i<h?p.getPrevious():p;if(u>f)v=v.getNext();if(i>f)p=p.getNext();if(!s||!v||!d||!p)return!1;var _=[];function P(L,z){var V=L.getValues(),N=T.classify(V).roots||T.getPeaks(V),q=N.length,A=T.getLength(V,z&&q?N[q-1]:0,!z&&q?N[0]:1);_.push(q?A:A/32)}function w(L,z,V){return z<V?L>z&&L<V:L>z||L<V}if(!g)P(s,!0),P(v,!1);if(!x)P(d,!0),P(p,!1);var r=this.getPoint(),C=Math.min.apply(Math,_),B=g?v.getTangentAtTime(u):v.getPointAt(C).subtract(r),j=g?B.negate():s.getPointAt(-C).subtract(r),o=x?p.getTangentAtTime(i):p.getPointAt(C).subtract(r),y=x?o.negate():d.getPointAt(-C).subtract(r),S=j.getAngle(),D=B.getAngle(),G=y.getAngle(),c=o.getAngle();return!!(g?w(S,G,c)^w(D,G,c)&&w(S,c,G)^w(D,c,G):w(G,S,D)^w(c,S,D)&&w(G,D,S)^w(c,D,S))},hasOverlap:function(){return!!this._overlap}},k.each(T._evaluateMethods,function(t){var u=t+"At";this[t]=function(){var i=this.getCurve(),h=this.getTime();return h!=null&&i&&i[u](h,!0)}},{preserve:!0}),new function(){function t(u,i,h){var f=u.length,g=0,x=f-1;function v(r,C){for(var B=r+C;B>=-1&&B<=f;B+=C){var j=u[(B%f+f)%f];if(!i.getPoint().isClose(j.getPoint(),0.0000001))break;if(i.equals(j))return j}return null}while(g<=x){var s=g+x>>>1,p=u[s],d;if(h&&(d=i.equals(p)?p:v(s,-1)||v(s,1))){if(i._overlap)d._overlap=d._intersection._overlap=!0;return d}var _=i.getPath(),P=p.getPath(),w=_!==P?_._id-P._id:i.getIndex()+i.getTime()-(p.getIndex()+p.getTime());if(w<0)x=s-1;else g=s+1}return u.splice(g,0,i),i}return{statics:{insert:t,expand:function(u){var i=u.slice();for(var h=u.length-1;h>=0;h--)t(i,u[h]._intersection,!1);return i}}}}),e0=d0.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function t(){},statics:{create:function(t){var u,i,h;if(k.isPlainObject(t))i=t.segments,u=t.pathData;else if(Array.isArray(t))i=t;else if(typeof t==="string")u=t;if(i){var f=i[0];h=f&&Array.isArray(f[0])}else if(u)h=(u.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(u);var g=h?O0:w0;return new g(t)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(t){if(this.isClockwise()!=(t=!!t))this.reverse()},setPathData:function(t){var u=t&&t.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),i,h=!1,f,g,x=new O,v=new O;function s(y,S){var D=+i[y];if(h)D+=x[S];return D}function p(y){return new O(s(y,"x"),s(y+1,"y"))}this.clear();for(var d=0,_=u&&u.length;d<_;d++){var P=u[d],w=P[0],r=w.toLowerCase();i=P.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var C=i&&i.length;if(h=w===r,f==="z"&&!/[mz]/.test(r))this.moveTo(x);switch(r){case"m":case"l":var B=r==="m";for(var j=0;j<C;j+=2)if(this[B?"moveTo":"lineTo"](x=p(j)),B)v=x,B=!1;g=x;break;case"h":case"v":var o=r==="h"?"x":"y";x=x.clone();for(var j=0;j<C;j++)x[o]=s(j,o),this.lineTo(x);g=x;break;case"c":for(var j=0;j<C;j+=6)this.cubicCurveTo(p(j),g=p(j+2),x=p(j+4));break;case"s":for(var j=0;j<C;j+=4)this.cubicCurveTo(/[cs]/.test(f)?x.multiply(2).subtract(g):x,g=p(j),x=p(j+2)),f=r;break;case"q":for(var j=0;j<C;j+=4)this.quadraticCurveTo(g=p(j),x=p(j+2));break;case"t":for(var j=0;j<C;j+=2)this.quadraticCurveTo(g=/[qt]/.test(f)?x.multiply(2).subtract(g):x,x=p(j)),f=r;break;case"a":for(var j=0;j<C;j+=7)this.arcTo(x=p(j+5),new f0(+i[j],+i[j+1]),+i[j+2],+i[j+4],+i[j+3]);break;case"z":this.closePath(0.000000000001),x=v;break}f=r}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(t){var u=t.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(t):{};return u.onPath||!!(this.getFillRule()==="evenodd"?u.windingL&1||u.windingR&1:u.winding)},getIntersections:function(t,u,i,h){var f=this===t||!t,g=this._matrix._orNullIfIdentity(),x=f?g:(i||t._matrix)._orNullIfIdentity();return f||this.getBounds(g).intersects(t.getBounds(x),0.000000000001)?T.getIntersections(this.getCurves(),!f&&t.getCurves(),u,g,x,h):[]},getCrossings:function(t){return this.getIntersections(t,function(u){return u.isCrossing()})},getNearestLocation:function(){var t=O.read(arguments),u=this.getCurves(),i=Infinity,h=null;for(var f=0,g=u.length;f<g;f++){var x=u[f].getNearestLocation(t);if(x._distance<i)i=x._distance,h=x}return h},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t?t.getPoint():t},interpolate:function(t,u,i){var h=!this._children,f=h?"_segments":"_children",g=t[f],x=u[f],v=this[f];if(!g||!x||g.length!==x.length)throw new Error("Invalid operands in interpolate() call: "+t+", "+u);var s=v.length,p=x.length;if(s<p){var d=h?Z:w0;for(var _=s;_<p;_++)this.add(new d)}else if(s>p)this[h?"removeSegments":"removeChildren"](p,s);for(var _=0;_<p;_++)v[_].interpolate(g[_],x[_],i);if(h)this.setClosed(t._closed),this._changed(9)},compare:function(t){var u=!1;if(t){var i=this._children||[this],h=t._children?t._children.slice():[t],f=i.length,g=h.length,x=[],v=0;u=!0;var s=m0.findItemBoundsCollisions(i,h,Q.GEOMETRIC_EPSILON);for(var p=f-1;p>=0&&u;p--){var d=i[p];u=!1;var _=s[p];if(_){for(var P=_.length-1;P>=0&&!u;P--)if(d.compare(h[_[P]])){if(!x[_[P]])x[_[P]]=!0,v++;u=!0}}}u=u&&v===g}return u}}),w0=e0.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function t(u){this._closed=!1,this._segments=[],this._version=0;var i=arguments,h=Array.isArray(u)?typeof u[0]==="object"?u:i:u&&(u.size===M&&(u.x!==M||u.point!==M))?i:null;if(h&&h.length>0)this.setSegments(h);else if(this._curves=M,this._segmentSelection=0,!h&&typeof u==="string")this.setPathData(u),u=null;this._initialize(!h&&u)},_equals:function(t){return this._closed===t._closed&&k.equals(this._segments,t._segments)},copyContent:function(t){this.setSegments(t._segments),this._closed=t._closed},_changed:function t(u){if(t.base.call(this,u),u&8){if(this._length=this._area=M,u&32)this._version++;else if(this._curves)for(var i=0,h=this._curves.length;i<h;i++)this._curves[i]._changed()}else if(u&64)this._bounds=M},getStyle:function(){var t=this._parent;return(t instanceof O0?t:this)._style},getSegments:function(){return this._segments},setSegments:function(t){var u=this.isFullySelected(),i=t&&t.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=M,i){var h=t[i-1];if(typeof h==="boolean")this.setClosed(h),i--;this._add(Z.readList(t,0,{},i))}if(u)this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var t=this._curves,u=this._segments;if(!t){var i=this._countCurves();t=this._curves=new Array(i);for(var h=0;h<i;h++)t[h]=new T(this,u[h],u[h+1]||u[0])}return t},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var t=this.getCurves();return t[t.length-1]},isClosed:function(){return this._closed},setClosed:function(t){if(this._closed!=(t=!!t)){if(this._closed=t,this._curves){var u=this._curves.length=this._countCurves();if(t)this._curves[u-1]=new T(this,this._segments[u-1],this._segments[0])}this._changed(41)}}},{beans:!0,getPathData:function(t,u){var i=this._segments,h=i.length,f=new S0(u),g=new Array(6),x=!0,v,s,p,d,_,P,w,r,C=[];function B(o,y){if(o._transformCoordinates(t,g),v=g[0],s=g[1],x)C.push("M"+f.pair(v,s)),x=!1;else if(_=g[2],P=g[3],_===v&&P===s&&w===p&&r===d){if(!y){var S=v-p,D=s-d;C.push(S===0?"v"+f.number(D):D===0?"h"+f.number(S):"l"+f.pair(S,D))}}else C.push("c"+f.pair(w-p,r-d)+" "+f.pair(_-p,P-d)+" "+f.pair(v-p,s-d));p=v,d=s,w=g[4],r=g[5]}if(!h)return"";for(var j=0;j<h;j++)B(i[j]);if(this._closed&&h>0)B(i[0],!0),C.push("z");return C.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(t){var u=this._segments,i=new Array(6);for(var h=0,f=u.length;h<f;h++)u[h]._transformCoordinates(t,i,!0);return!0},_add:function(t,x){var i=this._segments,h=this._curves,f=t.length,g=x==null,x=g?i.length:x;for(var v=0;v<f;v++){var s=t[v];if(s._path)s=t[v]=s.clone();if(s._path=this,s._index=x+v,s._selection)this._updateSelection(s,0,s._selection)}if(g)k.push(i,t);else{i.splice.apply(i,[x,0].concat(t));for(var v=x+f,p=i.length;v<p;v++)i[v]._index=v}if(h){var d=this._countCurves(),_=x>0&&x+f-1===d?x-1:x,P=_,w=Math.min(_+f,d);if(t._curves)h.splice.apply(h,[_,0].concat(t._curves)),P+=t._curves.length;for(var v=P;v<w;v++)h.splice(v,0,new T(this,null,null));this._adjustCurves(_,w)}return this._changed(41),t},_adjustCurves:function(t,u){var i=this._segments,h=this._curves,f;for(var g=t;g<u;g++)f=h[g],f._path=this,f._segment1=i[g],f._segment2=i[g+1]||i[0],f._changed();if(f=h[this._closed&&!t?i.length-1:t-1])f._segment2=i[t]||i[0],f._changed();if(f=h[u])f._segment1=i[u],f._changed()},_countCurves:function(){var t=this._segments.length;return!this._closed&&t>0?t-1:t},add:function(t){var u=arguments;return u.length>1&&typeof t!=="number"?this._add(Z.readList(u)):this._add([Z.read(u)])[0]},insert:function(t,u){var i=arguments;return i.length>2&&typeof u!=="number"?this._add(Z.readList(i,1),t):this._add([Z.read(i,1)],t)[0]},addSegment:function(){return this._add([Z.read(arguments)])[0]},insertSegment:function(t){return this._add([Z.read(arguments,1)],t)[0]},addSegments:function(t){return this._add(Z.readList(t))},insertSegments:function(t,u){return this._add(Z.readList(u),t)},removeSegment:function(t){return this.removeSegments(t,t+1)[0]||null},removeSegments:function(t,u,i){t=t||0,u=k.pick(u,this._segments.length);var h=this._segments,f=this._curves,g=h.length,x=h.splice(t,u-t),v=x.length;if(!v)return x;for(var s=0;s<v;s++){var p=x[s];if(p._selection)this._updateSelection(p,p._selection,0);p._index=p._path=null}for(var s=t,d=h.length;s<d;s++)h[s]._index=s;if(f){var _=t>0&&u===g+(this._closed?1:0)?t-1:t,f=f.splice(_,v);for(var s=f.length-1;s>=0;s--)f[s]._path=null;if(i)x._curves=f.slice(1);this._adjustCurves(_,_)}return this._changed(41),x},clear:"#removeSegments",hasHandles:function(){var t=this._segments;for(var u=0,i=t.length;u<i;u++)if(t[u].hasHandles())return!0;return!1},clearHandles:function(){var t=this._segments;for(var u=0,i=t.length;u<i;u++)t[u].clearHandles()},getLength:function(){if(this._length==null){var t=this.getCurves(),u=0;for(var i=0,h=t.length;i<h;i++)u+=t[i].getLength();this._length=u}return this._length},getArea:function(){var t=this._area;if(t==null){var u=this._segments,i=this._closed;t=0;for(var h=0,f=u.length;h<f;h++){var g=h+1===f;t+=T.getArea(T.getValues(u[h],u[g?0:h+1],null,g&&!i))}this._area=t}return t},isFullySelected:function(){var t=this._segments.length;return this.isSelected()&&t>0&&this._segmentSelection===t*7},setFullySelected:function(t){if(t)this._selectSegments(!0);this.setSelected(t)},setSelection:function t(u){if(!(u&1))this._selectSegments(!1);t.base.call(this,u)},_selectSegments:function(t){var u=this._segments,i=u.length,h=t?7:0;this._segmentSelection=h*i;for(var f=0;f<i;f++)u[f]._selection=h},_updateSelection:function(t,u,i){t._selection=i;var h=this._segmentSelection+=i-u;if(h>0)this.setSelected(!0)},divideAt:function(t){var u=this.getLocationAt(t),i;return u&&(i=u.getCurve().divideAt(u.getCurveOffset()))?i._segment1:null},splitAt:function(t){var u=this.getLocationAt(t),i=u&&u.index,h=u&&u.time,f=0.00000001,g=1-f;if(h>g)i++,h=0;var x=this.getCurves();if(i>=0&&i<x.length){if(h>=f)x[i++].divideAtTime(h);var v=this.removeSegments(i,this._segments.length,!0),s;if(this._closed)this.setClosed(!1),s=this;else s=new w0(d0.NO_INSERT),s.insertAbove(this),s.copyAttributes(this);return s._add(v,0),this.addSegment(v[0]),s}return null},split:function(t,u){var i,h=u===M?t:(i=this.getCurves()[t])&&i.getLocationAtTime(u);return h!=null?this.splitAt(h):null},join:function(t,u){var i=u||0;if(t&&t!==this){var h=t._segments,f=this.getLastSegment(),g=t.getLastSegment();if(!g)return this;if(f&&f._point.isClose(g._point,i))t.reverse();var x=t.getFirstSegment();if(f&&f._point.isClose(x._point,i))f.setHandleOut(x._handleOut),this._add(h.slice(1));else{var v=this.getFirstSegment();if(v&&v._point.isClose(x._point,i))t.reverse();if(g=t.getLastSegment(),v&&v._point.isClose(g._point,i))v.setHandleIn(g._handleIn),this._add(h.slice(0,h.length-1),0);else this._add(h.slice())}if(t._closed)this._add([h[0]]);t.remove()}var s=this.getFirstSegment(),p=this.getLastSegment();if(s!==p&&s._point.isClose(p._point,i))s.setHandleIn(p._handleIn),p.remove(),this.setClosed(!0);return this},reduce:function(t){var u=this.getCurves(),i=t&&t.simplify,h=i?0.0000001:0;for(var f=u.length-1;f>=0;f--){var g=u[f];if(!g.hasHandles()&&(!g.hasLength(h)||i&&g.isCollinear(g.getNext())))g.remove()}return this},reverse:function(){this._segments.reverse();for(var t=0,u=this._segments.length;t<u;t++){var i=this._segments[t],h=i._handleIn;i._handleIn=i._handleOut,i._handleOut=h,i._index=t}this._curves=null,this._changed(9)},flatten:function(t){var u=new F0(this,t||0.25,256,!0),i=u.parts,h=i.length,f=[];for(var g=0;g<h;g++)f.push(new Z(i[g].curve.slice(0,2)));if(!this._closed&&h>0)f.push(new Z(i[h-1].curve.slice(6)));this.setSegments(f)},simplify:function(t){var u=new Y0(this).fit(t||2.5);if(u)this.setSegments(u);return!!u},smooth:function(t){var u=this,i=t||{},h=i.type||"asymmetric",f=this._segments,g=f.length,x=this._closed;function v(p0,V0){var o0=p0&&p0.index;if(o0!=null){var L0=p0.path;if(L0&&L0!==u)throw new Error(p0._class+" "+o0+" of "+L0+" is not part of "+u);if(V0&&p0 instanceof T)o0++}else o0=typeof p0==="number"?p0:V0;return Math.min(o0<0&&x?o0%g:o0<0?o0+g:o0,g-1)}var s=x&&i.from===M&&i.to===M,p=v(i.from,0),d=v(i.to,g-1);if(p>d)if(x)p-=g;else{var _=p;p=d,d=_}if(/^(?:asymmetric|continuous)$/.test(h)){var P=h==="asymmetric",w=Math.min,r=d-p+1,C=r-1,B=s?w(r,4):1,j=B,o=B,y=[];if(!x)j=w(1,p),o=w(1,g-d-1);if(C+=j+o,C<=1)return;for(var S=0,D=p-j;S<=C;S++,D++)y[S]=f[(D<0?D+g:D)%g]._point;var G=y[0]._x+2*y[1]._x,c=y[0]._y+2*y[1]._y,L=2,z=C-1,V=[G],N=[c],q=[L],A=[],a=[];for(var S=1;S<C;S++){var R=S<z,X=R?1:P?1:2,e=R?4:P?2:7,Y=R?4:P?3:8,U=R?2:P?0:1,t0=X/L;L=q[S]=e-t0,G=V[S]=Y*y[S]._x+U*y[S+1]._x-t0*G,c=N[S]=Y*y[S]._y+U*y[S+1]._y-t0*c}A[z]=V[z]/q[z],a[z]=N[z]/q[z];for(var S=C-2;S>=0;S--)A[S]=(V[S]-A[S+1])/q[S],a[S]=(N[S]-a[S+1])/q[S];A[C]=(3*y[C]._x-A[z])/2,a[C]=(3*y[C]._y-a[z])/2;for(var S=j,y0=C-o,D=p;S<=y0;S++,D++){var v0=f[D<0?D+g:D],b0=v0._point,h0=A[S]-b0._x,j0=a[S]-b0._y;if(s||S<y0)v0.setHandleOut(h0,j0);if(s||S>j)v0.setHandleIn(-h0,-j0)}}else for(var S=p;S<=d;S++)f[S<0?S+g:S].smooth(i,!s&&S===p,!s&&S===d)},toShape:function(t){if(!this._closed)return null;var u=this._segments,i,h,f,g;function x(P,w){var r=u[P],C=r.getNext(),B=u[w],j=B.getNext();return r._handleOut.isZero()&&C._handleIn.isZero()&&B._handleOut.isZero()&&j._handleIn.isZero()&&C._point.subtract(r._point).isCollinear(j._point.subtract(B._point))}function v(P){var w=u[P],r=w.getPrevious(),C=w.getNext();return r._handleOut.isZero()&&w._handleIn.isZero()&&w._handleOut.isZero()&&C._handleIn.isZero()&&w._point.subtract(r._point).isOrthogonal(C._point.subtract(w._point))}function s(P){var w=u[P],r=w.getNext(),C=w._handleOut,B=r._handleIn,j=0.5522847498307936;if(C.isOrthogonal(B)){var o=w._point,y=r._point,S=new D0(o,C,!0).intersect(new D0(y,B,!0),!0);return S&&Q.isZero(C.getLength()/S.subtract(o).getLength()-j)&&Q.isZero(B.getLength()/S.subtract(y).getLength()-j)}return!1}function p(P,w){return u[P]._point.getDistance(u[w]._point)}if(!this.hasHandles()&&u.length===4&&x(0,2)&&x(1,3)&&v(1))i=g0.Rectangle,h=new f0(p(0,3),p(0,1)),g=u[1]._point.add(u[2]._point).divide(2);else if(u.length===8&&s(0)&&s(2)&&s(4)&&s(6)&&x(1,5)&&x(3,7))i=g0.Rectangle,h=new f0(p(1,6),p(0,3)),f=h.subtract(new f0(p(0,7),p(1,2))).divide(2),g=u[3]._point.add(u[4]._point).divide(2);else if(u.length===4&&s(0)&&s(1)&&s(2)&&s(3)){if(Q.isZero(p(0,2)-p(1,3)))i=g0.Circle,f=p(0,2)/2;else i=g0.Ellipse,f=new f0(p(2,0)/2,p(3,1)/2);g=u[1]._point}if(i){var d=this.getPosition(!0),_=new i({center:d,size:h,radius:f,insert:!1});if(_.copyAttributes(this,!0),_._matrix.prepend(this._matrix),_.rotate(g.subtract(d).getAngle()+90),t===M||t)_.insertAbove(this);return _}return null},toPath:"#clone",compare:function t(u){if(!u||u instanceof O0)return t.base.call(this,u);var i=this.getCurves(),h=u.getCurves(),f=i.length,g=h.length;if(!f||!g)return f==g;var x=i[0].getValues(),v=[],s=0,p,d=0,_;for(var P=0;P<g;P++){var B=h[P].getValues();v.push(B);var w=T.getOverlaps(x,B);if(w){p=!P&&w[0][0]>0?g-1:P,_=w[0][1];break}}var r=Math.abs,C=0.00000001,B=v[p],j;while(x&&B){var w=T.getOverlaps(x,B);if(w){var o=w[0][0];if(r(o-d)<C){if(d=w[1][0],d===1)x=++s<f?i[s].getValues():null,d=0;var y=w[0][1];if(r(y-_)<C){if(!j)j=[p,y];if(_=w[1][1],_===1){if(++p>=g)p=0;B=v[p]||h[p].getValues(),_=0}if(!x)return j[0]===p&&j[1]===_;continue}}}break}return!1},_hitTestSelf:function(t,u,i,h){var f=this,g=this.getStyle(),x=this._segments,v=x.length,s=this._closed,p=u._tolerancePadding,d=p,_,P,w,r,C,B,j=u.stroke&&g.hasStroke(),o=u.fill&&g.hasFill(),y=u.curves,S=j?g.getStrokeWidth()/2:o&&u.tolerance>0||y?0:null;if(S!==null)if(S>0)_=g.getStrokeJoin(),P=g.getStrokeCap(),w=g.getMiterLimit(),d=d.add(w0._getStrokePadding(S,h));else _=P="round";function D(A,a){return t.subtract(A).divide(a).length<=1}function G(A,a,R){if(!u.selected||a.isSelected()){var X=A._point;if(a!==X)a=a.add(X);if(D(a,d))return new n0(R,f,{segment:A,point:a})}}function c(A,a){return(a||u.segments)&&G(A,A._point,"segment")||!a&&u.handles&&(G(A,A._handleIn,"handle-in")||G(A,A._handleOut,"handle-out"))}function L(A){r.add(A)}function z(A){var a=s||A._index>0&&A._index<v-1;if((a?_:P)==="round")return D(A._point,d);else{if(r=new w0({internal:!0,closed:!0}),a){if(!A.isSmooth())w0._addBevelJoin(A,_,S,w,null,h,L,!0)}else if(P==="square")w0._addSquareCap(A,P,S,null,h,L,!0);if(!r.isEmpty()){var R;return r.contains(t)||(R=r.getNearestLocation(t))&&D(R.getPoint(),p)}}}if(u.ends&&!u.segments&&!s){if(B=c(x[0],!0)||c(x[v-1],!0))return B}else if(u.segments||u.handles){for(var V=0;V<v;V++)if(B=c(x[V]))return B}if(S!==null){if(C=this.getNearestLocation(t),C){var N=C.getTime();if(N===0||N===1&&v>1){if(!z(C.getSegment()))C=null}else if(!D(C.getPoint(),d))C=null}if(!C&&_==="miter"&&v>1)for(var V=0;V<v;V++){var q=x[V];if(t.getDistance(q._point)<=w*S&&z(q)){C=q.getLocation();break}}}return!C&&o&&this._contains(t)||C&&!j&&!y?new n0("fill",this):C?new n0(j?"stroke":"curve",this,{location:C,point:C.getPoint()}):null}},k.each(T._evaluateMethods,function(t){this[t+"At"]=function(u){var i=this.getLocationAt(u);return i&&i[t]()}},{beans:!1,getLocationOf:function(){var t=O.read(arguments),u=this.getCurves();for(var i=0,h=u.length;i<h;i++){var f=u[i].getLocationOf(t);if(f)return f}return null},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getLocationAt:function(t){if(typeof t==="number"){var u=this.getCurves(),i=0;for(var h=0,f=u.length;h<f;h++){var g=i,x=u[h];if(i+=x.getLength(),i>t)return x.getLocationAt(t-g)}if(u.length>0&&t<=this.getLength())return new c0(u[u.length-1],1)}else if(t&&t.getPath&&t.getPath()===this)return t;return null},getOffsetsWithTangent:function(){var t=O.read(arguments);if(t.isZero())return[];var u=[],i=0,h=this.getCurves();for(var f=0,g=h.length;f<g;f++){var x=h[f],v=x.getTimesWithTangent(t);for(var s=0,p=v.length;s<p;s++){var d=i+x.getOffsetAtTime(v[s]);if(u.indexOf(d)<0)u.push(d)}i+=x.length}return u}}),new function(){function t(i,h,f,g){if(g<=0)return;var x=g/2,v=g-2,s=x-1,p=new Array(6),d,_;function P(o){var y=p[o],S=p[o+1];if(d!=y||_!=S)i.beginPath(),i.moveTo(d,_),i.lineTo(y,S),i.stroke(),i.beginPath(),i.arc(y,S,x,0,Math.PI*2,!0),i.fill()}for(var w=0,r=h.length;w<r;w++){var C=h[w],B=C._selection;if(C._transformCoordinates(f,p),d=p[0],_=p[1],B&2)P(2);if(B&4)P(4);if(i.fillRect(d-x,_-x,g,g),v>0&&!(B&1)){var j=i.fillStyle;i.fillStyle="#ffffff",i.fillRect(d-s,_-s,v,v),i.fillStyle=j}}}function u(i,h,f){var g=h._segments,x=g.length,v=new Array(6),s=!0,p,d,_,P,w,r,C,B;function j(y){if(f)y._transformCoordinates(f,v),p=v[0],d=v[1];else{var S=y._point;p=S._x,d=S._y}if(s)i.moveTo(p,d),s=!1;else{if(f)w=v[2],r=v[3];else{var D=y._handleIn;w=p+D._x,r=d+D._y}if(w===p&&r===d&&C===_&&B===P)i.lineTo(p,d);else i.bezierCurveTo(C,B,w,r,p,d)}if(_=p,P=d,f)C=v[4],B=v[5];else{var D=y._handleOut;C=_+D._x,B=P+D._y}}for(var o=0;o<x;o++)j(g[o]);if(h._closed&&x>0)j(g[0])}return{_draw:function(i,h,f,g){var x=h.dontStart,v=h.dontFinish||h.clip,s=this.getStyle(),p=s.hasFill(),d=s.hasStroke(),_=s.getDashArray(),P=!k0.support.nativeDash&&d&&_&&_.length;if(!x)i.beginPath();if(p||d&&!P||v){if(u(i,this,g),this._closed)i.closePath()}function w(y){return _[(y%P+P)%P]}if(!v&&(p||d)){if(this._setStyles(i,h,f),p)i.fill(s.getFillRule()),i.shadowColor="rgba(0,0,0,0)";if(d){if(P){if(!x)i.beginPath();var r=new F0(this,0.25,32,!1,g),C=r.length,B=-s.getDashOffset(),j,o=0;while(B>0)B-=w(o--)+w(o--);while(B<C){if(j=B+w(o++),B>0||j>0)r.drawPart(i,Math.max(B,0),Math.max(j,0));B=j+w(o++)}}i.stroke()}}},_drawSelected:function(i,h){i.beginPath(),u(i,this,h),i.stroke(),t(i,this._segments,h,k0.settings.handleSize)}}},new function(){function t(u){var i=u._segments;if(!i.length)throw new Error("Use a moveTo() command first");return i[i.length-1]}return{moveTo:function(){var u=this._segments;if(u.length===1)this.removeSegment(0);if(!u.length)this._add([new Z(O.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new Z(O.read(arguments))])},cubicCurveTo:function(){var u=arguments,i=O.read(u),h=O.read(u),f=O.read(u),g=t(this);g.setHandleOut(i.subtract(g._point)),this._add([new Z(f,h.subtract(f))])},quadraticCurveTo:function(){var u=arguments,i=O.read(u),h=O.read(u),f=t(this)._point;this.cubicCurveTo(i.add(f.subtract(i).multiply(0.3333333333333333)),i.add(h.subtract(i).multiply(0.3333333333333333)),h)},curveTo:function(){var u=arguments,i=O.read(u),h=O.read(u),f=k.pick(k.read(u),0.5),g=1-f,x=t(this)._point,v=i.subtract(x.multiply(g*g)).subtract(h.multiply(f*f)).divide(2*f*g);if(v.isNaN())throw new Error("Cannot put a curve through points with parameter = "+f);this.quadraticCurveTo(v,h)},arcTo:function(){var u=arguments,i=Math.abs,h=Math.sqrt,f=t(this),g=f._point,x=O.read(u),r,v=k.peek(u),s=k.pick(v,!0),p,d,_,P;if(typeof s==="boolean")var w=g.add(x).divide(2),r=w.add(w.subtract(g).rotate(s?-90:90));else if(k.remain(u)<=2)r=x,x=O.read(u);else if(!g.equals(x)){var C=f0.read(u),B=Q.isZero;if(B(C.width)||B(C.height))return this.lineTo(x);var j=k.read(u),s=!!k.read(u),o=!!k.read(u),w=g.add(x).divide(2),y=g.subtract(w).rotate(-j),S=y.x,D=y.y,G=i(C.width),c=i(C.height),L=G*G,z=c*c,V=S*S,N=D*D,q=h(V/L+N/z);if(q>1)G*=q,c*=q,L=G*G,z=c*c;if(q=(L*z-L*N-z*V)/(L*N+z*V),i(q)<0.000000000001)q=0;if(q<0)throw new Error("Cannot create an arc with the given arguments");if(p=new O(G*D/c,-c*S/G).multiply((o===s?-1:1)*h(q)).rotate(j).add(w),P=new r0().translate(p).rotate(j).scale(G,c),_=P._inverseTransform(g),d=_.getDirectedAngle(P._inverseTransform(x)),!s&&d>0)d-=360;else if(s&&d<0)d+=360}if(r){var A=new D0(g.add(r).divide(2),r.subtract(g).rotate(90),!0),a=new D0(r.add(x).divide(2),x.subtract(r).rotate(90),!0),R=new D0(g,x),X=R.getSide(r);if(p=A.intersect(a,!0),!p){if(!X)return this.lineTo(x);throw new Error("Cannot create an arc with the given arguments")}_=g.subtract(p),d=_.getDirectedAngle(x.subtract(p));var e=R.getSide(p,!0);if(e===0)d=X*i(d);else if(X===e)d+=d<0?360:-360}if(d){var Y=0.00001,U=i(d),t0=U>=360?4:Math.ceil((U-Y)/90),y0=d/t0,v0=y0*Math.PI/360,b0=1.3333333333333333*Math.sin(v0)/(1+Math.cos(v0)),h0=[];for(var j0=0;j0<=t0;j0++){var y=x,p0=null;if(j0<t0)if(p0=_.rotate(90).multiply(b0),P)y=P._transformPoint(_),p0=P._transformPoint(_.add(p0)).subtract(y);else y=p.add(_);if(!j0)f.setHandleOut(p0);else{var V0=_.rotate(-90).multiply(b0);if(P)V0=P._transformPoint(_.add(V0)).subtract(y);h0.push(new Z(y,V0,p0))}_=_.rotate(y0)}this._add(h0)}},lineBy:function(){var u=O.read(arguments),i=t(this)._point;this.lineTo(i.add(u))},curveBy:function(){var u=arguments,i=O.read(u),h=O.read(u),f=k.read(u),g=t(this)._point;this.curveTo(g.add(i),g.add(h),f)},cubicCurveBy:function(){var u=arguments,i=O.read(u),h=O.read(u),f=O.read(u),g=t(this)._point;this.cubicCurveTo(g.add(i),g.add(h),g.add(f))},quadraticCurveBy:function(){var u=arguments,i=O.read(u),h=O.read(u),f=t(this)._point;this.quadraticCurveTo(f.add(i),f.add(h))},arcBy:function(){var u=arguments,i=t(this)._point,h=i.add(O.read(u)),f=k.pick(k.peek(u),!0);if(typeof f==="boolean")this.arcTo(h,f);else this.arcTo(h,i.add(O.read(u)))},closePath:function(u){this.setClosed(!0),this.join(this,u)}}},{_getBounds:function(t,u){var i=u.handle?"getHandleBounds":u.stroke?"getStrokeBounds":"getBounds";return w0[i](this._segments,this._closed,this,t,u)},statics:{getBounds:function(t,u,i,h,f,g){var x=t[0];if(!x)return new K;var v=new Array(6),s=x._transformCoordinates(h,new Array(6)),p=s.slice(0,2),d=p.slice(),_=new Array(2);function P(C){C._transformCoordinates(h,v);for(var B=0;B<2;B++)T._addBounds(s[B],s[B+4],v[B+2],v[B],B,g?g[B]:0,p,d,_);var j=s;s=v,v=j}for(var w=1,r=t.length;w<r;w++)P(t[w]);if(u)P(x);return new K(p[0],p[1],d[0]-p[0],d[1]-p[1])},getStrokeBounds:function(t,u,i,h,f){var g=i.getStyle(),x=g.hasStroke(),v=g.getStrokeWidth(),s=x&&i._getStrokeMatrix(h,f),p=x&&w0._getStrokePadding(v,s),d=w0.getBounds(t,u,i,h,f,p);if(!x)return d;var _=v/2,P=g.getStrokeJoin(),w=g.getStrokeCap(),r=g.getMiterLimit(),C=new K(new f0(p));function B(G){d=d.include(G)}function j(G){d=d.unite(C.setCenter(G._point.transform(h)))}function o(G,c){if(c==="round"||G.isSmooth())j(G);else w0._addBevelJoin(G,c,_,r,h,s,B)}function y(G,c){if(c==="round")j(G);else w0._addSquareCap(G,c,_,h,s,B)}var S=t.length-(u?0:1);if(S>0){for(var D=1;D<S;D++)o(t[D],P);if(u)o(t[0],P);else y(t[0],w),y(t[t.length-1],w)}return d},_getStrokePadding:function(t,u){if(!u)return[t,t];var i=new O(t,0).transform(u),h=new O(0,t).transform(u),f=i.getAngleInRadians(),g=i.getLength(),x=h.getLength(),v=Math.sin(f),s=Math.cos(f),p=Math.tan(f),d=Math.atan2(x*p,g),_=Math.atan2(x,p*g);return[Math.abs(g*Math.cos(d)*s+x*Math.sin(d)*v),Math.abs(x*Math.sin(_)*s+g*Math.cos(_)*v)]},_addBevelJoin:function(t,u,i,h,f,g,x,v){var s=t.getCurve(),p=s.getPrevious(),d=s.getPoint1().transform(f),_=p.getNormalAtTime(1).multiply(i).transform(g),P=s.getNormalAtTime(0).multiply(i).transform(g),w=_.getDirectedAngle(P);if(w<0||w>=180)_=_.negate(),P=P.negate();if(v)x(d);if(x(d.add(_)),u==="miter"){var r=new D0(d.add(_),new O(-_.y,_.x),!0).intersect(new D0(d.add(P),new O(-P.y,P.x),!0),!0);if(r&&d.getDistance(r)<=h*i)x(r)}x(d.add(P))},_addSquareCap:function(t,u,i,h,f,g,x){var v=t._point.transform(h),s=t.getLocation(),p=s.getNormal().multiply(s.getTime()===0?i:-i).transform(f);if(u==="square"){if(x)g(v.subtract(p)),g(v.add(p));v=v.add(p.rotate(-90))}g(v.add(p)),g(v.subtract(p))},getHandleBounds:function(t,u,i,h,f){var g=i.getStyle(),x=f.stroke&&g.hasStroke(),v,s;if(x){var p=i._getStrokeMatrix(h,f),d=g.getStrokeWidth()/2,_=d;if(g.getStrokeJoin()==="miter")_=d*g.getMiterLimit();if(g.getStrokeCap()==="square")_=Math.max(_,d*Math.SQRT2);v=w0._getStrokePadding(d,p),s=w0._getStrokePadding(_,p)}var P=new Array(6),w=Infinity,r=-w,C=w,B=r;for(var j=0,o=t.length;j<o;j++){var y=t[j];y._transformCoordinates(h,P);for(var S=0;S<6;S+=2){var D=!S?s:v,G=D?D[0]:0,c=D?D[1]:0,L=P[S],z=P[S+1],V=L-G,N=L+G,q=z-c,A=z+c;if(V<w)w=V;if(N>r)r=N;if(q<C)C=q;if(A>B)B=A}}return new K(w,C,r-w,B-C)}}});w0.inject({statics:new function(){var t=0.5522847498307936,u=[new Z([-1,0],[0,t],[0,-t]),new Z([0,-1],[-t,0],[t,0]),new Z([1,0],[0,-t],[0,t]),new Z([0,1],[t,0],[-t,0])];function i(f,g,x){var v=k.getNamed(x),s=new w0(v&&(v.insert==!0?d0.INSERT:v.insert==!1?d0.NO_INSERT:null));return s._add(f),s._closed=g,s.set(v,d0.INSERT)}function h(f,g,x){var v=new Array(4);for(var s=0;s<4;s++){var p=u[s];v[s]=new Z(p._point.multiply(g).add(f),p._handleIn.multiply(g),p._handleOut.multiply(g))}return i(v,!0,x)}return{Line:function(){var f=arguments;return i([new Z(O.readNamed(f,"from")),new Z(O.readNamed(f,"to"))],!1,f)},Circle:function(){var f=arguments,g=O.readNamed(f,"center"),x=k.readNamed(f,"radius");return h(g,new f0(x),f)},Rectangle:function(){var f=arguments,g=K.readNamed(f,"rectangle"),x=f0.readNamed(f,"radius",0,{readNull:!0}),v=g.getBottomLeft(!0),s=g.getTopLeft(!0),p=g.getTopRight(!0),d=g.getBottomRight(!0),_;if(!x||x.isZero())_=[new Z(v),new Z(s),new Z(p),new Z(d)];else{x=f0.min(x,g.getSize(!0).divide(2));var{width:P,height:w}=x,r=P*t,C=w*t;_=[new Z(v.add(P,0),null,[-r,0]),new Z(v.subtract(0,w),[0,C]),new Z(s.add(0,w),null,[0,-C]),new Z(s.add(P,0),[-r,0],null),new Z(p.subtract(P,0),null,[r,0]),new Z(p.add(0,w),[0,-C],null),new Z(d.subtract(0,w),null,[0,C]),new Z(d.subtract(P,0),[r,0])]}return i(_,!0,f)},RoundRectangle:"#Rectangle",Ellipse:function(){var f=arguments,g=g0._readEllipse(f);return h(g.center,g.radius,f)},Oval:"#Ellipse",Arc:function(){var f=arguments,g=O.readNamed(f,"from"),x=O.readNamed(f,"through"),v=O.readNamed(f,"to"),s=k.getNamed(f),p=new w0(s&&s.insert==!1&&d0.NO_INSERT);return p.moveTo(g),p.arcTo(x,v),p.set(s)},RegularPolygon:function(){var f=arguments,g=O.readNamed(f,"center"),x=k.readNamed(f,"sides"),v=k.readNamed(f,"radius"),s=360/x,p=x%3===0,d=new O(0,p?-v:v),_=p?-1:0.5,P=new Array(x);for(var w=0;w<x;w++)P[w]=new Z(g.add(d.rotate((w+_)*s)));return i(P,!0,f)},Star:function(){var f=arguments,g=O.readNamed(f,"center"),x=k.readNamed(f,"points")*2,v=k.readNamed(f,"radius1"),s=k.readNamed(f,"radius2"),p=360/x,d=new O(0,-1),_=new Array(x);for(var P=0;P<x;P++)_[P]=new Z(g.add(d.rotate(p*P).multiply(P%2?s:v)));return i(_,!0,f)}}}});var O0=e0.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function t(u){if(this._children=[],this._namedChildren={},!this._initialize(u))if(typeof u==="string")this.setPathData(u);else this.addChildren(Array.isArray(u)?u:arguments)},insertChildren:function t(u,i){var h=i,f=h[0];if(f&&typeof f[0]==="number")h=[h];for(var g=i.length-1;g>=0;g--){var x=h[g];if(h===i&&!(x instanceof w0))h=k.slice(h);if(Array.isArray(x))h[g]=new w0({segments:x,insert:!1});else if(x instanceof O0)h.splice.apply(h,[g,1].concat(x.removeChildren())),x.remove()}return t.base.call(this,u,h)},reduce:function t(u){var i=this._children;for(var h=i.length-1;h>=0;h--){var f=i[h].reduce(u);if(f.isEmpty())f.remove()}if(!i.length){var f=new w0(d0.NO_INSERT);return f.copyAttributes(this),f.insertAbove(this),this.remove(),f}return t.base.call(this)},isClosed:function(){var t=this._children;for(var u=0,i=t.length;u<i;u++)if(!t[u]._closed)return!1;return!0},setClosed:function(t){var u=this._children;for(var i=0,h=u.length;i<h;i++)u[i].setClosed(t)},getFirstSegment:function(){var t=this.getFirstChild();return t&&t.getFirstSegment()},getLastSegment:function(){var t=this.getLastChild();return t&&t.getLastSegment()},getCurves:function(){var t=this._children,u=[];for(var i=0,h=t.length;i<h;i++)k.push(u,t[i].getCurves());return u},getFirstCurve:function(){var t=this.getFirstChild();return t&&t.getFirstCurve()},getLastCurve:function(){var t=this.getLastChild();return t&&t.getLastCurve()},getArea:function(){var t=this._children,u=0;for(var i=0,h=t.length;i<h;i++)u+=t[i].getArea();return u},getLength:function(){var t=this._children,u=0;for(var i=0,h=t.length;i<h;i++)u+=t[i].getLength();return u},getPathData:function(t,u){var i=this._children,h=[];for(var f=0,g=i.length;f<g;f++){var x=i[f],v=x._matrix;h.push(x.getPathData(t&&!v.isIdentity()?t.appended(v):t,u))}return h.join("")},_hitTestChildren:function t(u,i,h){return t.base.call(this,u,i.class===w0||i.type==="path"?i:k.set({},i,{fill:!1}),h)},_draw:function(t,u,i,h){var f=this._children;if(!f.length)return;u=u.extend({dontStart:!0,dontFinish:!0}),t.beginPath();for(var g=0,x=f.length;g<x;g++)f[g].draw(t,u,h);if(!u.clip){this._setStyles(t,u,i);var v=this._style;if(v.hasFill())t.fill(v.getFillRule()),t.shadowColor="rgba(0,0,0,0)";if(v.hasStroke())t.stroke()}},_drawSelected:function(t,u,i){var h=this._children;for(var f=0,g=h.length;f<g;f++){var x=h[f],v=x._matrix;if(!i[x._id])x._drawSelected(t,v.isIdentity()?u:u.appended(v))}}},new function(){function t(u,i){var h=u._children;if(i&&!h.length)throw new Error("Use a moveTo() command first");return h[h.length-1]}return k.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(u){this[u]=function(){var i=t(this,!0);i[u].apply(i,arguments)}},{moveTo:function(){var u=t(this),i=u&&u.isEmpty()?u:new w0(d0.NO_INSERT);if(i!==u)this.addChild(i);i.moveTo.apply(i,arguments)},moveBy:function(){var u=t(this,!0),i=u&&u.getLastSegment(),h=O.read(arguments);this.moveTo(i?h.add(i._point):h)},closePath:function(u){t(this,!0).closePath(u)}})},k.each(["reverse","flatten","simplify","smooth"],function(t){this[t]=function(u){var i=this._children,h;for(var f=0,g=i.length;f<g;f++)h=i[f][t](u)||h;return h}},{}));e0.inject(new function(){var{min:t,max:u,abs:i}=Math,h={unite:{"1":!0,"2":!0},intersect:{"2":!0},subtract:{"1":!0},exclude:{"1":!0,"-1":!0}};function f(j){return j._children||[j]}function g(j,o){var y=j.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(o){var S=f(y);for(var D=0,G=S.length;D<G;D++){var j=S[D];if(!j._closed&&!j.isEmpty())j.closePath(0.000000000001),j.getFirstSegment().setHandleIn(0,0),j.getLastSegment().setHandleOut(0,0)}y=y.resolveCrossings().reorient(y.getFillRule()==="nonzero",!0)}return y}function x(j,o,y,S,D){var G=new O0(d0.NO_INSERT);if(G.addChildren(j,!0),G=G.reduce({simplify:o}),!(D&&D.insert==!1))G.insertAbove(S&&y.isSibling(S)&&y.getIndex()<S.getIndex()?S:y);return G.copyAttributes(y,!0),G}function v(j){return j.hasOverlap()||j.isCrossing()}function s(j,o,y,S){if(S&&(S.trace==!1||S.stroke)&&/^(subtract|intersect)$/.test(y))return p(j,o,y);var D=g(j,!0),G=o&&j!==o&&g(o,!0),c=h[y];if(c[y]=!0,G&&(c.subtract||c.exclude)^(G.isClockwise()^D.isClockwise()))G.reverse();var L=w(c0.expand(D.getIntersections(G,v))),z=f(D),V=G&&f(G),N=[],q=[],A;function a(p0){for(var V0=0,o0=p0.length;V0<o0;V0++){var L0=p0[V0];k.push(N,L0._segments),k.push(q,L0.getCurves()),L0._overlapsOnly=!0}}function R(p0){var V0=[];for(var o0=0,L0=p0&&p0.length;o0<L0;o0++)V0.push(q[p0[o0]]);return V0}if(L.length){if(a(z),V)a(V);var X=new Array(q.length);for(var e=0,Y=q.length;e<Y;e++)X[e]=q[e].getValues();var U=m0.findCurveBoundsCollisions(X,X,0,!0),t0={};for(var e=0;e<q.length;e++){var y0=q[e],v0=y0._path._id,b0=t0[v0]=t0[v0]||{};b0[y0.getIndex()]={hor:R(U[e].hor),ver:R(U[e].ver)}}for(var e=0,Y=L.length;e<Y;e++)C(L[e]._segment,D,G,t0,c);for(var e=0,Y=N.length;e<Y;e++){var h0=N[e],j0=h0._intersection;if(!h0._winding)C(h0,D,G,t0,c);if(!(j0&&j0._overlap))h0._path._overlapsOnly=!1}A=B(N,c)}else A=P(V?z.concat(V):z.slice(),function(p0){return!!c[p0]});return x(A,!0,j,o,S)}function p(j,o,y){var S=g(j),D=g(o),G=S.getIntersections(D,v),c=y==="subtract",L=y==="divide",z={},V=[];function N(a){if(!z[a._id]&&(L||D.contains(a.getPointAt(a.getLength()/2))^c))return V.unshift(a),z[a._id]=!0}for(var q=G.length-1;q>=0;q--){var A=G[q].split();if(A){if(N(A))A.getFirstSegment().setHandleIn(0,0);S.getLastSegment().setHandleOut(0,0)}}return N(S),x(V,!1,j,o)}function d(j,o){var y=j;while(y){if(y===o)return;y=y._previous}while(j._next&&j._next!==o)j=j._next;if(!j._next){while(o._previous)o=o._previous;j._next=o,o._previous=j}}function _(j){for(var o=j.length-1;o>=0;o--)j[o].clearHandles()}function P(j,o,y){var S=j&&j.length;if(S){var D=k.each(j,function(U,t0){this[U._id]={container:null,winding:U.isClockwise()?1:-1,index:t0}},{}),G=j.slice().sort(function(U,t0){return i(t0.getArea())-i(U.getArea())}),c=G[0],L=m0.findItemBoundsCollisions(G,null,Q.GEOMETRIC_EPSILON);if(y==null)y=c.isClockwise();for(var z=0;z<S;z++){var V=G[z],N=D[V._id],q=0,A=L[z];if(A){var a=null;for(var R=A.length-1;R>=0;R--)if(A[R]<z){a=a||V.getInteriorPoint();var X=G[A[R]];if(X.contains(a)){var e=D[X._id];q=e.winding,N.winding+=q,N.container=e.exclude?e.container:X;break}}}if(o(N.winding)===o(q))N.exclude=!0,j[N.index]=null;else{var Y=N.container;V.setClockwise(Y?!Y.isClockwise():y)}}}return j}function w(j,o,y){var S=o&&[],D=0.00000001,G=1-D,c=!1,L=y||[],z=y&&{},V,N,q;function A(V0){return V0._path._id+"."+V0._segment1._index}for(var a=(y&&y.length)-1;a>=0;a--){var R=y[a];if(R._path)z[A(R)]=!0}for(var a=j.length-1;a>=0;a--){var X=j[a],e=X._time,Y=e,U=o&&!o(X),R=X._curve,t0;if(R){if(R!==N)c=!R.hasHandles()||z&&z[A(R)],V=[],q=null,N=R;else if(q>=D)e/=q}if(U){if(V)V.push(X);continue}else if(o)S.unshift(X);if(q=Y,e<D)t0=R._segment1;else if(e>G)t0=R._segment2;else{var y0=R.divideAtTime(e,!0);if(c)L.push(R,y0);t0=y0._segment1;for(var v0=V.length-1;v0>=0;v0--){var b0=V[v0];b0._time=(b0._time-e)/(1-e)}}X._setSegment(t0);var h0=t0._intersection,j0=X._intersection;if(h0){d(h0,j0);var p0=h0;while(p0)d(p0._intersection,h0),p0=p0._next}else t0._intersection=j0}if(!y)_(L);return S||j}function r(j,o,y,S,D){var G=Array.isArray(o)?o:o[y?"hor":"ver"],c=y?1:0,L=c^1,z=[j.x,j.y],V=z[c],N=z[L],q=0.000000001,A=0.000001,a=V-q,R=V+q,X=0,e=0,Y=0,U=0,t0=!1,y0=!1,v0=1,b0=[],h0,j0;function p0(a0){var Q0=a0[L+0],b6=a0[L+6];if(N<t(Q0,b6)||N>u(Q0,b6))return;var h6=a0[c+0],B6=a0[c+2],T6=a0[c+4],k6=a0[c+6];if(Q0===b6){if(h6<R&&k6>a||k6<R&&h6>a)t0=!0;return}var V6=N===Q0?0:N===b6?1:a>u(h6,B6,T6,k6)||R<t(h6,B6,T6,k6)?1:T.solveCubic(a0,L,N,b0,0,1)>0?b0[0]:1,_6=V6===0?h6:V6===1?k6:T.getPoint(a0,V6)[y?"y":"x"],S6=Q0>b6?1:-1,i4=h0[L]>h0[L+6]?1:-1,M6=h0[c+6];if(N!==Q0){if(_6<a)Y+=S6;else if(_6>R)U+=S6;else t0=!0;if(_6>V-A&&_6<V+A)v0/=2}else{if(S6!==i4){if(h6<a)Y+=S6;else if(h6>R)U+=S6}else if(h6!=M6){if(M6<R&&_6>R)U+=S6,t0=!0;else if(M6>a&&_6<a)Y+=S6,t0=!0}v0/=4}return h0=a0,!D&&_6>a&&_6<R&&T.getTangent(a0,V6)[y?"x":"y"]===0&&r(j,o,!y,S,!0)}function V0(a0){var Q0=a0[L+0],b6=a0[L+2],h6=a0[L+4],B6=a0[L+6];if(N<=u(Q0,b6,h6,B6)&&N>=t(Q0,b6,h6,B6)){var T6=a0[c+0],k6=a0[c+2],V6=a0[c+4],_6=a0[c+6],S6=a>u(T6,k6,V6,_6)||R<t(T6,k6,V6,_6)?[a0]:T.getMonoCurves(a0,y),i4;for(var M6=0,J5=S6.length;M6<J5;M6++)if(i4=p0(S6[M6]))return i4}}for(var o0=0,L0=G.length;o0<L0;o0++){var z0=G[o0],I0=z0._path,u6=z0.getValues(),i6;if(!o0||G[o0-1]._path!==I0){if(h0=null,!I0._closed){if(j0=T.getValues(I0.getLastCurve().getSegment2(),z0.getSegment1(),null,!S),j0[L]!==j0[L+6])h0=j0}if(!h0){h0=u6;var s6=I0.getLastCurve();while(s6&&s6!==z0){var J0=s6.getValues();if(J0[L]!==J0[L+6]){h0=J0;break}s6=s6.getPrevious()}}}if(i6=V0(u6))return i6;if(o0+1===L0||G[o0+1]._path!==I0){if(j0&&(i6=V0(j0)))return i6;if(t0&&!Y&&!U)Y=U=I0.isClockwise(S)^y?1:-1;if(X+=Y,e+=U,Y=U=0,t0)y0=!0,t0=!1;j0=null}}return X=i(X),e=i(e),{winding:u(X,e),windingL:X,windingR:e,quality:v0,onPath:y0}}function C(j,o,y,S,D){var G=[],c=j,L=0,q;do{var z=j.getCurve();if(z){var V=z.getLength();G.push({segment:j,curve:z,length:V}),L+=V}j=j.getNext()}while(j&&!j._intersection&&j!==c);var N=[0.5,0.25,0.75],q={winding:0,quality:-1},A=0.001,a=1-A;for(var R=0;R<N.length&&q.quality<0.5;R++){var V=L*N[R];for(var X=0,e=G.length;X<e;X++){var Y=G[X],U=Y.length;if(V<=U){var z=Y.curve,t0=z._path,y0=t0._parent,v0=y0 instanceof O0?y0:t0,b0=Q.clamp(z.getTimeAt(V),A,a),h0=z.getPointAtTime(b0),j0=i(z.getTangentAtTime(b0).y)<Math.SQRT1_2,p0=null;if(D.subtract&&y){var V0=v0===o?y:o,o0=V0._getWinding(h0,j0,!0);if(v0===o&&o0.winding||v0===y&&!o0.winding)if(o0.quality<1)continue;else p0={winding:0,quality:1}}if(p0=p0||r(h0,S[t0._id][z.getIndex()],j0,!0),p0.quality>q.quality)q=p0;break}V-=U}}for(var X=G.length-1;X>=0;X--)G[X].segment._winding=q}function B(j,o){var y=[],S;function D(L0){var z0;return!!(L0&&!L0._visited&&(!o||o[(z0=L0._winding||{}).winding]&&!(o.unite&&z0.winding===2&&z0.windingL&&z0.windingR)))}function G(L0){if(L0){for(var z0=0,I0=S.length;z0<I0;z0++)if(L0===S[z0])return!0}return!1}function c(L0){var z0=L0._segments;for(var I0=0,u6=z0.length;I0<u6;I0++)z0[I0]._visited=!0}function L(L0,z0){var I0=L0._intersection,u6=I0,i6=[];if(z0)S=[L0];function s6(J0,a0){while(J0&&J0!==a0){var Q0=J0._segment,b6=Q0&&Q0._path;if(b6){var h6=Q0.getNext()||b6.getFirstSegment(),B6=h6._intersection;if(Q0!==L0&&(G(Q0)||G(h6)||h6&&(D(Q0)&&(D(h6)||B6&&D(B6._segment)))))i6.push(Q0);if(z0)S.push(Q0)}J0=J0._next}}if(I0){s6(I0);while(I0&&I0._previous)I0=I0._previous;s6(I0,u6)}return i6}j.sort(function(L0,z0){var I0=L0._intersection,u6=z0._intersection,i6=!!(I0&&I0._overlap),s6=!!(u6&&u6._overlap),J0=L0._path,a0=z0._path;return i6^s6?i6?1:-1:!I0^!u6?I0?1:-1:J0!==a0?J0._id-a0._id:L0._index-z0._index});for(var z=0,V=j.length;z<V;z++){var N=j[z],q=D(N),A=null,a=!1,R=!0,X=[],e,Y,U;if(q&&N._path._overlapsOnly){var t0=N._path,y0=N._intersection._segment._path;if(t0.compare(y0)){if(t0.getArea())y.push(t0.clone(!1));c(t0),c(y0),q=!1}}while(q){var v0=!A,b0=L(N,v0),h0=b0.shift(),a=!v0&&(G(N)||G(h0)),j0=!a&&h0;if(v0)A=new w0(d0.NO_INSERT),e=null;if(a){if(N.isFirst()||N.isLast())R=N._path._closed;N._visited=!0;break}if(j0&&e)X.push(e),e=null;if(!e){if(j0)b0.push(N);e={start:A._segments.length,crossings:b0,visited:Y=[],handleIn:U}}if(j0)N=h0;if(!D(N)){A.removeSegments(e.start);for(var p0=0,V0=Y.length;p0<V0;p0++)Y[p0]._visited=!1;Y.length=0;do if(N=e&&e.crossings.shift(),!N||!N._path){if(N=null,e=X.pop(),e)Y=e.visited,U=e.handleIn}while(e&&!D(N));if(!N)break}var o0=N.getNext();A.add(new Z(N._point,U,o0&&N._handleOut)),N._visited=!0,Y.push(N),N=o0||N._path.getFirstSegment(),U=o0&&o0._handleIn}if(a){if(R)A.getFirstSegment().setHandleIn(U),A.setClosed(R);if(A.getArea()!==0)y.push(A)}}return y}return{_getWinding:function(j,o,y){return r(j,this.getCurves(),o,y)},unite:function(j,o){return s(this,j,"unite",o)},intersect:function(j,o){return s(this,j,"intersect",o)},subtract:function(j,o){return s(this,j,"subtract",o)},exclude:function(j,o){return s(this,j,"exclude",o)},divide:function(j,o){return o&&(o.trace==!1||o.stroke)?p(this,j,"divide"):x([this.subtract(j,o),this.intersect(j,o)],!0,this,j,o)},resolveCrossings:function(){var j=this._children,o=j||[this];function y(e,Y){var U=e&&e._intersection;return U&&U._overlap&&U._path===Y}var S=!1,D=!1,G=this.getIntersections(null,function(e){return e.hasOverlap()&&(S=!0)||e.isCrossing()&&(D=!0)}),c=S&&D&&[];if(G=c0.expand(G),S){var L=w(G,function(e){return e.hasOverlap()},c);for(var z=L.length-1;z>=0;z--){var V=L[z],N=V._path,q=V._segment,A=q.getPrevious(),a=q.getNext();if(y(A,N)&&y(a,N)){if(q.remove(),A._handleOut._set(0,0),a._handleIn._set(0,0),A!==q&&!A.getCurve().hasLength())a._handleIn.set(A._handleIn),A.remove()}}}if(D){if(w(G,S&&function(e){var Y=e.getCurve(),U=e.getSegment(),t0=e._intersection,y0=t0._curve,v0=t0._segment;if(Y&&y0&&Y._path&&y0._path)return!0;if(U)U._intersection=null;if(v0)v0._intersection=null},c),c)_(c);o=B(k.each(o,function(e){k.push(this,e._segments)},[]))}var R=o.length,X;if(R>1&&j){if(o!==j)this.setChildren(o);X=this}else if(R===1&&!j){if(o[0]!==this)this.setSegments(o[0].removeSegments());X=this}if(!X)X=new O0(d0.NO_INSERT),X.addChildren(o),X=X.reduce(),X.copyAttributes(this),this.replaceWith(X);return X},reorient:function(j,o){var y=this._children;if(y&&y.length)this.setChildren(P(this.removeChildren(),function(S){return!!(j?S:S&1)},o));else if(o!==M)this.setClockwise(o);return this},getInteriorPoint:function(){var j=this.getBounds(),o=j.getCenter(!0);if(!this.contains(o)){var y=this.getCurves(),S=o.y,D=[],G=[];for(var c=0,L=y.length;c<L;c++){var z=y[c].getValues(),V=z[1],N=z[3],q=z[5],A=z[7];if(S>=t(V,N,q,A)&&S<=u(V,N,q,A)){var a=T.getMonoCurves(z);for(var R=0,X=a.length;R<X;R++){var e=a[R],Y=e[1],U=e[7];if(Y!==U&&(S>=Y&&S<=U||S>=U&&S<=Y)){var t0=S===Y?e[0]:S===U?e[6]:T.solveCubic(e,1,S,G,0,1)===1?T.getPoint(e,G[0]).x:(e[0]+e[6])/2;D.push(t0)}}}}if(D.length>1)D.sort(function(y0,v0){return y0-v0}),o.x=(D[0]+D[1])/2}return o}}});var F0=k.extend({_class:"PathFlattener",initialize:function(t,u,i,h,f){var g=[],x=[],v=0,s=1/(i||32),p=t._segments,d=p[0],_;function P(B,j){var o=T.getValues(B,j,f);g.push(o),w(o,B._index,0,1)}function w(B,j,o,y){if(y-o>s&&!(h&&T.isStraight(B))&&!T.isFlatEnough(B,u||0.25)){var S=T.subdivide(B,0.5),D=(o+y)/2;w(S[0],j,o,D),w(S[1],j,D,y)}else{var G=B[6]-B[0],c=B[7]-B[1],L=Math.sqrt(G*G+c*c);if(L>0)v+=L,x.push({offset:v,curve:B,index:j,time:y})}}for(var r=1,C=p.length;r<C;r++)_=p[r],P(d,_),d=_;if(t._closed)P(_||d,p[0]);this.curves=g,this.parts=x,this.length=v,this.index=0},_get:function(t){var u=this.parts,i=u.length,h,f,g=this.index;for(;;)if(f=g,!g||u[--g].offset<t)break;for(;f<i;f++){var x=u[f];if(x.offset>=t){this.index=f;var v=u[f-1],s=v&&v.index===x.index?v.time:0,p=v?v.offset:0;return{index:x.index,time:s+(x.time-s)*(t-p)/(x.offset-p)}}}return{index:u[i-1].index,time:1}},drawPart:function(t,u,i){var h=this._get(u),f=this._get(i);for(var g=h.index,x=f.index;g<=x;g++){var v=T.getPart(this.curves[g],g===h.index?h.time:0,g===f.index?f.time:1);if(g===h.index)t.moveTo(v[0],v[1]);t.bezierCurveTo.apply(t,v.slice(2))}}},k.each(T._evaluateMethods,function(t){this[t+"At"]=function(u){var i=this._get(u);return T[t](this.curves[i.index],i.time)}},{})),Y0=k.extend({initialize:function(t){var u=this.points=[],i=t._segments,h=t._closed;for(var f=0,g,x=i.length;f<x;f++){var v=i[f].point;if(!g||!g.equals(v))u.push(g=v.clone())}if(h)u.unshift(u[u.length-1]),u.push(u[1]);this.closed=h},fit:function(t){var u=this.points,i=u.length,h=null;if(i>0){if(h=[new Z(u[0])],i>1){if(this.fitCubic(h,t,0,i-1,u[1].subtract(u[0]),u[i-2].subtract(u[i-1])),this.closed)h.shift(),h.pop()}}return h},fitCubic:function(t,u,i,h,f,g){var x=this.points;if(h-i===1){var v=x[i],s=x[h],p=v.getDistance(s)/3;this.addCurve(t,[v,v.add(f.normalize(p)),s.add(g.normalize(p)),s]);return}var d=this.chordLengthParameterize(i,h),_=Math.max(u,u*u),P,w=!0;for(var r=0;r<=4;r++){var C=this.generateBezier(i,h,d,f,g),B=this.findMaxError(i,h,C,d);if(B.error<u&&w){this.addCurve(t,C);return}if(P=B.index,B.error>=_)break;w=this.reparameterize(i,h,d,C),_=B.error}var j=x[P-1].subtract(x[P+1]);this.fitCubic(t,u,i,P,f,j),this.fitCubic(t,u,P,h,j.negate(),g)},addCurve:function(t,u){var i=t[t.length-1];i.setHandleOut(u[1].subtract(u[0])),t.push(new Z(u[3],u[2].subtract(u[3])))},generateBezier:function(t,u,i,h,f){var g=0.000000000001,x=Math.abs,v=this.points,s=v[t],p=v[u],d=[[0,0],[0,0]],_=[0,0];for(var P=0,w=u-t+1;P<w;P++){var r=i[P],C=1-r,B=3*r*C,j=C*C*C,o=B*C,y=B*r,S=r*r*r,D=h.normalize(o),G=f.normalize(y),c=v[t+P].subtract(s.multiply(j+o)).subtract(p.multiply(y+S));d[0][0]+=D.dot(D),d[0][1]+=D.dot(G),d[1][0]=d[0][1],d[1][1]+=G.dot(G),_[0]+=D.dot(c),_[1]+=G.dot(c)}var L=d[0][0]*d[1][1]-d[1][0]*d[0][1],z,V;if(x(L)>g){var N=d[0][0]*_[1]-d[1][0]*_[0],q=_[0]*d[1][1]-_[1]*d[0][1];z=q/L,V=N/L}else{var A=d[0][0]+d[0][1],a=d[1][0]+d[1][1];z=V=x(A)>g?_[0]/A:x(a)>g?_[1]/a:0}var R=p.getDistance(s),X=g*R,e,Y;if(z<X||V<X)z=V=R/3;else{var U=p.subtract(s);if(e=h.normalize(z),Y=f.normalize(V),e.dot(U)-Y.dot(U)>R*R)z=V=R/3,e=Y=null}return[s,s.add(e||h.normalize(z)),p.add(Y||f.normalize(V)),p]},reparameterize:function(t,u,i,h){for(var f=t;f<=u;f++)i[f-t]=this.findRoot(h,this.points[f],i[f-t]);for(var f=1,g=i.length;f<g;f++)if(i[f]<=i[f-1])return!1;return!0},findRoot:function(t,u,i){var h=[],f=[];for(var g=0;g<=2;g++)h[g]=t[g+1].subtract(t[g]).multiply(3);for(var g=0;g<=1;g++)f[g]=h[g+1].subtract(h[g]).multiply(2);var x=this.evaluate(3,t,i),v=this.evaluate(2,h,i),s=this.evaluate(1,f,i),p=x.subtract(u),d=v.dot(v)+p.dot(s);return Q.isMachineZero(d)?i:i-p.dot(v)/d},evaluate:function(t,u,i){var h=u.slice();for(var f=1;f<=t;f++)for(var g=0;g<=t-f;g++)h[g]=h[g].multiply(1-i).add(h[g+1].multiply(i));return h[0]},chordLengthParameterize:function(t,u){var i=[0];for(var h=t+1;h<=u;h++)i[h-t]=i[h-t-1]+this.points[h].getDistance(this.points[h-1]);for(var h=1,f=u-t;h<=f;h++)i[h]/=i[f];return i},findMaxError:function(t,u,i,h){var f=Math.floor((u-t+1)/2),g=0;for(var x=t+1;x<u;x++){var v=this.evaluate(3,i,h[x-t]),s=v.subtract(this.points[x]),p=s.x*s.x+s.y*s.y;if(p>=g)g=p,f=x}return{error:g,index:f}}}),f6=d0.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function t(u){this._content="",this._lines=[];var i=u&&k.isPlainObject(u)&&u.x===M&&u.y===M;this._initialize(i&&u,!i&&O.read(arguments))},_equals:function(t){return this._content===t._content},copyContent:function(t){this.setContent(t._content)},getContent:function(){return this._content},setContent:function(t){this._content=""+t,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),W0=f6.extend({_class:"PointText",initialize:function t(){f6.apply(this,arguments)},getPoint:function(){var t=this._matrix.getTranslation();return new M0(t.x,t.y,this,"setPoint")},setPoint:function(){var t=O.read(arguments);this.translate(t.subtract(this._matrix.getTranslation()))},_draw:function(t,u,i){if(!this._content)return;this._setStyles(t,u,i);var h=this._lines,f=this._style,g=f.hasFill(),x=f.hasStroke(),v=f.getLeading(),s=t.shadowColor;t.font=f.getFontStyle(),t.textAlign=f.getJustification();for(var p=0,d=h.length;p<d;p++){t.shadowColor=s;var _=h[p];if(g)t.fillText(_,0,0),t.shadowColor="rgba(0,0,0,0)";if(x)t.strokeText(_,0,0);t.translate(0,v)}},_getBounds:function(t,u){var i=this._style,h=this._lines,f=h.length,g=i.getJustification(),x=i.getLeading(),v=this.getView().getTextWidth(i.getFontStyle(),h),s=0;if(g!=="left")s-=v/(g==="center"?2:1);var p=new K(s,f?-0.75*x:0,v,f*x);return t?t._transformBounds(p,p):p}}),s0=k.extend(new function(){var t={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},u={},i={transparent:[0,0,0,0]},h;function f(v){var s=v.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||v.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),p="rgb",d;if(s){var _=s[4]?4:3;d=new Array(_);for(var P=0;P<_;P++){var w=s[P+1];d[P]=parseInt(w.length==1?w+w:w,16)/255}}else if(s=v.match(/^(rgb|hsl)a?\((.*)\)$/)){p=s[1],d=s[2].trim().split(/[,\s]+/g);var r=p==="hsl";for(var P=0,C=Math.min(d.length,4);P<C;P++){var B=d[P],w=parseFloat(B);if(r){if(P===0){var j=B.match(/([a-z]*)$/)[1];w*={turn:360,rad:180/Math.PI,grad:0.9}[j]||1}else if(P<3)w/=100}else if(P<3)w/=/%$/.test(B)?100:255;d[P]=w}}else{var o=i[v];if(!o)if(F){if(!h)h=U0.getContext(1,1,{willReadFrequently:!0}),h.globalCompositeOperation="copy";h.fillStyle="rgba(0,0,0,0)",h.fillStyle=v,h.fillRect(0,0,1,1);var y=h.getImageData(0,0,1,1).data;o=i[v]=[y[0]/255,y[1]/255,y[2]/255]}else o=[0,0,0];d=o.slice()}return[p,d]}var g=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],x={"rgb-hsb":function(v,s,p){var d=Math.max(v,s,p),_=Math.min(v,s,p),P=d-_,w=P===0?0:(d==v?(s-p)/P+(s<p?6:0):d==s?(p-v)/P+2:(v-s)/P+4)*60;return[w,d===0?0:P/d,d]},"hsb-rgb":function(v,s,p){v=(v/60%6+6)%6;var _=Math.floor(v),d=v-_,_=g[_],P=[p,p*(1-s),p*(1-s*d),p*(1-s*(1-d))];return[P[_[0]],P[_[1]],P[_[2]]]},"rgb-hsl":function(v,s,p){var d=Math.max(v,s,p),_=Math.min(v,s,p),P=d-_,w=P===0,r=w?0:(d==v?(s-p)/P+(s<p?6:0):d==s?(p-v)/P+2:(v-s)/P+4)*60,C=(d+_)/2,B=w?0:C<0.5?P/(d+_):P/(2-d-_);return[r,B,C]},"hsl-rgb":function(v,s,p){if(v=(v/360%1+1)%1,s===0)return[p,p,p];var d=[v+0.3333333333333333,v,v-0.3333333333333333],_=p<0.5?p*(1+s):p+s-p*s,P=2*p-_,w=[];for(var r=0;r<3;r++){var C=d[r];if(C<0)C+=1;if(C>1)C-=1;w[r]=6*C<1?P+(_-P)*6*C:2*C<1?_:3*C<2?P+(_-P)*(0.6666666666666666-C)*6:P}return w},"rgb-gray":function(v,s,p){return[v*0.2989+s*0.587+p*0.114]},"gray-rgb":function(v){return[v,v,v]},"gray-hsb":function(v){return[0,0,v]},"gray-hsl":function(v){return[0,0,v]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return k.each(t,function(v,s){u[s]=[],k.each(v,function(p,d){var _=k.capitalize(p),P=/^(hue|saturation)$/.test(p),w=u[s][d]=s==="gradient"?p==="gradient"?function(r){var C=this._components[0];if(r=n6.read(Array.isArray(r)?r:arguments,0,{readNull:!0}),C!==r){if(C)C._removeOwner(this);if(r)r._addOwner(this)}return r}:function(){return O.read(arguments,0,{readNull:p==="highlight",clone:!0})}:function(r){return r==null||isNaN(r)?0:+r};this["get"+_]=function(){return this._type===s||P&&/^hs[bl]$/.test(this._type)?this._components[d]:this._convert(s)[d]},this["set"+_]=function(r){if(this._type!==s&&!(P&&/^hs[bl]$/.test(this._type)))this._components=this._convert(s),this._properties=t[s],this._type=s;this._components[d]=w.call(this,r),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function v(s){var p=arguments,d=this.__read,_=0,P,w,r,C;if(Array.isArray(s))p=s,s=p[0];var B=s!=null&&typeof s;if(B==="string"&&s in t)if(P=s,s=p[1],Array.isArray(s))w=s,r=p[2];else{if(d)_=1;p=k.slice(p,1),B=typeof s}if(!w){if(C=B==="number"?p:B==="object"&&s.length!=null?s:null,C){if(!P)P=C.length>=3?"rgb":"gray";var j=t[P].length;if(r=C[j],d)_+=C===arguments?j+(r!=null?1:0):1;if(C.length>j)C=k.slice(C,0,j)}else if(B==="string"){var o=f(s);if(P=o[0],w=o[1],w.length===4)r=w[3],w.length--}else if(B==="object")if(s.constructor===v){if(P=s._type,w=s._components.slice(),r=s._alpha,P==="gradient")for(var y=1,S=w.length;y<S;y++){var D=w[y];if(D)w[y]=D.clone()}}else if(s.constructor===n6)P="gradient",C=p;else{P="hue"in s?"lightness"in s?"hsl":"hsb":("gradient"in s)||("stops"in s)||("radial"in s)?"gradient":("gray"in s)?"gray":"rgb";var G=t[P],c=u[P];this._components=w=[];for(var y=0,S=G.length;y<S;y++){var L=s[G[y]];if(L==null&&!y&&P==="gradient"&&"stops"in s)L={stops:s.stops,radial:s.radial};if(L=c[y].call(this,L),L!=null)w[y]=L}r=s.alpha}if(d&&P)_=1}if(this._type=P||"rgb",!w){this._components=w=[];var c=u[this._type];for(var y=0,S=c.length;y<S;y++){var L=c[y].call(this,C&&C[y]);if(L!=null)w[y]=L}}if(this._components=w,this._properties=t[this._type],this._alpha=r,d)this.__read=_;return this},set:"#initialize",_serialize:function(v,s){var p=this.getComponents();return k.serialize(/^(gray|rgb)$/.test(this._type)?p:[this._type].concat(p),v,!0,s)},_changed:function(){if(this._canvasStyle=null,this._owner)if(this._setter)this._owner[this._setter](this);else this._owner._changed(129)},_convert:function(v){var s;return this._type===v?this._components.slice():(s=x[this._type+"-"+v])?s.apply(this,this._components):x["rgb-"+v].apply(this,x[this._type+"-rgb"].apply(this,this._components))},convert:function(v){return new s0(v,this._convert(v),this._alpha)},getType:function(){return this._type},setType:function(v){this._components=this._convert(v),this._properties=t[v],this._type=v},getComponents:function(){var v=this._components.slice();if(this._alpha!=null)v.push(this._alpha);return v},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(v){this._alpha=v==null?null:Math.min(Math.max(v,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(v){var s=k.isPlainValue(v,!0)?s0.read(arguments):v;return s===this||s&&this._class===s._class&&this._type===s._type&&this.getAlpha()===s.getAlpha()&&k.equals(this._components,s._components)||!1},toString:function(){var v=this._properties,s=[],p=this._type==="gradient",d=S0.instance;for(var _=0,P=v.length;_<P;_++){var w=this._components[_];if(w!=null)s.push(v[_]+": "+(p?w:d.number(w)))}if(this._alpha!=null)s.push("alpha: "+d.number(this._alpha));return"{ "+s.join(", ")+" }"},toCSS:function(v){var s=this._convert("rgb"),p=v||this._alpha==null?1:this._alpha;function d(_){return Math.round((_<0?0:_>1?1:_)*255)}if(s=[d(s[0]),d(s[1]),d(s[2])],p<1)s.push(p<0?0:p);return v?"#"+((1<<24)+(s[0]<<16)+(s[1]<<8)+s[2]).toString(16).slice(1):(s.length==4?"rgba(":"rgb(")+s.join(",")+")"},toCanvasStyle:function(v,s){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var p=this._components,d=p[0],_=d._stops,P=p[1],w=p[2],r=p[3],C=s&&s.inverted(),B;if(C){if(P=C._transformPoint(P),w=C._transformPoint(w),r)r=C._transformPoint(r)}if(d._radial){var j=w.getDistance(P);if(r){var o=r.subtract(P);if(o.getLength()>j)r=P.add(o.normalize(j-0.1))}var y=r||P;B=v.createRadialGradient(y.x,y.y,0,P.x,P.y,j)}else B=v.createLinearGradient(P.x,P.y,w.x,w.y);for(var S=0,D=_.length;S<D;S++){var G=_[S],c=G._offset;B.addColorStop(c==null?S/(D-1):c,G._color.toCanvasStyle())}return this._canvasStyle=B},transform:function(v){if(this._type==="gradient"){var s=this._components;for(var p=1,d=s.length;p<d;p++){var _=s[p];v._transformPoint(_,_,!0)}this._changed()}},statics:{_types:t,random:function(){var v=Math.random;return new s0(v(),v(),v())},_setOwner:function(v,s,p){if(v){if(v._owner&&s&&v._owner!==s)v=v.clone();if(!v._owner^!s)v._owner=s||null,v._setter=p||null}return v}}})},new function(){var t={add:function(u,i){return u+i},subtract:function(u,i){return u-i},multiply:function(u,i){return u*i},divide:function(u,i){return u/i}};return k.each(t,function(u,i){this[i]=function(h){h=s0.read(arguments);var f=this._type,g=this._components,x=h._convert(f);for(var v=0,s=g.length;v<s;v++)x[v]=u(g[v],x[v]);return new s0(f,x,this._alpha!=null?u(this._alpha,h.getAlpha()):null)}},{})}),n6=k.extend({_class:"Gradient",initialize:function t(u,i){if(this._id=x0.get(),u&&k.isPlainObject(u))this.set(u),u=i=null;if(this._stops==null)this.setStops(u||["white","black"]);if(this._radial==null)this.setRadial(typeof i==="string"&&i==="radial"||i||!1)},_serialize:function(t,u){return u.add(this,function(){return k.serialize([this._stops,this._radial],t,!0,u)})},_changed:function(){for(var t=0,u=this._owners&&this._owners.length;t<u;t++)this._owners[t]._changed()},_addOwner:function(t){if(!this._owners)this._owners=[];this._owners.push(t)},_removeOwner:function(t){var u=this._owners?this._owners.indexOf(t):-1;if(u!=-1){if(this._owners.splice(u,1),!this._owners.length)this._owners=M}},clone:function(){var t=[];for(var u=0,i=this._stops.length;u<i;u++)t[u]=this._stops[u].clone();return new n6(t,this._radial)},getStops:function(){return this._stops},setStops:function(t){if(t.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var u=this._stops;if(u)for(var i=0,h=u.length;i<h;i++)u[i]._owner=M;u=this._stops=m6.readList(t,0,{clone:!0});for(var i=0,h=u.length;i<h;i++)u[i]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(t){this._radial=t,this._changed()},equals:function(t){if(t===this)return!0;if(t&&this._class===t._class){var u=this._stops,i=t._stops,h=u.length;if(h===i.length){for(var f=0;f<h;f++)if(!u[f].equals(i[f]))return!1;return!0}}return!1}}),m6=k.extend({_class:"GradientStop",initialize:function t(u,i){var h=u,f=i;if(typeof u==="object"&&i===M){if(Array.isArray(u)&&typeof u[0]!=="number")h=u[0],f=u[1];else if("color"in u||"offset"in u||"rampPoint"in u)h=u.color,f=u.offset||u.rampPoint||0}this.setColor(h),this.setOffset(f)},clone:function(){return new m6(this._color.clone(),this._offset)},_serialize:function(t,u){var i=this._color,h=this._offset;return k.serialize(h==null?[i]:[i,h],t,!0,u)},_changed:function(){if(this._owner)this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(t){this._offset=t,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){s0._setOwner(this._color,null),this._color=s0._setOwner(s0.read(arguments,0),this,"setColor"),this._changed()},equals:function(t){return t===this||t&&this._class===t._class&&this._color.equals(t._color)&&this._offset==t._offset||!1}}),x6=k.extend(new function(){var t={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new O,selectedColor:null},u=k.set({},t,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),i=k.set({},u,{fillColor:new s0}),h={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},f={beans:!0},g={_class:"Style",beans:!0,initialize:function x(v,s,p){if(this._values={},this._owner=s,this._project=s&&s._project||p||k0.project,this._defaults=!s||s instanceof v6?u:s instanceof f6?i:t,v)this.set(v)}};return k.each(u,function(x,v){var s=/Color$/.test(v),p=v==="shadowOffset",d=k.capitalize(v),_=h[v],P="set"+d,w="get"+d;g[P]=function(r){var C=this._owner,B=C&&C._children,j=B&&B.length>0&&!(C instanceof O0);if(j)for(var o=0,y=B.length;o<y;o++)B[o]._style[P](r);if((v==="selectedColor"||!j)&&v in this._defaults){var S=this._values[v];if(S!==r){if(s){if(S)s0._setOwner(S,null),S._canvasStyle=null;if(r&&r.constructor===s0)r=s0._setOwner(r,C,j&&P)}if(this._values[v]=r,C)C._changed(_||129)}}},g[w]=function(r){var C=this._owner,B=C&&C._children,j=B&&B.length>0&&!(C instanceof O0),o;if(j&&!r)for(var y=0,S=B.length;y<S;y++){var D=B[y]._style[w]();if(!y)o=D;else if(!k.equals(o,D))return M}else if(v in this._defaults){var o=this._values[v];if(o===M){if(o=this._defaults[v],o&&o.clone)o=o.clone()}else{var G=s?s0:p?O:null;if(G&&!(o&&o.constructor===G))this._values[v]=o=G.read([o],0,{readNull:!0,clone:!0})}}if(o&&s)o=s0._setOwner(o,C,j&&P);return o},f[w]=function(r){return this._style[w](r)},f[P]=function(r){this._style[P](r)}}),k.each({Font:"FontFamily",WindingRule:"FillRule"},function(x,v){var s="get"+v,p="set"+v;g[s]=f[s]="#get"+x,g[p]=f[p]="#set"+x}),d0.inject(f),g},{set:function(t){var u=t instanceof x6,i=u?t._values:t;if(i){for(var h in i)if(h in this._defaults){var f=i[h];this[h]=f&&u&&f.clone?f.clone():f}}},equals:function(t){function u(i,h,f){var g=i._values,x=h._values,v=h._defaults;for(var s in g){var p=g[s],d=x[s];if(!(f&&(s in x))&&!k.equals(p,d===M?v[s]:d))return!1}return!0}return t===this||t&&this._class===t._class&&u(this,t)&&u(t,this,!0)||!1},_dispose:function(){var t=this.getFillColor();if(t)t._canvasStyle=null;if(t=this.getStrokeColor(),t)t._canvasStyle=null;if(t=this.getShadowColor(),t)t._canvasStyle=null},hasFill:function(){var t=this.getFillColor();return!!t&&t.alpha>0},hasStroke:function(){var t=this.getStrokeColor();return!!t&&t.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var t=this.getShadowColor();return!!t&&t.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var t=this.getFontSize();return this.getFontWeight()+" "+t+(/[a-z]/i.test(t+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function t(){var u=t.base.call(this),i=this.getFontSize();if(/pt|em|%|px/.test(i))i=this.getView().getPixelSize(i);return u!=null?u:i*1.2}}),A0=new function(){function t(u,i,h,f){var g=["","webkit","moz","Moz","ms","o"],x=i[0].toUpperCase()+i.substring(1);for(var v=0;v<6;v++){var s=g[v],p=s?s+x:i;if(p in u){if(h)u[p]=f;else return u[p];break}}}return{getStyles:function(u){var i=u&&u.nodeType!==9?u.ownerDocument:u,h=i&&i.defaultView;return h&&h.getComputedStyle(u,"")},getBounds:function(u,i){var h=u.ownerDocument,f=h.body,g=h.documentElement,x;try{x=u.getBoundingClientRect()}catch(d){x={left:0,top:0,width:0,height:0}}var v=x.left-(g.clientLeft||f.clientLeft||0),s=x.top-(g.clientTop||f.clientTop||0);if(!i){var p=h.defaultView;v+=p.pageXOffset||g.scrollLeft||f.scrollLeft,s+=p.pageYOffset||g.scrollTop||f.scrollTop}return new K(v,s,x.width,x.height)},getViewportBounds:function(u){var i=u.ownerDocument,h=i.defaultView,f=i.documentElement;return new K(0,0,h.innerWidth||f.clientWidth,h.innerHeight||f.clientHeight)},getOffset:function(u,i){return A0.getBounds(u,i).getPoint()},getSize:function(u){return A0.getBounds(u,!0).getSize()},isInvisible:function(u){return A0.getSize(u).equals(new f0(0,0))},isInView:function(u){return!A0.isInvisible(u)&&A0.getViewportBounds(u).intersects(A0.getBounds(u,!0))},isInserted:function(u){return H.body.contains(u)},getPrefixed:function(u,i){return u&&t(u,i)},setPrefixed:function(u,i,h){if(typeof i==="object")for(var f in i)t(u,f,!0,i[f]);else t(u,i,!0,h)}}},T0={add:function(t,u){if(t)for(var i in u){var h=u[i],f=i.split(/[\s,]+/g);for(var g=0,x=f.length;g<x;g++){var v=f[g],s=t===H&&(v==="touchstart"||v==="touchmove")?{passive:!1}:!1;t.addEventListener(v,h,s)}}},remove:function(t,u){if(t)for(var i in u){var h=u[i],f=i.split(/[\s,]+/g);for(var g=0,x=f.length;g<x;g++)t.removeEventListener(f[g],h,!1)}},getPoint:function(t){var u=t.targetTouches?t.targetTouches.length?t.targetTouches[0]:t.changedTouches[0]:t;return new O(u.pageX||u.clientX+H.documentElement.scrollLeft,u.pageY||u.clientY+H.documentElement.scrollTop)},getTarget:function(t){return t.target||t.srcElement},getRelatedTarget:function(t){return t.relatedTarget||t.toElement},getOffset:function(t,u){return T0.getPoint(t).subtract(A0.getOffset(u||T0.getTarget(t)))}};T0.requestAnimationFrame=new function(){var t=A0.getPrefixed(F,"requestAnimationFrame"),u=!1,i=[],h;function f(){var g=i;i=[];for(var x=0,v=g.length;x<v;x++)g[x]();if(u=t&&i.length,u)t(f)}return function(g){if(i.push(g),t){if(!u)t(f),u=!0}else if(!h)h=setInterval(f,16.666666666666668)}};var R0=k.extend(u0,{_class:"View",initialize:function t(u,i){function h(_){return i[_]||parseInt(i.getAttribute(_),10)}function f(){var _=A0.getSize(i);return _.isNaN()||_.isZero()?new f0(h("width"),h("height")):_}var g;if(F&&i){if(this._id=i.getAttribute("id"),this._id==null)i.setAttribute("id",this._id="paper-view-"+t._id++);T0.add(i,this._viewEvents);var x="none";if(A0.setPrefixed(i.style,{userDrag:x,userSelect:x,touchCallout:x,contentZooming:x,tapHighlightColor:"rgba(0,0,0,0)"}),i0.hasAttribute(i,"resize")){var v=this;T0.add(F,this._windowEvents={resize:function(){v.setViewSize(f())}})}if(g=f(),i0.hasAttribute(i,"stats")&&typeof Stats!=="undefined"){this._stats=new Stats;var s=this._stats.domElement,p=s.style,d=A0.getOffset(i);p.position="absolute",p.left=d.x+"px",p.top=d.y+"px",H.body.appendChild(s)}}else g=new f0(i),i=null;if(this._project=u,this._scope=u._scope,this._element=i,!this._pixelRatio)this._pixelRatio=F&&F.devicePixelRatio||1;if(this._setElementSize(g.width,g.height),this._viewSize=g,t._views.push(this),t._viewsById[this._id]=this,(this._matrix=new r0)._owner=this,!t._focused)t._focused=this;this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!k0.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;if(R0._focused===this)R0._focused=null;R0._views.splice(R0._views.indexOf(this),1),delete R0._viewsById[this._id];var t=this._project;if(t._view===this)t._view=null;return T0.remove(this._element,this._viewEvents),T0.remove(F,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:k.each(d0._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(t){this[t]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(t){if(this._autoUpdate=t,t)this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var t=this;T0.requestAnimationFrame(function(){if(t._requested=!1,t._animate){t.requestUpdate();var u=t._element;if((!A0.getPrefixed(H,"hidden")||i0.getAttribute(u,"keepalive")==="true")&&A0.isInView(u))t._handleFrame()}if(t._autoUpdate)t.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){k0=this._scope;var t=Date.now()/1000,u=this._last?t-this._last:0;if(this._last=t,this.emit("frame",new k({delta:u,time:this._time+=u,count:this._count++})),this._stats)this._stats.update()},_animateItem:function(t,u){var i=this._frameItems;if(u){if(i[t._id]={item:t,time:0,count:0},++this._frameItemCount===1)this.on("frame",this._handleFrameItems)}else if(delete i[t._id],--this._frameItemCount===0)this.off("frame",this._handleFrameItems)},_handleFrameItems:function(t){for(var u in this._frameItems){var i=this._frameItems[u];i.item.emit("frame",new k(t,{time:i.time+=t.delta,count:i.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=M},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return this._pixelRatio*72},getViewSize:function(){var t=this._viewSize;return new y6(t.width,t.height,this,"setViewSize")},setViewSize:function(){var t=f0.read(arguments),u=t.subtract(this._viewSize);if(u.isZero())return;if(this._setElementSize(t.width,t.height),this._viewSize.set(t),this._changed(),this.emit("resize",{size:t,delta:u}),this._autoUpdate)this.update()},_setElementSize:function(t,u){var i=this._element;if(i){if(i.width!==t)i.width=t;if(i.height!==u)i.height=u}},getBounds:function(){if(!this._bounds)this._bounds=this._matrix.inverted()._transformBounds(new K(new O,this._viewSize));return this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return A0.isInView(this._element)},isInserted:function(){return A0.isInserted(this._element)},getPixelSize:function(t){var u=this._element,i;if(u){var h=u.parentNode,f=H.createElement("div");f.style.fontSize=t,h.appendChild(f),i=parseFloat(A0.getStyles(f).fontSize),h.removeChild(f)}else i=parseFloat(i);return i},getTextWidth:function(t,u){return 0}},k.each(["rotate","scale","shear","skew"],function(t){var u=t==="rotate";this[t]=function(){var i=arguments,h=(u?k:O).read(i),f=O.read(i,0,{readNull:!0});return this.transform(new r0()[t](h,f||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var t=new r0;return this.transform(t.translate.apply(t,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var t=O.read(arguments);this.translate(this.getCenter().subtract(t))},getZoom:function(){var t=this._decompose().scaling;return(t.x+t.y)/2},setZoom:function(t){this.transform(new r0().scale(t/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(t){var u=this.getRotation();if(u!=null&&t!=null)this.rotate(t-u)},getScaling:function(){var t=this._decompose().scaling;return new M0(t.x,t.y,this,"setScaling")},setScaling:function(){var t=this.getScaling(),u=O.read(arguments,0,{clone:!0,readNull:!0});if(t&&u)this.scale(u.x/t.x,u.y/t.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},transform:function(t){this._matrix.append(t)},scrollBy:function(){this.translate(O.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(O.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(O.read(arguments))},getEventPoint:function(t){return this.viewToProject(T0.getOffset(t,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(t,u){if(H&&typeof u==="string")u=H.getElementById(u);var i=F?A6:R0;return new i(t,u)}}},new function(){if(!F)return;var t,u,i=!1,h=!1;function f(A){var a=T0.getTarget(A);return a.getAttribute&&R0._viewsById[a.getAttribute("id")]}function g(){var A=R0._focused;if(!A||!A.isVisible()){for(var a=0,R=R0._views.length;a<R;a++)if((A=R0._views[a]).isVisible()){R0._focused=u=A;break}}}function x(A,a,R){A._handleMouseEvent("mousemove",a,R)}var v=F.navigator,s,p,d;if(v.pointerEnabled||v.msPointerEnabled)s="pointerdown MSPointerDown",p="pointermove MSPointerMove",d="pointerup pointercancel MSPointerUp MSPointerCancel";else if(s="touchstart",p="touchmove",d="touchend touchcancel",!(("ontouchstart"in F)&&v.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)))s+=" mousedown",p+=" mousemove",d+=" mouseup";var _={},P={mouseout:function(A){var a=R0._focused,R=T0.getRelatedTarget(A);if(a&&(!R||R.nodeName==="HTML")){var X=T0.getOffset(A,a._element),e=X.x,Y=Math.abs,U=Y(e),t0=1<<25,y0=U-t0;X.x=Y(y0)<U?y0*(e<0?-1:1):e,x(a,A,a.viewToProject(X))}},scroll:g};_[s]=function(A){var a=R0._focused=f(A);if(!i)i=!0,a._handleMouseEvent("mousedown",A)},P[p]=function(A){var a=R0._focused;if(!h){var R=f(A);if(R){if(a!==R){if(a)x(a,A);if(!t)t=a;a=R0._focused=u=R}}else if(u&&u===a){if(t&&!t.isInserted())t=null;a=R0._focused=t,t=null,g()}}if(a)x(a,A)},P[s]=function(){h=!0},P[d]=function(A){var a=R0._focused;if(a&&i)a._handleMouseEvent("mouseup",A);h=i=!1},T0.add(H,P),T0.add(F,{load:g});var w=!1,r=!1,C={doubleclick:"click",mousedrag:"mousemove"},B=!1,j,o,y,S,D,G,c,L,z;function V(A,a,R,X,e,Y,U){var t0=!1,y0;function v0(b0,h0){if(b0.responds(h0)){if(!y0)y0=new u4(h0,X,e,a||b0,Y?e.subtract(Y):null);if(b0.emit(h0,y0)){if(w=!0,y0.prevented)r=!0;if(y0.stopped)return t0=!0}}else{var j0=C[h0];if(j0)return v0(b0,j0)}}while(A&&A!==U){if(v0(A,R))break;A=A._parent}return t0}function N(A,a,R,X,e,Y){return A._project.removeOn(R),r=w=!1,G&&V(G,null,R,X,e,Y)||a&&a!==G&&!a.isDescendant(G)&&V(a,null,R==="mousedrag"?"mousemove":R,X,e,Y,G)||V(A,G||a||A,R,X,e,Y)}var q={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:_,_handleMouseEvent:function(A,a,R){var X=this._itemEvents,e=X.native[A],Y=A==="mousemove",U=this._scope.tool,t0=this;function y0(o0){return X.virtual[o0]||t0.responds(o0)||U&&U.responds(o0)}if(Y&&i&&y0("mousedrag"))A="mousedrag";if(!R)R=this.getEventPoint(a);var v0=this.getBounds().contains(R),b0=e&&v0&&t0._project.hitTest(R,{tolerance:0,fill:!0,stroke:!0}),h0=b0&&b0.item||null,j0=!1,p0={};if(p0[A.substr(5)]=!0,e&&h0!==D){if(D)V(D,null,"mouseleave",a,R);if(h0)V(h0,null,"mouseenter",a,R);D=h0}if(B^v0)V(this,null,v0?"mouseenter":"mouseleave",a,R),j=v0?this:null,j0=!0;if((v0||p0.drag)&&!R.equals(y))N(this,h0,Y?A:"mousemove",a,R,y),j0=!0;if(B=v0,p0.down&&v0||p0.up&&o){if(N(this,h0,A,a,R,o),p0.down){if(z=h0===c&&Date.now()-L<300,S=c=h0,!r&&h0){var V0=h0;while(V0&&!V0.responds("mousedrag"))V0=V0._parent;if(V0)G=h0}o=R}else if(p0.up){if(!r&&h0===S)L=Date.now(),N(this,h0,z?"doubleclick":"click",a,R,o),z=!1;S=G=null}B=!1,j0=!0}if(y=R,j0&&U)w=U._handleMouseEvent(A,a,R,p0)||w;if(a.cancelable!==!1&&(w&&!p0.move||p0.down&&y0("mouseup")))a.preventDefault()},_handleKeyEvent:function(A,a,R,X){var e=this._scope,Y=e.tool,U;function t0(y0){if(y0.responds(A))k0=e,y0.emit(A,U=U||new t4(A,a,R,X))}if(this.isVisible()){if(t0(this),Y&&Y.responds(A))t0(Y)}},_countItemEvent:function(A,a){var R=this._itemEvents,X=R.native,e=R.virtual;for(var Y in q)X[Y]=(X[Y]||0)+(q[Y][A]||0)*a;e[A]=(e[A]||0)+a},statics:{updateFocus:g,_resetState:function(){i=h=w=B=!1,t=u=j=o=y=S=D=G=c=L=z=null}}}}),A6=R0.extend({_class:"CanvasView",initialize:function t(u,i){if(!(i instanceof F.HTMLCanvasElement)){var h=f0.read(arguments,1);if(h.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+k.slice(arguments,1));i=U0.getCanvas(h)}var f=this._context=i.getContext("2d");if(f.save(),this._pixelRatio=1,!/^off|false$/.test(i0.getAttribute(i,"hidpi"))){var g=F.devicePixelRatio||1,x=A0.getPrefixed(f,"backingStorePixelRatio")||1;this._pixelRatio=g/x}R0.call(this,u,i),this._needsUpdate=!0},remove:function t(){return this._context.restore(),t.base.call(this)},_setElementSize:function t(u,i){var h=this._pixelRatio;if(t.base.call(this,u*h,i*h),h!==1){var f=this._element,g=this._context;if(!i0.hasAttribute(f,"resize")){var x=f.style;x.width=u+"px",x.height=i+"px"}g.restore(),g.save(),g.scale(h,h)}},getContext:function(){return this._context},getPixelSize:function t(u){var i=k0.agent,h;if(i&&i.firefox)h=t.base.call(this,u);else{var f=this._context,g=f.font;f.font=u+" serif",h=parseFloat(f.font),f.font=g}return h},getTextWidth:function(t,u){var i=this._context,h=i.font,f=0;i.font=t;for(var g=0,x=u.length;g<x;g++)f=Math.max(f,i.measureText(u[g]).width);return i.font=h,f},update:function(){if(!this._needsUpdate)return!1;var t=this._project,u=this._context,i=this._viewSize;if(u.clearRect(0,0,i.width+1,i.height+1),t)t.draw(u,this._matrix,this._pixelRatio);return this._needsUpdate=!1,!0}}),I6=k.extend({_class:"Event",initialize:function t(u){this.event=u,this.type=u&&u.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return F6.modifiers}}),t4=I6.extend({_class:"KeyEvent",initialize:function t(u,i,h,f){this.type=u,this.event=i,this.key=h,this.character=f},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),F6=new function(){var t={"\t":"tab"," ":"space","\b":"backspace","\x7F":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},u={tab:"\t",space:" ",enter:"\r"},i={},h={},f,g,x=new k({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var p=k0&&k0.agent;return p&&p.mac?this.meta:this.control}}});function v(p){var d=p.key||p.keyIdentifier;return d=/^U\+/.test(d)?String.fromCharCode(parseInt(d.substr(2),16)):/^Arrow[A-Z]/.test(d)?d.substr(5):d==="Unidentified"||d===M?String.fromCharCode(p.keyCode):d,t[d]||(d.length>1?k.hyphenate(d):d.toLowerCase())}function s(p,d,_,P){var w=p?"keydown":"keyup",r=R0._focused,C;if(i[d]=p,p)h[d]=_;else delete h[d];if(d.length>1&&(C=k.camelize(d))in x){x[C]=p;var B=k0&&k0.agent;if(C==="meta"&&B&&B.mac)if(p)f={};else{for(var j in f)if(j in h)s(!1,j,f[j],P);f=null}}else if(p&&f)f[d]=_;if(r)r._handleKeyEvent(p?"keydown":"keyup",P,d,_)}return T0.add(H,{keydown:function(p){var d=v(p),_=k0&&k0.agent;if(d.length>1||_&&(_.chrome&&(p.altKey||_.mac&&p.metaKey||!_.mac&&p.ctrlKey)))s(!0,d,u[d]||(d.length>1?"":d),p);else g=d},keypress:function(p){if(g){var d=v(p),_=p.charCode,P=_>=32?String.fromCharCode(_):d.length>1?"":d;if(d!==g)d=P.toLowerCase();s(!0,d,P,p),g=null}},keyup:function(p){var d=v(p);if(d in h)s(!1,d,h[d],p)}}),T0.add(F,{blur:function(p){for(var d in h)s(!1,d,h[d],p)}}),{modifiers:x,isDown:function(p){return!!i[p]}}},u4=I6.extend({_class:"MouseEvent",initialize:function t(u,i,h,f,g){this.type=u,this.event=i,this.point=h,this.target=f,this.delta=g},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),W5=I6.extend({_class:"ToolEvent",_item:null,initialize:function t(u,i,h){this.tool=u,this.type=i,this.event=h},_choosePoint:function(t,u){return t?t:u?u.clone():null},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(t){this._point=t},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(t){this._lastPoint=t},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(t){this._downPoint=t},getMiddlePoint:function(){if(!this._middlePoint&&this.tool._lastPoint)return this.tool._point.add(this.tool._lastPoint).divide(2);return this._middlePoint},setMiddlePoint:function(t){this._middlePoint=t},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(t){this._delta=t},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(t){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=t},getItem:function(){if(!this._item){var t=this.tool._scope.project.hitTest(this.getPoint());if(t){var u=t.item,i=u._parent;while(/^(Group|CompoundPath)$/.test(i._class))u=i,i=i._parent;this._item=u}}return this._item},setItem:function(t){this._item=t},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),i3=P0.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function t(u){P0.call(this),this._moveCount=-1,this._downCount=-1,this.set(u)},getMinDistance:function(){return this._minDistance},setMinDistance:function(t){if(this._minDistance=t,t!=null&&this._maxDistance!=null&&t>this._maxDistance)this._maxDistance=t},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(t){if(this._maxDistance=t,this._minDistance!=null&&t!=null&&t<this._minDistance)this._minDistance=t},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(t){this._minDistance=this._maxDistance=t},_handleMouseEvent:function(t,u,i,h){if(k0=this._scope,h.drag&&!this.responds(t))t="mousemove";var f=h.move||h.drag,g=this.responds(t),x=this.minDistance,v=this.maxDistance,s=!1,p=this;function d(P,w){var r=i,C=f?p._point:p._downPoint||r;if(f){if(p._moveCount>=0&&r.equals(C))return!1;if(C&&(P!=null||w!=null)){var B=r.subtract(C),j=B.getLength();if(j<(P||0))return!1;if(w)r=C.add(B.normalize(Math.min(j,w)))}p._moveCount++}if(p._point=r,p._lastPoint=C||r,h.down)p._moveCount=-1,p._downPoint=r,p._downCount++;return!0}function _(){if(g)s=p.emit(t,new W5(p,t,u))||s}if(h.down)d(),_();else if(h.up)d(null,v),_();else if(g)while(d(x,v))_();return s}}),U5=k.extend(u0,{_class:"Tween",statics:{easings:new k({linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<0.5?2*t*t:-1+2*(2-t)*t},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<0.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<0.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<0.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}})},initialize:function t(u,i,h,f,g,x){this.object=u;var v=typeof g,s=v==="function";this.type=s?v:v==="string"?g:"linear",this.easing=s?g:t.easings[this.type],this.duration=f,this.running=!1,this._then=null,this._startTime=null;var p=i||h;if(this._keys=p?Object.keys(p):[],this._parsedKeys=this._parseKeys(this._keys),this._from=p&&this._getState(i),this._to=p&&this._getState(h),x!==!1)this.start()},then:function(t){return this._then=t,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(t){if(this.running){if(t>=1)t=1,this.running=!1;var u=this.easing(t),i=this._keys,h=function(d){return typeof d==="function"?d(u,t):d};for(var f=0,g=i&&i.length;f<g;f++){var x=i[f],v=h(this._from[x]),s=h(this._to[x]),p=v&&s&&v.__add&&s.__add?s.__subtract(v).__multiply(u).__add(v):(s-v)*u+v;this._setProperty(this._parsedKeys[x],p)}if(this.responds("update"))this.emit("update",new k({progress:t,factor:u}));if(!this.running&&this._then)this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(t){var u=this._startTime,i=u?(t-u)/this.duration:0;if(!u)this._startTime=t;this.update(i)},_getState:function(t){var u=this._keys,i={};for(var h=0,f=u.length;h<f;h++){var g=u[h],x=this._parsedKeys[g],v=this._getProperty(x),s;if(t){var p=this._resolveValue(v,t[g]);this._setProperty(x,p),s=this._getProperty(x),s=s&&s.clone?s.clone():s,this._setProperty(x,v)}else s=v&&v.clone?v.clone():v;i[g]=s}return i},_resolveValue:function(t,u){if(u){if(Array.isArray(u)&&u.length===2){var i=u[0];return i&&i.match&&i.match(/^[+\-\*\/]=/)?this._calculate(t,i[0],u[1]):u}else if(typeof u==="string"){var h=u.match(/^[+\-*/]=(.*)/);if(h){var f=JSON.parse(h[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(t,u[0],f)}}}return u},_calculate:function(t,u,i){return k0.PaperScript.calculateBinary(t,u,i)},_parseKeys:function(t){var u={};for(var i=0,h=t.length;i<h;i++){var f=t[i],g=f.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");u[f]=g.split("/")}return u},_getProperty:function(t,u){var i=this.object;for(var h=0,f=t.length-(u||0);h<f&&i;h++)i=i[t[h]];return i},_setProperty:function(t,u){var i=this._getProperty(t,1);if(i)i[t[t.length-1]]=u}}),Z5={request:function(t){var u=new E.XMLHttpRequest;if(u.open((t.method||"get").toUpperCase(),t.url,k.pick(t.async,!0)),t.mimeType)u.overrideMimeType(t.mimeType);return u.onload=function(){var i=u.status;if(i===0||i===200){if(t.onLoad)t.onLoad.call(u,u.responseText)}else u.onerror()},u.onerror=function(){var i=u.status,h='Could not load "'+t.url+'" (Status: '+i+")";if(t.onError)t.onError(h,i);else throw new Error(h)},u.send(null)}},U0=k.exports.CanvasProvider={canvases:[],getCanvas:function(t,u,i){if(!F)return null;var h,f=!0;if(typeof t==="object")u=t.height,t=t.width;if(this.canvases.length)h=this.canvases.pop();else h=H.createElement("canvas"),f=!1;var g=h.getContext("2d",i||{});if(!g)throw new Error("Canvas "+h+" is unable to provide a 2D context.");if(h.width===t&&h.height===u){if(f)g.clearRect(0,0,t+1,u+1)}else h.width=t,h.height=u;return g.save(),h},getContext:function(t,u,i){var h=this.getCanvas(t,u,i);return h?h.getContext("2d",i||{}):null},release:function(t){var u=t&&t.canvas?t.canvas:t;if(u&&u.getContext)u.getContext("2d").restore(),this.canvases.push(u)}},d4=new function(){var{min:t,max:u,abs:i}=Math,h,f,g,x,v,s,p,d,_,P,w;function r(D,G,c){return 0.2989*D+0.587*G+0.114*c}function C(D,G,c,V){var z=V-r(D,G,c);_=D+z,P=G+z,w=c+z;var V=r(_,P,w),N=t(_,P,w),q=u(_,P,w);if(N<0){var A=V-N;_=V+(_-V)*V/A,P=V+(P-V)*V/A,w=V+(w-V)*V/A}if(q>255){var a=255-V,R=q-V;_=V+(_-V)*a/R,P=V+(P-V)*a/R,w=V+(w-V)*a/R}}function B(D,G,c){return u(D,G,c)-t(D,G,c)}function j(D,G,c,L){var z=[D,G,c],V=u(D,G,c),N=t(D,G,c),q;if(N=N===D?0:N===G?1:2,V=V===D?0:V===G?1:2,q=t(N,V)===0?u(N,V)===1?2:1:0,z[V]>z[N])z[q]=(z[q]-z[N])*L/(z[V]-z[N]),z[V]=L;else z[q]=z[V]=0;z[N]=0,_=z[0],P=z[1],w=z[2]}var o={multiply:function(){_=v*h/255,P=s*f/255,w=p*g/255},screen:function(){_=v+h-v*h/255,P=s+f-s*f/255,w=p+g-p*g/255},overlay:function(){_=v<128?2*v*h/255:255-2*(255-v)*(255-h)/255,P=s<128?2*s*f/255:255-2*(255-s)*(255-f)/255,w=p<128?2*p*g/255:255-2*(255-p)*(255-g)/255},"soft-light":function(){var D=h*v/255;_=D+v*(255-(255-v)*(255-h)/255-D)/255,D=f*s/255,P=D+s*(255-(255-s)*(255-f)/255-D)/255,D=g*p/255,w=D+p*(255-(255-p)*(255-g)/255-D)/255},"hard-light":function(){_=h<128?2*h*v/255:255-2*(255-h)*(255-v)/255,P=f<128?2*f*s/255:255-2*(255-f)*(255-s)/255,w=g<128?2*g*p/255:255-2*(255-g)*(255-p)/255},"color-dodge":function(){_=v===0?0:h===255?255:t(255,255*v/(255-h)),P=s===0?0:f===255?255:t(255,255*s/(255-f)),w=p===0?0:g===255?255:t(255,255*p/(255-g))},"color-burn":function(){_=v===255?255:h===0?0:u(0,255-(255-v)*255/h),P=s===255?255:f===0?0:u(0,255-(255-s)*255/f),w=p===255?255:g===0?0:u(0,255-(255-p)*255/g)},darken:function(){_=v<h?v:h,P=s<f?s:f,w=p<g?p:g},lighten:function(){_=v>h?v:h,P=s>f?s:f,w=p>g?p:g},difference:function(){if(_=v-h,_<0)_=-_;if(P=s-f,P<0)P=-P;if(w=p-g,w<0)w=-w},exclusion:function(){_=v+h*(255-v-v)/255,P=s+f*(255-s-s)/255,w=p+g*(255-p-p)/255},hue:function(){j(h,f,g,B(v,s,p)),C(_,P,w,r(v,s,p))},saturation:function(){j(v,s,p,B(h,f,g)),C(_,P,w,r(v,s,p))},luminosity:function(){C(v,s,p,r(h,f,g))},color:function(){C(h,f,g,r(v,s,p))},add:function(){_=t(v+h,255),P=t(s+f,255),w=t(p+g,255)},subtract:function(){_=u(v-h,0),P=u(s-f,0),w=u(p-g,0)},average:function(){_=(v+h)/2,P=(s+f)/2,w=(p+g)/2},negation:function(){_=255-i(255-h-v),P=255-i(255-f-s),w=255-i(255-g-p)}},y=this.nativeModes=k.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(D){this[D]=!0},{}),S=U0.getContext(1,1,{willReadFrequently:!0});if(S)k.each(o,function(D,G){var c=G==="darken",L=!1;S.save();try{if(S.fillStyle=c?"#300":"#a00",S.fillRect(0,0,1,1),S.globalCompositeOperation=G,S.globalCompositeOperation===G)S.fillStyle=c?"#a00":"#300",S.fillRect(0,0,1,1),L=S.getImageData(0,0,1,1).data[0]!==c?170:51}catch(z){}S.restore(),y[G]=L}),U0.release(S);this.process=function(D,G,c,L,z){var V=G.canvas,N=D==="normal";if(N||y[D]){if(c.save(),c.setTransform(1,0,0,1,0,0),c.globalAlpha=L,!N)c.globalCompositeOperation=D;c.drawImage(V,z.x,z.y),c.restore()}else{var q=o[D];if(!q)return;var A=c.getImageData(z.x,z.y,V.width,V.height),a=A.data,R=G.getImageData(0,0,V.width,V.height).data;for(var X=0,e=a.length;X<e;X+=4){h=R[X],v=a[X],f=R[X+1],s=a[X+1],g=R[X+2],p=a[X+2],x=R[X+3],d=a[X+3],q();var Y=x*L/255,U=1-Y;a[X]=Y*_+U*v,a[X+1]=Y*P+U*s,a[X+2]=Y*w+U*p,a[X+3]=x*L+U*d}c.putImageData(A,z.x,z.y)}}},H0=new function(){var t="http://www.w3.org/2000/svg",u="http://www.w3.org/2000/xmlns",i="http://www.w3.org/1999/xlink",h={href:i,xlink:u,xmlns:u+"/","xmlns:xlink":u+"/"};function f(v,s,p){return x(H.createElementNS(t,v),s,p)}function g(v,s){var p=h[s],d=p?v.getAttributeNS(p,s):v.getAttribute(s);return d==="null"?null:d}function x(v,s,p){for(var d in s){var _=s[d],P=h[d];if(typeof _==="number"&&p)_=p.number(_);if(P)v.setAttributeNS(P,d,_);else v.setAttribute(d,_)}return v}return{svg:t,xmlns:u,xlink:i,create:f,get:g,set:x}},X4=k.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(t,u){return!u&&(t instanceof e0||t instanceof g0||t instanceof f6)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(t,u){var i=k.capitalize(u),h=t[2];this[u]={type:t[1],property:u,attribute:t[0],toSVG:h,fromSVG:h&&k.each(h,function(f,g){this[f]=g},{}),exportFilter:t[3],get:"get"+i,set:"set"+i}},{});new function(){var t;function u(o,y,S){var D=new k,G=o.getTranslation();if(y){var c;if(o.isInvertible())o=o._shiftless(),c=o._inverseTransform(G),G=null;else c=new O;D[S?"cx":"x"]=c.x,D[S?"cy":"y"]=c.y}if(!o.isIdentity()){var L=o.decompose();if(L){var z=[],V=L.rotation,N=L.scaling,q=L.skewing;if(G&&!G.isZero())z.push("translate("+t.point(G)+")");if(V)z.push("rotate("+t.number(V)+")");if(!Q.isZero(N.x-1)||!Q.isZero(N.y-1))z.push("scale("+t.point(N)+")");if(q.x)z.push("skewX("+t.number(q.x)+")");if(q.y)z.push("skewY("+t.number(q.y)+")");D.transform=z.join(" ")}else D.transform="matrix("+o.getValues().join(",")+")"}return D}function i(o,y){var S=u(o._matrix),D=o._children,G=H0.create("g",S,t);for(var c=0,L=D.length;c<L;c++){var z=D[c],V=B(z,y);if(V)if(z.isClipMask()){var N=H0.create("clipPath");N.appendChild(V),r(z,N,"clip"),H0.set(G,{"clip-path":"url(#"+N.id+")"})}else G.appendChild(V)}return G}function h(o,y){var S=u(o._matrix,!0),D=o.getSize(),G=o.getImage();return S.x-=D.width/2,S.y-=D.height/2,S.width=D.width,S.height=D.height,S.href=y.embedImages==!1&&G&&G.src||o.toDataURL(),H0.create("image",S,t)}function f(o,y){var S=y.matchShapes;if(S){var D=o.toShape(!1);if(D)return g(D,y)}var G=o._segments,c=G.length,L,z=u(o._matrix);if(S&&c>=2&&!o.hasHandles())if(c>2){L=o._closed?"polygon":"polyline";var V=[];for(var N=0;N<c;N++)V.push(t.point(G[N]._point));z.points=V.join(" ")}else{L="line";var q=G[0]._point,A=G[1]._point;z.set({x1:q.x,y1:q.y,x2:A.x,y2:A.y})}else L="path",z.d=o.getPathData(null,y.precision);return H0.create(L,z,t)}function g(o){var{_type:y,_radius:S}=o,D=u(o._matrix,!0,y!=="rectangle");if(y==="rectangle"){y="rect";var G=o._size,c=G.width,L=G.height;if(D.x-=c/2,D.y-=L/2,D.width=c,D.height=L,S.isZero())S=null}if(S)if(y==="circle")D.r=S;else D.rx=S.width,D.ry=S.height;return H0.create(y,D,t)}function x(o,y){var S=u(o._matrix),D=o.getPathData(null,y.precision);if(D)S.d=D;return H0.create("path",S,t)}function v(o,y){var S=u(o._matrix,!0),D=o._definition,G=w(D,"symbol"),c=D._item,L=c.getStrokeBounds();if(!G)G=H0.create("symbol",{viewBox:t.rectangle(L)}),G.appendChild(B(c,y)),r(D,G,"symbol");return S.href="#"+G.id,S.x+=L.x,S.y+=L.y,S.width=L.width,S.height=L.height,S.overflow="visible",H0.create("use",S,t)}function s(o){var y=w(o,"color");if(!y){var S=o.getGradient(),D=S._radial,G=o.getOrigin(),c=o.getDestination(),L;if(D){L={cx:G.x,cy:G.y,r:G.getDistance(c)};var z=o.getHighlight();if(z)L.fx=z.x,L.fy=z.y}else L={x1:G.x,y1:G.y,x2:c.x,y2:c.y};L.gradientUnits="userSpaceOnUse",y=H0.create((D?"radial":"linear")+"Gradient",L,t);var V=S._stops;for(var N=0,q=V.length;N<q;N++){var A=V[N],a=A._color,R=a.getAlpha(),X=A._offset;if(L={offset:X==null?N/(q-1):X},a)L["stop-color"]=a.toCSS(!0);if(R<1)L["stop-opacity"]=R;y.appendChild(H0.create("stop",L,t))}r(o,y,"color")}return"url(#"+y.id+")"}function p(o){var y=H0.create("text",u(o._matrix,!0),t);return y.textContent=o._content,y}var d={Group:i,Layer:i,Raster:h,Path:f,Shape:g,CompoundPath:x,SymbolItem:v,PointText:p};function _(o,y,S){var D={},G=!S&&o.getParent(),c=[];if(o._name!=null)D.id=o._name;if(k.each(X4,function(L){var{get:z,type:V}=L,N=o[z]();if(L.exportFilter?L.exportFilter(o,N):!G||!k.equals(G[z](),N)){if(V==="color"&&N!=null){var q=N.getAlpha();if(q<1)D[L.attribute+"-opacity"]=q}if(V==="style")c.push(L.attribute+": "+N);else D[L.attribute]=N==null?"none":V==="color"?N.gradient?s(N,o):N.toCSS(!0):V==="array"?N.join(","):V==="lookup"?L.toSVG[N]:N}}),c.length)D.style=c.join(";");if(D.opacity===1)delete D.opacity;if(!o._visible)D.visibility="hidden";return H0.set(y,D,t)}var P;function w(o,y){if(!P)P={ids:{},svgs:{}};return o&&P.svgs[y+"-"+(o._id||o.__id||(o.__id=x0.get("svg")))]}function r(o,y,S){if(!P)w();var D=P.ids[S]=(P.ids[S]||0)+1;y.id=S+"-"+D,P.svgs[S+"-"+(o._id||o.__id)]=y}function C(o,y){var S=o,D=null;if(P){S=o.nodeName.toLowerCase()==="svg"&&o;for(var G in P.svgs){if(!D){if(!S)S=H0.create("svg"),S.appendChild(o);D=S.insertBefore(H0.create("defs"),S.firstChild)}D.appendChild(P.svgs[G])}P=null}return y.asString?new E.XMLSerializer().serializeToString(S):S}function B(o,y,S){var D=d[o._class],G=D&&D(o,y);if(G){var c=y.onExport;if(c)G=c(o,G,y)||G;var L=JSON.stringify(o._data);if(L&&L!=="{}"&&L!=="null")G.setAttribute("data-paper-data",L)}return G&&_(o,G,S)}function j(o){if(!o)o={};return t=new S0(o.precision),o}d0.inject({exportSVG:function(o){return o=j(o),C(B(this,o,!0),o)}}),Z0.inject({exportSVG:function(o){o=j(o);var y=this._children,S=this.getView(),D=k.pick(o.bounds,"view"),G=o.matrix||D==="view"&&S._matrix,c=G&&r0.read([G]),L=D==="view"?new K([0,0],S.getViewSize()):D==="content"?d0._getBounds(y,c,{stroke:!0}).rect:K.read([D],0,{readNull:!0}),z={version:"1.1",xmlns:H0.svg,"xmlns:xlink":H0.xlink};if(L){if(z.width=L.width,z.height=L.height,L.x||L.x===0||L.y||L.y===0)z.viewBox=t.rectangle(L)}var V=H0.create("svg",z,t),N=V;if(c&&!c.isIdentity())N=V.appendChild(H0.create("g",u(c),t));for(var q=0,A=y.length;q<A;q++)N.appendChild(B(y[q],o,!0));return C(V,o)}})},new function(){var t={},u;function i(y,S,D,G,c,L){var z=H0.get(y,S)||L,V=z==null?G?null:D?"":0:D?z:parseFloat(z);return/%\s*$/.test(z)?V/100*(c?1:u[/x|^width/.test(S)?"width":"height"]):V}function h(y,S,D,G,c,L,z){return S=i(y,S||"x",!1,G,c,L),D=i(y,D||"y",!1,G,c,z),G&&(S==null||D==null)?null:new O(S,D)}function f(y,S,D,G,c){return S=i(y,S||"width",!1,G,c),D=i(y,D||"height",!1,G,c),G&&(S==null||D==null)?null:new f0(S,D)}function g(y,S,D){return y==="none"?null:S==="number"?parseFloat(y):S==="array"?y?y.split(/[\s,]+/g).map(parseFloat):[]:S==="color"?B(y)||y:S==="lookup"?D[y]:y}function x(y,S,D,G){var c=y.childNodes,L=S==="clippath",z=S==="defs",V=new v6,N=V._project,q=N._currentStyle,A=[];if(!L&&!z)V=C(V,y,G),N._currentStyle=V._style.clone();if(G){var a=y.querySelectorAll("defs");for(var R=0,X=a.length;R<X;R++)j(a[R],D,!1)}for(var R=0,X=c.length;R<X;R++){var e=c[R],Y;if(e.nodeType===1&&!/^defs$/i.test(e.nodeName)&&(Y=j(e,D,!1))&&!(Y instanceof W))A.push(Y)}if(V.addChildren(A),L)V=C(V.reduce(),y,G);if(N._currentStyle=q,L||z)V.remove(),V=null;return V}function v(y,S){var D=y.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),G=[];for(var c=0,L=D.length;c<L;c+=2)G.push(new O(parseFloat(D[c]),parseFloat(D[c+1])));var z=new w0(G);if(S==="polygon")z.closePath();return z}function s(y){return e0.create(y.getAttribute("d"))}function p(y,S){var D=(i(y,"href",!0)||"").substring(1),G=S==="radialgradient",c;if(D){if(c=t[D].getGradient(),c._radial^G)c=c.clone(),c._radial=G}else{var L=y.childNodes,z=[];for(var V=0,N=L.length;V<N;V++){var q=L[V];if(q.nodeType===1)z.push(C(new m6,q))}c=new n6(z,G)}var A,a,R,X=i(y,"gradientUnits",!0)!=="userSpaceOnUse";if(G)A=h(y,"cx","cy",!1,X,"50%","50%"),a=A.add(i(y,"r",!1,!1,X,"50%"),0),R=h(y,"fx","fy",!0,X);else A=h(y,"x1","y1",!1,X,"0%","0%"),a=h(y,"x2","y2",!1,X,"100%","0%");var e=C(new s0(c,A,a,R),y);return e._scaleToBounds=X,null}var d={"#document":function(y,S,D,G){var c=y.childNodes;for(var L=0,z=c.length;L<z;L++){var V=c[L];if(V.nodeType===1)return j(V,D,G)}},g:x,svg:x,clippath:x,polygon:v,polyline:v,path:s,lineargradient:p,radialgradient:p,image:function(y){var S=new J(i(y,"href",!0));return S.on("load",function(){var D=f(y);this.setSize(D);var G=h(y).add(D.divide(2));this._matrix.append(new r0().translate(G))}),S},symbol:function(y,S,D,G){return new W(x(y,S,D,G),!0)},defs:x,use:function(y){var S=(i(y,"href",!0)||"").substring(1),D=t[S],G=h(y);return D?D instanceof W?D.place(G):D.clone().translate(G):null},circle:function(y){return new g0.Circle(h(y,"cx","cy"),i(y,"r"))},ellipse:function(y){return new g0.Ellipse({center:h(y,"cx","cy"),radius:f(y,"rx","ry")})},rect:function(y){return new g0.Rectangle(new K(h(y),f(y)),f(y,"rx","ry"))},line:function(y){return new w0.Line(h(y,"x1","y1"),h(y,"x2","y2"))},text:function(y){var S=new W0(h(y).add(h(y,"dx","dy")));return S.setContent(y.textContent.trim()||""),S},switch:x};function _(y,S,D,G){if(y.transform){var c=(G.getAttribute(D)||"").split(/\)\s*/g),L=new r0;for(var z=0,V=c.length;z<V;z++){var N=c[z];if(!N)break;var q=N.split(/\(\s*/),A=q[0],a=q[1].split(/[\s,]+/g);for(var R=0,X=a.length;R<X;R++)a[R]=parseFloat(a[R]);switch(A){case"matrix":L.append(new r0(a[0],a[1],a[2],a[3],a[4],a[5]));break;case"rotate":L.rotate(a[0],a[1]||0,a[2]||0);break;case"translate":L.translate(a[0],a[1]||0);break;case"scale":L.scale(a);break;case"skewX":L.skew(a[0],0);break;case"skewY":L.skew(0,a[0]);break}}y.transform(L)}}function P(y,S,D){var G=D==="fill-opacity"?"getFillColor":"getStrokeColor",c=y[G]&&y[G]();if(c)c.setAlpha(parseFloat(S))}var w=k.set(k.each(X4,function(y){this[y.attribute]=function(S,D){if(S[y.set]){if(S[y.set](g(D,y.type,y.fromSVG)),y.type==="color"){var G=S[y.get]();if(G){if(G._scaleToBounds){var c=S.getBounds();G.transform(new r0().translate(c.getPoint()).scale(c.getSize()))}}}}}},{}),{id:function(y,S){if(t[S]=y,y.setName)y.setName(S)},"clip-path":function(y,S){var D=B(S);if(D)if(D=D.clone(),D.setClipMask(!0),y instanceof v6)y.insertChild(0,D);else return new v6(D,y)},gradientTransform:_,transform:_,"fill-opacity":P,"stroke-opacity":P,visibility:function(y,S){if(y.setVisible)y.setVisible(S==="visible")},display:function(y,S){if(y.setVisible)y.setVisible(S!==null)},"stop-color":function(y,S){if(y.setColor)y.setColor(S)},"stop-opacity":function(y,S){if(y._color)y._color.setAlpha(parseFloat(S))},offset:function(y,S){if(y.setOffset){var D=S.match(/(.*)%$/);y.setOffset(D?D[1]/100:parseFloat(S))}},viewBox:function(y,S,D,G,c){var L=new K(g(S,"array")),z=f(G,null,null,!0),V,N;if(y instanceof v6){var q=z?z.divide(L.getSize()):1,N=new r0().scale(q).translate(L.getPoint().negate());V=y}else if(y instanceof W){if(z)L.setSize(z);V=y._item}if(V){if(r(G,"overflow",c)!=="visible"){var A=new g0.Rectangle(L);A.setClipMask(!0),V.addChild(A)}if(N)V.transform(N)}}});function r(y,S,D){var G=y.attributes[S],c=G&&G.value;if(!c&&y.style){var L=k.camelize(S);if(c=y.style[L],!c&&D.node[L]!==D.parent[L])c=D.node[L]}return!c?M:c==="none"?null:c}function C(y,S,D){var G=S.parentNode,c={node:A0.getStyles(S)||{},parent:!D&&!/^defs$/i.test(G.tagName)&&A0.getStyles(G)||{}};return k.each(w,function(L,z){var V=r(S,z,c);y=V!==M&&L(y,V,z,S,c)||y}),y}function B(y){var S=y&&y.match(/\((?:["'#]*)([^"')]+)/),D=S&&S[1],G=D&&t[F?D.replace(F.location.href.split("#")[0]+"#",""):D];if(G&&G._scaleToBounds)G=G.clone(),G._scaleToBounds=!0;return G}function j(y,S,D){var G=y.nodeName.toLowerCase(),c=G!=="#document",L=H.body,z,V,N;if(D&&c)u=k0.getView().getSize(),u=f(y,null,null,!0)||u,z=H0.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),V=y.parentNode,N=y.nextSibling,z.appendChild(y),L.appendChild(z);var q=k0.settings,A=q.applyMatrix,a=q.insertItems;q.applyMatrix=!1,q.insertItems=!1;var R=d[G],X=R&&R(y,G,S,D)||null;if(q.insertItems=a,q.applyMatrix=A,X){if(c&&!(X instanceof v6))X=C(X,y,D);var e=S.onImport,Y=c&&y.getAttribute("data-paper-data");if(e)X=e(y,X,S)||X;if(S.expandShapes&&X instanceof g0)X.remove(),X=X.toPath();if(Y)X._data=JSON.parse(Y)}if(z){if(L.removeChild(z),V)if(N)V.insertBefore(y,N);else V.appendChild(y)}if(D){if(t={},X&&k.pick(S.applyMatrix,A))X.matrix.apply(!0,!0)}return X}function o(y,S,D){if(!y)return null;S=typeof S==="function"?{onLoad:S}:S||{};var G=k0,c=null;function L(q){try{var A=typeof q==="object"?q:new E.DOMParser().parseFromString(q.trim(),"image/svg+xml");if(!A.nodeName)throw A=null,new Error("Unsupported SVG source: "+y);if(k0=G,c=j(A,S,!0),!S||S.insert!==!1)D._insertItem(M,c);var a=S.onLoad;if(a)a(c,q)}catch(R){z(R)}}function z(q,A){var a=S.onError;if(a)a(q,A);else throw new Error(q)}if(typeof y==="string"&&!/^[\s\S]*</.test(y)){var V=H.getElementById(y);if(V)L(V);else Z5.request({url:y,async:!0,onLoad:L,onError:z})}else if(typeof File!=="undefined"&&y instanceof File){var N=new FileReader;return N.onload=function(){L(N.result)},N.onerror=function(){z(N.error)},N.readAsText(y)}else L(y);return c}d0.inject({importSVG:function(y,S){return o(y,S,this)}}),Z0.inject({importSVG:function(y,S){return this.activate(),o(y,S,this)}})};var k0=new(i0.inject(k.exports,{Base:k,Numerical:Q,Key:F6,DomEvent:T0,DomElement:A0,document:H,window:F,Symbol:W,PlacedSymbol:$}));if(k0.agent.node)(()=>({}))(k0);if(typeof define==="function"&&define.amd)define("paper",k0);else if(typeof m==="object"&&m)m.exports=k0;return k0}.call(n,typeof self==="object"?self:null)}),$8=I4(B4(),1),G4=I4(B4(),1),b=new d6.Generator("JavaScript");b.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(globalThis).join(","));b.ORDER_ATOMIC=0;b.ORDER_NEW=1.1;b.ORDER_MEMBER=1.2;b.ORDER_FUNCTION_CALL=2;b.ORDER_INCREMENT=3;b.ORDER_DECREMENT=3;b.ORDER_BITWISE_NOT=4.1;b.ORDER_UNARY_PLUS=4.2;b.ORDER_UNARY_NEGATION=4.3;b.ORDER_LOGICAL_NOT=4.4;b.ORDER_TYPEOF=4.5;b.ORDER_VOID=4.6;b.ORDER_DELETE=4.7;b.ORDER_DIVISION=5.1;b.ORDER_MULTIPLICATION=5.2;b.ORDER_MODULUS=5.3;b.ORDER_SUBTRACTION=6.1;b.ORDER_ADDITION=6.2;b.ORDER_BITWISE_SHIFT=7;b.ORDER_RELATIONAL=8;b.ORDER_IN=8;b.ORDER_INSTANCEOF=8;b.ORDER_EQUALITY=9;b.ORDER_BITWISE_AND=10;b.ORDER_BITWISE_XOR=11;b.ORDER_BITWISE_OR=12;b.ORDER_LOGICAL_AND=13;b.ORDER_LOGICAL_OR=14;b.ORDER_CONDITIONAL=15;b.ORDER_ASSIGNMENT=16;b.ORDER_COMMA=17;b.ORDER_NONE=99;b.ORDER_OVERRIDES=[[b.ORDER_FUNCTION_CALL,b.ORDER_MEMBER],[b.ORDER_FUNCTION_CALL,b.ORDER_FUNCTION_CALL],[b.ORDER_MEMBER,b.ORDER_MEMBER],[b.ORDER_MEMBER,b.ORDER_FUNCTION_CALL],[b.ORDER_LOGICAL_NOT,b.ORDER_LOGICAL_NOT],[b.ORDER_MULTIPLICATION,b.ORDER_MULTIPLICATION],[b.ORDER_ADDITION,b.ORDER_ADDITION],[b.ORDER_LOGICAL_AND,b.ORDER_LOGICAL_AND],[b.ORDER_LOGICAL_OR,b.ORDER_LOGICAL_OR]];b.init=function(n){if(b.definitions_=Object.create(null),b.functionNames_=Object.create(null),!b.variableDB_)b.variableDB_=new d6.Names(b.RESERVED_WORDS_);else b.variableDB_.reset();b.variableDB_.setVariableMap(n.getVariableMap());var m=[],l=n.getAllVariables();for(var E=0;E<l.length;E++){if(l[E].type===d6.BROADCAST_MESSAGE_VARIABLE_TYPE)continue;const F=b.variableDB_.getName(l[E].getId(),d6.Variables.NAME_TYPE);if(l[E].type===d6.LIST_VARIABLE_TYPE)m.push(`let ${F}${d6.LIST_VARIABLE_TYPE} = [];`);else m.push(`let ${F} = 0;`)}var M=d6.Variables.allDeveloperVariables(n);for(var E=0;E<M.length;E++){const H=b.variableDB_.getName(M[E],d6.Names.DEVELOPER_VARIABLE_TYPE);if(l[E].type===d6.LIST_VARIABLE_TYPE)m.push(`let ${H}${d6.LIST_VARIABLE_TYPE} = [];`);else m.push(`let ${H} = 0;`)}if(m.length)b.definitions_.variables=m.join("\n")};b.finish=function(n){var m=[];for(var l in b.definitions_)m.push(b.definitions_[l]);return delete b.definitions_,delete b.functionNames_,b.variableDB_.reset(),m.join("\n\n")+"\n\n\n"+n};b.scrubNakedValue=function(n){return n+";\n"};b.quote_=function(n){return n=n.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"),"'"+n+"'"};b.HAT_CODE="/* HatCode */";b.scrub_=function(n,m){var l="";if(!n.outputConnection||!n.outputConnection.targetConnection){var E=n.getCommentText();if(E=d6.utils.wrap(E,b.COMMENT_WRAP-3),E)if(n.getProcedureDef)l+="/**\n"+b.prefixLines(E+"\n"," * ")+" */\n";else l+=b.prefixLines(E+"\n","// ");for(var M=0;M<n.inputList.length;M++)if(n.inputList[M].type==d6.INPUT_VALUE){var F=n.inputList[M].connection.targetBlock();if(F){var E=b.allNestedComments(F);if(E)l+=b.prefixLines(E,"// ")}}}if(n.startHat_){const H=n.nextConnection&&n.nextConnection.targetBlock();let k=b.blockToCode(H);if(k)k=b.prefixLines(k,b.INDENT),m=m.replace(b.HAT_CODE,k);return l+m}if(n.parentBlock_){const H=n.nextConnection&&n.nextConnection.targetBlock(),k=b.blockToCode(H);return l+m+k}return""};b.getAdjusted=function(n,m,l,E,M){var F=l||0,H=M||b.ORDER_NONE;if(n.workspace.options.oneBasedIndex)F--;var k=n.workspace.options.oneBasedIndex?"1":"0";if(F>0)var u0=b.valueToCode(n,m,b.ORDER_ADDITION)||k;else if(F<0)var u0=b.valueToCode(n,m,b.ORDER_SUBTRACTION)||k;else if(E)var u0=b.valueToCode(n,m,b.ORDER_UNARY_NEGATION)||k;else var u0=b.valueToCode(n,m,H)||k;if(d6.isNumber(u0)){if(u0=parseFloat(u0)+F,E)u0=-u0}else{if(F>0){u0=u0+" + "+F;var i0=b.ORDER_ADDITION}else if(F<0){u0=u0+" - "+-F;var i0=b.ORDER_SUBTRACTION}if(E){if(F)u0="-("+u0+")";else u0="-"+u0;var i0=b.ORDER_UNARY_NEGATION}if(i0=Math.floor(i0),H=Math.floor(H),i0&&H>=i0)u0="("+u0+")"}return u0};var s5="if (abort || !runtime.running) break;\n",Y6=`  await runtime.nextFrame();\n  ${s5}`;b.control_wait=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const l=b.valueToCode(n,"DURATION",b.ORDER_NONE)||0;return m+=`await runtime.sleep(runtime.number(${l}));\n${s5}`,m};b.control_repeat=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);let l=b.statementToCode(n,"SUBSTACK")||"";if(b.STATEMENT_SUFFIX)l=b.prefixLines(b.injectId(b.STATEMENT_SUFFIX,n),b.INDENT)+l;const E=b.valueToCode(n,"TIMES",b.ORDER_NONE)||0;return m+=`for (let _ = 0; _ < runtime.number(${E}); _++) {\n${Y6}${l}}\n`,m};b.control_forever=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);let l=b.statementToCode(n,"SUBSTACK")||"";if(b.STATEMENT_SUFFIX)l=b.prefixLines(b.injectId(b.STATEMENT_SUFFIX,n),b.INDENT)+l;return m+=`while (true) {\n${Y6}${l}}\n`,m};b.control_if=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);let l=b.statementToCode(n,"SUBSTACK")||"";if(b.STATEMENT_SUFFIX)l=b.prefixLines(b.injectId(b.STATEMENT_SUFFIX,n),b.INDENT)+l;const E=b.valueToCode(n,"CONDITION",b.ORDER_NONE)||"false";if(m+=`if (${E}) {\n${l}}\n`,n.getInput("SUBSTACK2")){if(l=b.statementToCode(n,"SUBSTACK2")||"",b.STATEMENT_SUFFIX)l=b.prefixLines(b.injectId(b.STATEMENT_SUFFIX,n),b.INDENT)+l;m+=`else {\n${l}}\n`}return m};b.control_if_else=b.control_if;b.control_wait_until=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const l=b.valueToCode(n,"CONDITION",b.ORDER_NONE)||"false";return m+=`while (!(${l})) {\n${Y6}}\n`,m};b.control_repeat_until=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);let l=b.statementToCode(n,"SUBSTACK")||"";if(b.STATEMENT_SUFFIX)l=b.prefixLines(b.injectId(b.STATEMENT_SUFFIX,n),b.INDENT)+l;const E=b.valueToCode(n,"CONDITION",b.ORDER_NONE)||"false";return m+=`while (!(${E})) {\n${Y6}${l}}\n`,m};b.control_while=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);let l=b.statementToCode(n,"SUBSTACK")||"";if(b.STATEMENT_SUFFIX)l=b.prefixLines(b.injectId(b.STATEMENT_SUFFIX,n),b.INDENT)+l;const E=b.valueToCode(n,"CONDITION",b.ORDER_NONE)||"false";return m+=`while (${E}) {\n${Y6}${l}}\n`,m};b.control_stop=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);switch(n.getFieldValue("STOP_OPTION")){case"all":m+="runtime.stop();\n";break;case"this script":m+="return done();\n";break;case"other scripts in sprite":m+="abort = true;\n";break}return m};b.data_variable=(n)=>{return[b.variableDB_.getName(n.getFieldValue("VARIABLE"),X0.Variables.NAME_TYPE),b.ORDER_CONDITIONAL]};b.data_setvariableto=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const l=b.variableDB_.getName(n.getFieldValue("VARIABLE"),X0.Variables.NAME_TYPE),E=b.valueToCode(n,"VALUE",b.ORDER_NONE)||'""';return m+=`${l} = ${E};\n`,m};b.data_changevariableby=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const l=b.variableDB_.getName(n.getFieldValue("VARIABLE"),X0.Variables.NAME_TYPE),E=b.valueToCode(n,"VALUE",b.ORDER_NONE)||0;return m+=`${l} = runtime.number(${l}) + runtime.number(${E});\n`,m};b.data_listcontents=(n)=>{return[b.variableDB_.getName(n.getFieldValue("LIST"),X0.Variables.NAME_TYPE)+X0.LIST_VARIABLE_TYPE,b.ORDER_ATOMIC]};b.data_addtolist=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const l=b.variableDB_.getName(n.getFieldValue("LIST"),X0.Variables.NAME_TYPE)+X0.LIST_VARIABLE_TYPE,E=b.valueToCode(n,"ITEM",b.ORDER_NONE)||'""';return m+=`${l}.push(${E});\n`,m};b.data_deleteoflist=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const l=b.variableDB_.getName(n.getFieldValue("LIST"),X0.Variables.NAME_TYPE)+X0.LIST_VARIABLE_TYPE,E=b.valueToCode(n,"INDEX",b.ORDER_NONE)||1;return m+=`${l}.splice(runtime.index(${E}, ${l}.length), 1);\n`,m};b.data_deletealloflist=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const l=b.variableDB_.getName(n.getFieldValue("LIST"),X0.Variables.NAME_TYPE)+X0.LIST_VARIABLE_TYPE;return m+=`${l}.length = 0;\n`,m};b.data_insertatlist=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const l=b.variableDB_.getName(n.getFieldValue("LIST"),X0.Variables.NAME_TYPE)+X0.LIST_VARIABLE_TYPE,E=b.valueToCode(n,"INDEX",b.ORDER_NONE)||1,M=b.valueToCode(n,"ITEM",b.ORDER_NONE)||'""';return m+=`${l}.splice(runtime.index(${E}, ${l}.length), 0, ${M});\n`,m};b.data_replaceitemoflist=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const l=b.variableDB_.getName(n.getFieldValue("LIST"),X0.Variables.NAME_TYPE)+X0.LIST_VARIABLE_TYPE,E=b.valueToCode(n,"INDEX",b.ORDER_NONE)||1,M=b.valueToCode(n,"ITEM",b.ORDER_NONE)||'""';return m+=`${l}.splice(runtime.index(${E}, ${l}.length), 1, ${M});\n`,m};b.data_itemoflist=(n)=>{const m=b.variableDB_.getName(n.getFieldValue("LIST"),X0.Variables.NAME_TYPE)+X0.LIST_VARIABLE_TYPE,l=b.valueToCode(n,"INDEX",b.ORDER_NONE)||1;return[`(${m}[runtime.index(${l}, ${m}.length)] || '""')`,b.ORDER_CONDITIONAL]};b.data_itemnumoflist=(n)=>{const m=b.variableDB_.getName(n.getFieldValue("LIST"),X0.Variables.NAME_TYPE)+X0.LIST_VARIABLE_TYPE,l=b.valueToCode(n,"ITEM",b.ORDER_NONE)||'""';return[`(${m}.indexOf(${l}) + 1)`,b.ORDER_NONE]};b.data_lengthoflist=(n)=>{return[`${b.variableDB_.getName(n.getFieldValue("LIST"),X0.Variables.NAME_TYPE)+X0.LIST_VARIABLE_TYPE}.length`,b.ORDER_MEMBER]};b.data_listcontainsitem=(n)=>{const m=b.variableDB_.getName(n.getFieldValue("LIST"),X0.Variables.NAME_TYPE)+X0.LIST_VARIABLE_TYPE,l=b.valueToCode(n,"ITEM",b.ORDER_NONE)||'""';return[`${m}.includes(${l})`,b.ORDER_FUNCTION_CALL]};var h7="if (abort || !runtime.running) break;\n",k4=`async (done) => {\ndo {\n${b.HAT_CODE}} while (false);\n  done();\n}`;b.event_whenflagclicked=(n)=>{return`runtime.when('start', ${k4});\n`};b.event_whengreaterthan=(n)=>{const m=n.getFieldValue("WHENGREATERTHANMENU"),l=b.valueToCode(n,"VALUE",b.ORDER_NONE)||10;return`runtime.whenGreaterThen('${m}', runtime.number(${l}), ${k4});\n`};b.event_whenbroadcastreceived=(n)=>{return`runtime.when('message:${b.variableDB_.getName(n.getFieldValue("BROADCAST_OPTION"),p5.Variables.NAME_TYPE)}', ${k4});\n`};b.event_broadcast_menu=(n)=>{return[b.variableDB_.getName(n.getFieldValue("BROADCAST_OPTION"),p5.Variables.NAME_TYPE),b.ORDER_ATOMIC]};b.event_broadcast=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const l=b.valueToCode(n,"BROADCAST_INPUT",b.ORDER_NONE)||"message1";return m+=`runtime.fire('message:${l}')\n`,m};b.event_broadcastandwait=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const l=b.valueToCode(n,"BROADCAST_INPUT",b.ORDER_NONE)||"message1";return m+=`await runtime.fire('message:${l}')\n${h7}`,m};b.math_number=(n)=>{let m=parseFloat(n.getFieldValue("NUM")),l;if(m===Infinity)m="Infinity",l=b.ORDER_FUNCTION_CALL;else if(m===(-Infinity))m="-Infinity",l=b.ORDER_UNARY_SIGN;else if(Number.isNaN(m))m="NaN",l=b.ORDER_UNARY_SIGN;else l=m<0?b.ORDER_UNARY_SIGN:b.ORDER_ATOMIC;return[m,l]};b.math_integer=(n)=>{const m=parseInt(n.getFieldValue("NUM")),l=m<0?b.ORDER_UNARY_SIGN:b.ORDER_ATOMIC;return[m,l]};b.math_whole_number=(n)=>{return[Math.abs(parseInt(n.getFieldValue("NUM"))),b.ORDER_ATOMIC]};b.math_positive_number=(n)=>{let m=parseFloat(n.getFieldValue("NUM")),l;if(m===Infinity)m="Infinity",l=b.ORDER_FUNCTION_CALL;else if(m===(-Infinity))m="-Infinity",l=b.ORDER_FUNCTION_CALL;else if(Number.isNaN(m))m="NaN",l=b.ORDER_FUNCTION_CALL;else m=m<0?0:m,l=b.ORDER_ATOMIC;return[m,l]};b.math_angle=(n)=>{let m=parseFloat(n.getFieldValue("NUM")),l;if(m==Infinity)m="Infinity",l=b.ORDER_FUNCTION_CALL;else if(m==(-Infinity))m="-Infinity",l=b.ORDER_UNARY_SIGN;else m=m%360,m=m<0?m+360:m,l=b.ORDER_ATOMIC;return[m,l]};b.operator_add=(n)=>{const m=b.valueToCode(n,"NUM1",b.ORDER_NONE)||0,l=b.valueToCode(n,"NUM2",b.ORDER_NONE)||0;return[`(runtime.number(${m}) + runtime.number(${l}))`,b.ORDER_SUBTRACTION]};b.operator_subtract=(n)=>{const m=b.valueToCode(n,"NUM1",b.ORDER_NONE)||0,l=b.valueToCode(n,"NUM2",b.ORDER_NONE)||0;return[`(runtime.number(${m}) - runtime.number(${l}))`,b.ORDER_ADDITION]};b.operator_multiply=(n)=>{const m=b.valueToCode(n,"NUM1",b.ORDER_NONE)||0,l=b.valueToCode(n,"NUM2",b.ORDER_NONE)||0;return[`(runtime.number(${m}) * runtime.number(${l}))`,b.ORDER_MULTIPLICATION]};b.operator_divide=(n)=>{const m=b.valueToCode(n,"NUM1",b.ORDER_NONE)||0,l=b.valueToCode(n,"NUM2",b.ORDER_NONE)||0;return[`(runtime.number(${m}) / runtime.number(${l}))`,b.ORDER_DIVISION]};b.operator_random=(n)=>{const m=b.valueToCode(n,"FROM",b.ORDER_NONE)||0,l=b.valueToCode(n,"TO",b.ORDER_NONE)||0;return[`runtime.random(${m}, ${l})`,b.ORDER_FUNCTION_CALL]};b.operator_gt=(n)=>{const m=b.valueToCode(n,"OPERAND1",b.ORDER_NONE)||0,l=b.valueToCode(n,"OPERAND2",b.ORDER_NONE)||0;return[`(runtime.number(${m}) > runtime.number(${l}))`,b.ORDER_RELATIONAL]};b.operator_lt=(n)=>{const m=b.valueToCode(n,"OPERAND1",b.ORDER_NONE)||0,l=b.valueToCode(n,"OPERAND2",b.ORDER_NONE)||0;return[`(runtime.number(${m}) < runtime.number(${l}))`,b.ORDER_RELATIONAL]};b.operator_equals=(n)=>{const m=b.valueToCode(n,"OPERAND1",b.ORDER_NONE)||0,l=b.valueToCode(n,"OPERAND2",b.ORDER_NONE)||0;return[`(${m} == ${l})`,b.ORDER_RELATIONAL]};b.operator_and=(n)=>{const m=b.valueToCode(n,"OPERAND1",b.ORDER_NONE)||0,l=b.valueToCode(n,"OPERAND2",b.ORDER_NONE)||0;return[`(${m} && ${l})`,b.ORDER_LOGICAL_AND]};b.operator_or=(n)=>{const m=b.valueToCode(n,"OPERAND1",b.ORDER_NONE)||0,l=b.valueToCode(n,"OPERAND2",b.ORDER_NONE)||0;return[`(${m} || ${l})`,b.ORDER_LOGICAL_OR]};b.operator_not=(n)=>{return[`!(${b.valueToCode(n,"OPERAND",b.ORDER_NONE)||0})`,b.ORDER_LOGICAL_NOT]};b.operator_join=(n)=>{const m=b.valueToCode(n,"STRING1",b.ORDER_NONE)||'""',l=b.valueToCode(n,"STRING2",b.ORDER_NONE)||'""';return[`(String(${m}) + String(${l}))`,b.ORDER_ATOMIC]};b.operator_letter_of=(n)=>{const m=b.valueToCode(n,"LETTER",b.ORDER_NONE)||0;return[`(String(${b.valueToCode(n,"STRING",b.ORDER_NONE)||'""'}).at(${m} - 1) || '')`,b.ORDER_ATOMIC]};b.operator_length=(n)=>{return[`String(${b.valueToCode(n,"STRING",b.ORDER_NONE)||'""'}).length`,b.ORDER_MEMBER]};b.operator_contains=(n)=>{const m=b.valueToCode(n,"STRING1",b.ORDER_NONE)||'""',l=b.valueToCode(n,"STRING2",b.ORDER_NONE)||'""';return[`String(${m}).includes(String(${l}))`,b.ORDER_FUNCTION_CALL]};b.operator_mod=(n)=>{const m=b.valueToCode(n,"NUM1",b.ORDER_NONE)||0,l=b.valueToCode(n,"NUM2",b.ORDER_NONE)||0;return[`(runtime.number(${m}) % runtime.number(${l}))`,b.ORDER_MODULUS]};b.operator_round=(n)=>{return[`Math.round(${b.valueToCode(n,"NUM",b.ORDER_NONE)||0})`,b.ORDER_FUNCTION_CALL]};b.operator_mathop=(n)=>{const m=b.valueToCode(n,"NUM",b.ORDER_NONE)||0,l=n.getFieldValue("OPERATOR");let E="";if(l==="ceiling")E+=`Math.ceil(runtime.number(${m}))`;else if(l==="sin"||l==="cos"||l==="tan")E+=`Math.${l}(Math.PI * runtime.number(${m}) / 180)`;else if(l==="asin"||l==="acos"||l==="atan")E+=`(Math.${l}(runtime.number(${m})) * 180 / Math.PI)`;else if(l==="ln")E+=`Math.log(runtime.number(${m}))`;else if(l==="log")E+=`Math.log10(runtime.number(${m}))`;else if(l==="e ^")E+=`Math.exp(runtime.number(${m}))`;else if(l==="10 ^")E+=`Math.pow(10, runtime.number(${m}))`;else E+=`Math.${l}(runtime.number(${m}))`;return[E,b.ORDER_FUNCTION_CALL]};b.procedures_definition=(n)=>{};b.procedures_call=(n)=>{};b.procedures_prototype=(n)=>{};b.procedures_declaration=(n)=>{};b.argument_reporter_boolean=(n)=>{};b.argument_reporter_string_number=(n)=>{};b.argument_editor_boolean=(n)=>{};b.argument_editor_string_number=(n)=>{};b.sensing_timer=(n)=>{return["runtime.time",b.ORDER_FUNCTION_CALL]};b.sensing_resettimer=(n)=>{return"runtime.resetTimer()\n"};b.text=(n)=>{const m=n.getFieldValue("TEXT");return[isNaN(m)?b.quote_(m):+m,b.ORDER_ATOMIC]};var n7=new Set([p6.Events.BLOCK_CHANGE,p6.Events.BLOCK_CREATE,p6.Events.BLOCK_DELETE,p6.Events.BLOCK_MOVE,p6.Events.COMMENT_CHANGE,p6.Events.COMMENT_CREATE,p6.Events.COMMENT_DELETE,p6.Events.COMMENT_MOVE,p6.Events.VAR_CREATE,p6.Events.VAR_DELETE,p6.Events.VAR_RENAME]),g7=function(n){console&&console.warn&&console.warn(n)},E0=function(){E0.init.call(this)},v4=function(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)},w5=function(n){return n._maxListeners===void 0?E0.defaultMaxListeners:n._maxListeners},d5=function(n,m,l,E){var M,F,H;if(v4(l),F=n._events,F===void 0?(F=n._events=Object.create(null),n._eventsCount=0):(F.newListener!==void 0&&(n.emit("newListener",m,l.listener?l.listener:l),F=n._events),H=F[m]),H===void 0)H=F[m]=l,++n._eventsCount;else if(typeof H=="function"?H=F[m]=E?[l,H]:[H,l]:E?H.unshift(l):H.push(l),M=w5(n),M>0&&H.length>M&&!H.warned){H.warned=!0;var k=new Error("Possible EventEmitter memory leak detected. "+H.length+" "+String(m)+" listeners added. Use emitter.setMaxListeners() to increase limit");k.name="MaxListenersExceededWarning",k.emitter=n,k.type=m,k.count=H.length,g7(k)}return n},v7=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)},P5=function(n,m,l){var E={fired:!1,wrapFn:void 0,target:n,type:m,listener:l},M=v7.bind(E);return M.listener=l,E.wrapFn=M,M},l5=function(n,m,l){var E=n._events;if(E===void 0)return[];var M=E[m];return M===void 0?[]:typeof M=="function"?l?[M.listener||M]:[M]:l?x7(M):_5(M,M.length)},b5=function(n){var m=this._events;if(m!==void 0){var l=m[n];if(typeof l=="function")return 1;if(l!==void 0)return l.length}return 0},_5=function(n,m){for(var l=new Array(m),E=0;E<m;++E)l[E]=n[E];return l},m7=function(n,m){for(;m+1<n.length;m++)n[m]=n[m+1];n.pop()},x7=function(n){for(var m=new Array(n.length),l=0;l<m.length;++l)m[l]=n[l].listener||n[l];return m},X6=typeof Reflect=="object"?Reflect:null,m5=X6&&typeof X6.apply=="function"?X6.apply:function(n,m,l){return Function.prototype.apply.call(n,m,l)},g4;X6&&typeof X6.ownKeys=="function"?g4=X6.ownKeys:Object.getOwnPropertySymbols?g4=function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:g4=function(n){return Object.getOwnPropertyNames(n)};var S5=Number.isNaN||function(n){return n!==n};E0.EventEmitter=E0;E0.prototype._events=void 0;E0.prototype._eventsCount=0;E0.prototype._maxListeners=void 0;var x5=10;Object.defineProperty(E0,"defaultMaxListeners",{enumerable:!0,get:function(){return x5},set:function(n){if(typeof n!="number"||n<0||S5(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");x5=n}});E0.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};E0.prototype.setMaxListeners=function(n){if(typeof n!="number"||n<0||S5(n))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+n+".");return this._maxListeners=n,this};E0.prototype.getMaxListeners=function(){return w5(this)};E0.prototype.emit=function(n){for(var m=[],l=1;l<arguments.length;l++)m.push(arguments[l]);var E=n==="error",M=this._events;if(M!==void 0)E=E&&M.error===void 0;else if(!E)return!1;if(E){var F;if(m.length>0&&(F=m[0]),F instanceof Error)throw F;var H=new Error("Unhandled error."+(F?" ("+F.message+")":""));throw H.context=F,H}var k=M[n];if(k===void 0)return!1;if(typeof k=="function")m5(k,this,m);else for(var u0=k.length,i0=_5(k,u0),l=0;l<u0;++l)m5(i0[l],this,m);return!0};E0.prototype.addListener=function(n,m){return d5(this,n,m,!1)};E0.prototype.on=E0.prototype.addListener;E0.prototype.prependListener=function(n,m){return d5(this,n,m,!0)};E0.prototype.once=function(n,m){return v4(m),this.on(n,P5(this,n,m)),this};E0.prototype.prependOnceListener=function(n,m){return v4(m),this.prependListener(n,P5(this,n,m)),this};E0.prototype.removeListener=function(n,m){var l,E,M,F,H;if(v4(m),E=this._events,E===void 0)return this;if(l=E[n],l===void 0)return this;if(l===m||l.listener===m)--this._eventsCount===0?this._events=Object.create(null):(delete E[n],E.removeListener&&this.emit("removeListener",n,l.listener||m));else if(typeof l!="function"){for(M=-1,F=l.length-1;F>=0;F--)if(l[F]===m||l[F].listener===m){H=l[F].listener,M=F;break}if(M<0)return this;M===0?l.shift():m7(l,M),l.length===1&&(E[n]=l[0]),E.removeListener!==void 0&&this.emit("removeListener",n,H||m)}return this};E0.prototype.off=E0.prototype.removeListener;E0.prototype.removeAllListeners=function(n){var m,l,E;if(l=this._events,l===void 0)return this;if(l.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):l[n]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete l[n]),this;if(arguments.length===0){var M=Object.keys(l),F;for(E=0;E<M.length;++E)F=M[E],F!=="removeListener"&&this.removeAllListeners(F);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(m=l[n],typeof m=="function")this.removeListener(n,m);else if(m!==void 0)for(E=m.length-1;E>=0;E--)this.removeListener(n,m[E]);return this};E0.prototype.listeners=function(n){return l5(this,n,!0)};E0.prototype.rawListeners=function(n){return l5(this,n,!1)};E0.listenerCount=function(n,m){return typeof n.listenerCount=="function"?n.listenerCount(m):b5.call(n,m)};E0.prototype.listenerCount=b5;E0.prototype.eventNames=function(){return this._eventsCount>0?g4(this._events):[]};var T3=E0.prototype,s7=I4(B4(),1);class m4 extends E0{static DEFAULT_FPS=24;constructor(n,m,l=m4.DEFAULT_FPS){super();this._fps=l,this._frame_sec=1/l,this._running=!1,this._requestStop=m,this._timer=0,this._timers=[],this._greaterThen={},this._eventsHappening={},new Function("runtime",n)(this)}get running(){return this._running}get time(){return(Date.now()-this._timer)/1000}resetTimer(){this._timer=Date.now()}when(n,m){this._eventsHappening[n]=this._eventsHappening[n]||[],this._eventsHappening[n].push(!1);const l=this._eventsHappening[n].length-1;this.on(`${n}_${l}`,m)}whenGreaterThen(n,m,l){const E=`${n}>${m}`;this._greaterThen[E]=!1,this.when(`greaterthen:${E}`,l)}emit(...n){return new Promise((m)=>{if(this.running)super.emit(...n,m)})}fire(n,...m){if(this.emit(n,...m),this._eventsHappening[n]=this._eventsHappening[n]||[],this._eventsHappening[n].length>0)return Promise.race(this._eventsHappening[n].map(async(l,E)=>{if(!l)this._eventsHappening[n][E]=!0,await this.emit(`${n}_${E}`,...m),this._eventsHappening[n][E]=!1}));return Promise.resolve()}_handleFrameForGreaterThen(n){const m=Object.keys(this._greaterThen);for(let l of m){const[E,M]=l.split(">");if(E==="TIMER"){const F=this.time>parseFloat(M);if(F&&!this._greaterThen[l])this.fire(`greaterthen:${l}`);this._greaterThen[l]=F}}n()}async _handleStart(){while(this.running){if(!s7.default.project){this.stop();break}await this.nextFrame(),this.fire("frame")}}start(){this._running=!0,this.on("frame",this._handleFrameForGreaterThen.bind(this)),this.on("start",this._handleStart.bind(this)),this.fire("start"),this.resetTimer()}async stop(){this._running=!1,await this.nextFrame(),this._timers.forEach(clearTimeout),this._timers.length=0,this._requestStop()}sleep(n){return new Promise((m)=>this._timers.push(setTimeout(m,n*1000)))}nextFrame(){return this.sleep(this._frame_sec)}random(n=1,m=10){const l=Math.ceil(Math.min(n,m)),E=Math.floor(Math.max(n,m));return Math.floor(Math.random()*(E-l+1))+l}number(n,m=0){return isNaN(n)?m:+n}index(n,m){let l=this.number(n)-1;return l%=m,l+=m,l%m}}var l0=$8.default;var W6="if (abort || !runtime.running) break;\n";b.motion_attack=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const l=b.valueToCode(n,"DIRECTION",b.ORDER_NONE)||0,E=b.valueToCode(n,"DISTANCE",b.ORDER_NONE)||100;return m+=`await tank.util.attack(${l}, ${E});\n${W6}`,m};b.motion_move=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const l=b.valueToCode(n,"DIRECTION",b.ORDER_NONE)||0,E=b.valueToCode(n,"SPEED",b.ORDER_NONE)||100;return m+=`await tank.util.move(${l}, ${E});\n${W6}`,m};b.motion_turnright=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const l=b.valueToCode(n,"DEGREES",b.ORDER_NONE)||0;return m+=`await tank.util.turnRight(${l});\n${W6}`,m};b.motion_turnleft=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const l=b.valueToCode(n,"DEGREES",b.ORDER_NONE)||0;return m+=`await tank.util.turnLeft(${l});\n${W6}`,m};b.motion_pointindirection=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const l=b.valueToCode(n,"DIRECTION",b.ORDER_NONE)||0;return m+=`await tank.util.setDirection(+${l});\n${W6}`,m};b.motion_setspeed=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const l=b.valueToCode(n,"SPEED",b.ORDER_NONE)||0;return m+=`tank.util.speed = ${l};\n`,m};b.motion_stop=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);return m+="tank.util.speed = 0;\n",m};b.motion_xposition=(n)=>{return["tank.util.x",b.ORDER_ATOMIC]};b.motion_yposition=(n)=>{return["tank.util.y",b.ORDER_ATOMIC]};b.motion_speed=(n)=>{return["tank.util.currentSpeed",b.ORDER_ATOMIC]};b.motion_direction=(n)=>{return["tank.util.direction",b.ORDER_ATOMIC]};b.sensing_scanwidth=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const l=b.valueToCode(n,"WIDTH",b.ORDER_NONE)||5;return m+=`tank.util.scanWidth = ${l};\n`,m};b.sensing_scan=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const l=b.valueToCode(n,"DIRECTION",b.ORDER_NONE)||0;return m+=`(await tank.util.scan(${l}) !== Infinity)`,[m,b.ORDER_EQUALITY]};b.sensing_scandistance=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);const l=b.valueToCode(n,"DIRECTION",b.ORDER_NONE)||0;return m+=`(await tank.util.scan(${l}))`,[m,b.ORDER_FUNCTION_CALL]};b.sensing_health=(n)=>{let m="";if(b.STATEMENT_PREFIX)m+=b.injectId(b.STATEMENT_PREFIX,n);return m+="tank.util.health",[m,b.ORDER_FUNCTION_CALL]};var y7=()=>`
  <category name="%{BKY_CATEGORY_MOTION}" id="motion" colour="#4C97FF" secondaryColour="#3373CC">
    <block type="motion_attack">
      <value name="DIRECTION">
        <shadow type="math_angle">
          <field name="NUM">90</field>
        </shadow>
      </value>
      <value name="DISTANCE">
        <shadow type="math_number">
          <field name="NUM">200</field>
        </shadow>
      </value>
    </block>
    <block type="motion_move">
      <value name="DIRECTION">
        <shadow type="math_angle">
          <field name="NUM">90</field>
        </shadow>
      </value>
      <value name="SPEED">
        <shadow type="math_number">
          <field name="NUM">100</field>
        </shadow>
      </value>
    </block>
    ${D6}
    <block type="motion_turnright">
      <value name="DEGREES">
        <shadow type="math_number">
          <field name="NUM">15</field>
        </shadow>
      </value>
    </block>
    <block type="motion_turnleft">
      <value name="DEGREES">
        <shadow type="math_number">
          <field name="NUM">15</field>
        </shadow>
      </value>
    </block>
    <block type="motion_pointindirection">
      <value name="DIRECTION">
        <shadow type="math_angle">
          <field name="NUM">90</field>
        </shadow>
      </value>
    </block>
    ${D6}
    <block type="motion_setspeed">
      <value name="SPEED">
        <shadow type="math_number">
          <field name="NUM">50</field>
        </shadow>
      </value>
    </block>
    <block type="motion_stop"/>
    ${D6}
    <block type="motion_speed"/>
    <block type="motion_direction"/>
    ${c4}
  </category>
`,w7=()=>`
  <category name="%{BKY_CATEGORY_SENSING}" id="sensing" colour="#4CBFE6" secondaryColour="#2E8EB8">
    <block type="sensing_scanwidth">
      <value name="WIDTH">
        <shadow type="math_number">
          <field name="NUM">5</field>
        </shadow>
      </value>
    </block>
    <block type="sensing_scan">
      <value name="DIRECTION">
        <shadow type="math_angle">
          <field name="NUM">90</field>
        </shadow>
      </value>
    </block>
    <block type="sensing_scandistance">
      <value name="DIRECTION">
        <shadow type="math_angle">
          <field name="NUM">90</field>
        </shadow>
      </value>
    </block>
    ${D6}
    <block type="sensing_health"/>
    ${D6}
    <block id="timer" type="sensing_timer"/>
    <block type="sensing_resettimer"/>
    ${c4}
  </category>
`,d7=()=>`
  <category name="%{BKY_CATEGORY_OPERATORS}" id="operators" colour="#40BF4A" secondaryColour="#389438">
    <block type="operator_add">
      <value name="NUM1">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
      <value name="NUM2">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    <block type="operator_subtract">
      <value name="NUM1">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
      <value name="NUM2">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    <block type="operator_multiply">
      <value name="NUM1">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
      <value name="NUM2">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    <block type="operator_divide">
      <value name="NUM1">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
      <value name="NUM2">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    ${D6}
    <block type="operator_random">
      <value name="FROM">
        <shadow type="math_number">
          <field name="NUM">1</field>
        </shadow>
      </value>
      <value name="TO">
        <shadow type="math_number">
          <field name="NUM">10</field>
        </shadow>
      </value>
    </block>
    ${D6}
    <block type="operator_gt">
      <value name="OPERAND1">
        <shadow type="text">
          <field name="TEXT"/>
        </shadow>
      </value>
      <value name="OPERAND2">
        <shadow type="text">
          <field name="TEXT">50</field>
        </shadow>
      </value>
    </block>
    <block type="operator_lt">
      <value name="OPERAND1">
        <shadow type="text">
          <field name="TEXT"/>
        </shadow>
      </value>
      <value name="OPERAND2">
        <shadow type="text">
          <field name="TEXT">50</field>
        </shadow>
      </value>
    </block>
    <block type="operator_equals">
      <value name="OPERAND1">
        <shadow type="text">
          <field name="TEXT"/>
        </shadow>
      </value>
      <value name="OPERAND2">
        <shadow type="text">
          <field name="TEXT">50</field>
        </shadow>
      </value>
    </block>
    ${D6}
    <block type="operator_and"/>
    <block type="operator_or"/>
    <block type="operator_not"/>
    ${D6}
    <block type="operator_mod">
      <value name="NUM1">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
      <value name="NUM2">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    <block type="operator_round">
      <value name="NUM">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    ${D6}
    <block type="operator_mathop">
      <value name="NUM">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    ${c4}
  </category>
`;function L4(){return p7([{id:"motion",xml:y7()},{id:"sensing",xml:w7()},{id:"operators",xml:d7()}])}import{jsx as b7} from"preact/jsx-runtime";var l7=f4.Content;function z4({onReady:n}){const{getText:m}=P7(),l={MOTION_ATTACK:m("tankwar.blocks.motion_attack","fire in direction %1 at %2 steps"),MOTION_MOVE:m("tankwar.blocks.motion_move","forward in direction %1 at %2 % speed"),MOTION_SETSPEED:m("tankwar.blocks.motion_setspeed","set speed to %1 %"),MOTION_STOP:m("tankwar.blocks.motion_stop","stop"),MOTION_SPEED:m("tankwar.blocks.motion_speed","speed"),SENSING_SCANWIDTH:m("tankwar.blocks.sensing_scanwidth","set scan width to %1"),SENSING_SCAN:m("tankwar.blocks.sensing_scan","scan for enemy in direction %1?"),SENSING_DISTANCE:m("tankwar.blocks.sensing_distance","measure distance of enemy in direction %1"),SENSING_HEALTH:m("tankwar.blocks.sensing_health","health")},E=L4();return b7(l7,{disableGenerator:!0,disableExtension:!0,messages:l,toolbox:E,onReady:n})}import{useState as w4} from"preact/hooks";import{classNames as H7} from"@blockcode/ui";import{useState as O5} from"preact/hooks";import{useEditor as q7} from"@blockcode/core";var r5="./assets/background-81dedab007c311a5.png";function e6(n){return new Promise((m)=>{const l=new Image;l.src=n,l.addEventListener("load",()=>m(l))})}var j5="./assets/tank_1-5797dcf7b198a48d.png";var o5="./assets/turret_1-26017ccc46b87689.png";var D5="./assets/tank_2-337708f7538d8787.png";var C5="./assets/turret_2-5c4bb2c458561ace.png";var G5="./assets/tank_3-1d999a2c9dacc246.png";var I5="./assets/turret_3-956bfba650c81c57.png";var B5="./assets/tank_4-f93afcfd2c3d1734.png";var k5="./assets/turret_4-d6c2200ed4ca50b0.png";var c5="./assets/broken-2d9779d033bbcdb5.png";var L5="./assets/bullet-80854a0e7090b0fc.png";var z5="./assets/boom1-65b37ddc26db4cbd.png";var V5="./assets/boom2-82ff355a8e0177ba.png";var M5="./assets/boom3-703bd7bb6580e4d9.png";var V7=20,M7=4,E7=40,x4=500,N7=70,a7=400,U6=10,V4=50,M4=1000,E5=(n,m)=>Math.sqrt((n.x-m.x)**2+(n.y-m.y)**2),c6=(n)=>isNaN(n)?0:+n,Z6=(n,m,l)=>Math.min(Math.max(n,m),l),J6=(n)=>n*Math.PI/180,L6=(n)=>parseInt((n%360+360)%360),N5=(n,m)=>L6(n)===L6(m);class N0{static PLACE={LEFT:{get position(){return new l0.Point(l0.view.center.x-300,l0.view.center.y)},rotation:90},RIGHT:{get position(){return new l0.Point(l0.view.center.x+300,l0.view.center.y)},rotation:-90},LEFT_TOP:{get position(){return new l0.Point(l0.view.center.x-300,l0.view.center.y-300)},rotation:135},RIGHT_TOP:{get position(){return new l0.Point(l0.view.center.x+300,l0.view.center.y-300)},rotation:-135},LEFT_BOTTOM:{get position(){return new l0.Point(l0.view.center.x-300,l0.view.center.y+300)},rotation:45},RIGHT_BOTTOM:{get position(){return new l0.Point(l0.view.center.x+300,l0.view.center.y+300)},rotation:-45}};static STYLE={PLAYER:{tank:j5,turret:o5},ENEMY_A:{tank:D5,turret:C5},ENEMY_B:{tank:G5,turret:I5},ENEMY_C:{tank:B5,turret:k5}};constructor(n,m=N0.STYLE.PLAYER,l=N0.PLACE.LEFT){this.raster=new l0.Raster({name:n,scaling:0.2,source:m.tank,position:l.position,rotation:l.rotation,visible:m===N0.STYLE.PLAYER}),this.turretRaster=new l0.Raster({scaling:0.2,source:m.turret,position:l.position,rotation:l.rotation,visible:m===N0.STYLE.PLAYER}),this.raster.util=this,this.turretRaster.owner=this,this._hidden=!0,this._lastScanDistance=0,this._imageCache={},this._timers=[],this.reset()}sleep(n){return new Promise((m)=>this._timers.push(setTimeout(m,n)))}reset(){if(this._speed=0,this._currentSpeed=0,this._health=100,this._scanWidth=M7,this._turretReady=null,this._scanShape)this._scanShape.remove(),this._scanShape=null;if(this._bulletRaster)this._bulletRaster.remove(),this._bulletRaster=null;if(this._boomRaster)this._boomRaster.remove(),this._boomRaster=null;if(this._collideTester)this._collideTester.remove(),this._collideTester=null;clearTimeout(this._turretReady),this._timers.forEach(clearTimeout),this._timers.length=0}bringToFront(){this.raster.bringToFront(),this.turretRaster.bringToFront()}get running(){return this._running}set running(n){if(this.reset(),this._running=n,n){const m=this.raster.scaling.x*this.raster.width-5;this._collideTester=new l0.Path.Rectangle({point:[this.raster.position.x-m/2,this.raster.position.y-5],size:[m,10],applyMatrix:!1})}}get bullseye(){if(!this._bullseye)this._bullseye=Math.min(this.raster.width,this.raster.height)*this.raster.scaling.x/4;return this._bullseye}get enemies(){if(!this._enemies)this._enemies=["red","yellow","green","player"].filter((n)=>n!==this.raster.name).map((n)=>l0.project.activeLayer.children[n]);return this._enemies}set place(n){if(this.running)return;this.raster.position=this.turretRaster.position=n.position,this.raster.rotation=this.turretRaster.rotation=n.rotation,this.hidden=!1}get hidden(){return this._hidden}set hidden(n){this._hidden=n,this.raster.visible=this.turretRaster.visible=!n}async _turn(n,m){if(!N5(n.rotation,m)){let l=L6(m)-L6(n.rotation);if(l>180)l-=360;if(l<-180)l+=360;await n.tween({rotation:n.rotation+l},M4*(Math.abs(l)/360))}}async attack(n,m){if(!this.running)return;if(this._bulletRaster||this.death)return;n=Math.round(c6(n)),m=c6(m)-V4,clearTimeout(this._turretReady),this._turretReady=null,await this._turn(this.turretRaster,n);const l=L6(n),E=J6(90-l);if(!this._imageCache.buttet)this._imageCache.buttet=await e6(L5);if(this._bulletRaster)this._bulletRaster.remove(),this._bulletRaster=null;this._bulletRaster=new l0.Raster({image:this._imageCache.buttet,position:new l0.Point(this.raster.position.x+V4*Math.cos(E),this.raster.position.y-V4*Math.sin(E)),rotation:this.raster.rotation,scaling:this.raster.scaling}),m=Z6(m,N7,a7);const M=m/2,F=U6/m/2;let H=U6*Math.cos(E),k=U6*Math.sin(E);while(m>0){if(await this.sleep(15),m<U6)H=m*Math.cos(E),k=m*Math.sin(E);if(m-=U6,this._bulletRaster.position.x+=H,this._bulletRaster.position.y-=k,this._bulletRaster.scaling.x+=m>M?F:-F,this._bulletRaster.scaling.y=this._bulletRaster.scaling.x,this._bulletRaster.scaling.x<this.raster.scaling.x)this._bulletRaster.scaling=this.raster.scaling}this._boom(this._bulletRaster.position),this._collide(this._bulletRaster,(u0)=>{if(E5(u0.position,this._bulletRaster.position)<u0.util.bullseye)u0.util.hurt(10);else u0.util.hurt(5)}),this._bulletRaster.remove(),this._bulletRaster=null,this._turretReady=setTimeout(()=>{this._turn(this.turretRaster,this.raster.rotation),this._turretReady=null},1000)}async _boom(n){if(!this.running)return;if(!this._imageCache.booms)this._imageCache.booms=[await e6(z5),await e6(V5),await e6(M5)];if(this._boomRaster)this._boomRaster.remove(),this._boomRaster=null;this._boomRaster=new l0.Raster({image:this._imageCache.booms[0],position:n}),await this.sleep(30),this._boomRaster.image=this._imageCache.booms[1],await this.sleep(50),this._boomRaster.image=this._imageCache.booms[2],await this.sleep(90),this._boomRaster.remove(),this._boomRaster=null}_intersectsOrContains(n,m){return n.intersects(m)||m.contains(n.position)}_collide(n,m){if(this.running&&!this.death)this.enemies.forEach((l)=>{if(l.util.death||l.util.hidden)return;if(this._intersectsOrContains(n,l))m(l)})}async move(n,m){if(!this.running)return;if(this.death)return;await this.setDirection(n),this.speed=c6(m)}drive(){if(!this.running)return;if(this.speed===0)return;if(this.hidden||this.death)return;let n=this.speed;const m=J6(90-this.direction),l=this.raster.scaling.y*this.raster.height;this._collideTester.rotation=this.raster.rotation,this._collideTester.position.x=this.raster.position.x+(l/2+5)*Math.cos(m),this._collideTester.position.y=this.raster.position.y-(l/2+5)*Math.sin(m),this.enemies.forEach((E)=>{if(E.util.hidden)return;if(this._intersectsOrContains(this.raster,E)&&this._intersectsOrContains(this._collideTester,E))n=0}),this._currentSpeed=n,n/=V7,this.raster.position.x+=n*Math.cos(m),this.raster.position.y-=n*Math.sin(m),this.turretRaster.position=this.raster.position}get x(){return this.raster.position.x-l0.view.center.x}get y(){return l0.view.center.y-this.raster.position.y}get currentSpeed(){return Z6(this._currentSpeed,-100,100)}get speed(){return Z6(this._speed,-100,100)}set speed(n){if(!this.running)return;this._speed=Z6(n,-100,100)}get speedVelocity(){const n=L6(this.speed<0?180+this.direction:this.direction),m=J6(90-n),l=Math.abs(this.speed);return new l0.Point(l*Math.cos(m),l*Math.sin(m))}get direction(){let n=this.raster.rotation%360;if(n>180)n-=360;if(n<=-180)n+=360;return n}async setDirection(n){if(!this.running)return;if(n=Math.round(c6(n)),!this._turretReady)this._turn(this.turretRaster,n);await this._turn(this.raster,n)}turnRight(n){let m=this.raster.rotation;return m+=c6(n),this.setDirection(m)}turnLeft(n){return this.turnRight(-c6(n))}hurt(n){if(!this.running)return;if(this._health-=Math.abs(n),this.death)this.raster.visible=this.turretRaster.visible=!1,new l0.Raster({source:c5,scaling:this.raster.scaling,position:this.raster.position,rotation:this.raster.rotation}).insertAbove(l0.project.activeLayer.children.background)}get health(){if(this._health<0)return 0;return this._health}get death(){return this.health<=0}get scanWidth(){return this._scanWidth}set scanWidth(n){n=c6(n),this._scanWidth=Z6(n,1,E7)}async scan(n){if(!this.running)return Infinity;if(this._scanShape||this.death)return Infinity;if(n=c6(n),!N5(this._lastScanDistance,n)){let P0=L6(n)-L6(this._lastScanDistance);if(P0>180)P0-=360;if(P0<-180)P0+=360;await this.sleep(M4*(Math.abs(P0)/360)),this._lastScanDistance=n}const m=J6(90-(n-this.scanWidth/2)),l=x4*Math.cos(m),E=x4*Math.sin(m),M=new l0.Point(this.raster.position.x+l,this.raster.position.y-E),F=J6(90-(n+this.scanWidth/2)),H=x4*Math.cos(F),k=x4*Math.sin(F),u0=new l0.Point(this.raster.position.x+H,this.raster.position.y-k);if(this._scanShape)this._scanShape.remove(),this._scanShape=null;this._scanShape=new l0.Path({segments:[this.raster.position,M,u0],closed:!0,fillColor:{gradient:{stops:[["rgb(255 0 0 0.4)",0],["rgb(255 0 0 0)",0.7]],radial:!0},origin:this.raster.position,destination:M}}),await this.sleep(M4*(this.scanWidth/360));let i0=Infinity;return this._collide(this._scanShape,(P0)=>{const m0=E5(this.raster.position,P0.position);if(m0<i0)i0=m0}),this._scanShape.remove(),this._scanShape=null,i0}}class s4 extends m4{get player(){return l0.project.activeLayer.children.player}get redTank(){return l0.project.activeLayer.children.red}get yellowTank(){return l0.project.activeLayer.children.yellow}get greenTank(){return l0.project.activeLayer.children.green}start(){this.player.util.running=!0,this.redTank.util.running=!0,this.yellowTank.util.running=!0,this.greenTank.util.running=!0,super.start()}stop(){return this.player.util.running=!1,this.redTank.util.running=!1,this.yellowTank.util.running=!1,this.greenTank.util.running=!1,super.stop()}}var a5=(n="",m=[])=>`
${m.join("\n")}

((tank) => {
let abort = false;
${n||""}
})(runtime.player);

runtime.on('frame', () => {
  runtime.player.util.drive();
  runtime.redTank.util.drive();
  runtime.yellowTank.util.drive();
  runtime.greenTank.util.drive();
});

runtime.player.util.bringToFront();
runtime.start();
`;var Q6={};$5(Q6,{simple:()=>{{return O7}},senior:()=>{{return R7}},medium:()=>{{return A7}}});var O7=(n,m)=>`
((tank) => {
  let abort = false;

  runtime.when('start', async function (done) {
    await tank.util.turnRight(45);
    tank.util.speed = 100;
    await runtime.sleep(2.5);
    tank.util.speed = 0;
    await tank.util.turnLeft(90);
    runtime.fire('@ai_simple_${n}_${m}_message_1');
    while (true) {
      tank.util.speed = 100;
      await runtime.sleep(5.5);
      tank.util.speed = 0;
      await tank.util.turnLeft(180);
      if (abort || !runtime.running) {
        break;
      };
      await runtime.nextFrame();
    }
    done();
  });

  runtime.when('@ai_simple_${n}_${m}_message_1', async function anonymous(done) {
    while (true) {
      if ((await tank.util.scan(0) !== Infinity)) {
        await tank.util.attack(0, (await tank.util.scan(0)));
      }
      if ((await tank.util.scan(45) !== Infinity)) {
        await tank.util.attack(45, (await tank.util.scan(45)));
      }
      if ((await tank.util.scan(90) !== Infinity)) {
        await tank.util.attack(90, (await tank.util.scan(90)));
      }
      if ((await tank.util.scan(135) !== Infinity)) {
        await tank.util.attack(135, (await tank.util.scan(135)));
      }
      if ((await tank.util.scan(180) !== Infinity)) {
        await tank.util.attack(180, (await tank.util.scan(180)));
      }
      if ((await tank.util.scan(225) !== Infinity)) {
        await tank.util.attack(225, (await tank.util.scan(225)));
      }
      if ((await tank.util.scan(270) !== Infinity)) {
        await tank.util.attack(270, (await tank.util.scan(270)));
      }
      if ((await tank.util.scan(315) !== Infinity)) {
        await tank.util.attack(315, (await tank.util.scan(315)));
      }
      if (abort || !runtime.running) {
        break;
      };
      await runtime.nextFrame();
    }
    done();
  });


})(runtime.${n}Tank);
`,A7=(n,m)=>`
((tank) => {
  let abort = false;

  let _health_ = 0;
  let _angle_ = 0;

  runtime.when('start', async function anonymous() {
    _angle_ = runtime.random(1, 360);
    runtime.fire('@ai_medium_${n}_${m}_start')
  });

  runtime.when('start', async function anonymous() {
    while (true) {
      _health_ = tank.util.health;
      while (!((tank.util.health < _health_))) {
        if (abort || !runtime.running) {
          break;
        };
        await runtime.nextFrame();
      }
      abort = false;
      tank.util.move(runtime.random(1, 360), 100);
      await runtime.sleep(1);
      tank.util.speed = 0;
      runtime.fire('@ai_medium_${n}_${m}_start')
      if (abort || !runtime.running) {
        break;
      };
      await runtime.nextFrame();
    }
  });

  runtime.when('@ai_medium_${n}_${m}_start', async function anonymous(done) {
    while (true) {
      while (!((await tank.util.scan(_angle_) !== Infinity))) {
        _angle_ = (isNaN(_angle_) ? 0 : +_angle_) + +(10);

        if (abort || !runtime.running) {
          break;
        };
        await runtime.nextFrame();
      }
      while (((await tank.util.scan(_angle_) !== Infinity) && ((await tank.util.scan(_angle_)) > '400'))) {
        tank.util.move(_angle_, 100);

        if (abort || !runtime.running) {
          break;
        };
        await runtime.nextFrame();
      }
      tank.util.speed = 0;
      if (((await tank.util.scan(_angle_)) < '400') && ((await tank.util.scan(_angle_)) > '100')) {
        await tank.util.attack((_angle_ + 1), (await tank.util.scan(_angle_)));
      }
      _angle_ = (isNaN(_angle_) ? 0 : +_angle_) + +(-10);

      if (abort || !runtime.running) {
        break;
      };
      await runtime.nextFrame();
    }
    done()
  });


})(runtime.${n}Tank);
`,R7=(n,m)=>`
((tank) => {
  let abort = false;

  let _angle_ = 0;
  let _health_ = 0;


  runtime.when('start', async function anonymous() {
    if (((tank.util.y < '5') && (tank.util.y > '-5'))) {
      await tank.util.turnLeft(104);
    }
    else {
      await tank.util.turnLeft(180);
    }
    tank.util.speed = 100;
    while (!(((Math.abs(tank.util.x) > '400') && (Math.abs(tank.util.y) > '400')))) {

    if (abort || !runtime.running) {
      break;
    };
      await runtime.nextFrame();
    }
    tank.util.speed = 0;
    runtime.fire('@ai_senior_${n}_${m}_start')
  });

  runtime.when('@ai_senior_${n}_${m}_start', async function anonymous(done) {
    if ((tank.util.x < '0')) {
      if ((tank.util.y < '0')) {
        _angle_ = '45';
      }
      else {
        _angle_ = '135';
      }
    }
    else {
      if ((tank.util.y < '0')) {
        _angle_ = '-45';
      }
      else {
        _angle_ = '-135';
      }
    }
    await tank.util.setDirection(_angle_);
    runtime.fire('@ai_senior_${n}_${m}_watch_health');
    _angle_ = (isNaN(_angle_) ? 0 : +_angle_) + +(-60);
    for (let _ = 0; _ < 78; _++) {
      if (((await tank.util.scan(_angle_)) < '400') && ((await tank.util.scan(_angle_)) > '100')) {
        await tank.util.attack((_angle_ + 1), (await tank.util.scan(_angle_)));
        _angle_ = (isNaN(_angle_) ? 0 : +_angle_) + +(-10);
      }
      _angle_ = (isNaN(_angle_) ? 0 : +_angle_) + +(10);

      if (abort || !runtime.running) {
        break;
      };
      await runtime.nextFrame();
    }
    runtime.fire('@ai_senior_${n}_${m}_next_place');
    done();
  });

  runtime.when('@ai_senior_${n}_${m}_next_place', async function anonymous(done) {
    abort = false;
    if ((runtime.random(1, 3) == '1')) {
      await tank.util.turnLeft(45);
    }
    else {
      await tank.util.turnRight(45);
    }
    tank.util.speed = 100;
    await runtime.sleep(1);
    if (((tank.util.direction > '-5') && (tank.util.direction < '5'))) {
      while (!((tank.util.y > '400'))) {

      if (abort || !runtime.running) {
        break;
      };
        await runtime.nextFrame();
      }
    }
    else {
      if (((tank.util.direction > '85') && (tank.util.direction < '95'))) {
        while (!((tank.util.x > '400'))) {

        if (abort || !runtime.running) {
          break;
        };
          await runtime.nextFrame();
        }
      }
      else {
        if (((tank.util.direction > '-95') && (tank.util.direction < '-85'))) {
          while (!((tank.util.x < '-400'))) {

          if (abort || !runtime.running) {
            break;
          };
            await runtime.nextFrame();
          }
        }
        else {
          while (!((tank.util.y < '-400'))) {

          if (abort || !runtime.running) {
            break;
          };
            await runtime.nextFrame();
          }
        }
      }
    }
    tank.util.speed = 0;
    runtime.fire('@ai_senior_${n}_${m}_start')
    done()
  });

  runtime.when('@ai_senior_${n}_${m}_watch_health', async function anonymous(done) {
    _health_ = tank.util.health;
    while (!((tank.util.health < _health_))) {

    if (abort || !runtime.running) {
      break;
    };
      await runtime.nextFrame();
    }
    runtime.fire('@ai_senior_${n}_${m}_next_place')
    done()
  });


})(runtime.${n}Tank);
`;function A5({playing:n,enemies:m,enemiesAI:l,onRequestStop:E,onChangeHealth:M}){const[F,H]=O5(null),[k,u0]=O5(!1),{fileList:i0,selectedIndex:P0}=q7(),m0=i0[P0];if(F){const Q=l0.project.activeLayer.children;if(n){if(!k){const x0=[];if(m>0)x0.push(Q6[l.red]("red",Date.now().toString(36)));if(m>1)x0.push(Q6[l.yellow]("yellow",Date.now().toString(36)));if(m>2)x0.push(Q6[l.green]("green",Date.now().toString(36)));const O=a5(m0.script,x0),M0=new s4(O,E);M0.on("frame",()=>{M({player:Q.player.util.health,red:Q.red.util.health,yellow:Q.yellow.util.health,green:Q.green.util.health})}),u0(M0)}}else if(k)k.stop().then(()=>{M({player:100,red:100,yellow:100,green:100}),l0.project.activeLayer.children.forEach((x0)=>{if(x0.name==="background")return;if(x0.util instanceof N0||x0.owner instanceof N0)return;x0.remove()}),u0(!1)});else{if(Q.player.util.place=N0.PLACE.LEFT_TOP,m>0)Q.red.util.place=N0.PLACE.RIGHT_BOTTOM;else Q.red.util.hidden=!0;if(m>2)Q.yellow.util.place=N0.PLACE.RIGHT_TOP,Q.green.util.place=N0.PLACE.LEFT_BOTTOM;else Q.yellow.util.hidden=!0,Q.green.util.hidden=!0;l0.project.activeLayer.children.forEach((x0)=>{if(x0.name==="background")return;if(x0.util instanceof N0||x0.owner instanceof N0)return;x0.remove()})}}return X7(y5,{width:"480px",height:"480px",onSetup:(Q)=>{H(Q),l0.view.zoom=0.5,new l0.Raster({name:"background",source:r5,position:l0.view.center}),new N0("player",N0.STYLE.PLAYER,N0.PLACE.LEFT),new N0("red",N0.STYLE.ENEMY_A,N0.PLACE.RIGHT),new N0("yellow",N0.STYLE.ENEMY_B,N0.PLACE.RIGHT_BOTTOM),new N0("green",N0.STYLE.ENEMY_C,N0.PLACE.LEFT_BOTTOM)}})}import{jsx as X7} from"preact/jsx-runtime";import{useLocale as T7} from"@blockcode/core";import{classNames as X5} from"@blockcode/ui";function C6(n){const m=globalThis.document,l=m.createElement("style");l.appendChild(m.createTextNode(n)),m.head.append(l)}C6(".v2Obxa_toolbar-wrapper{height:var(--tool-bar-height);padding:var(--space)0;flex-shrink:0;justify-content:space-between;align-items:center;display:flex}.v2Obxa_green-flag,.v2Obxa_stop-all{user-select:none;cursor:pointer;border:0;border-radius:.25rem;width:2rem;height:2rem;padding:.375rem}.v2Obxa_green-flag:hover,.v2Obxa_stop-all:hover{background:var(--motion-light-transparent)}.v2Obxa_green-flag.v2Obxa_actived{background:var(--motion-transparent)}.v2Obxa_stop-all{opacity:.5}.v2Obxa_stop-all.v2Obxa_actived{opacity:1}.v2Obxa_green-flag.v2Obxa_disabled,.v2Obxa_stop-all.v2Obxa_disabled{opacity:.5}.v2Obxa_toolbar-button{width:calc(2rem + 2px);height:calc(2rem + 2px);padding:.375rem!important}.v2Obxa_space{margin-left:.2rem}.v2Obxa_toolbar-buttons-group{display:flex}.v2Obxa_group-button-first{border-top-right-radius:0;border-bottom-right-radius:0}.v2Obxa_group-button{border-left:none;border-radius:0}.v2Obxa_group-button-last{border-left:none;border-top-left-radius:0;border-bottom-left-radius:0}");var a6={groupButton:"v2Obxa_group-button",groupButtonLast:"v2Obxa_group-button-last",groupButtonFirst:"v2Obxa_group-button-first",actived:"v2Obxa_actived",greenFlag:"v2Obxa_green-flag",disabled:"v2Obxa_disabled",stopAll:"v2Obxa_stop-all",toolbarButton:"v2Obxa_toolbar-button",space:"v2Obxa_space",toolbarButtonsGroup:"v2Obxa_toolbar-buttons-group",toolbarWrapper:"v2Obxa_toolbar-wrapper"};var R5="./assets/icon-green-flag-8eb2c7e7b0a15fba.svg";var q5="./assets/icon-stop-all-21d83d10e3dd785f.svg";import{jsx as p4} from"preact/jsx-runtime";function E4({playing:n,onPlay:m,onStop:l}){const{getText:E}=T7();return p4("div",{className:a6.toolbarWrapper,children:p4("div",{className:a6.toolbarButtonsGroup,children:[p4("img",{className:X5(a6.greenFlag,{[a6.actived]:n}),src:R5,title:E("tankwar.player.greenFlag","Go"),onClick:m}),p4("img",{className:X5(a6.stopAll,{[a6.actived]:n}),src:q5,title:E("tankwar.player.stopAll","Stop"),onClick:l})]})})}C6(".XAeOQq_stage-wrapper{position:relative}.XAeOQq_stage{border:1px solid var(--ui-black-transparent);border-radius:var(--space);background:var(--ui-white);width:482px;height:482px;position:relative;overflow:hidden}");var N4={stage:"XAeOQq_stage",stageWrapper:"XAeOQq_stage-wrapper"};import{jsx as y4} from"preact/jsx-runtime";function a4({playing:n,enemies:m,enemiesAI:l,onChangePlaying:E,onChangeHealth:M}){const F=()=>E(!0),H=()=>E(!1);return y4("div",{className:N4.stageWrapper,children:[y4(E4,{playing:n,onPlay:F,onStop:H}),y4("div",{className:H7(N4.stage),children:y4(A5,{playing:n,enemies:m,enemiesAI:l,onRequestStop:H,onChangeHealth:M})})]})}import{useLocale as U7,useEditor as Z7} from"@blockcode/core";import{classNames as G6,Text as $6,Button as z6,Label as O6,BufferedInput as J7,ComingSoon as Q7} from"@blockcode/ui";C6('.lIvsca_stage-info-wrapper{margin-top:var(--space);background:var(--ui-white);color:var(--text-primary);border-radius:var(--space);border:1px solid var(--ui-black-transparent);padding:1rem}.lIvsca_row{justify-content:space-between;margin-top:.5rem;display:flex}.lIvsca_row-primary{margin-top:0}.lIvsca_group{flex-direction:row;align-items:center;display:inline-flex}.lIvsca_full-input{flex:1}.lIvsca_name-input{width:8rem}.lIvsca_button{min-width:calc(2rem + 2px);height:calc(2rem + 2px);padding:.375rem!important}.lIvsca_button-icon{margin:auto}.lIvsca_space{margin-left:.2rem}.lIvsca_toolbar-button-group{display:flex}.lIvsca_group-button-first{border-top-right-radius:0;border-bottom-right-radius:0}.lIvsca_group-button{border-left:none;border-radius:0}.lIvsca_group-button-last{border-left:none;border-top-left-radius:0;border-bottom-left-radius:0}.lIvsca_button-text{flex:auto}.lIvsca_group-button-toggled-on .lIvsca_button-text{color:#4c97ff}.lIvsca_tank-image{width:1.65rem}.lIvsca_health-progress{background:#f5f5f5;border-radius:10px;width:12rem;height:20px}.lIvsca_health-progress:before{counter-reset:progress var(--percent,0);content:counter(progress)"%\u2002";width:calc(12rem*var(--percent,0)/100);color:var(--ui-white);text-align:right;white-space:nowrap;background:#ff6680;border-radius:10px;height:20px;font-size:12px;line-height:20px;display:block;overflow:hidden}');var _0={groupButtonFirst:"lIvsca_group-button-first",healthProgress:"lIvsca_health-progress",tankImage:"lIvsca_tank-image",space:"lIvsca_space",toolbarButtonGroup:"lIvsca_toolbar-button-group",rowPrimary:"lIvsca_row-primary",nameInput:"lIvsca_name-input",button:"lIvsca_button",groupButton:"lIvsca_group-button",buttonText:"lIvsca_button-text",groupButtonLast:"lIvsca_group-button-last",fullInput:"lIvsca_full-input",groupButtonToggledOn:"lIvsca_group-button-toggled-on",group:"lIvsca_group",stageInfoWrapper:"lIvsca_stage-info-wrapper",buttonIcon:"lIvsca_button-icon",row:"lIvsca_row"};var e5="./assets/tank-2-95f1944eace1f71a.png";var F5="./assets/tank-3-fc6d9534c6d7bba5.png";var T5="./assets/tank-4-79e2f163c902d864.png";import{jsx as C0} from"preact/jsx-runtime";var $7=[e5,F5,T5];function O4({playing:n,enemies:m,enemiesAI:l,health:E,onChangeEnemies:M,onChangeEnemyAI:F}){const{getText:H}=U7(),{fileList:k,modifyFile:u0}=Z7(),i0=k[0],P0=(m0,S0)=>{u0({[m0]:S0})};return C0("div",{className:_0.stageInfoWrapper,children:[C0("div",{className:G6(_0.row,_0.rowPrimary),children:[C0(O6,{text:H("tankwar.stageInfo.player","Player"),children:C0(J7,{disabled:n,className:_0.nameInput,placeholder:H("tankwar.stageInfo.nickname","Nickname"),onSubmit:(m0)=>P0("name",m0),value:i0.name})}),C0(O6,{secondary:!0,className:_0.health,text:H("tankwar.stageInfo.health","Health"),children:C0("div",{className:_0.healthProgress,style:`--percent:${E.player||0}`})})]}),C0("div",{className:_0.row,children:[C0(O6,{secondary:!0,text:H("tankwar.stageInfo.enemies","Enemies"),children:[C0(z6,{disabled:n,className:G6(_0.button,_0.groupButtonFirst,{[_0.groupButtonToggledOn]:m===0}),onClick:()=>M(0),children:C0("div",{className:_0.buttonText,children:"0"})}),C0(z6,{disabled:n,className:G6(_0.button,_0.groupButton,{[_0.groupButtonToggledOn]:m===1}),onClick:()=>M(1),children:C0("div",{className:_0.buttonText,children:"1"})}),C0(z6,{disabled:n,className:G6(_0.button,_0.groupButtonLast,{[_0.groupButtonToggledOn]:m===3}),onClick:()=>M(3),children:C0("div",{className:_0.buttonText,children:"3"})})]}),m>0&&C0(O6,{secondary:!0,children:[C0(z6,{disabled:n,className:G6(_0.button,_0.groupButtonFirst,{[_0.groupButtonToggledOn]:!0}),children:C0("div",{className:_0.buttonText,children:C0($6,{id:"tankwar.stageInfo.mode.local",defaultMessage:"Local AI"})})}),C0(Q7,{placement:"bottom",children:C0(z6,{disabled:n,className:G6(_0.button,_0.groupButtonLast,{[_0.groupButtonToggledOn]:!1}),children:C0("div",{className:_0.buttonText,children:C0($6,{id:"tankwar.stageInfo.mode.remote",defaultMessage:"Remote Players"})})})})]})]}),["red","yellow","green"].slice(0,m).map((m0,S0)=>C0("div",{className:_0.row,children:[C0(O6,{secondary:!0,children:C0("img",{className:_0.tankImage,src:$7[S0],alt:H(`tankwar.stageInfo.enemy.${m0}`,m0.replace(m0[0],m0[0].toUpperCase())),title:H(`tankwar.stageInfo.enemy.${m0}`,m0.replace(m0[0],m0[0].toUpperCase()))})}),C0(O6,{secondary:!0,children:C0("div",{className:_0.healthProgress,style:`--percent:${E[m0]||0}`})}),C0(O6,{secondary:!0,text:H("tankwar.stageInfo.ai","AI"),children:[C0(z6,{disabled:n,className:G6(_0.button,_0.groupButtonFirst,{[_0.groupButtonToggledOn]:l[m0]==="simple"}),onClick:()=>F(m0,"simple"),children:C0("div",{className:_0.buttonText,children:C0($6,{id:"tankwar.stageInfo.ai.simple",defaultMessage:"Simple"})})}),C0(z6,{disabled:n,className:G6(_0.button,_0.groupButton,{[_0.groupButtonToggledOn]:l[m0]==="medium"}),onClick:()=>F(m0,"medium"),children:C0("div",{className:_0.buttonText,children:C0($6,{id:"tankwar.stageInfo.ai.medium",defaultMessage:"Medium"})})}),C0(z6,{disabled:n,className:G6(_0.button,_0.groupButtonLast,{[_0.groupButtonToggledOn]:l[m0]==="senior"}),onClick:()=>F(m0,"senior"),children:C0("div",{className:_0.buttonText,children:C0($6,{id:"tankwar.stageInfo.ai.senior",defaultMessage:"Senior"})})})]})]},S0))]})}C6(".aTXsAq_sidebar-wrapper{flex-direction:column;height:100%;display:flex}.aTXsAq_stage-wrapper{display:flex}.aTXsAq_selector-wrapper{margin-top:var(--space);flex-direction:row;height:100%;display:flex}");var A4={selectorWrapper:"aTXsAq_selector-wrapper",sidebarWrapper:"aTXsAq_sidebar-wrapper",stageWrapper:"aTXsAq_stage-wrapper"};import{jsx as R4} from"preact/jsx-runtime";function q4(){const[n,m]=w4(!1),[l,E]=w4(1),[M,F]=w4({red:"simple",yellow:"medium",green:"senior"}),[H,k]=w4({player:100,red:100,yellow:100,green:100});return R4("div",{className:A4.sidebarWrapper,children:[R4(a4,{className:A4.stageWrapper,playing:n,enemies:l,enemiesAI:M,onChangePlaying:m,onChangeHealth:k}),R4(O4,{playing:n,enemies:l,enemiesAI:M,health:H,onChangeEnemies:E,onChangeEnemyAI:(u0,i0)=>F({...M,[u0]:i0})})]})}var H5={fileList:[{id:"player",name:"player"}]};var K5={"tankwar.player.greenFlag":"Go","tankwar.player.stopAll":"Stop","tankwar.stageInfo.player":"Player","tankwar.stageInfo.nickname":"Nickname","tankwar.stageInfo.enemies":"Enemies","tankwar.stageInfo.health":"Health","tankwar.stageInfo.enemy.red":"Red","tankwar.stageInfo.enemy.yellow":"Yellow","tankwar.stageInfo.enemy.green":"Green","tankwar.stageInfo.mode.local":"Local AI","tankwar.stageInfo.mode.remote":"Remote Players","tankwar.stageInfo.ai":"AI","tankwar.stageInfo.ai.simple":"Simple","tankwar.stageInfo.ai.medium":"Medium","tankwar.stageInfo.ai.senior":"Senior","tankwar.blocks.motion_attack":"fire in direction %1 at %2 steps","tankwar.blocks.motion_move":"forward in direction %1 at %2 % speed","tankwar.blocks.motion_setspeed":"set speed to %1 %","tankwar.blocks.motion_stop":"stop","tankwar.blocks.motion_speed":"speed","tankwar.blocks.sensing_scanwidth":"set scan width to %1","tankwar.blocks.sensing_scan":"scan for enemy in direction %1?","tankwar.blocks.sensing_distance":"measure distance of enemy in direction %1","tankwar.blocks.sensing_health":"health"};var Y5={"tankwar.player.greenFlag":"\u8FD0\u884C","tankwar.player.stopAll":"\u505C\u6B62","tankwar.stageInfo.player":"\u73A9\u5BB6","tankwar.stageInfo.nickname":"\u6635\u79F0","tankwar.stageInfo.enemies":"\u654C\u65B9\u6570\u91CF","tankwar.stageInfo.health":"\u751F\u547D\u503C","tankwar.stageInfo.enemy.red":"\u7EA2","tankwar.stageInfo.enemy.yellow":"\u9EC4","tankwar.stageInfo.enemy.green":"\u7EFF","tankwar.stageInfo.mode.local":"\u672C\u673A AI","tankwar.stageInfo.mode.remote":"\u8054\u7F51\u73A9\u5BB6","tankwar.stageInfo.ai":"AI \u7B56\u7565","tankwar.stageInfo.ai.simple":"\u7B80\u5355","tankwar.stageInfo.ai.medium":"\u4E2D\u7B49","tankwar.stageInfo.ai.senior":"\u9AD8\u7EA7","tankwar.blocks.motion_attack":"\u671D\u5411 %1 \u65B9\u5411\u8DDD\u79BB %2 \u6B65\u53D1\u5C04\u70AE\u5F39","tankwar.blocks.motion_move":"\u4EE5 %2 % \u901F\u5EA6\u9762\u5411 %1 \u65B9\u5411\u524D\u8FDB","tankwar.blocks.motion_setspeed":"\u5C06\u901F\u5EA6\u8BBE\u4E3A %1 %","tankwar.blocks.motion_stop":"\u505C\u6B62\u524D\u8FDB","tankwar.blocks.motion_speed":"\u901F\u5EA6","tankwar.blocks.sensing_scanwidth":"\u5C06\u96F7\u8FBE\u626B\u63CF\u5BBD\u5EA6\u8BBE\u4E3A %1","tankwar.blocks.sensing_scan":"\u96F7\u8FBE\u626B\u63CF %1 \u65B9\u5411\u6709\u654C\u4EBA\uFF1F","tankwar.blocks.sensing_distance":"\u96F7\u8FBE\u6D4B\u91CF %1 \u65B9\u5411\u654C\u4EBA\u7684\u8DDD\u79BB","tankwar.blocks.sensing_health":"\u751F\u547D\u503C"};import{jsx as u3} from"preact/jsx-runtime";function t3({addLocaleData:n,setLayout:m,openStoreLibrary:l,closeStoreLibrary:E,setPrompt:M,setAlert:F,removeAlert:H,hideSplashScreen:k,openProject:u0}){n(g5),n({en:K5,"zh-Hans":Y5});const i0=()=>{u0(Object.assign(H5,{selectedIndex:0}))};i0(),m({menus:h5({openStoreLibrary:l,closeStoreLibrary:E,newProject:i0,setPrompt:M,setAlert:F,removeAlert:H,extendsMenu:[{id:"device",hidden:!0}],onSave:()=>{return{thumb:document.querySelector("#blockcode-blocks-player").toDataURL()}}}),tabs:[{...f4,Content:()=>u3(z4,{onReady:k})}],sidebars:[{expand:"right",Content:q4}],pane:!1,tutorials:!0,canEditProjectName:!0})}export{t3 as default};
