var A4=Object.defineProperty;var E4=(v,p)=>{for(var r in p)A4(v,r,{get:p[r],enumerable:!0,configurable:!0,set:(V)=>p[r]=()=>V})};import{Text as G8} from"@blockcode/ui";import{Keys as R0} from"@blockcode/core";import{Text as F0,Spinner as X4} from"@blockcode/ui";import{ScratchBlocks as O4} from"@blockcode/blocks-editor";import{Serial as a4,sleep as i8} from"@blockcode/core";var e4=function(v,p){return new Promise((r)=>{const V=new Image;V.src=`data:${v};base64,${p}`,V.addEventListener("load",async()=>{const G=new OffscreenCanvas(V.width,V.height).getContext("2d",{willReadFrequently:!0});G.drawImage(V,0,0);const T=[];for(let F=0;F<V.height;F++)for(let _=0;_<V.width;_++){const[$,U,S0,n0]=G.getImageData(_,F,1,1).data,d0=n0===0?0:R4($,U,S0);T.push(d0>>8&255),T.push(d0&255)}r(Uint8Array.from(T))})})},z8=function(v){return v.replaceAll("\r\n","\n")},o8=function(v){return v.slice(2,-3)},q4="\x01",B8="\x02",h8="\x03",u8="\x04",_8=128;class k8{constructor(){this.serial=null,this._connected=!1,this._encoder=new TextEncoder,this._decoder=new TextDecoder}requestPort(v=[]){return navigator.serial.requestPort({filters:v}).then((p)=>{this.serial=new a4(p),this.serial.on("connect",()=>this._connected=!0),this.serial.on("disconnect",()=>this._connected=!1)})}connect(v={}){return new Promise((p,r)=>{if(this.serial)this.serial.open({baudRate:115200,...v}).then(p).catch(r);else r(new Error("No device specified"))})}get connected(){return this._connected}disconnect(){return this.serial.close()}get deviceInfo(){return this.serial.getInfo()}readUntil(v,p){return new Promise((r)=>{let V="";const G=async(T)=>{if(T){if(V+=this._decoder.decode(T),p)p(T)}if(V.indexOf(v)!==-1)this.serial.off("data",G),r(V)};this.serial.on("data",G)})}writeAndReadUntil(v,p,r){return new Promise(async(V)=>{if(p)this.readUntil(p,r).then(V);for(let G=0;G<v.length;G+=_8)await this.serial.write(v.slice(G,G+_8)),await i8(10);if(!p)V()})}async getPrompt(){return await i8(150),await this.stop(),await i8(150),await this.writeAndReadUntil(`\r${h8}${B8}`,"\r\n>>>")}async enterRawRepl(){return await this.writeAndReadUntil(q4,"raw REPL; CTRL-B to exit")}async exitRawRepl(){return await this.writeAndReadUntil(B8,"\r\n>>>")}async execRaw(v,p){return await this.writeAndReadUntil(v),await this.writeAndReadUntil(u8,`${u8}>`,p)}async execFile(v,p){if(p=p||function(){},v){await this.enterRawRepl();const r=await this.execRaw(v,p);return await this.exitRawRepl(),r}return Promise.reject()}async run(v,p){return p=p||function(){},new Promise(async(r,V)=>{if(this.rejectRun)this.rejectRun(new Error("re-run")),this.rejectRun=null;this.rejectRun=V;try{await this.enterRawRepl();const G=await this.execRaw(v||"#",p);return await this.exitRawRepl(),r(G)}catch(G){V(G),this.rejectRun=null}})}async eval(v){await this.serial.write(v)}async stop(){if(this.rejectRun)this.rejectRun(new Error("pre stop")),this.rejectRun=null;await this.serial.write(h8)}async reset(){if(this.rejectRun)this.rejectRun(new Error("pre reset")),this.rejectRun=null;await this.serial.write(h8),await this.serial.write(u8)}async exists(v){v=v||"";let p="";p+="try:\n",p+=`  f = open('${v}', 'r')\n`,p+="  print(1)\n",p+="except OSError:\n",p+="  print(0)\n",await this.enterRawRepl();let r=await this.execRaw(p);return await this.exitRawRepl(),r[2]=="1"}async listdir(v){v=v||"";let p="";p+="import os\n",p+="try:\n",p+=`  print(os.listdir('${v}'))\n`,p+="except OSError:\n",p+="  print([])\n",await this.enterRawRepl();let r=await this.execRaw(p);return await this.exitRawRepl(),r=o8(r),r=r.replace(/'/g,'"'),JSON.parse(r)}async mkdir(v){if(v){await this.enterRawRepl();const p=await this.execRaw(`import os\nos.mkdir('${v}')`);return await this.exitRawRepl(),p}return Promise.reject(new Error("Path to file was not specified"))}async rmdir(v){if(v){let p="";p+="import os\n",p+="try:\n",p+=`  os.rmdir("${v}")\n`,p+="except OSError:\n",p+="  print(0)\n",await this.enterRawRepl();const r=await this.execRaw(p);return await this.exitRawRepl(),r}return Promise.reject(new Error("Path to file was not specified"))}async remove(v){if(v){let p="";p+="import os\n",p+="try:\n",p+=`  os.remove("${v}")\n`,p+="except OSError:\n",p+="  print(0)\n",await this.enterRawRepl();const r=await this.execRaw(p);return this.exitRawRepl()}return Promise.reject(new Error("Path to file was not specified"))}async rename(v,p){if(v&&p){await this.enterRawRepl();const r=await this.execRaw(`import os\nos.rename('${v}', '${p}')`);return this.exitRawRepl()}return Promise.reject(new Error("Path to file was not specified"))}async cat(v){if(v){await this.enterRawRepl();let p=await this.execRaw(`with open('${v}','r') as f:\n while 1:\n  b=f.read(256)\n  if not b:break\n  print(b,end='')`);return await this.exitRawRepl(),p=o8(p),z8(p)}return Promise.reject(new Error("Path to file was not specified"))}async put(v,p,r){if(r=r||function(){},v&&p){let V;if(typeof v==="string")V=this._encoder.encode(z8(v));else if(v instanceof ArrayBuffer)V=new Uint8Array(v);else if(v instanceof Uint8Array)V=v;else Promise.reject(new Error(`${v} must string, Uint8Array or ArrayBuffer`));const G=Array.from(V).map((_)=>_.toString(16).padStart(2,"0"));let T="";T+=await this.enterRawRepl(),T+=await this.execRaw(`f=open('${p}','w')\nw=f.write`);const F=48;for(let _=0;_<G.length;_+=F){let $=`w(bytes([${G.slice(_,_+F).map((U)=>`0x${U}`).join(",")}]))`;T+=await this.execRaw($),r(parseInt(_/G.length*100))}return T+=await this.execRaw("f.close()"),T+=await this.exitRawRepl(),r(100),T}return Promise.reject(new Error("Must specify content and destination path"))}}var R4=(v,p,r)=>(v&248)<<8|(p&252)<<3|r>>3,f8=async(v,p)=>{const r=new k8;await r.requestPort(v),await r.connect(),await r.stop(),p(r);const V=()=>setTimeout(async()=>{if(r.connected)V();else p(null)},1000);return V(),r},L8=async(v,p)=>{await v.disconnect(),p(null)},t8=async(v,p,r)=>{await v.stop();const V=p.length;let G=0;const T=(F)=>{r(parseInt((G+1/V*(F/100))*100))};for(let F of p){let{id:_,content:$}=F;if(F.type==="text/x-python")_+=".py";else if(F.type.startsWith("image/"))$=await e4(F.type,F.data);console.log(_),await v.put($,_,T),G+=1/V}r(100),await v.reset()};import{jsx as e0} from"preact/jsx-runtime";var V8=function({newProject:v,openStoreLibrary:p,setPrompt:r,setAlert:V,removeAlert:G,extendsMenu:T,filters:F}={}){let _=()=>{},$=()=>{},U;const S0=()=>{if(U=O4.getMainWorkspace(),U){U.addChangeListener(()=>{_(U.undoStack_.length===0),$(U.redoStack_.length===0)}),_(U.undoStack_.length===0),$(U.redoStack_.length===0);return}setTimeout(S0)};S0();const n0=(Q)=>{if(!n0.id)n0.id=`download.${Date.now()}`;if(Q<100){if(V)V({id:n0.id,icon:e0(X4,{level:"success"}),message:e0(F0,{id:"blocks.alert.downloading",defaultMessage:"Downloading...{progress}%",progress:Q})})}else if(G)G(n0.id),delete n0.id},d0={label:e0(F0,{id:"blocks.menu.file",defaultMessage:"File"}),menuItems:[[{label:e0(F0,{id:"blocks.menu.file.newProject",defaultMessage:"New"}),hotkey:[c6?R0.COMMAND:R0.CONTROL,R0.N],onClick({context:Q}){if(Q.modified)r({title:e0(F0,{id:"gui.projects.notSaved",defaultMessage:"Not saved"}),label:e0(F0,{id:"gui.projects.replaceProject",defaultMessage:"Replace contents of the current project?"}),onSubmit:v});else v()}}],[{label:e0(F0,{id:"blocks.menu.file.openProject",defaultMessage:"Open"}),hotkey:[c6?R0.COMMAND:R0.CONTROL,R0.O],onClick(){p()}},{label:e0(F0,{id:"blocks.menu.file.saveProject",defaultMessage:"Save"}),hotkey:[c6?R0.COMMAND:R0.CONTROL,R0.S],onClick({context:Q}){if(Q.saveNow(),n0.id)return;if(Q.device&&Q.editor.autoDownload)t8(Q.device,[].concat(Q.fileList,Q.assetList),n0)}}],[{label:e0(F0,{id:"blocks.menu.file.uploadProject",defaultMessage:"Load from your computer"}),disabled:!0,async onClick(){console.log("upload")}},{label:e0(F0,{id:"blocks.menu.file.downloadProject",defaultMessage:"save to your computer"}),disabled:!0,async onClick(){console.log("download")}}]]},i0={label:e0(F0,{id:"blocks.menu.edit",defaultMessage:"Edit"}),menuItems:[[{label:e0(F0,{id:"blocks.menu.edit.undo",defaultMessage:"Undo"}),hotkey:[c6?R0.COMMAND:R0.CONTROL,R0.Z],onDisable({setDisable:Q}){if(_=Q,U)_(U.undoStack_.length===0)},async onClick(Q){if(Q instanceof MouseEvent&&U)U.undo(!1)}},{label:e0(F0,{id:"blocks.menu.edit.redo",defaultMessage:"Redo"}),hotkey:c6?[R0.SHIFT,R0.COMMAND,R0.Z]:[R0.CONTROL,R0.Y],onDisable({setDisable:Q}){if($=Q,U)$(U.redoStack_.length===0)},async onClick(Q){if(Q instanceof MouseEvent&&U)U.undo(!0)}}]]},I0={label:e0(F0,{id:"blocks.menu.device",defaultMessage:"Device"}),menuItems:[[{label:e0(F0,{id:"blocks.menu.device.connect",defaultMessage:"Connect your device"}),onLabel({locale:Q,context:K}){if(K.device)return Q.getText("blocks.menu.device.disconnect","Disconnect this device");return Q.getText("blocks.menu.device.connect","Connect your device")},onClick({context:Q}){if(Q.device)L8(Q.device,Q.connectDevice);else f8(F||T4,Q.connectDevice)}},{label:e0(F0,{id:"blocks.menu.device.download",defaultMessage:"Download program"}),async onClick({context:Q}){if(n0.id)return;let{device:K}=Q;if(!K)K=await f8(F,Q.connectDevice);t8(K,[].concat(Q.fileList,Q.assetList),n0)}}],[{label:e0(F0,{id:"blocks.menu.device.turnOnAutoDownload",defaultMessage:"Turn on auto download"}),onLabel({locale:Q,context:K}){if(K.editor.autoDownload)return Q.getText("blocks.menu.device.turnOffAutoDownload","Turn off auto download");return Q.getText("blocks.menu.device.turnOnAutoDownload","Turn on auto download")},onDisable({context:Q,setDisable:K}){if(!Q.device&&Q.editor.autoDownload)Q.setEditor({autoDownload:!1});K(!Q.device)},async onClick({context:Q}){Q.setEditor({autoDownload:!Q.editor.autoDownload})}}]]};T=T||[];const a=(Q,K)=>{const h6=T.findIndex((u0)=>u0.id===K);if(h6>=0){const[u0]=T.splice(h6,1);if(u0.hidden)return[];Q.menuItems.concat(u0.menuItems)}return Q};return[].concat(a(d0,"file"),a(i0,"edit"),a(I0,"device"),T)};import{ScratchBlocks as U0} from"@blockcode/blocks-editor";import{ScratchBlocks as v8} from"@blockcode/blocks-editor";import{ScratchBlocks as A8} from"@blockcode/blocks-editor";import{useState as c8} from"preact/hooks";import{useLocale as F4,useEditor as H4} from"@blockcode/core";import{classNames as Y4,ComingSoon as Z4} from"@blockcode/ui";import{BlocksEditor as W4,ScratchBlocks as n6,makeToolboxXML as K4} from"@blockcode/blocks-editor";import{useRef as U4,useEffect as J4,useState as M8} from"preact/hooks";import{classNames as Q4,Text as z6,Button as D8,Modal as $4,BufferedInput as i5} from"@blockcode/ui";var m8=function(v){const p=globalThis.document,r=p.createElement("style");r.appendChild(p.createTextNode(v)),p.head.append(r)};import{jsx as D0} from"preact/jsx-runtime";var h5=function({title:v,label:p,defaultValue:r,enableLocalVariable:V,showListMessage:G,showVariableOptions:T,showCloudOption:F,onClose:_,onSubmit:$}){const U=U4(null),[S0,n0]=M8(r),[d0,i0]=M8({scope:"global",isCloud:!1}),I0=()=>{$(S0,d0)},a=(Q)=>{if(Q.key==="Escape")_();if(Q.key==="Enter")$(U.current.base.value,d0)};return J4(()=>{if(U.current)U.current.base.focus(),window.addEventListener("keydown",a);return()=>{window.removeEventListener("keydown",a)}},[U]),D0($4,{title:v,className:v6.promptModal,onClose:_,children:D0("div",{className:v6.promptContent,children:[D0("div",{className:v6.label,children:p}),D0(i5,{autoFocus:!0,forceFocus:!0,ref:U,className:v6.variableNameTextInput,defaultValue:S0,onSubmit:n0}),T&&D0("div",{children:V?D0("div",{className:v6.options,children:[D0("label",{children:[D0("input",{checked:d0.scope==="global",name:"variableScopeOption",type:"radio",value:"global",onChange:()=>i0({...d0,scope:"global"})}),D0(z6,{id:"blocks.dataPrompt.forAllTargets",defaultMessage:"For all targets"})]}),D0("label",{children:[D0("input",{checked:d0.scope==="local",name:"variableScopeOption",type:"radio",value:"local",onChange:()=>i0({...d0,scope:"local"})}),D0(z6,{id:"blocks.dataPrompt.forThisTarget",defaultMessage:"For this target only"})]})]}):D0("div",{className:v6.infoMessage,children:G?D0(z6,{id:"blocks.dataPrompt.listAvailableToAllTargets",defaultMessage:"This list will be available to all targets."}):D0(z6,{id:"blocks.dataPrompt.availableToAllTargets",defaultMessage:"This variable will be available to all targets."})})}),D0("div",{className:v6.buttonRow,children:[D0(D8,{className:v6.button,onClick:_,children:D0(z6,{id:"blocks.dataPrompt.cancel",defaultMessage:"Cancel"})}),D0(D8,{className:Q4(v6.button,v6.okButton),onClick:I0,children:D0(z6,{id:"blocks.dataPrompt.ok",defaultMessage:"OK"})})]})]})})};import{jsx as b6} from"preact/jsx-runtime";var f5=function({toolbox:v,messages:p,xml:r,enableMultiTargets:V,enableLocalVariable:G,disableGenerator:T,disableExtension:F,onChange:_}){const{getText:$}=F4(),{fileList:U,selectedIndex:S0,modifyFile:n0}=H4(),[d0,i0]=c8(),[I0,a]=c8(!1);if(p={EVENT_WHENPROGRAMSTART:$("blocks.event.programStart","when program start"),CONTROL_STOP_OTHER:$("blocks.control.stopOther","other scripts"),...p||[]},n6.prompt=(H0,l0,_0,g6,m0)=>{const q0={callback:_0,message:H0,defaultValue:l0};q0.title=g6?g6:n6.Msg.VARIABLE_MODAL_TITLE,q0.varType=typeof m0==="string"?m0:n6.SCALAR_VARIABLE_TYPE,q0.showVariableOptions=V&&m0!==n6.BROADCAST_MESSAGE_VARIABLE_TYPE&&q0.title!==n6.Msg.RENAME_VARIABLE_MODAL_TITLE&&q0.title!==n6.Msg.RENAME_LIST_MODAL_TITLE,q0.showCloudOption=m0===n6.SCALAR_VARIABLE_TYPE&&this.props.canUseCloud,a(q0)},v=v||K4(),!r&&S0!==-1){const H0=U[S0];r=H0&&H0.xml}let Q;if(d0)Q=d0.getAllVariables().filter((H0)=>{if(H0.isLocal)return!1;if(H0.type===n6.BROADCAST_MESSAGE_VARIABLE_TYPE){if(H0.name===n6.Msg.DEFAULT_BROADCAST_MESSAGE_NAME)return!1;const l0=H0.id_.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),_0=new RegExp(`<field name="BROADCAST_OPTION" id="${l0}"[^>]+>[^<]+</field>`,"g");for(let g6 of U)if(_0.test(g6.xml))return!0;return!1}return!0});const K=_||((H0,l0)=>{const _0={xml:H0};if(!T)_0.content=M.workspaceToCode(l0);n0(_0)}),h6=(H0,l0)=>{I0.callback(H0,[],l0),a(!1)},u0=()=>a(!1);return b6("div",{className:n8.editorWrapper,children:[b6(W4,{toolbox:v,messages:p,xml:r,variables:Q,onWorkspaceCreated:i0,onChange:S0!==-1?K:null}),F?null:b6("div",{className:Y4("scratchCategoryMenu",n8.extensionButton),children:b6(Z4,{children:b6("button",{className:n8.addButton,title:$("blocks.extensions.addExtension","Add Extension"),children:b6("img",{src:u5,title:"Add Extension"})})})}),I0&&b6(h5,{title:I0.title,label:I0.message,defaultValue:I0.defaultValue,enableLocalVariable:G,showListMessage:I0.varType===n6.LIST_VARIABLE_TYPE,showVariableOptions:I0.showVariableOptions,showCloudOption:I0.showCloudOption,onClose:u0,onSubmit:h6})]})};import{jsx as n5} from"preact/jsx-runtime";var v5=function(){return n5("div",{className:t5.pane})};import{jsx as E8} from"preact/jsx-runtime";var T4=[{usbVendorId:12346},{usbVendorId:11914}],c6=/Mac/i.test(navigator.platform||navigator.userAgent);var M=new U0.Generator("Python");M.addReservedWords("False,None,True,and,as,assert,break,class,continue,def,del,elif,else,except,exec,finally,for,from,global,if,import,in,is,lambda,nonlocal,not,or,pass,print,raise,return,try,while,with,yield,NotImplemented,Ellipsis,__debug__,quit,exit,copyright,license,credits,ArithmeticError,AssertionError,AttributeError,BaseException,BlockingIOError,BrokenPipeError,BufferError,BytesWarning,ChildProcessError,ConnectionAbortedError,ConnectionError,ConnectionRefusedError,ConnectionResetError,DeprecationWarning,EOFError,Ellipsis,EnvironmentError,Exception,FileExistsError,FileNotFoundError,FloatingPointError,FutureWarning,GeneratorExit,IOError,ImportError,ImportWarning,IndentationError,IndexError,InterruptedError,IsADirectoryError,KeyError,KeyboardInterrupt,LookupError,MemoryError,ModuleNotFoundError,NameError,NotADirectoryError,NotImplemented,NotImplementedError,OSError,OverflowError,PendingDeprecationWarning,PermissionError,ProcessLookupError,RecursionError,ReferenceError,ResourceWarning,RuntimeError,RuntimeWarning,StandardError,StopAsyncIteration,StopIteration,SyntaxError,SyntaxWarning,SystemError,SystemExit,TabError,TimeoutError,TypeError,UnboundLocalError,UnicodeDecodeError,UnicodeEncodeError,UnicodeError,UnicodeTranslateError,UnicodeWarning,UserWarning,ValueError,Warning,ZeroDivisionError,_,__build_class__,__debug__,__doc__,__import__,__loader__,__name__,__package__,__spec__,abs,all,any,apply,ascii,basestring,bin,bool,buffer,bytearray,bytes,callable,chr,classmethod,cmp,coerce,compile,complex,copyright,credits,delattr,dict,dir,divmod,enumerate,eval,exec,execfile,exit,file,filter,float,format,frozenset,getattr,globals,hasattr,hash,help,hex,id,input,int,intern,isinstance,issubclass,iter,len,license,list,locals,long,map,max,memoryview,min,next,object,oct,open,ord,pow,print,property,quit,range,raw_input,reduce,reload,repr,reversed,round,set,setattr,slice,sorted,staticmethod,str,sum,super,tuple,type,unichr,unicode,vars,xrange,zip");M.ORDER_ATOMIC=0;M.ORDER_COLLECTION=1;M.ORDER_STRING_CONVERSION=1;M.ORDER_MEMBER=2.1;M.ORDER_FUNCTION_CALL=2.2;M.ORDER_EXPONENTIATION=3;M.ORDER_UNARY_SIGN=4;M.ORDER_BITWISE_NOT=4;M.ORDER_MULTIPLICATIVE=5;M.ORDER_ADDITIVE=6;M.ORDER_BITWISE_SHIFT=7;M.ORDER_BITWISE_AND=8;M.ORDER_BITWISE_XOR=9;M.ORDER_BITWISE_OR=10;M.ORDER_RELATIONAL=11;M.ORDER_LOGICAL_NOT=12;M.ORDER_LOGICAL_AND=13;M.ORDER_LOGICAL_OR=14;M.ORDER_CONDITIONAL=15;M.ORDER_LAMBDA=16;M.ORDER_NONE=99;M.ORDER_OVERRIDES=[[M.ORDER_FUNCTION_CALL,M.ORDER_MEMBER],[M.ORDER_FUNCTION_CALL,M.ORDER_FUNCTION_CALL],[M.ORDER_MEMBER,M.ORDER_MEMBER],[M.ORDER_MEMBER,M.ORDER_FUNCTION_CALL],[M.ORDER_LOGICAL_NOT,M.ORDER_LOGICAL_NOT],[M.ORDER_LOGICAL_AND,M.ORDER_LOGICAL_AND],[M.ORDER_LOGICAL_OR,M.ORDER_LOGICAL_OR]];M.init=(v)=>{if(M.PASS=M.INDENT+"pass\n",M.definitions_=Object.create(null),M.functionNames_=Object.create(null),!M.variableDB_)M.variableDB_=new U0.Names(M.RESERVED_WORDS_);else M.variableDB_.reset();M.variableDB_.setVariableMap(v.getVariableMap());const p=[],r=v.getAllVariables();for(let G=0;G<r.length;G++){if(r[G].type===U0.BROADCAST_MESSAGE_VARIABLE_TYPE)continue;const T=M.variableDB_.getName(r[G].getId(),U0.Variables.NAME_TYPE);if(r[G].type===U0.LIST_VARIABLE_TYPE)p.push(`${T}_${U0.LIST_VARIABLE_TYPE} = []`);else p.push(`${T} = None`)}const V=U0.Variables.allDeveloperVariables(v);for(let G=0;G<V.length;G++){const T=M.variableDB_.getName(V[G],U0.Names.DEVELOPER_VARIABLE_TYPE);if(r[G].type===U0.LIST_VARIABLE_TYPE)p.push(`${T}_${U0.LIST_VARIABLE_TYPE} = []`);else p.push(`${T} = None`)}if(p.length)M.definitions_.variables=p.join("\n");M.definitions_.import_popsicle_scratch="from popsicle.scratch import *"};M.finish=(v)=>{const p=[],r=[];for(let V in M.definitions_){const G=M.definitions_[V];if(G.match(/^(from\s+\S+\s+)?import\s+\S+/))p.push(G);else r.push(G)}return delete M.definitions_,delete M.functionNames_,M.variableDB_.reset(),(p.join("\n")+"\n\n"+r.join("\n\n")).replace(/\n\n+/g,"\n\n").replace(/\n*$/,"\n\n\n")+v};M.scrubNakedValue=(v)=>{return v+"\n"};M.quote_=(v)=>{v=v.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/\%/g,"\\%");let p="'";if(v.indexOf("'")!==-1)if(v.indexOf('"')===-1)p='"';else v=v.replace(/'/g,"\\'");return p+v+p};M.scrub_=(v,p)=>{let r="";if(!v.outputConnection||!v.outputConnection.targetConnection){let V=v.getCommentText();if(V=U0.utils.wrap(V,M.COMMENT_WRAP-3),V)if(v.getProcedureDef)r+='"""'+V+'\n"""\n';else r+=M.prefixLines(V+"\n","# ");for(let G=0;G<v.inputList.length;G++)if(v.inputList[G].type==U0.INPUT_VALUE){const T=v.inputList[G].connection.targetBlock();if(T){const F=M.allNestedComments(T);if(F)r+=M.prefixLines(F,"# ")}}}if(v.startHat_){const V=v.nextConnection&&v.nextConnection.targetBlock();let G=M.blockToCode(V);if(G)G=M.prefixLines(G,M.INDENT),p=p.replace(`:\n${M.PASS}`,`:\n${G}`);return r+p}if(v.parentBlock_){const V=v.nextConnection&&v.nextConnection.targetBlock(),G=M.blockToCode(V);return r+p+G}};M.getAdjustedInt=(v,p,r,V)=>{let G=r||0;if(v.workspace.options.oneBasedIndex)G--;const T=v.workspace.options.oneBasedIndex?"1":"0",F=G?M.ORDER_ADDITIVE:M.ORDER_NONE;let _=M.valueToCode(v,p,F)||T;if(U0.isNumber(_)){if(_=parseInt(_,10)+G,V)_=-_}else{if(G>0)_="int("+_+" + "+G+")";else if(G<0)_="int("+_+" - "+-G+")";else _="int("+_+")";if(V)_="-"+_}return _};M.functionToCode=(v="",...p)=>{if(!M.functionNames_[v])M.functionNames_[v]=0;M.functionNames_[v]+=1,v=`${v}_${M.functionNames_[v]}`;const r=`async def ${v}(${p.join(",")}):\n${M.PASS}`;return[v,r]};M.control_wait=(v)=>{let p="";if(M.STATEMENT_PREFIX)p+=M.injectId(M.STATEMENT_PREFIX,v);const r=M.valueToCode(v,"DURATION",M.ORDER_NONE);return p+=`await wait_for(${r})\n`,p};M.control_repeat=(v)=>{let p="",r,V;if(M.STATEMENT_PREFIX)p+=M.injectId(M.STATEMENT_PREFIX,v);if(r=M.valueToCode(v,"TIMES",M.ORDER_NONE)||"False",V=M.statementToCode(v,"SUBSTACK")||M.PASS,M.STATEMENT_SUFFIX)V=M.prefixLines(M.injectId(M.STATEMENT_SUFFIX,v),M.INDENT)+V;return p+=`for _ in range(${r}):\n${V}  await sleep_fps()\n`,p};M.control_forever=(v)=>{let p="",r;if(M.STATEMENT_PREFIX)p+=M.injectId(M.STATEMENT_PREFIX,v);if(r=M.statementToCode(v,"SUBSTACK")||M.PASS,M.STATEMENT_SUFFIX)r=M.prefixLines(M.injectId(M.STATEMENT_SUFFIX,v),M.INDENT)+r;return p+=`while True:\n${r}  await sleep_fps()\n`,p};M.control_if=(v)=>{let p="",r,V;if(M.STATEMENT_PREFIX)p+=M.injectId(M.STATEMENT_PREFIX,v);if(V=M.valueToCode(v,"CONDITION",M.ORDER_NONE)||"False",r=M.statementToCode(v,"SUBSTACK")||M.PASS,M.STATEMENT_SUFFIX)r=M.prefixLines(M.injectId(M.STATEMENT_SUFFIX,v),M.INDENT)+r;if(p+=`if ${V}:\n${r}`,v.getInput("SUBSTACK2")){if(r=M.statementToCode(v,"SUBSTACK2")||M.PASS,M.STATEMENT_SUFFIX)r=M.prefixLines(M.injectId(M.STATEMENT_SUFFIX,v),M.INDENT)+r;p+=`else:\n${r}`}return p};M.control_if_else=M.control_if;M.control_wait_until=(v)=>{let p="";if(M.STATEMENT_PREFIX)p+=M.injectId(M.STATEMENT_PREFIX,v);const r=M.valueToCode(v,"CONDITION",M.ORDER_NONE)||"False";return p+=`while not ${r}: await sleep_fps()\n`,p};M.control_repeat_until=(v)=>{let p="",r,V;if(M.STATEMENT_PREFIX)p+=M.injectId(M.STATEMENT_PREFIX,v);if(V=M.valueToCode(v,"CONDITION",M.ORDER_NONE)||"False",r=M.statementToCode(v,"SUBSTACK")||M.PASS,M.STATEMENT_SUFFIX)r=M.prefixLines(M.injectId(M.STATEMENT_SUFFIX,v),M.INDENT)+r;return p+=`while not ${V}:\n${r}  await sleep_fps()\n`,p};M.control_while=(v)=>{let p="",r,V;if(M.STATEMENT_PREFIX)p+=M.injectId(M.STATEMENT_PREFIX,v);if(V=M.valueToCode(v,"CONDITION",M.ORDER_NONE)||"False",r=M.statementToCode(v,"SUBSTACK")||M.PASS,M.STATEMENT_SUFFIX)r=M.prefixLines(M.injectId(M.STATEMENT_SUFFIX,v),M.INDENT)+r;return p+=`while ${V}:\n${r}  await sleep_fps()\n`,p};M.control_stop=(v)=>{let p="";if(M.STATEMENT_PREFIX)p+=M.injectId(M.STATEMENT_PREFIX,v);switch(v.getFieldValue("STOP_OPTION")){case"all":M.definitions_.import_sys="import sys",p+="sys.exit()\n";break;case"this script":p+="return\n";break;case"other scripts in sprite":p+="pass\n";break}return p};M.data_variable=(v)=>{return[`${M.variableDB_.getName(v.getFieldValue("VARIABLE"),v8.Variables.NAME_TYPE)}.value`,M.ORDER_ATOMIC]};M.data_setvariableto=(v)=>{const p=M.variableDB_.getName(v.getFieldValue("VARIABLE"),v8.Variables.NAME_TYPE),r=M.valueToCode(v,"VALUE",M.ORDER_NONE)||"0";return`${p}.set(${r})\n`};M.data_changevariableby=(v)=>{const p=M.variableDB_.getName(v.getFieldValue("VARIABLE"),v8.Variables.NAME_TYPE),r=M.valueToCode(v,"VALUE",M.ORDER_NONE)||"0";return`${p}.inc(${r})\n`};M.data_listcontents=(v)=>{};M.data_addtolist=(v)=>{};M.data_deleteoflist=(v)=>{};M.data_deletealloflist=(v)=>{};M.data_insertatlist=(v)=>{};M.data_replaceitemoflist=(v)=>{};M.data_itemoflist=(v)=>{};M.data_itemnumoflist=(v)=>{};M.data_lengthoflist=(v)=>{};M.data_listcontainsitem=(v)=>{};M.event_whenflagclicked=(v)=>{let p="";const[r,V]=M.functionToCode("start");return p+=`${V}when_start(${r})\n`,p};M.event_whengreaterthan=(v)=>{};M.event_whenbroadcastreceived=(v)=>{let p="";const r=M.variableDB_.getName(v.getFieldValue("BROADCAST_OPTION"),A8.Variables.NAME_TYPE),[V,G]=M.functionToCode("broadcast_received","sprite");return p+=`${G}when_broadcast_received("${r}",${V},sprite)\n`,p};M.event_broadcast_menu=(v)=>{return[M.variableDB_.getName(v.getFieldValue("BROADCAST_OPTION"),A8.Variables.NAME_TYPE),M.ORDER_ATOMIC]};M.event_broadcast=(v)=>{return`broadcast_message("${M.valueToCode(v,"BROADCAST_INPUT",M.ORDER_NONE)||"None"}")\n`};M.event_broadcastandwait=(v)=>{return`await broadcast_message("${M.valueToCode(v,"BROADCAST_INPUT",M.ORDER_NONE)||"None"}")\n`};M.addReservedWords("math,random,Number");M.math_number=(v)=>{let p=parseFloat(v.getFieldValue("NUM")),r;if(p===Infinity)p='float("inf")',r=M.ORDER_FUNCTION_CALL;else if(p===(-Infinity))p='-float("inf")',r=M.ORDER_UNARY_SIGN;else if(Number.isNaN(p))p='float("nan")',r=M.ORDER_UNARY_SIGN;else r=p<0?M.ORDER_UNARY_SIGN:M.ORDER_ATOMIC;return[p,r]};M.math_integer=(v)=>{const p=parseInt(v.getFieldValue("NUM")),r=p<0?M.ORDER_UNARY_SIGN:M.ORDER_ATOMIC;return[p,r]};M.math_whole_number=(v)=>{return[Math.abs(parseInt(v.getFieldValue("NUM"))),M.ORDER_ATOMIC]};M.math_positive_number=(v)=>{let p=parseFloat(v.getFieldValue("NUM")),r;if(p===Infinity)p='float("inf")',r=M.ORDER_FUNCTION_CALL;else if(p===(-Infinity))p='-float("inf")',r=M.ORDER_FUNCTION_CALL;else if(Number.isNaN(p))p='float("nan")',r=M.ORDER_FUNCTION_CALL;else p=p<0?0:p,r=M.ORDER_ATOMIC;return[p,r]};M.math_angle=(v)=>{let p=parseFloat(v.getFieldValue("NUM")),r;if(p==Infinity)p='float("inf")',r=M.ORDER_FUNCTION_CALL;else if(p==(-Infinity))p='-float("inf")',r=M.ORDER_UNARY_SIGN;else p=p%360,p=p<0?p+360:p,r=M.ORDER_ATOMIC;return[p,r]};M.operator_add=(v)=>{};M.operator_subtract=(v)=>{};M.operator_multiply=(v)=>{};M.operator_divide=(v)=>{};M.operator_random=(v)=>{};M.operator_gt=(v)=>{};M.operator_lt=(v)=>{};M.operator_equals=(v)=>{};M.operator_and=(v)=>{};M.operator_or=(v)=>{};M.operator_not=(v)=>{};M.operator_join=(v)=>{};M.operator_letter_of=(v)=>{};M.operator_length=(v)=>{};M.operator_contains=(v)=>{};M.operator_mod=(v)=>{};M.operator_round=(v)=>{};M.operator_mathop=(v)=>{};M.procedures_definition=(v)=>{};M.procedures_call=(v)=>{};M.procedures_prototype=(v)=>{};M.procedures_declaration=(v)=>{};M.argument_reporter_boolean=(v)=>{};M.argument_reporter_string_number=(v)=>{};M.argument_editor_boolean=(v)=>{};M.argument_editor_string_number=(v)=>{};M.sensing_timer=(v)=>{return["get_timer()",M.ORDER_FUNCTION_CALL]};M.sensing_resettimer=(v)=>{return"reset_timer()\n"};M.text=(v)=>{return[M.quote_(v.getFieldValue("TEXT")),M.ORDER_ATOMIC]};m8(".R1cW-q_prompt-modal{width:360px}.R1cW-q_prompt-content{background:var(--ui-white);padding:1.5rem 2.25rem}.R1cW-q_prompt-content input[type=checkbox],.R1cW-q_prompt-content input[type=radio]{margin:3px}.R1cW-q_label{margin:0 0 .75rem;font-weight:500}.R1cW-q_variable-name-text-input{border:1px solid var(--ui-black-transparent);color:var(--text-primary-transparent);border-radius:5px;width:100%;height:3rem;margin-bottom:1.5rem;padding:0 1rem;font-size:.875rem}.R1cW-q_info-message{text-align:center;margin-bottom:1.5rem;font-size:.875rem;font-weight:400}.R1cW-q_options{justify-content:space-between;margin-bottom:1.5rem;font-weight:400;display:flex}.R1cW-q_button-row{text-align:right;font-weight:bolder}.R1cW-q_button{padding:.75rem 1rem;font-size:.85rem;font-weight:600}.R1cW-q_ok-button{background:var(--motion-primary);border:var(--motion-primary);color:var(--ui-white);margin-left:var(--space)}");var v6={promptModal:"R1cW-q_prompt-modal",options:"R1cW-q_options",variableNameTextInput:"R1cW-q_variable-name-text-input",okButton:"R1cW-q_ok-button",buttonRow:"R1cW-q_button-row",promptContent:"R1cW-q_prompt-content",button:"R1cW-q_button",label:"R1cW-q_label",infoMessage:"R1cW-q_info-message"};m8(".OF790G_editor-wrapper{border-radius:inherit;width:100%;height:100%;position:relative}.OF790G_extension-button{z-index:var(--z-index-extension-button);background:var(--motion-primary);border:1px solid var(--motion-primary);box-sizing:content-box;border-bottom-left-radius:inherit;border-top:0;height:3.25rem;position:absolute;bottom:-1px;left:-1px}.OF790G_extension-button:before{--fade-out-distance:15px;content:\"\";top:calc(calc(-1*var(--fade-out-distance)));height:var(--fade-out-distance);background:linear-gradient(#0000,#00000026);position:absolute;left:0;right:0}.OF790G_add-button{cursor:pointer;background:0 0;border:none;outline:none;width:100%;height:100%}.OF790G_add-button img{width:1.75rem;height:1.75rem}");var n8={addButton:"OF790G_add-button",editorWrapper:"OF790G_editor-wrapper",extensionButton:"OF790G_extension-button"},u5="./assets/icon-add-extension-5ec2ee35b87b4126.svg";m8(".GS2oYa_pane{height:8rem}");var t5={pane:"GS2oYa_pane"},m5="./assets/icon-blocks-d7e4a3a3eb74d0fb.svg",g5={"blocks.menu.file":"File","blocks.menu.file.newProject":"New","blocks.menu.file.openProject":"Open","blocks.menu.file.saveProject":"Save","blocks.menu.file.uploadProject":"Load from your computer","blocks.menu.file.downloadProject":"Save to your computer","blocks.menu.edit":"Edit","blocks.menu.edit.undo":"Undo","blocks.menu.edit.redo":"Redo","blocks.menu.device":"Device","blocks.menu.device.connect":"Connect to your device","blocks.menu.device.disconnect":"Disconnect this device","blocks.menu.device.download":"Download program","blocks.menu.device.turnOnAutoDownload":"Turn on Auto Download","blocks.menu.device.turnOffAutoDownload":"Turn off Auto Download","blocks.alert.downloading":"Downloading...{progress}%","blocks.codeTab":"Code","blocks.backpackPane.title":"Backpack","blocks.downloadToDevice":"Download","blocks.extensions.addExtension":"Add Extension","blocks.dataPrompt.forAllTargets":"For all targets","blocks.dataPrompt.forThisTarget":"For this target only","blocks.dataPrompt.availableToAllTargets":"This variable will be available to all targets.","blocks.dataPrompt.listAvailableToAllTargets":"This list will be available to all targets.","blocks.dataPrompt.cancel":"Cancel","blocks.dataPrompt.ok":"OK","blocks.event.programStart":"when program start","blocks.control.stopOther":"other scripts"},w5={"blocks.menu.file":"\u6587\u4EF6","blocks.menu.file.newProject":"\u65B0\u4F5C\u54C1","blocks.menu.file.openProject":"\u6253\u5F00","blocks.menu.file.saveProject":"\u4FDD\u5B58","blocks.menu.file.uploadProject":"\u4ECE\u7535\u8111\u4E2D\u6253\u5F00","blocks.menu.file.downloadProject":"\u4FDD\u5B58\u5230\u7535\u8111","blocks.menu.edit":"\u7F16\u8F91","blocks.menu.edit.undo":"\u64A4\u9500","blocks.menu.edit.redo":"\u6062\u590D","blocks.menu.device":"\u8BBE\u5907","blocks.menu.device.connect":"\u8FDE\u63A5\u8BBE\u5907","blocks.menu.device.disconnect":"\u65AD\u5F00\u8BBE\u5907\u8FDE\u63A5","blocks.menu.device.download":"\u4E0B\u8F7D\u7A0B\u5E8F","blocks.menu.device.turnOnAutoDownload":"\u6253\u5F00\u81EA\u52A8\u4E0B\u8F7D","blocks.menu.device.turnOffAutoDownload":"\u5173\u95ED\u81EA\u52A8\u4E0B\u8F7D","blocks.alert.downloading":"\u6B63\u5728\u4E0B\u8F7D\u2026{progress}%","blocks.codeTab":"\u4EE3\u7801","blocks.backpackPane.title":"\u4E66\u5305","blocks.downloadToDevice":"\u4E0B\u8F7D","blocks.extensions.addExtension":"\u6DFB\u52A0\u6269\u5C55","blocks.dataPrompt.forAllTargets":"\u9002\u7528\u4E8E\u5168\u5C40","blocks.dataPrompt.forThisTarget":"\u4EC5\u9002\u7528\u4E8E\u5F53\u524D","blocks.dataPrompt.availableToAllTargets":"\u5168\u5C40\u90FD\u53EF\u4F7F\u7528\u8BE5\u53D8\u91CF\u3002","blocks.dataPrompt.listAvailableToAllTargets":"\u5168\u5C40\u90FD\u53EF\u4F7F\u7528\u8BE5\u5217\u8868\u3002","blocks.dataPrompt.cancel":"\u53D6\u6D88","blocks.dataPrompt.ok":"\u786E\u5B9A","blocks.event.programStart":"\u5F53\u7A0B\u5E8F\u5F00\u59CB\u8FD0\u884C","blocks.control.stopOther":"\u5176\u4ED6\u811A\u672C"},a8={en:g5,"zh-Hans":w5},q6={icon:m5,label:E8(G8,{id:"blocks.codeTab",defaultMessage:"Code"}),Content:f5},x5={label:E8(G8,{id:"blocks.backpackPane.title",defaultMessage:"Backpack"}),Content:v5};import{useLocale as c5,useEditor as M5,exportFile as p3} from"@blockcode/core";import{ScratchBlocks as t3,makeToolboxXML as B5,blockSeparator as m6,categorySeparator as w8} from"@blockcode/blocks-editor";import{ScratchBlocks as R6} from"@blockcode/blocks-editor";R6.Blocks.event_whenflagclicked={init(){this.jsonInit({message0:R6.Msg.EVENT_WHENFLAGCLICKED,args0:[{type:"field_image",src:R6.mainWorkspace.options.pathToMedia+"green-flag.svg",width:24,height:24,alt:"flag"}],category:R6.Categories.event,extensions:["colours_event","shape_hat"]})}};import{ScratchBlocks as Y0} from"@blockcode/blocks-editor";Y0.Blocks.motion_attack={init(){this.jsonInit({message0:Y0.Msg.MOTION_ATTACK,args0:[{type:"input_value",name:"DIRECTION"},{type:"input_value",name:"DISTANCE"}],category:Y0.Categories.motion,extensions:["colours_motion","shape_statement"]})}};Y0.Blocks.motion_move={init(){this.jsonInit({message0:Y0.Msg.MOTION_MOVE,args0:[{type:"input_value",name:"DIRECTION"},{type:"input_value",name:"SPEED"}],category:Y0.Categories.motion,extensions:["colours_motion","shape_statement"]})}};Y0.Blocks.motion_setspeed={init(){this.jsonInit({message0:Y0.Msg.MOTION_SETSPEED,args0:[{type:"input_value",name:"SPEED"}],category:Y0.Categories.motion,extensions:["colours_motion","shape_statement"]})}};Y0.Blocks.motion_stop={init(){this.jsonInit({message0:Y0.Msg.MOTION_STOP,category:Y0.Categories.motion,extensions:["colours_motion","shape_statement"]})}};Y0.Blocks.motion_speed={init(){this.jsonInit({message0:Y0.Msg.MOTION_SPEED,category:Y0.Categories.motion,checkboxInFlyout:!0,extensions:["colours_motion","output_number"]})}};import{ScratchBlocks as J0} from"@blockcode/blocks-editor";J0.Blocks.sensing_scanwidth={init(){this.jsonInit({message0:J0.Msg.SENSING_SCANWIDTH,args0:[{type:"input_value",name:"WIDTH"}],category:J0.Categories.sensing,extensions:["colours_sensing","shape_statement"]})}};J0.Blocks.sensing_scan={init(){this.jsonInit({message0:J0.Msg.SENSING_SCAN,args0:[{type:"input_value",name:"DIRECTION"}],category:J0.Categories.sensing,extensions:["colours_sensing","output_boolean"]})}};J0.Blocks.sensing_scandistance={init(){this.jsonInit({message0:J0.Msg.SENSING_DISTANCE,args0:[{type:"input_value",name:"DIRECTION"}],category:J0.Categories.sensing,extensions:["colours_sensing","output_number"]})}};J0.Blocks.sensing_health={init(){this.jsonInit({message0:J0.Msg.SENSING_HEALTH,category:J0.Categories.sensing,checkboxInFlyout:!0,extensions:["colours_sensing","output_number"]})}};import{useRef as j5,useEffect as C5,useState as R8} from"preact/hooks";import{useEditor as r5} from"@blockcode/core";import{ScratchBlocks as W0} from"@blockcode/blocks-editor";import{ScratchBlocks as Q0} from"@blockcode/blocks-editor";import{ScratchBlocks as k0} from"@blockcode/blocks-editor";import{ScratchBlocks as F8} from"@blockcode/blocks-editor";var H8=function({width:v,height:p,onSetup:r,...V}){const G=j5(null),[T,F]=R8(null),[_,$]=R8(null),{selectedIndex:U,modifyFile:S0}=r5();return C5(()=>{if(G.current){if(g8.default.setup(G.current),r)r(G.current);let n0;const d0=()=>{if(n0=W0.getMainWorkspace(),n0){n0.addChangeListener((i0)=>{if(n0.isDragging())return;if(!N5.has(i0.type))return;const I0=W0.Xml.workspaceToDom(n0),a=W0.Xml.domToText(I0).replace(/<variable type="broadcast_msg"[^>]+>[^<]+<\/variable>/gi,"");if(a!==T||U!==_){if(S0({script:j.workspaceToCode(n0)}),a!==T)F(a);if(U!==_)$(U)}});return}setTimeout(d0)};d0()}return()=>{g8.default.project.clear(),g8.default.project.remove()}},[G]),b5("canvas",{ref:G,style:{width:v,height:p},...V})};import{jsx as b5} from"preact/jsx-runtime";var p5=Object.create,{defineProperty:q8,getPrototypeOf:s5,getOwnPropertyNames:y5}=Object,d5=Object.prototype.hasOwnProperty,O8=(v,p,r)=>{r=v!=null?p5(s5(v)):{};const V=p||!v||!v.__esModule?q8(r,"default",{value:v,enumerable:!0}):r;for(let G of y5(v))if(!d5.call(V,G))q8(V,G,{get:()=>v[G],enumerable:!0});return V},P5=(v,p)=>()=>(p||v((p={exports:{}}).exports,p),p.exports);var T8=P5((v,p)=>{/*!
 * Paper.js v0.12.17 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, Jürg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Thu Nov 3 21:15:36 2022 +0100
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 Jürg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */var r=function(V,G){V=V||(()=>({}));var{window:T,document:F}=V,_=new function(){var i=/^(statics|enumerable|beans|preserve)$/,h=[],u=h.slice,f=Object.create,t=Object.getOwnPropertyDescriptor,n=Object.defineProperty,g=h.forEach||function(P,y){for(var b=0,z=this.length;b<z;b++)P.call(y,this[b],b,this)},m=function(P,y){for(var b in this)if(this.hasOwnProperty(b))P.call(y,this[b],b,this)},w=Object.assign||function(P){for(var y=1,b=arguments.length;y<b;y++){var z=arguments[y];for(var B in z)if(z.hasOwnProperty(B))P[B]=z[B]}return P},x=function(P,y,b){if(P){var z=t(P,"length");(z&&typeof z.value==="number"?g:m).call(P,y,b=b||P)}return b};function d(P,y,b,z,B){var N={};function S(k,L){if(L=L||(L=t(y,k))&&(L.get?L:L.value),typeof L==="string"&&L[0]==="#")L=P[L.substring(1)]||L;var c=typeof L==="function",D=L,A=B||c&&!L.base?L&&L.get?k in P:P[k]:null,e;if(!B||!A){if(c&&A)L.base=A;if(c&&z!==!1&&(e=k.match(/^([gs]et|is)(([A-Z])(.*))$/)))N[e[3].toLowerCase()+e[4]]=e[2];if(!D||c||!D.get||typeof D.get!=="function"||!l.isPlainObject(D))D={value:D,writable:!0};if((t(P,k)||{configurable:!0}).configurable)D.configurable=!0,D.enumerable=b!=null?b:!e;n(P,k,D)}}if(y){for(var s in y)if(y.hasOwnProperty(s)&&!i.test(s))S(s);for(var s in N){var C=N[s],I=P["set"+C],o=P["get"+C]||I&&P["is"+C];if(o&&(z===!0||o.length===0))S(s,{get:o,set:I})}}return P}function l(){for(var P=0,y=arguments.length;P<y;P++){var b=arguments[P];if(b)w(this,b)}return this}return d(l,{inject:function(P){if(P){var y=P.statics===!0?P:P.statics,b=P.beans,z=P.preserve;if(y!==P)d(this.prototype,P,P.enumerable,b,z);d(this,y,null,b,z)}for(var B=1,N=arguments.length;B<N;B++)this.inject(arguments[B]);return this},extend:function(){var P=this,y,b;for(var z=0,B,N=arguments.length;z<N&&!(y&&b);z++)B=arguments[z],y=y||B.initialize,b=b||B.prototype;if(y=y||function(){P.apply(this,arguments)},b=y.prototype=b||f(this.prototype),n(b,"constructor",{value:y,writable:!0,configurable:!0}),d(y,this),arguments.length)this.inject.apply(y,arguments);return y.base=P,y}}).inject({enumerable:!1,initialize:l,set:l,inject:function(){for(var P=0,y=arguments.length;P<y;P++){var b=arguments[P];if(b)d(this,b,b.enumerable,b.beans,b.preserve)}return this},extend:function(){var P=f(this);return P.inject.apply(P,arguments)},each:function(P,y){return x(this,P,y)},clone:function(){return new this.constructor(this)},statics:{set:w,each:x,create:f,define:n,describe:t,clone:function(P){return w(new P.constructor,P)},isPlainObject:function(P){var y=P!=null&&P.constructor;return y&&(y===Object||y===l||y.name==="Object")},pick:function(P,y){return P!==G?P:y},slice:function(P,y,b){return u.call(P,y,b)}}})};if(typeof p!=="undefined")p.exports=_;_.inject({enumerable:!1,toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+_.each(this,function(i,h){if(!/^_/.test(h)){var u=typeof i;this.push(h+": "+(u==="number"?d0.instance.number(i):u==="string"?"'"+i+"'":i))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(i){return _.importJSON(i,this)},exportJSON:function(i){return _.exportJSON(this,i)},toJSON:function(){return _.serialize(this)},set:function(i,h){if(i)_.filter(this,i,h,this._prioritize);return this}},{beans:!1,statics:{exports:{},extend:function i(){var h=i.base.apply(this,arguments),u=h.prototype._class;if(u&&!_.exports[u])_.exports[u]=h;return h},equals:function(i,h){if(i===h)return!0;if(i&&i.equals)return i.equals(h);if(h&&h.equals)return h.equals(i);if(i&&h&&typeof i==="object"&&typeof h==="object"){if(Array.isArray(i)&&Array.isArray(h)){var u=i.length;if(u!==h.length)return!1;while(u--)if(!_.equals(i[u],h[u]))return!1}else{var f=Object.keys(i),u=f.length;if(u!==Object.keys(h).length)return!1;while(u--){var t=f[u];if(!(h.hasOwnProperty(t)&&_.equals(i[t],h[t])))return!1}}return!0}return!1},read:function(i,h,u,f){if(this===_){var t=this.peek(i,h);return i.__index++,t}var n=this.prototype,g=n._readIndex,m=h||g&&i.__index||0,w=i.length,x=i[m];if(f=f||w-m,x instanceof this||u&&u.readNull&&x==null&&f<=1){if(g)i.__index=m+1;return x&&u&&u.clone?x.clone():x}if(x=_.create(n),g)x.__read=!0;if(x=x.initialize.apply(x,m>0||m+f<w?_.slice(i,m,m+f):i)||x,g){i.__index=m+x.__read;var d=x.__filtered;if(d)i.__filtered=d,x.__filtered=G;x.__read=G}return x},peek:function(i,h){return i[i.__index=h||i.__index||0]},remain:function(i){return i.length-(i.__index||0)},readList:function(i,h,u,f){var t=[],n,g=h||0,m=f?g+f:i.length;for(var w=g;w<m;w++)t.push(Array.isArray(n=i[w])?this.read(n,0,u):this.read(i,w,u,1));return t},readNamed:function(i,h,u,f,t){var n=this.getNamed(i,h),g=n!==G;if(g){var m=i.__filtered;if(!m){var w=this.getSource(i);m=i.__filtered=_.create(w),m.__unfiltered=w}m[h]=G}return this.read(g?[n]:i,u,f,t)},readSupported:function(i,h){var u=this.getSource(i),f=this,t=!1;if(u)Object.keys(u).forEach(function(n){if(n in h){var g=f.readNamed(i,n);if(g!==G)h[n]=g;t=!0}});return t},getSource:function(i){var h=i.__source;if(h===G){var u=i.length===1&&i[0];h=i.__source=u&&_.isPlainObject(u)?u:null}return h},getNamed:function(i,h){var u=this.getSource(i);if(u)return h?u[h]:i.__filtered||u},hasNamed:function(i,h){return!!this.getNamed(i,h)},filter:function(i,h,u,f){var t;function n(d){if(!(u&&(d in u))&&!(t&&(d in t))){var l=h[d];if(l!==G)i[d]=l}}if(f){var g={};for(var m=0,w,x=f.length;m<x;m++)if((w=f[m])in h)n(w),g[w]=!0;t=g}return Object.keys(h.__unfiltered||h).forEach(n),i},isPlainValue:function(i,h){return _.isPlainObject(i)||Array.isArray(i)||h&&typeof i==="string"},serialize:function(i,h,u,f){h=h||{};var t=!f,n;if(t)h.formatter=new d0(h.precision),f={length:0,definitions:{},references:{},add:function(l,P){var y="#"+l._id,b=this.references[y];if(!b){this.length++;var z=P.call(l),B=l._class;if(B&&z[0]!==B)z.unshift(B);this.definitions[y]=z,b=this.references[y]=[y]}return b}};if(i&&i._serialize){n=i._serialize(h,f);var g=i._class;if(g&&!i._compactSerialize&&(t||!u)&&n[0]!==g)n.unshift(g)}else if(Array.isArray(i)){n=[];for(var m=0,w=i.length;m<w;m++)n[m]=_.serialize(i[m],h,u,f)}else if(_.isPlainObject(i)){n={};var x=Object.keys(i);for(var m=0,w=x.length;m<w;m++){var d=x[m];n[d]=_.serialize(i[d],h,u,f)}}else if(typeof i==="number")n=h.formatter.number(i,h.precision);else n=i;return t&&f.length>0?[["dictionary",f.definitions],n]:n},deserialize:function(i,h,u,f,t){var n=i,g=!u,m=g&&i&&i.length&&i[0][0]==="dictionary";if(u=u||{},Array.isArray(i)){var w=i[0],x=w==="dictionary";if(i.length==1&&/^#/.test(w))return u.dictionary[w];w=_.exports[w],n=[];for(var d=w?1:0,l=i.length;d<l;d++)n.push(_.deserialize(i[d],h,u,x,m));if(w){var P=n;if(h)n=h(w,P,g||t);else n=new w(P)}}else if(_.isPlainObject(i)){if(n={},f)u.dictionary=n;for(var y in i)n[y]=_.deserialize(i[y],h,u)}return m?n[1]:n},exportJSON:function(i,h){var u=_.serialize(i,h);return h&&h.asString==!1?u:JSON.stringify(u)},importJSON:function(i,h){return _.deserialize(typeof i==="string"?JSON.parse(i):i,function(u,f,t){var n=t&&h&&h.constructor===u,g=n?h:_.create(u.prototype);if(f.length===1&&g instanceof m0&&(n||!(g instanceof _6))){var m=f[0];if(_.isPlainObject(m)){if(m.insert=!1,n)f=f.concat([m0.INSERT])}}if((n?g.set:u).apply(g,f),n)h=null;return g})},push:function(i,h){var u=h.length;if(u<4096)i.push.apply(i,h);else{var f=i.length;i.length+=u;for(var t=0;t<u;t++)i[f+t]=h[t]}return i},splice:function(i,h,u,f){var t=h&&h.length,n=u===G;if(u=n?i.length:u,u>i.length)u=i.length;for(var g=0;g<t;g++)h[g]._index=u+g;if(n)return _.push(i,h),[];else{var m=[u,f];if(h)_.push(m,h);var w=i.splice.apply(i,m);for(var g=0,x=w.length;g<x;g++)w[g]._index=G;for(var g=u+t,x=i.length;g<x;g++)i[g]._index=g;return w}},capitalize:function(i){return i.replace(/\b[a-z]/g,function(h){return h.toUpperCase()})},camelize:function(i){return i.replace(/-(.)/g,function(h,u){return u.toUpperCase()})},hyphenate:function(i){return i.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var $={on:function(i,h){if(typeof i!=="string")_.each(i,function(n,g){this.on(g,n)},this);else{var u=this._eventTypes,f=u&&u[i],t=this._callbacks=this._callbacks||{};if(t=t[i]=t[i]||[],t.indexOf(h)===-1){if(t.push(h),f&&f.install&&t.length===1)f.install.call(this,i)}}return this},off:function(i,h){if(typeof i!=="string"){_.each(i,function(g,m){this.off(m,g)},this);return}var u=this._eventTypes,f=u&&u[i],t=this._callbacks&&this._callbacks[i],n;if(t){if(!h||(n=t.indexOf(h))!==-1&&t.length===1){if(f&&f.uninstall)f.uninstall.call(this,i);delete this._callbacks[i]}else if(n!==-1)t.splice(n,1)}return this},once:function(i,h){return this.on(i,function u(){h.apply(this,arguments),this.off(i,u)})},emit:function(i,h){var u=this._callbacks&&this._callbacks[i];if(!u)return!1;var f=_.slice(arguments,1),t=h&&h.target&&!h.currentTarget;if(u=u.slice(),t)h.currentTarget=this;for(var n=0,g=u.length;n<g;n++)if(u[n].apply(this,f)==!1){if(h&&h.stop)h.stop();break}if(t)delete h.currentTarget;return!0},responds:function(i){return!!(this._callbacks&&this._callbacks[i])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(i){var h=this._eventTypes,u=this._callbacks,f=i?"install":"uninstall";if(h){for(var t in u)if(u[t].length>0){var n=h[t],g=n&&n[f];if(g)g.call(this,t)}}},statics:{inject:function i(h){var u=h._events;if(u){var f={};_.each(u,function(t,n){var g=typeof t==="string",m=g?t:n,w=_.capitalize(m),x=m.substring(2).toLowerCase();f[x]=g?{}:t,m="_"+m,h["get"+w]=function(){return this[m]},h["set"+w]=function(d){var l=this[m];if(l)this.off(x,l);if(d)this.on(x,d);this[m]=d}}),h._eventTypes=f}return i.base.apply(this,arguments)}}},U=_.extend({_class:"PaperScope",initialize:function i(){j0=this,this.settings=new _({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=i._id++,i._scopes[this._id]=this;var h=i.prototype;if(!this.support){var u=G0.getContext(1,1)||{};h.support={nativeDash:"setLineDash"in u||"mozDash"in u,nativeBlendModes:$6.nativeModes},G0.release(u)}if(!this.agent){var f=V.navigator.userAgent.toLowerCase(),t=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(f)||[])[0],n=t==="darwin"?"mac":t,g=h.agent=h.browser={platform:n};if(n)g[n]=!0;if(f.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(m,w,x,d,l){if(!g.chrome){var P=w==="opera"?d:/^(node|trident)$/.test(w)?l:x;g.version=P,g.versionNumber=parseFloat(P),w={trident:"msie",jsdom:"node"}[w]||w,g.name=w,g[w]=!0}}),g.chrome)delete g.webkit;if(g.atom)delete g.chrome}},version:"0.12.17",getView:function(){var i=this.project;return i&&i._view},getPaper:function(){return this},execute:function(i,h){},install:function(i){var h=this;_.each(["project","view","tool"],function(f){_.define(i,f,{configurable:!0,get:function(){return h[f]}})});for(var u in this)if(!/^_/.test(u)&&this[u])i[u]=this[u]},setup:function(i){return j0=this,this.project=new g6(i),this},createCanvas:function(i,h){return G0.getCanvas(i,h)},activate:function(){j0=this},clear:function(){var i=this.projects,h=this.tools;for(var u=i.length-1;u>=0;u--)i[u].remove();for(var u=h.length-1;u>=0;u--)h[u].remove()},remove:function(){this.clear(),delete U._scopes[this._id]},statics:new function(){function i(h){return h+="Attribute",function(u,f){return u[h](f)||u[h]("data-paper-"+f)}}return{_scopes:{},_id:0,get:function(h){return this._scopes[h]||null},getAttribute:i("get"),hasAttribute:i("has")}}}),S0=_.extend($,{initialize:function(i){if(this._scope=j0,this._index=this._scope[this._list].push(this)-1,i||!this._scope[this._reference])this.activate()},activate:function(){if(!this._scope)return!1;var i=this._scope[this._reference];if(i&&i!==this)i.emit("deactivate");return this._scope[this._reference]=this,this.emit("activate",i),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){if(this._index==null)return!1;if(_.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this)this._scope[this._reference]=null;return this._scope=null,!0},getView:function(){return this._scope.getView()}}),n0={findItemBoundsCollisions:function(i,h,u){function f(g){var m=new Array(g.length);for(var w=0;w<g.length;w++){var x=g[w].getBounds();m[w]=[x.left,x.top,x.right,x.bottom]}return m}var t=f(i),n=!h||h===i?t:f(h);return this.findBoundsCollisions(t,n,u||0)},findCurveBoundsCollisions:function(i,h,u,f){function t(P){var{min:y,max:b}=Math,z=new Array(P.length);for(var B=0;B<P.length;B++){var N=P[B];z[B]=[y(N[0],N[2],N[4],N[6]),y(N[1],N[3],N[5],N[7]),b(N[0],N[2],N[4],N[6]),b(N[1],N[3],N[5],N[7])]}return z}var n=t(i),g=!h||h===i?n:t(h);if(f){var m=this.findBoundsCollisions(n,g,u||0,!1,!0),w=this.findBoundsCollisions(n,g,u||0,!0,!0),x=[];for(var d=0,l=m.length;d<l;d++)x[d]={hor:m[d],ver:w[d]};return x}return this.findBoundsCollisions(n,g,u||0)},findBoundsCollisions:function(i,h,u,f,t){var n=!h||i===h,g=n?i:i.concat(h),m=i.length,w=g.length;function x(Y,W,t0){var h0=0,g0=Y.length;while(h0<g0){var J=g0+h0>>>1;if(g[Y[J]][W]<t0)h0=J+1;else g0=J}return h0-1}var d=f?1:0,l=d+2,P=f?0:1,y=P+2,b=new Array(w);for(var z=0;z<w;z++)b[z]=z;b.sort(function(Y,W){return g[Y][d]-g[W][d]});var B=[],N=new Array(m);for(var z=0;z<w;z++){var S=b[z],s=g[S],C=n?S:S-m,I=S<m,o=n||!I,k=I?[]:null;if(B.length){var L=x(B,l,s[d]-u)+1;if(B.splice(0,L),n&&t){k=k.concat(B);for(var c=0;c<B.length;c++){var D=B[c];N[D].push(C)}}else{var A=s[y],e=s[P];for(var c=0;c<B.length;c++){var D=B[c],q=g[D],E=D<m,R=n||D>=m;if(t||(I&&R||o&&E)&&(A>=q[P]-u&&e<=q[y]+u)){if(I&&R)k.push(n?D:D-m);if(o&&E)N[D].push(C)}}}}if(I){if(i===h)k.push(S);N[S]=k}if(B.length){var X=s[l],O=x(B,l,X);B.splice(O+1,0,S)}else B.push(S)}for(var z=0;z<N.length;z++){var H=N[z];if(H)H.sort(function(W,t0){return W-t0})}return N}},d0=_.extend({initialize:function(i){this.precision=_.pick(i,5),this.multiplier=Math.pow(10,this.precision)},number:function(i){return this.precision<16?Math.round(i*this.multiplier)/this.multiplier:i},pair:function(i,h,u){return this.number(i)+(u||",")+this.number(h)},point:function(i,h){return this.number(i.x)+(h||",")+this.number(i.y)},size:function(i,h){return this.number(i.width)+(h||",")+this.number(i.height)},rectangle:function(i,h){return this.point(i,h)+(h||",")+this.size(i,h)}});d0.instance=new d0;var i0=new function(){var i=[[0.5773502691896257],[0,0.7745966692414834],[0.33998104358485626,0.8611363115940526],[0,0.5384693101056831,0.906179845938664],[0.2386191860831969,0.6612093864662645,0.932469514203152],[0,0.4058451513773972,0.7415311855993945,0.9491079123427585],[0.1834346424956498,0.525532409916329,0.7966664774136267,0.9602898564975363],[0,0.3242534234038089,0.6133714327005904,0.8360311073266358,0.9681602395076261],[0.14887433898163122,0.4333953941292472,0.6794095682990244,0.8650633666889845,0.9739065285171717],[0,0.26954315595234496,0.5190961292068118,0.7301520055740494,0.8870625997680953,0.978228658146057],[0.1252334085114689,0.3678314989981802,0.5873179542866175,0.7699026741943047,0.9041172563704749,0.9815606342467192],[0,0.2304583159551348,0.44849275103644687,0.6423493394403402,0.8015780907333099,0.9175983992229779,0.9841830547185881],[0.10805494870734367,0.31911236892788974,0.5152486363581541,0.6872929048116855,0.827201315069765,0.9284348836635735,0.9862838086968123],[0,0.20119409399743451,0.3941513470775634,0.5709721726085388,0.7244177313601701,0.8482065834104272,0.937273392400706,0.9879925180204854],[0.09501250983763744,0.2816035507792589,0.45801677765722737,0.6178762444026438,0.755404408355003,0.8656312023878318,0.9445750230732326,0.9894009349916499]],h=[[1],[0.8888888888888888,0.5555555555555556],[0.6521451548625461,0.34785484513745385],[0.5688888888888889,0.47862867049936647,0.23692688505618908],[0.46791393457269104,0.3607615730481386,0.17132449237917036],[0.4179591836734694,0.3818300505051189,0.27970539148927664,0.1294849661688697],[0.362683783378362,0.31370664587788727,0.22238103445337448,0.10122853629037626],[0.3302393550012598,0.31234707704000286,0.26061069640293544,0.1806481606948574,0.08127438836157441],[0.29552422471475287,0.26926671930999635,0.21908636251598204,0.1494513491505806,0.06667134430868814],[0.2729250867779006,0.26280454451024665,0.23319376459199048,0.18629021092773426,0.1255803694649046,0.05566856711617366],[0.24914704581340277,0.2334925365383548,0.20316742672306592,0.16007832854334622,0.10693932599531843,0.04717533638651183],[0.2325515532308739,0.22628318026289723,0.2078160475368885,0.17814598076194574,0.13887351021978725,0.09212149983772845,0.04048400476531588],[0.2152638534631578,0.2051984637212956,0.18553839747793782,0.15720316715819355,0.12151857068790319,0.08015808715976021,0.03511946033175186],[0.2025782419255613,0.19843148532711158,0.1861610000155622,0.16626920581699392,0.13957067792615432,0.10715922046717194,0.07036604748810812,0.03075324199611727],[0.1894506104550685,0.18260341504492358,0.16915651939500254,0.14959598881657674,0.12462897125553388,0.09515851168249279,0.062253523938647894,0.027152459411754096]],u=Math.abs,f=Math.sqrt,t=Math.pow,n=Math.log2||function(l){return Math.log(l)*Math.LOG2E},g=0.000000000001,m=0.000000000000000112;function w(l,P,y){return l<P?P:l>y?y:l}function x(l,P,y){function b(L){var c=L*134217729,D=L-c,A=D+c,e=L-A;return[A,e]}var z=P*P-l*y,B=P*P+l*y;if(u(z)*3<B){var N=b(l),S=b(P),s=b(y),C=P*P,I=S[0]*S[0]-C+2*S[0]*S[1]+S[1]*S[1],o=l*y,k=N[0]*s[0]-o+N[0]*s[1]+N[1]*s[0]+N[1]*s[1];z=C-o+(I-k)}return z}function d(){var l=Math.max.apply(Math,arguments);return l&&(l<0.00000001||l>1e8)?t(2,-Math.round(n(l))):0}return{EPSILON:g,MACHINE_EPSILON:m,CURVETIME_EPSILON:0.00000001,GEOMETRIC_EPSILON:0.0000001,TRIGONOMETRIC_EPSILON:0.00000001,ANGULAR_EPSILON:0.00001,KAPPA:4*(f(2)-1)/3,isZero:function(l){return l>=-g&&l<=g},isMachineZero:function(l){return l>=-m&&l<=m},clamp:w,integrate:function(l,P,y,b){var z=i[b-2],B=h[b-2],N=(y-P)*0.5,S=N+P,s=0,C=b+1>>1,I=b&1?B[s++]*l(S):0;while(s<C){var o=N*z[s];I+=B[s++]*(l(S+o)+l(S-o))}return N*I},findRoot:function(l,P,y,b,z,B,N){for(var S=0;S<B;S++){var s=l(y),C=s/P(y),I=y-C;if(u(C)<N){y=I;break}if(s>0)z=y,y=I<=b?(b+z)*0.5:I;else b=y,y=I>=z?(b+z)*0.5:I}return w(y,b,z)},solveQuadratic:function(l,P,y,b,z,B){var N,S=Infinity;if(u(l)<g){if(u(P)<g)return u(y)<g?-1:0;N=-y/P}else{P*=-0.5;var s=x(l,P,y);if(s&&u(s)<m){var C=d(u(l),u(P),u(y));if(C)l*=C,P*=C,y*=C,s=x(l,P,y)}if(s>=-m){var I=s<0?0:f(s),o=P+(P<0?-I:I);if(o===0)N=y/l,S=-N;else N=o/l,S=y/o}}var k=0,L=z==null,c=z-g,D=B+g;if(isFinite(N)&&(L||N>c&&N<D))b[k++]=L?N:w(N,z,B);if(S!==N&&isFinite(S)&&(L||S>c&&S<D))b[k++]=L?S:w(S,z,B);return k},solveCubic:function(l,P,y,b,z,B,N){var S=d(u(l),u(P),u(y),u(b)),s,C,I,o,k;if(S)l*=S,P*=S,y*=S,b*=S;function L(O){s=O;var H=l*s;C=H+P,I=C*s+y,o=(H+C)*s+I,k=I*s+b}if(u(l)<g)l=P,C=y,I=b,s=Infinity;else if(u(b)<g)C=P,I=y,s=0;else{L(-(P/l)/3);var c=k/l,D=t(u(c),0.3333333333333333),A=c<0?-1:1,e=-o/l,q=e>0?1.324717957244746*Math.max(D,f(e)):D,E=s-A*q;if(E!==s){do L(E),E=o===0?s:s-k/o/(1+m);while(A*E>A*s);if(u(l)*s*s>u(b/s))I=-b/s,C=(I-y)/s}}var R=i0.solveQuadratic(l,C,I,z,B,N),X=B==null;if(isFinite(s)&&(R===0||R>0&&s!==z[0]&&s!==z[1])&&(X||s>B-g&&s<N+g))z[R++]=X?s:w(s,B,N);return R}}},I0={_id:1,_pools:{},get:function(i){if(i){var h=this._pools[i];if(!h)h=this._pools[i]={_id:1};return h._id++}else return this._id++}},a=_.extend({_class:"Point",_readIndex:!0,initialize:function i(h,u){var f=typeof h,t=this.__read,n=0;if(f==="number"){var g=typeof u==="number";if(this._set(h,g?u:h),t)n=g?2:1}else if(f==="undefined"||h===null){if(this._set(0,0),t)n=h===null?1:0}else{var m=f==="string"?h.split(/[\s,]+/)||[]:h;if(n=1,Array.isArray(m))this._set(+m[0],+(m.length>1?m[1]:m[0]));else if("x"in m)this._set(m.x||0,m.y||0);else if("width"in m)this._set(m.width||0,m.height||0);else if("angle"in m)this._set(m.length||0,0),this.setAngle(m.angle||0);else this._set(0,0),n=0}if(t)this.__read=n;return this},set:"#initialize",_set:function(i,h){return this.x=i,this.y=h,this},equals:function(i){return this===i||i&&(this.x===i.x&&this.y===i.y||Array.isArray(i)&&this.x===i[0]&&this.y===i[1])||!1},clone:function(){return new a(this.x,this.y)},toString:function(){var i=d0.instance;return"{ x: "+i.number(this.x)+", y: "+i.number(this.y)+" }"},_serialize:function(i){var h=i.formatter;return[h.number(this.x),h.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(i){if(this.isZero()){var h=this._angle||0;this._set(Math.cos(h)*i,Math.sin(h)*i)}else{var u=i/this.getLength();if(i0.isZero(u))this.getAngle();this._set(this.x*u,this.y*u)}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180/Math.PI},setAngle:function(i){this.setAngleInRadians.call(this,i*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(!arguments.length)return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x);else{var i=a.read(arguments),h=this.getLength()*i.getLength();if(i0.isZero(h))return NaN;else{var u=this.dot(i)/h;return Math.acos(u<-1?-1:u>1?1:u)}}},setAngleInRadians:function(i){if(this._angle=i,!this.isZero()){var h=this.getLength();this._set(Math.cos(i)*h,Math.sin(i)*h)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var i=a.read(arguments);return Math.atan2(this.cross(i),this.dot(i))*180/Math.PI},getDistance:function(){var i=arguments,h=a.read(i),u=h.x-this.x,f=h.y-this.y,t=u*u+f*f,n=_.read(i);return n?t:Math.sqrt(t)},normalize:function(i){if(i===G)i=1;var h=this.getLength(),u=h!==0?i/h:0,f=new a(this.x*u,this.y*u);if(u>=0)f._angle=this._angle;return f},rotate:function(i,h){if(i===0)return this.clone();i=i*Math.PI/180;var u=h?this.subtract(h):this,f=Math.sin(i),t=Math.cos(i);return u=new a(u.x*t-u.y*f,u.x*f+u.y*t),h?u.add(h):u},transform:function(i){return i?i._transformPoint(this):this},add:function(){var i=a.read(arguments);return new a(this.x+i.x,this.y+i.y)},subtract:function(){var i=a.read(arguments);return new a(this.x-i.x,this.y-i.y)},multiply:function(){var i=a.read(arguments);return new a(this.x*i.x,this.y*i.y)},divide:function(){var i=a.read(arguments);return new a(this.x/i.x,this.y/i.y)},modulo:function(){var i=a.read(arguments);return new a(this.x%i.x,this.y%i.y)},negate:function(){return new a(-this.x,-this.y)},isInside:function(){return u0.read(arguments).contains(this)},isClose:function(){var i=arguments,h=a.read(i),u=_.read(i);return this.getDistance(h)<=u},isCollinear:function(){var i=a.read(arguments);return a.isCollinear(this.x,this.y,i.x,i.y)},isColinear:"#isCollinear",isOrthogonal:function(){var i=a.read(arguments);return a.isOrthogonal(this.x,this.y,i.x,i.y)},isZero:function(){var i=i0.isZero;return i(this.x)&&i(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(i){return this.x*(i>1&&i<4?-1:1)>=0&&this.y*(i>2?-1:1)>=0},dot:function(){var i=a.read(arguments);return this.x*i.x+this.y*i.y},cross:function(){var i=a.read(arguments);return this.x*i.y-this.y*i.x},project:function(){var i=a.read(arguments),h=i.isZero()?0:this.dot(i)/i.dot(i);return new a(i.x*h,i.y*h)},statics:{min:function(){var i=arguments,h=a.read(i),u=a.read(i);return new a(Math.min(h.x,u.x),Math.min(h.y,u.y))},max:function(){var i=arguments,h=a.read(i),u=a.read(i);return new a(Math.max(h.x,u.x),Math.max(h.y,u.y))},random:function(){return new a(Math.random(),Math.random())},isCollinear:function(i,h,u,f){return Math.abs(i*f-h*u)<=Math.sqrt((i*i+h*h)*(u*u+f*f))*0.00000001},isOrthogonal:function(i,h,u,f){return Math.abs(i*u+h*f)<=Math.sqrt((i*i+h*h)*(u*u+f*f))*0.00000001}}},_.each(["round","ceil","floor","abs"],function(i){var h=Math[i];this[i]=function(){return new a(h(this.x),h(this.y))}},{})),Q=a.extend({initialize:function i(h,u,f,t){this._x=h,this._y=u,this._owner=f,this._setter=t},_set:function(i,h,u){if(this._x=i,this._y=h,!u)this._owner[this._setter](this);return this},getX:function(){return this._x},setX:function(i){this._x=i,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(i){this._y=i,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(i){this._owner._changeSelection(this._getSelection(),i)},_getSelection:function(){return this._setter==="setPosition"?4:0}}),K=_.extend({_class:"Size",_readIndex:!0,initialize:function i(h,u){var f=typeof h,t=this.__read,n=0;if(f==="number"){var g=typeof u==="number";if(this._set(h,g?u:h),t)n=g?2:1}else if(f==="undefined"||h===null){if(this._set(0,0),t)n=h===null?1:0}else{var m=f==="string"?h.split(/[\s,]+/)||[]:h;if(n=1,Array.isArray(m))this._set(+m[0],+(m.length>1?m[1]:m[0]));else if("width"in m)this._set(m.width||0,m.height||0);else if("x"in m)this._set(m.x||0,m.y||0);else this._set(0,0),n=0}if(t)this.__read=n;return this},set:"#initialize",_set:function(i,h){return this.width=i,this.height=h,this},equals:function(i){return i===this||i&&(this.width===i.width&&this.height===i.height||Array.isArray(i)&&this.width===i[0]&&this.height===i[1])||!1},clone:function(){return new K(this.width,this.height)},toString:function(){var i=d0.instance;return"{ width: "+i.number(this.width)+", height: "+i.number(this.height)+" }"},_serialize:function(i){var h=i.formatter;return[h.number(this.width),h.number(this.height)]},add:function(){var i=K.read(arguments);return new K(this.width+i.width,this.height+i.height)},subtract:function(){var i=K.read(arguments);return new K(this.width-i.width,this.height-i.height)},multiply:function(){var i=K.read(arguments);return new K(this.width*i.width,this.height*i.height)},divide:function(){var i=K.read(arguments);return new K(this.width/i.width,this.height/i.height)},modulo:function(){var i=K.read(arguments);return new K(this.width%i.width,this.height%i.height)},negate:function(){return new K(-this.width,-this.height)},isZero:function(){var i=i0.isZero;return i(this.width)&&i(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(i,h){return new K(Math.min(i.width,h.width),Math.min(i.height,h.height))},max:function(i,h){return new K(Math.max(i.width,h.width),Math.max(i.height,h.height))},random:function(){return new K(Math.random(),Math.random())}}},_.each(["round","ceil","floor","abs"],function(i){var h=Math[i];this[i]=function(){return new K(h(this.width),h(this.height))}},{})),h6=K.extend({initialize:function i(h,u,f,t){this._width=h,this._height=u,this._owner=f,this._setter=t},_set:function(i,h,u){if(this._width=i,this._height=h,!u)this._owner[this._setter](this);return this},getWidth:function(){return this._width},setWidth:function(i){this._width=i,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(i){this._height=i,this._owner[this._setter](this)}}),u0=_.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function i(h,u,f,t){var n=arguments,g=typeof h,m;if(g==="number")this._set(h,u,f,t),m=4;else if(g==="undefined"||h===null)this._set(0,0,0,0),m=h===null?1:0;else if(n.length===1){if(Array.isArray(h))this._set.apply(this,h),m=1;else if(h.x!==G||h.width!==G)this._set(h.x||0,h.y||0,h.width||0,h.height||0),m=1;else if(h.from===G&&h.to===G){if(this._set(0,0,0,0),_.readSupported(n,this))m=1}}if(m===G){var w=a.readNamed(n,"from"),x=_.peek(n),d=w.x,l=w.y,P,y;if(x&&x.x!==G||_.hasNamed(n,"to")){var b=a.readNamed(n,"to");if(P=b.x-d,y=b.y-l,P<0)d=b.x,P=-P;if(y<0)l=b.y,y=-y}else{var z=K.read(n);P=z.width,y=z.height}this._set(d,l,P,y),m=n.__index}var B=n.__filtered;if(B)this.__filtered=B;if(this.__read)this.__read=m;return this},set:"#initialize",_set:function(i,h,u,f){return this.x=i,this.y=h,this.width=u,this.height=f,this},clone:function(){return new u0(this.x,this.y,this.width,this.height)},equals:function(i){var h=_.isPlainValue(i)?u0.read(arguments):i;return h===this||h&&this.x===h.x&&this.y===h.y&&this.width===h.width&&this.height===h.height||!1},toString:function(){var i=d0.instance;return"{ x: "+i.number(this.x)+", y: "+i.number(this.y)+", width: "+i.number(this.width)+", height: "+i.number(this.height)+" }"},_serialize:function(i){var h=i.formatter;return[h.number(this.x),h.number(this.y),h.number(this.width),h.number(this.height)]},getPoint:function(i){var h=i?a:Q;return new h(this.x,this.y,this,"setPoint")},setPoint:function(){var i=a.read(arguments);this.x=i.x,this.y=i.y},getSize:function(i){var h=i?K:h6;return new h(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var i=K.read(arguments),h=this._sx,u=this._sy,f=i.width,t=i.height;if(h)this.x+=(this.width-f)*h;if(u)this.y+=(this.height-t)*u;this.width=f,this.height=t,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(i){if(!this._fw){var h=i-this.x;this.width-=this._sx===0.5?h*2:h}this.x=i,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(i){if(!this._fh){var h=i-this.y;this.height-=this._sy===0.5?h*2:h}this.y=i,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(i){if(!this._fw){var h=i-this.x;this.width=this._sx===0.5?h*2:h}this.x=i-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(i){if(!this._fh){var h=i-this.y;this.height=this._sy===0.5?h*2:h}this.y=i-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(i){if(this._fw||this._sx===0.5)this.x=i-this.width/2;else{if(this._sx)this.x+=(i-this.x)*2*this._sx;this.width=(i-this.x)*2}this._sx=0.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(i){if(this._fh||this._sy===0.5)this.y=i-this.height/2;else{if(this._sy)this.y+=(i-this.y)*2*this._sy;this.height=(i-this.y)*2}this._sy=0.5,this._fh=0},getCenter:function(i){var h=i?a:Q;return new h(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var i=a.read(arguments);return this.setCenterX(i.x),this.setCenterY(i.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return this.width===0||this.height===0},contains:function(i){return i&&i.width!==G||(Array.isArray(i)?i:arguments).length===4?this._containsRectangle(u0.read(arguments)):this._containsPoint(a.read(arguments))},_containsPoint:function(i){var{x:h,y:u}=i;return h>=this.x&&u>=this.y&&h<=this.x+this.width&&u<=this.y+this.height},_containsRectangle:function(i){var{x:h,y:u}=i;return h>=this.x&&u>=this.y&&h+i.width<=this.x+this.width&&u+i.height<=this.y+this.height},intersects:function(){var i=u0.read(arguments),h=_.read(arguments)||0;return i.x+i.width>this.x-h&&i.y+i.height>this.y-h&&i.x<this.x+this.width+h&&i.y<this.y+this.height+h},intersect:function(){var i=u0.read(arguments),h=Math.max(this.x,i.x),u=Math.max(this.y,i.y),f=Math.min(this.x+this.width,i.x+i.width),t=Math.min(this.y+this.height,i.y+i.height);return new u0(h,u,f-h,t-u)},unite:function(){var i=u0.read(arguments),h=Math.min(this.x,i.x),u=Math.min(this.y,i.y),f=Math.max(this.x+this.width,i.x+i.width),t=Math.max(this.y+this.height,i.y+i.height);return new u0(h,u,f-h,t-u)},include:function(){var i=a.read(arguments),h=Math.min(this.x,i.x),u=Math.min(this.y,i.y),f=Math.max(this.x+this.width,i.x),t=Math.max(this.y+this.height,i.y);return new u0(h,u,f-h,t-u)},expand:function(){var i=K.read(arguments),h=i.width,u=i.height;return new u0(this.x-h/2,this.y-u/2,this.width+h,this.height+u)},scale:function(i,h){return this.expand(this.width*i-this.width,this.height*(h===G?i:h)-this.height)}},_.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(i,h){var u=i.join(""),f=/^[RL]/.test(u);if(h>=4)i[1]+=f?"Y":"X";var t=i[f?0:1],n=i[f?1:0],g="get"+t,m="get"+n,w="set"+t,x="set"+n,d="get"+u,l="set"+u;this[d]=function(P){var y=P?a:Q;return new y(this[g](),this[m](),this,l)},this[l]=function(){var P=a.read(arguments);this[w](P.x),this[x](P.y)}},{beans:!0})),H0=u0.extend({initialize:function i(h,u,f,t,n,g){this._set(h,u,f,t,!0),this._owner=n,this._setter=g},_set:function(i,h,u,f,t){if(this._x=i,this._y=h,this._width=u,this._height=f,!t)this._owner[this._setter](this);return this}},new function(){var i=u0.prototype;return _.each(["x","y","width","height"],function(h){var u=_.capitalize(h),f="_"+h;this["get"+u]=function(){return this[f]},this["set"+u]=function(t){if(this[f]=t,!this._dontNotify)this._owner[this._setter](this)}},_.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(h){var u="set"+h;this[u]=function(){this._dontNotify=!0,i[u].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(h){var u=this._owner;if(u._changeSelection)u._changeSelection(2,h)}}))}),l0=_.extend({_class:"Matrix",initialize:function i(h,u){var f=arguments,t=f.length,n=!0;if(t>=6)this._set.apply(this,f);else if(t===1||t===2)if(h instanceof i)this._set(h._a,h._b,h._c,h._d,h._tx,h._ty,u);else if(Array.isArray(h))this._set.apply(this,u?h.concat([u]):h);else n=!1;else if(!t)this.reset();else n=!1;if(!n)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(i,h,u,f,t,n,g){if(this._a=i,this._b=h,this._c=u,this._d=f,this._tx=t,this._ty=n,!g)this._changed();return this},_serialize:function(i,h){return _.serialize(this.getValues(),i,!0,h)},_changed:function(){var i=this._owner;if(i)if(i._applyMatrix)i.transform(null,!0);else i._changed(25)},clone:function(){return new l0(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(i){return i===this||i&&this._a===i._a&&this._b===i._b&&this._c===i._c&&this._d===i._d&&this._tx===i._tx&&this._ty===i._ty},toString:function(){var i=d0.instance;return"[["+[i.number(this._a),i.number(this._c),i.number(this._tx)].join(", ")+"], ["+[i.number(this._b),i.number(this._d),i.number(this._ty)].join(", ")+"]]"},reset:function(i){if(this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,!i)this._changed();return this},apply:function(i,h){var u=this._owner;if(u)return u.transform(null,_.pick(i,!0),h),this.isIdentity();return!1},translate:function(){var i=a.read(arguments),h=i.x,u=i.y;return this._tx+=h*this._a+u*this._c,this._ty+=h*this._b+u*this._d,this._changed(),this},scale:function(){var i=arguments,h=a.read(i),u=a.read(i,0,{readNull:!0});if(u)this.translate(u);if(this._a*=h.x,this._b*=h.x,this._c*=h.y,this._d*=h.y,u)this.translate(u.negate());return this._changed(),this},rotate:function(i){i*=Math.PI/180;var h=a.read(arguments,1),u=h.x,f=h.y,t=Math.cos(i),n=Math.sin(i),g=u-u*t+f*n,m=f-u*n-f*t,w=this._a,x=this._b,d=this._c,l=this._d;return this._a=t*w+n*d,this._b=t*x+n*l,this._c=-n*w+t*d,this._d=-n*x+t*l,this._tx+=g*w+m*d,this._ty+=g*x+m*l,this._changed(),this},shear:function(){var i=arguments,h=a.read(i),u=a.read(i,0,{readNull:!0});if(u)this.translate(u);var f=this._a,t=this._b;if(this._a+=h.y*this._c,this._b+=h.y*this._d,this._c+=h.x*f,this._d+=h.x*t,u)this.translate(u.negate());return this._changed(),this},skew:function(){var i=arguments,h=a.read(i),u=a.read(i,0,{readNull:!0}),f=Math.PI/180,t=new a(Math.tan(h.x*f),Math.tan(h.y*f));return this.shear(t,u)},append:function(i,h){if(i){var u=this._a,f=this._b,t=this._c,n=this._d,g=i._a,m=i._c,w=i._b,x=i._d,d=i._tx,l=i._ty;if(this._a=g*u+w*t,this._c=m*u+x*t,this._b=g*f+w*n,this._d=m*f+x*n,this._tx+=d*u+l*t,this._ty+=d*f+l*n,!h)this._changed()}return this},prepend:function(i,h){if(i){var u=this._a,f=this._b,t=this._c,n=this._d,g=this._tx,m=this._ty,w=i._a,x=i._c,d=i._b,l=i._d,P=i._tx,y=i._ty;if(this._a=w*u+x*f,this._c=w*t+x*n,this._b=d*u+l*f,this._d=d*t+l*n,this._tx=w*g+x*m+P,this._ty=d*g+l*m+y,!h)this._changed()}return this},appended:function(i){return this.clone().append(i)},prepended:function(i){return this.clone().prepend(i)},invert:function(){var i=this._a,h=this._b,u=this._c,f=this._d,t=this._tx,n=this._ty,g=i*f-h*u,m=null;if(g&&!isNaN(g)&&isFinite(t)&&isFinite(n))this._a=f/g,this._b=-h/g,this._c=-u/g,this._d=i/g,this._tx=(u*n-f*t)/g,this._ty=(h*t-i*n)/g,m=this;return m},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new l0(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0},isInvertible:function(){var i=this._a*this._d-this._c*this._b;return i&&!isNaN(i)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(i,h,u){return arguments.length<3?this._transformPoint(a.read(arguments)):this._transformCoordinates(i,h,u)},_transformPoint:function(i,h,u){var{x:f,y:t}=i;if(!h)h=new a;return h._set(f*this._a+t*this._c+this._tx,f*this._b+t*this._d+this._ty,u)},_transformCoordinates:function(i,h,u){for(var f=0,t=2*u;f<t;f+=2){var n=i[f],g=i[f+1];h[f]=n*this._a+g*this._c+this._tx,h[f+1]=n*this._b+g*this._d+this._ty}return h},_transformCorners:function(i){var{x:h,y:u}=i,f=h+i.width,t=u+i.height,n=[h,u,f,u,f,t,h,t];return this._transformCoordinates(n,n,4)},_transformBounds:function(i,h,u){var f=this._transformCorners(i),t=f.slice(0,2),n=t.slice();for(var g=2;g<8;g++){var m=f[g],w=g&1;if(m<t[w])t[w]=m;else if(m>n[w])n[w]=m}if(!h)h=new u0;return h._set(t[0],t[1],n[0]-t[0],n[1]-t[1],u)},inverseTransform:function(){return this._inverseTransform(a.read(arguments))},_inverseTransform:function(i,h,u){var f=this._a,t=this._b,n=this._c,g=this._d,m=this._tx,w=this._ty,x=f*g-t*n,d=null;if(x&&!isNaN(x)&&isFinite(m)&&isFinite(w)){var l=i.x-this._tx,P=i.y-this._ty;if(!h)h=new a;d=h._set((l*g-P*n)/x,(P*f-l*t)/x,u)}return d},decompose:function(){var i=this._a,h=this._b,u=this._c,f=this._d,t=i*f-h*u,n=Math.sqrt,g=Math.atan2,m=180/Math.PI,w,x,d;if(i!==0||h!==0){var l=n(i*i+h*h);w=Math.acos(i/l)*(h>0?1:-1),x=[l,t/l],d=[g(i*u+h*f,l*l),0]}else if(u!==0||f!==0){var P=n(u*u+f*f);w=Math.asin(u/P)*(f>0?1:-1),x=[t/P,P],d=[0,g(i*u+h*f,P*P)]}else w=0,d=x=[0,0];return{translation:this.getTranslation(),rotation:w*m,scaling:new a(x),skewing:new a(d[0]*m,d[1]*m)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new a(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(i){if(!this.isIdentity())i.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},_.each(["a","b","c","d","tx","ty"],function(i){var h=_.capitalize(i),u="_"+i;this["get"+h]=function(){return this[u]},this["set"+h]=function(f){this[u]=f,this._changed()}},{})),_0=_.extend({_class:"Line",initialize:function i(h,u,f,t,n){var g=!1;if(arguments.length>=4)this._px=h,this._py=u,this._vx=f,this._vy=t,g=n;else this._px=h.x,this._py=h.y,this._vx=u.x,this._vy=u.y,g=f;if(!g)this._vx-=this._px,this._vy-=this._py},getPoint:function(){return new a(this._px,this._py)},getVector:function(){return new a(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(i,h){return _0.intersect(this._px,this._py,this._vx,this._vy,i._px,i._py,i._vx,i._vy,!0,h)},getSide:function(i,h){return _0.getSide(this._px,this._py,this._vx,this._vy,i.x,i.y,!0,h)},getDistance:function(i){return Math.abs(this.getSignedDistance(i))},getSignedDistance:function(i){return _0.getSignedDistance(this._px,this._py,this._vx,this._vy,i.x,i.y,!0)},isCollinear:function(i){return a.isCollinear(this._vx,this._vy,i._vx,i._vy)},isOrthogonal:function(i){return a.isOrthogonal(this._vx,this._vy,i._vx,i._vy)},statics:{intersect:function(i,h,u,f,t,n,g,m,w,x){if(!w)u-=i,f-=h,g-=t,m-=n;var d=u*m-f*g;if(!i0.isMachineZero(d)){var l=i-t,P=h-n,y=(g*P-m*l)/d,b=(u*P-f*l)/d,z=0.000000000001,B=-z,N=1+z;if(x||B<y&&y<N&&B<b&&b<N){if(!x)y=y<=0?0:y>=1?1:y;return new a(i+y*u,h+y*f)}}},getSide:function(i,h,u,f,t,n,g,m){if(!g)u-=i,f-=h;var w=t-i,x=n-h,d=w*f-x*u;if(!m&&i0.isMachineZero(d)){if(d=(w*u+w*u)/(u*u+f*f),d>=0&&d<=1)d=0}return d<0?-1:d>0?1:0},getSignedDistance:function(i,h,u,f,t,n,g){if(!g)u-=i,f-=h;return u===0?f>0?t-i:i-t:f===0?u<0?n-h:h-n:((t-i)*f-(n-h)*u)/(f>u?f*Math.sqrt(1+u*u/(f*f)):u*Math.sqrt(1+f*f/(u*u)))},getDistance:function(i,h,u,f,t,n,g){return Math.abs(_0.getSignedDistance(i,h,u,f,t,n,g))}}}),g6=S0.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function i(h){S0.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new Q6(null,null,this),this._view=c0.create(this,h||G0.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(i,h){return _.serialize(this._children,i,!0,h)},_changed:function(i,h){if(i&1){var u=this._view;if(u){if(u._needsUpdate=!0,!u._requested&&u._autoUpdate)u.requestUpdate()}}var f=this._changes;if(f&&h){var t=this._changesById,n=h._id,g=t[n];if(g)g.flags|=i;else f.push(t[n]={item:h,flags:i})}},clear:function(){var i=this._children;for(var h=i.length-1;h>=0;h--)i[h].remove()},isEmpty:function(){return!this._children.length},remove:function i(){if(!i.base.call(this))return!1;if(this._view)this._view.remove();return!0},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(i){this._currentStyle.set(i)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new _6({project:this,insert:!0})},getSymbolDefinitions:function(){var i=[],h={};return this.getItems({class:K6,match:function(u){var f=u._definition,t=f._id;if(!h[t])h[t]=!0,i.push(f);return!1}}),i},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var i=this._selectionItems,h=[];for(var u in i){var f=i[u],t=f._selection;if(t&1&&f.isInserted())h.push(f);else if(!t)this._updateSelection(f)}return h},_updateSelection:function(i){var h=i._id,u=this._selectionItems;if(i._selection){if(u[h]!==i)this._selectionCount++,u[h]=i}else if(u[h]===i)this._selectionCount--,delete u[h]},selectAll:function(){var i=this._children;for(var h=0,u=i.length;h<u;h++)i[h].setFullySelected(!0)},deselectAll:function(){var i=this._selectionItems;for(var h in i)i[h].setFullySelected(!1)},addLayer:function(i){return this.insertLayer(G,i)},insertLayer:function(i,h){if(h instanceof _6){h._remove(!1,!0),_.splice(this._children,[h],i,0),h._setProject(this,!0);var u=h._name;if(u)h.setName(u);if(this._changes)h._changed(5);if(!this._activeLayer)this._activeLayer=h}else h=null;return h},_insertItem:function(i,h,u){if(h=this.insertLayer(i,h)||(this._activeLayer||this._insertItem(G,new _6(m0.NO_INSERT),!0)).insertChild(i,h),u&&h.activate)h.activate();return h},getItems:function(i){return m0._getItems(this,i)},getItem:function(i){return m0._getItems(this,i,null,null,!0)[0]||null},importJSON:function(i){this.activate();var h=this._activeLayer;return _.importJSON(i,h&&h.isEmpty()&&h)},removeOn:function(i){var h=this._removeSets;if(h){if(i==="mouseup")h.mousedrag=null;var u=h[i];if(u){for(var f in u){var t=u[f];for(var n in h){var g=h[n];if(g&&g!=u)delete g[t._id]}t.remove()}h[i]=null}}},draw:function(i,h,u){this._updateVersion++,i.save(),h.applyToContext(i);var f=this._children,t=new _({offset:new a(0,0),pixelRatio:u,viewMatrix:h.isIdentity()?null:h,matrices:[new l0],updateMatrix:!0});for(var n=0,g=f.length;n<g;n++)f[n].draw(i,t);if(i.restore(),this._selectionCount>0){i.save(),i.strokeWidth=1;var m=this._selectionItems,w=this._scope.settings.handleSize,x=this._updateVersion;for(var d in m)m[d]._drawSelection(i,h,w,m,x);i.restore()}}}),m0=_.extend($,{statics:{extend:function i(h){if(h._serializeFields)h._serializeFields=_.set({},this.prototype._serializeFields,h._serializeFields);return i.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new l0,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var i=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return _.each(i,function(h){this._events[h]={install:function(u){this.getView()._countItemEvent(u,1)},uninstall:function(u){this.getView()._countItemEvent(u,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:i}})},{initialize:function i(){},_initialize:function(i,h){var u=i&&_.isPlainObject(i),f=u&&i.internal===!0,t=this._matrix=new l0,n=u&&i.project||j0.project,g=j0.settings;if(this._id=f?null:I0.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&g.applyMatrix,h)t.translate(h);if(t._owner=this,this._style=new Q6(n._currentStyle,this,n),f||u&&i.insert==!1||!g.insertItems&&!(u&&i.insert==!0))this._setProject(n);else(u&&i.parent||n)._insertItem(G,this,!0);if(u&&i!==m0.NO_INSERT&&i!==m0.INSERT)this.set(i,{internal:!0,insert:!0,project:!0,parent:!0});return u},_serialize:function(i,h){var u={},f=this;function t(n){for(var g in n){var m=f[g];if(!_.equals(m,g==="leading"?n.fontSize*1.2:n[g]))u[g]=_.serialize(m,i,g!=="data",h)}}if(t(this._serializeFields),!(this instanceof q0))t(this._style._defaults);return[this._class,u]},_changed:function(i){var h=this._symbol,u=this._parent||h,f=this._project;if(i&8)this._bounds=this._position=this._decomposed=G;if(i&16)this._globalMatrix=G;if(u&&i&72)m0._clearBoundsCache(u);if(i&2)m0._clearBoundsCache(this);if(f)f._changed(i,this);if(h)h._changed(i)},getId:function(){return this._id},getName:function(){return this._name},setName:function(i){if(this._name)this._removeNamed();if(i===+i+"")throw new Error("Names consisting only of numbers are not supported.");var h=this._getOwner();if(i&&h){var{_children:u,_namedChildren:f}=h;if((f[i]=f[i]||[]).push(this),!(i in u))u[i]=this}this._name=i||G,this._changed(256)},getStyle:function(){return this._style},setStyle:function(i){this.getStyle().set(i)}},_.each(["locked","visible","blendMode","opacity","guide"],function(i){var h=_.capitalize(i),u="_"+i,f={locked:256,visible:265};this["get"+h]=function(){return this[u]},this["set"+h]=function(t){if(t!=this[u])this[u]=t,this._changed(f[i]||257)}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(i){if(i!==this._selection){this._selection=i;var h=this._project;if(h)h._updateSelection(this),this._changed(257)}},_changeSelection:function(i,h){var u=this._selection;this.setSelection(h?u|i:u&~i)},isSelected:function(){if(this._selectChildren){var i=this._children;for(var h=0,u=i.length;h<u;h++)if(i[h].isSelected())return!0}return!!(this._selection&1)},setSelected:function(i){if(this._selectChildren){var h=this._children;for(var u=0,f=h.length;u<f;u++)h[u].setSelected(i)}this._changeSelection(1,i)},isFullySelected:function(){var i=this._children,h=!!(this._selection&1);if(i&&h){for(var u=0,f=i.length;u<f;u++)if(!i[u].isFullySelected())return!1;return!0}return h},setFullySelected:function(i){var h=this._children;if(h)for(var u=0,f=h.length;u<f;u++)h[u].setFullySelected(i);this._changeSelection(1,i)},isClipMask:function(){return this._clipMask},setClipMask:function(i){if(this._clipMask!=(i=!!i)){if(this._clipMask=i,i)this.setFillColor(null),this.setStrokeColor(null);if(this._changed(257),this._parent)this._parent._changed(2048)}},getData:function(){if(!this._data)this._data={};return this._data},setData:function(i){this._data=i},getPosition:function(i){var h=i?a:Q,u=this._position||(this._position=this._getPositionFromBounds());return new h(u.x,u.y,this,"setPosition")},setPosition:function(){this.translate(a.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(i){return this._pivot?this._matrix._transformPoint(this._pivot):(i||this.getBounds()).getCenter(!0)},getPivot:function(){var i=this._pivot;return i?new Q(i.x,i.y,this,"setPivot"):null},setPivot:function(){this._pivot=a.read(arguments,0,{clone:!0,readNull:!0}),this._position=G}},_.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(i,h){this[h]=function(u){return this.getBounds(u,i)}},{beans:!0,getBounds:function(i,h){var u=h||i instanceof l0,f=_.set({},u?h:i,this._boundsOptions);if(!f.stroke||this.getStrokeScaling())f.cacheItem=this;var t=this._getCachedBounds(u&&i,f).rect;return!arguments.length?new H0(t.x,t.y,t.width,t.height,this,"setBounds"):t},setBounds:function(){var i=u0.read(arguments),h=this.getBounds(),u=this._matrix,f=new l0,t=i.getCenter();if(f.translate(t),i.width!=h.width||i.height!=h.height){if(!u.isInvertible())u.set(u._backup||new l0().translate(u.getTranslation())),h=this.getBounds();f.scale(h.width!==0?i.width/h.width:0,h.height!==0?i.height/h.height:0)}t=h.getCenter(),f.translate(-t.x,-t.y),this.transform(f)},_getBounds:function(i,h){var u=this._children;if(!u||!u.length)return new u0;return m0._updateBoundsCache(this,h.cacheItem),m0._getBounds(u,i,h)},_getBoundsCacheKey:function(i,h){return[i.stroke?1:0,i.handle?1:0,h?1:0].join("")},_getCachedBounds:function(i,h,u){i=i&&i._orNullIfIdentity();var f=h.internal&&!u,t=h.cacheItem,n=f?null:this._matrix._orNullIfIdentity(),g=t&&(!i||i.equals(n))&&this._getBoundsCacheKey(h,f),m=this._bounds;if(m0._updateBoundsCache(this._parent||this._symbol,t),g&&m&&g in m){var w=m[g];return{rect:w.rect.clone(),nonscaling:w.nonscaling}}var x=this._getBounds(i||n,h),d=x.rect||x,l=this._style,P=x.nonscaling||l.hasStroke()&&!l.getStrokeScaling();if(g){if(!m)this._bounds=m={};var w=m[g]={rect:d.clone(),nonscaling:P,internal:f}}return{rect:d,nonscaling:P}},_getStrokeMatrix:function(i,h){var u=this.getStrokeScaling()?null:h&&h.internal?this:this._parent||this._symbol&&this._symbol._item,f=u?u.getViewMatrix().invert():i;return f&&f._shiftless()},statics:{_updateBoundsCache:function(i,h){if(i&&h){var u=h._id,f=i._boundsCache=i._boundsCache||{ids:{},list:[]};if(!f.ids[u])f.list.push(h),f.ids[u]=h}},_clearBoundsCache:function(i){var h=i._boundsCache;if(h){i._bounds=i._position=i._boundsCache=G;for(var u=0,f=h.list,t=f.length;u<t;u++){var n=f[u];if(n!==i){if(n._bounds=n._position=G,n._boundsCache)m0._clearBoundsCache(n)}}}},_getBounds:function(i,h,u){var f=Infinity,t=-f,n=f,g=t,m=!1;u=u||{};for(var w=0,x=i.length;w<x;w++){var d=i[w];if(d._visible&&!d.isEmpty(!0)){var l=d._getCachedBounds(h&&h.appended(d._matrix),u,!0),P=l.rect;if(f=Math.min(P.x,f),n=Math.min(P.y,n),t=Math.max(P.x+P.width,t),g=Math.max(P.y+P.height,g),l.nonscaling)m=!0}}return{rect:isFinite(f)?new u0(f,n,t-f,g-n):new u0,nonscaling:m}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var i=this._decompose();return i?i.rotation:0},setRotation:function(i){var h=this.getRotation();if(h!=null&&i!=null){var u=this._decomposed;if(this.rotate(i-h),u)u.rotation=i,this._decomposed=u}},getScaling:function(){var i=this._decompose(),h=i&&i.scaling;return new Q(h?h.x:1,h?h.y:1,this,"setScaling")},setScaling:function(){var i=this.getScaling(),h=a.read(arguments,0,{clone:!0,readNull:!0});if(i&&h&&!i.equals(h)){var u=this.getRotation(),f=this._decomposed,t=new l0,n=i0.isZero;if(n(i.x)||n(i.y)){if(t.translate(f.translation),u)t.rotate(u);t.scale(h.x,h.y),this._matrix.set(t)}else{var g=this.getPosition(!0);if(t.translate(g),u)t.rotate(u);if(t.scale(h.x/i.x,h.y/i.y),u)t.rotate(-u);t.translate(g.negate()),this.transform(t)}if(f)f.scaling=h,this._decomposed=f}},getMatrix:function(){return this._matrix},setMatrix:function(){var i=this._matrix;i.set.apply(i,arguments)},getGlobalMatrix:function(i){var h=this._globalMatrix;if(h){var u=this._parent,f=[];while(u){if(!u._globalMatrix){h=null;for(var t=0,n=f.length;t<n;t++)f[t]._globalMatrix=null;break}f.push(u),u=u._parent}}if(!h){h=this._globalMatrix=this._matrix.clone();var u=this._parent;if(u)h.prepend(u.getGlobalMatrix(!0))}return i?h:h.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(i){if(this._applyMatrix=this._canApplyMatrix&&!!i)this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(i,h){if(this._project!==i){if(this._project)this._installEvents(!1);this._project=i;var u=this._children;for(var f=0,t=u&&u.length;f<t;f++)u[f]._setProject(i);h=!0}if(h)this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function i(h){i.base.call(this,h);var u=this._children;for(var f=0,t=u&&u.length;f<t;f++)u[f]._installEvents(h)},getLayer:function(){var i=this;while(i=i._parent)if(i instanceof _6)return i;return null},getParent:function(){return this._parent},setParent:function(i){return i.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(i){this.removeChildren(),this.addChildren(i)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var i=this._getOwner();return i&&i._children[this._index+1]||null},getPreviousSibling:function(){var i=this._getOwner();return i&&i._children[this._index-1]||null},getIndex:function(){return this._index},equals:function(i){return i===this||i&&this._class===i._class&&this._style.equals(i._style)&&this._matrix.equals(i._matrix)&&this._locked===i._locked&&this._visible===i._visible&&this._blendMode===i._blendMode&&this._opacity===i._opacity&&this._clipMask===i._clipMask&&this._guide===i._guide&&this._equals(i)||!1},_equals:function(i){return _.equals(this._children,i._children)},clone:function(i){var h=new this.constructor(m0.NO_INSERT),u=this._children,f=_.pick(i?i.insert:G,i===G||i===!0),t=_.pick(i?i.deep:G,!0);if(u)h.copyAttributes(this);if(!u||t)h.copyContent(this);if(!u)h.copyAttributes(this);if(f)h.insertAbove(this);var n=this._name,g=this._parent;if(n&&g){var u=g._children,m=n,w=1;while(u[n])n=m+" "+w++;if(n!==m)h.setName(n)}return h},copyContent:function(i){var h=i._children;for(var u=0,f=h&&h.length;u<f;u++)this.addChild(h[u].clone(!1),!0)},copyAttributes:function(i,h){this.setStyle(i._style);var u=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"];for(var f=0,t=u.length;f<t;f++){var n=u[f];if(i.hasOwnProperty(n))this[n]=i[n]}if(!h)this._matrix.set(i._matrix,!0);this.setApplyMatrix(i._applyMatrix),this.setPivot(i._pivot),this.setSelection(i._selection);var{_data:g,_name:m}=i;if(this._data=g?_.clone(g):null,m)this.setName(m)},rasterize:function(i,h){var u,f,t;if(_.isPlainObject(i))u=i.resolution,f=i.insert,t=i.raster;else u=i,f=h;if(!t)t=new k6(m0.NO_INSERT);var n=this.getStrokeBounds(),g=(u||this.getView().getResolution())/72,m=n.getTopLeft().floor(),w=n.getBottomRight().ceil(),x=new K(w.subtract(m)),d=x.multiply(g);if(t.setSize(d,!0),!d.isZero()){var l=t.getContext(!0),P=new l0().scale(g).translate(m.negate());l.save(),P.applyToContext(l),this.draw(l,new _({matrices:[P]})),l.restore()}if(t._matrix.set(new l0().translate(m.add(x.divide(2))).scale(1/g)),f===G||f)t.insertAbove(this);return t},contains:function(){var i=this._matrix;return i.isInvertible()&&!!this._contains(i._inverseTransform(a.read(arguments)))},_contains:function(i){var h=this._children;if(h){for(var u=h.length-1;u>=0;u--)if(h[u].contains(i))return!0;return!1}return i.isInside(this.getInternalBounds())},isInside:function(){return u0.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new b0.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(i,h){if(!(i instanceof m0))return!1;return this._asPathItem().getIntersections(i._asPathItem(),null,h,!0).length>0}},new function(){function i(){var f=arguments;return this._hitTest(a.read(f),w6.getOptions(f))}function h(){var f=arguments,t=a.read(f),n=w6.getOptions(f),g=[];return this._hitTest(t,new _({all:g},n)),g}function u(f,t,n,g){var m=this._children;if(m)for(var w=m.length-1;w>=0;w--){var x=m[w],d=x!==g&&x._hitTest(f,t,n);if(d&&!t.all)return d}return null}return g6.inject({hitTest:i,hitTestAll:h,_hitTest:u}),{hitTest:i,hitTestAll:h,_hitTestChildren:u}},{_hitTest:function(i,h,u){if(this._locked||!this._visible||this._guide&&!h.guides||this.isEmpty())return null;var f=this._matrix,t=u?u.appended(f):this.getGlobalMatrix().prepend(this.getView()._matrix),n=Math.max(h.tolerance,0.000000000001),g=h._tolerancePadding=new K(b0._getStrokePadding(n,f._shiftless().invert()));if(i=f._inverseTransform(i),!i||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(g.multiply(2))._containsPoint(i))return null;var m=!(h.guides&&!this._guide||h.selected&&!this.isSelected()||h.type&&h.type!==_.hyphenate(this._class)||h.class&&!(this instanceof h.class)),w=h.match,x=this,d,l;function P(s){if(s&&w&&!w(s))s=null;if(s&&h.all)h.all.push(s);return s}function y(s,C){var I=C?d["get"+C]():x.getPosition();if(i.subtract(I).divide(g).length<=1)return new w6(s,x,{name:C?_.hyphenate(C):s,point:I})}var{position:b,center:z,bounds:B}=h;if(m&&this._parent&&(b||z||B)){if(z||B)d=this.getInternalBounds();if(l=b&&y("position")||z&&y("center","Center"),!l&&B){var N=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"];for(var S=0;S<8&&!l;S++)l=y("bounds",N[S])}l=P(l)}if(!l)l=this._hitTestChildren(i,h,t)||m&&P(this._hitTestSelf(i,h,t,this.getStrokeScaling()?null:t._shiftless().invert()))||null;if(l&&l.point)l.point=f.transform(l.point);return l},_hitTestSelf:function(i,h){if(h.fill&&this.hasFill()&&this._contains(i))return new w6("fill",this)},matches:function(i,h){function u(g,m){for(var w in g)if(g.hasOwnProperty(w)){var x=g[w],d=m[w];if(_.isPlainObject(x)&&_.isPlainObject(d)){if(!u(x,d))return!1}else if(!_.equals(x,d))return!1}return!0}var f=typeof i;if(f==="object"){for(var t in i)if(i.hasOwnProperty(t)&&!this.matches(t,i[t]))return!1;return!0}else if(f==="function")return i(this);else if(i==="match")return h(this);else{var n=/^(empty|editable)$/.test(i)?this["is"+_.capitalize(i)]():i==="type"?_.hyphenate(this._class):this[i];if(i==="class"){if(typeof h==="function")return this instanceof h;n=this._class}if(typeof h==="function")return!!h(n);else if(h){if(h.test)return h.test(n);else if(_.isPlainObject(h))return u(h,n)}return _.equals(n,h)}},getItems:function(i){return m0._getItems(this,i,this._matrix)},getItem:function(i){return m0._getItems(this,i,this._matrix,null,!0)[0]||null},statics:{_getItems:function i(h,u,f,t,n){if(!t){var g=typeof u==="object"&&u,m=g&&g.overlapping,w=g&&g.inside,x=m||w,P=x&&u0.read([x]);if(t={items:[],recursive:g&&g.recursive!==!1,inside:!!w,overlapping:!!m,rect:P,path:m&&new b0.Rectangle({rectangle:P,insert:!1})},g)u=_.filter({},u,{recursive:!0,inside:!0,overlapping:!0})}var d=h._children,l=t.items,P=t.rect;f=P&&(f||new l0);for(var y=0,b=d&&d.length;y<b;y++){var z=d[y],B=f&&f.appended(z._matrix),N=!0;if(P){var x=z.getBounds(B);if(!P.intersects(x))continue;if(!(P.contains(x)||t.overlapping&&(x.contains(P)||t.path.intersects(z,B))))N=!1}if(N&&z.matches(u)){if(l.push(z),n)break}if(t.recursive!==!1)i(z,u,B,t,n);if(n&&l.length>0)break}return l}}},{importJSON:function(i){var h=_.importJSON(i,this);return h!==this?this.addChild(h):h},addChild:function(i){return this.insertChild(G,i)},insertChild:function(i,h){var u=h?this.insertChildren(i,[h]):null;return u&&u[0]},addChildren:function(i){return this.insertChildren(this._children.length,i)},insertChildren:function(i,h){var u=this._children;if(u&&h&&h.length>0){h=_.slice(h);var f={};for(var t=h.length-1;t>=0;t--){var n=h[t],g=n&&n._id;if(!n||f[g])h.splice(t,1);else n._remove(!1,!0),f[g]=!0}_.splice(u,h,i,0);var m=this._project,w=m._changes;for(var t=0,x=h.length;t<x;t++){var n=h[t],d=n._name;if(n._parent=this,n._setProject(m,!0),d)n.setName(d);if(w)n._changed(5)}this._changed(11)}else h=null;return h},_insertItem:"#insertChild",_insertAt:function(i,h){var u=i&&i._getOwner(),f=i!==this&&u?this:null;if(f)f._remove(!1,!0),u._insertItem(i._index+h,f);return f},insertAbove:function(i){return this._insertAt(i,1)},insertBelow:function(i){return this._insertAt(i,0)},sendToBack:function(){var i=this._getOwner();return i?i._insertItem(0,this):null},bringToFront:function(){var i=this._getOwner();return i?i._insertItem(G,this):null},appendTop:"#addChild",appendBottom:function(i){return this.insertChild(0,i)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(i){return i._insertItem(G,this)},copyTo:function(i){return this.clone(!1).addTo(i)},reduce:function(i){var h=this._children;if(h&&h.length===1){var u=h[0].reduce(i);if(this._parent)u.insertAbove(this),this.remove();else u.remove();return u}return this},_removeNamed:function(){var i=this._getOwner();if(i){var{_children:h,_namedChildren:u}=i,f=this._name,t=u[f],n=t?t.indexOf(this):-1;if(n!==-1){if(h[f]==this)delete h[f];if(t.splice(n,1),t.length)h[f]=t[0];else delete u[f]}}},_remove:function(i,h){var u=this._getOwner(),f=this._project,t=this._index;if(this._style)this._style._dispose();if(u){if(this._name)this._removeNamed();if(t!=null){if(f._activeLayer===this)f._activeLayer=this.getNextSibling()||this.getPreviousSibling();_.splice(u._children,null,t,1)}if(this._installEvents(!1),i&&f._changes)this._changed(5);if(h)u._changed(11,this);return this._parent=null,!0}return!1},remove:function(){return this._remove(!0,!0)},replaceWith:function(i){var h=i&&i.insertBelow(this);if(h)this.remove();return h},removeChildren:function(i,h){if(!this._children)return null;i=i||0,h=_.pick(h,this._children.length);var u=_.splice(this._children,null,i,h-i);for(var f=u.length-1;f>=0;f--)u[f]._remove(!0,!1);if(u.length>0)this._changed(11);return u},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var i=0,h=this._children.length;i<h;i++)this._children[i]._index=i;this._changed(11)}},isEmpty:function(i){var h=this._children,u=h?h.length:0;if(i){for(var f=0;f<u;f++)if(!h[f].isEmpty(i))return!1;return!0}return!u},isEditable:function(){var i=this;while(i){if(!i._visible||i._locked)return!1;i=i._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(i){function h(g){var m=[];do m.unshift(g);while(g=g._parent);return m}var u=h(this),f=h(i);for(var t=0,n=Math.min(u.length,f.length);t<n;t++)if(u[t]!=f[t])return u[t]._index<f[t]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return this._parent?this._parent.isInserted():!1},isAbove:function(i){return this._getOrder(i)===-1},isBelow:function(i){return this._getOrder(i)===1},isParent:function(i){return this._parent===i},isChild:function(i){return i&&i._parent===this},isDescendant:function(i){var h=this;while(h=h._parent)if(h===i)return!0;return!1},isAncestor:function(i){return i?i.isDescendant(this):!1},isSibling:function(i){return this._parent===i._parent},isGroupedWith:function(i){var h=this._parent;while(h){if(h._parent&&/^(Group|Layer|CompoundPath)$/.test(h._class)&&i.isDescendant(h))return!0;h=h._parent}return!1}},_.each(["rotate","scale","shear","skew"],function(i){var h=i==="rotate";this[i]=function(){var u=arguments,f=(h?_:a).read(u),t=a.read(u,0,{readNull:!0});return this.transform(new l0()[i](f,t||this.getPosition(!0)))}},{translate:function(){var i=new l0;return this.transform(i.translate.apply(i,arguments))},transform:function(i,h,u){var f=this._matrix,t=i&&!i.isIdentity(),n=u&&this._canApplyMatrix||this._applyMatrix&&(t||!f.isIdentity()||h&&this._children);if(!t&&!n)return this;if(t){if(!i.isInvertible()&&f.isInvertible())f._backup=f.getValues();f.prepend(i,!0);var g=this._style,m=g.getFillColor(!0),w=g.getStrokeColor(!0);if(m)m.transform(i);if(w)w.transform(i)}if(n&&(n=this._transformContent(f,h,u))){var x=this._pivot;if(x)f._transformPoint(x,x,!0);if(f.reset(!0),u&&this._canApplyMatrix)this._applyMatrix=!0}var d=this._bounds,l=this._position;if(t||n)this._changed(25);var P=t&&d&&i.decompose();if(P&&P.skewing.isZero()&&P.rotation%90===0){for(var y in d){var b=d[y];if(b.nonscaling)delete d[y];else if(n||!b.internal){var z=b.rect;i._transformBounds(z,z)}}this._bounds=d;var B=d[this._getBoundsCacheKey(this._boundsOptions||{})];if(B)this._position=this._getPositionFromBounds(B.rect)}else if(t&&l&&this._pivot)this._position=i._transformPoint(l,l);return this},_transformContent:function(i,h,u){var f=this._children;if(f){for(var t=0,n=f.length;t<n;t++)f[t].transform(i,h,u);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(a.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(a.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(a.read(arguments))},localToParent:function(){return this._matrix._transformPoint(a.read(arguments))},fitBounds:function(i,h){i=u0.read(arguments);var u=this.getBounds(),f=u.height/u.width,t=i.height/i.width,n=(h?f>t:f<t)?i.width/u.width:i.height/u.height,g=new u0(new a,new K(u.width*n,u.height*n));g.setCenter(i.getCenter()),this.setBounds(g)}}),{_setStyles:function(i,h,u){var f=this._style,t=this._matrix;if(f.hasFill())i.fillStyle=f.getFillColor().toCanvasStyle(i,t);if(f.hasStroke()){i.strokeStyle=f.getStrokeColor().toCanvasStyle(i,t),i.lineWidth=f.getStrokeWidth();var n=f.getStrokeJoin(),g=f.getStrokeCap(),m=f.getMiterLimit();if(n)i.lineJoin=n;if(g)i.lineCap=g;if(m)i.miterLimit=m;if(j0.support.nativeDash){var w=f.getDashArray(),x=f.getDashOffset();if(w&&w.length)if("setLineDash"in i)i.setLineDash(w),i.lineDashOffset=x;else i.mozDash=w,i.mozDashOffset=x}}if(f.hasShadow()){var d=h.pixelRatio||1,l=u._shiftless().prepend(new l0().scale(d,d)),P=l.transform(new a(f.getShadowBlur(),0)),y=l.transform(this.getShadowOffset());i.shadowColor=f.getShadowColor().toCanvasStyle(i),i.shadowBlur=P.getLength(),i.shadowOffsetX=y.x,i.shadowOffsetY=y.y}},draw:function(i,h,u){var f=this._updateVersion=this._project._updateVersion;if(!this._visible||this._opacity===0)return;var{matrices:t,viewMatrix:n}=h,g=this._matrix,m=t[t.length-1].appended(g);if(!m.isInvertible())return;if(n=n?n.appended(m):m,t.push(m),h.updateMatrix)this._globalMatrix=m;var w=this._blendMode,x=i0.clamp(this._opacity,0,1),d=w==="normal",l=$6.nativeModes[w],P=d&&x===1||h.dontStart||h.clip||(l||d&&x<1)&&this._canComposite(),y=h.pixelRatio||1,b,z,B;if(!P){var N=this.getStrokeBounds(n);if(!N.width||!N.height){t.pop();return}if(B=h.offset,z=h.offset=N.getTopLeft().floor(),b=i,i=G0.getContext(N.getSize().ceil().add(1).multiply(y)),y!==1)i.scale(y,y)}i.save();var S=u?u.appended(g):this._canScaleStroke&&!this.getStrokeScaling(!0)&&n,s=!P&&h.clipItem,C=!S||s;if(P){if(i.globalAlpha=x,l)i.globalCompositeOperation=w}else if(C)i.translate(-z.x,-z.y);if(C)(P?g:n).applyToContext(i);if(s)h.clipItem.draw(i,h.extend({clip:!0}));if(S){i.setTransform(y,0,0,y,0,0);var I=h.offset;if(I)i.translate(-I.x,-I.y)}if(this._draw(i,h,n,S),i.restore(),t.pop(),h.clip&&!h.dontFinish)i.clip(this.getFillRule());if(!P)$6.process(w,i,b,x,z.subtract(B).multiply(y)),G0.release(i),h.offset=B},_isUpdated:function(i){var h=this._parent;if(h instanceof f6)return h._isUpdated(i);var u=this._updateVersion===i;if(!u&&h&&h._visible&&h._isUpdated(i))this._updateVersion=i,u=!0;return u},_drawSelection:function(i,h,u,f,t){var n=this._selection,g=n&1,m=n&2||g&&this._selectBounds,w=n&4;if(!this._drawSelected)g=!1;if((g||m||w)&&this._isUpdated(t)){var x,d=this.getSelectedColor(!0)||(x=this.getLayer())&&x.getSelectedColor(!0),l=h.appended(this.getGlobalMatrix(!0)),P=u/2;if(i.strokeStyle=i.fillStyle=d?d.toCanvasStyle(i):"#009dec",g)this._drawSelected(i,l,f);if(w){var y=this.getPosition(!0),b=this._parent,z=b?b.localToGlobal(y):y,B=z.x,N=z.y;i.beginPath(),i.arc(B,N,P,0,Math.PI*2,!0),i.stroke();var S=[[0,-1],[1,0],[0,1],[-1,0]],s=P,C=u+1;for(var I=0;I<4;I++){var o=S[I],k=o[0],L=o[1];i.moveTo(B+k*s,N+L*s),i.lineTo(B+k*C,N+L*C),i.stroke()}}if(m){var c=l._transformCorners(this.getInternalBounds());i.beginPath();for(var I=0;I<8;I++)i[!I?"moveTo":"lineTo"](c[I],c[++I]);i.closePath(),i.stroke();for(var I=0;I<8;I++)i.fillRect(c[I]-P,c[++I]-P,u,u)}}},_canComposite:function(){return!1}},_.each(["down","drag","up","move"],function(i){this["removeOn"+_.capitalize(i)]=function(){var h={};return h[i]=!0,this.removeOn(h)}},{removeOn:function(i){for(var h in i)if(i[h]){var u="mouse"+h,f=this._project,t=f._removeSets=f._removeSets||{};t[u]=t[u]||{},t[u][this._id]=this}return this}}),{tween:function(i,h,u){if(!u){if(u=h,h=i,i=null,!u)u=h,h=null}var f=u&&u.easing,t=u&&u.start,n=u!=null&&(typeof u==="number"?u:u.duration),g=new D4(this,i,h,n,f,t);function m(w){if(g._handleFrame(w.time*1000),!g.running)this.off("frame",m)}if(n)this.on("frame",m);return g},tweenTo:function(i,h){return this.tween(null,i,h)},tweenFrom:function(i,h){return this.tween(i,null,h)}}),q0=m0.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function i(h){if(this._children=[],this._namedChildren={},!this._initialize(h))this.addChildren(Array.isArray(h)?h:arguments)},_changed:function i(h){if(i.base.call(this,h),h&2050)this._clipItem=G},_getClipItem:function(){var i=this._clipItem;if(i===G){i=null;var h=this._children;for(var u=0,f=h.length;u<f;u++)if(h[u]._clipMask){i=h[u];break}this._clipItem=i}return i},isClipped:function(){return!!this._getClipItem()},setClipped:function(i){var h=this.getFirstChild();if(h)h.setClipMask(i)},_getBounds:function i(h,u){var f=this._getClipItem();return f?f._getCachedBounds(f._matrix.prepended(h),_.set({},u,{stroke:!1})):i.base.call(this,h,u)},_hitTestChildren:function i(h,u,f){var t=this._getClipItem();return(!t||t.contains(h))&&i.base.call(this,h,u,f,t)},_draw:function(i,h){var u=h.clip,f=!u&&this._getClipItem();if(h=h.extend({clipItem:f,clip:!1}),u)i.beginPath(),h.dontStart=h.dontFinish=!0;else if(f)f.draw(i,h.extend({clip:!0}));var t=this._children;for(var n=0,g=t.length;n<g;n++){var m=t[n];if(m!==f)m.draw(i,h)}}}),_6=q0.extend({_class:"Layer",initialize:function i(){q0.apply(this,arguments)},_getOwner:function(){return this._parent||this._index!=null&&this._project},isInserted:function i(){return this._parent?i.base.call(this):this._index!=null},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),K0=m0.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function i(h,u){this._initialize(h,u)},_equals:function(i){return this._type===i._type&&this._size.equals(i._size)&&_.equals(this._radius,i._radius)},copyContent:function(i){this.setType(i._type),this.setSize(i._size),this.setRadius(i._radius)},getType:function(){return this._type},setType:function(i){this._type=i},getShape:"#getType",setShape:"#setType",getSize:function(){var i=this._size;return new h6(i.width,i.height,this,"setSize")},setSize:function(){var i=K.read(arguments);if(!this._size)this._size=i.clone();else if(!this._size.equals(i)){var h=this._type,u=i.width,f=i.height;if(h==="rectangle")this._radius.set(K.min(this._radius,i.divide(2).abs()));else if(h==="circle")u=f=(u+f)/2,this._radius=u/2;else if(h==="ellipse")this._radius._set(u/2,f/2);this._size._set(u,f),this._changed(9)}},getRadius:function(){var i=this._radius;return this._type==="circle"?i:new h6(i.width,i.height,this,"setRadius")},setRadius:function(i){var h=this._type;if(h==="circle"){if(i===this._radius)return;var u=i*2;this._radius=i,this._size._set(u,u)}else if(i=K.read(arguments),!this._radius)this._radius=i.clone();else{if(this._radius.equals(i))return;if(this._radius.set(i),h==="rectangle"){var u=K.max(this._size,i.multiply(2));this._size.set(u)}else if(h==="ellipse")this._size._set(i.width*2,i.height*2)}this._changed(9)},isEmpty:function(){return!1},toPath:function(i){var h=new b0[_.capitalize(this._type)]({center:new a,size:this._size,radius:this._radius,insert:!1});if(h.copyAttributes(this),j0.settings.applyMatrix)h.setApplyMatrix(!0);if(i===G||i)h.insertAbove(this);return h},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(i,h,u,f){var t=this._style,n=t.hasFill(),g=t.hasStroke(),m=h.dontFinish||h.clip,w=!f;if(n||g||m){var x=this._type,d=this._radius,l=x==="circle";if(!h.dontStart)i.beginPath();if(w&&l)i.arc(0,0,d,0,Math.PI*2,!0);else{var P=l?d:d.width,y=l?d:d.height,b=this._size,z=b.width,B=b.height;if(w&&x==="rectangle"&&P===0&&y===0)i.rect(-z/2,-B/2,z,B);else{var N=z/2,S=B/2,s=0.44771525016920644,C=P*s,I=y*s,o=[-N,-S+y,-N,-S+I,-N+C,-S,-N+P,-S,N-P,-S,N-C,-S,N,-S+I,N,-S+y,N,S-y,N,S-I,N-C,S,N-P,S,-N+P,S,-N+C,S,-N,S-I,-N,S-y];if(f)f.transform(o,o,32);if(i.moveTo(o[0],o[1]),i.bezierCurveTo(o[2],o[3],o[4],o[5],o[6],o[7]),N!==P)i.lineTo(o[8],o[9]);if(i.bezierCurveTo(o[10],o[11],o[12],o[13],o[14],o[15]),S!==y)i.lineTo(o[16],o[17]);if(i.bezierCurveTo(o[18],o[19],o[20],o[21],o[22],o[23]),N!==P)i.lineTo(o[24],o[25]);i.bezierCurveTo(o[26],o[27],o[28],o[29],o[30],o[31])}}i.closePath()}if(!m&&(n||g)){if(this._setStyles(i,h,u),n)i.fill(t.getFillRule()),i.shadowColor="rgba(0,0,0,0)";if(g)i.stroke()}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(i,h){var u=new u0(this._size).setCenter(0,0),f=this._style,t=h.stroke&&f.hasStroke()&&f.getStrokeWidth();if(i)u=i._transformBounds(u);return t?u.expand(b0._getStrokePadding(t,this._getStrokeMatrix(i,h))):u}},new function(){function i(u,f,t){var n=u._radius;if(!n.isZero()){var g=u._size.divide(2);for(var m=1;m<=4;m++){var w=new a(m>1&&m<4?-1:1,m>2?-1:1),x=w.multiply(g),d=x.subtract(w.multiply(n)),l=new u0(t?x.add(w.multiply(t)):x,d);if(l.contains(f))return{point:d,quadrant:m}}}}function h(u,f,t,n){var g=u.divide(f);return(!n||g.isInQuadrant(n))&&g.subtract(g.normalize()).multiply(f).divide(t).length<=1}return{_contains:function u(f){if(this._type==="rectangle"){var t=i(this,f);return t?f.subtract(t.point).divide(this._radius).getLength()<=1:u.base.call(this,f)}else return f.divide(this.size).getLength()<=0.5},_hitTestSelf:function u(f,t,n,g){var m=!1,w=this._style,x=t.stroke&&w.hasStroke(),d=t.fill&&w.hasFill();if(x||d){var l=this._type,P=this._radius,y=x?w.getStrokeWidth()/2:0,b=t._tolerancePadding.add(b0._getStrokePadding(y,!w.getStrokeScaling()&&g));if(l==="rectangle"){var z=b.multiply(2),B=i(this,f,z);if(B)m=h(f.subtract(B.point),P,b,B.quadrant);else{var N=new u0(this._size).setCenter(0,0),S=N.expand(z),s=N.expand(z.negate());m=S._containsPoint(f)&&!s._containsPoint(f)}}else m=h(f,P,b)}return m?new w6(x?"stroke":"fill",this):u.base.apply(this,arguments)}}},{statics:new function(){function i(h,u,f,t,n){var g=_.create(K0.prototype);return g._type=h,g._size=f,g._radius=t,g._initialize(_.getNamed(n),u),g}return{Circle:function(){var h=arguments,u=a.readNamed(h,"center"),f=_.readNamed(h,"radius");return i("circle",u,new K(f*2),f,h)},Rectangle:function(){var h=arguments,u=u0.readNamed(h,"rectangle"),f=K.min(K.readNamed(h,"radius"),u.getSize(!0).divide(2));return i("rectangle",u.getCenter(!0),u.getSize(!0),f,h)},Ellipse:function(){var h=arguments,u=K0._readEllipse(h),f=u.radius;return i("ellipse",u.center,f.multiply(2),f,h)},_readEllipse:function(h){var u,f;if(_.hasNamed(h,"radius"))u=a.readNamed(h,"center"),f=K.readNamed(h,"radius");else{var t=u0.readNamed(h,"rectangle");u=t.getCenter(!0),f=t.getSize(!0).divide(2)}return{center:u,radius:f}}}}}),k6=m0.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function i(h,u){if(!this._initialize(h,u!==G&&a.read(arguments))){var f,t=typeof h,n=t==="string"?F.getElementById(h):t==="object"?h:null;if(n&&n!==m0.NO_INSERT){if(n.getContext||n.naturalHeight!=null)f=n;else if(n){var g=K.read(arguments);if(!g.isZero())f=G0.getCanvas(g)}}if(f)this.setImage(f);else this.setSource(h)}if(!this._size)this._size=new K,this._loaded=!1},_equals:function(i){return this.getSource()===i.getSource()},copyContent:function(i){var{_image:h,_canvas:u}=i;if(h)this._setImage(h);else if(u){var f=G0.getCanvas(i._size);f.getContext("2d").drawImage(u,0,0),this._setImage(f)}this._crossOrigin=i._crossOrigin},getSize:function(){var i=this._size;return new h6(i?i.width:0,i?i.height:0,this,"setSize")},setSize:function(i,h){var u=K.read(arguments);if(!u.equals(this._size))if(u.width>0&&u.height>0){var f=!h&&this.getElement();if(this._setImage(G0.getCanvas(u)),f)this.getContext(!0).drawImage(f,0,0,u.width,u.height)}else{if(this._canvas)G0.release(this._canvas);this._size=u.clone()}else if(h)this.clear()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(i){this.setSize(i,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(i){this.setSize(this.getWidth(),i)},getLoaded:function(){return this._loaded},isEmpty:function(){var i=this._size;return!i||i.width===0&&i.height===0},getResolution:function(){var i=this._matrix,h=new a(0,0).transform(i),u=new a(1,0).transform(i).subtract(h),f=new a(0,1).transform(i).subtract(h);return new K(72/u.getLength(),72/f.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(i){var h=this;function u(f){var t=h.getView(),n=f&&f.type||"load";if(t&&h.responds(n))j0=t._scope,h.emit(n,new E6(f))}if(this._setImage(i),this._loaded)setTimeout(u,0);else if(i)A0.add(i,{load:function(f){h._setImage(i),u(f)},error:u})},_setImage:function(i){if(this._canvas)G0.release(this._canvas);if(i&&i.getContext)this._image=null,this._canvas=i,this._loaded=!0;else this._image=i,this._canvas=null,this._loaded=!!(i&&i.src&&i.complete);this._size=new K(i?i.naturalWidth||i.width:0,i?i.naturalHeight||i.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var i=G0.getContext(this._size);try{if(this._image)i.drawImage(this._image,0,0);this._canvas=i.canvas}catch(h){G0.release(i)}}return this._canvas},setCanvas:"#setImage",getContext:function(i){if(!this._context)this._context=this.getCanvas().getContext("2d");if(i)this._image=null,this._changed(1025);return this._context},setContext:function(i){this._context=i},getSource:function(){var i=this._image;return i&&i.src||this.toDataURL()},setSource:function(i){var h=new V.Image,u=this._crossOrigin;if(u)h.crossOrigin=u;if(i)h.src=i;this.setImage(h)},getCrossOrigin:function(){var i=this._image;return i&&i.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(i){this._crossOrigin=i;var h=this._image;if(h)h.crossOrigin=i},getSmoothing:function(){return this._smoothing},setSmoothing:function(i){this._smoothing=typeof i==="string"?i:i?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var i=u0.read(arguments),h=G0.getContext(i.getSize());return h.drawImage(this.getCanvas(),i.x,i.y,i.width,i.height,0,0,i.width,i.height),h.canvas},getSubRaster:function(){var i=u0.read(arguments),h=new k6(m0.NO_INSERT);return h._setImage(this.getSubCanvas(i)),h.translate(i.getCenter().subtract(this.getSize().divide(2))),h._matrix.prepend(this._matrix),h.insertAbove(this),h},toDataURL:function(){var i=this._image,h=i&&i.src;if(/^data:/.test(h))return h;var u=this.getCanvas();return u?u.toDataURL.apply(u,arguments):null},drawImage:function(i){var h=a.read(arguments,1);this.getContext(!0).drawImage(i,h.x,h.y)},getAverageColor:function(i){var h,u;if(!i)h=this.getBounds();else if(i instanceof I6)u=i,h=i.getBounds();else if(typeof i==="object"){if("width"in i)h=new u0(i);else if("x"in i)h=new u0(i.x-0.5,i.y-0.5,1,1)}if(!h)return null;var f=32,t=Math.min(h.width,f),n=Math.min(h.height,f),g=k6._sampleContext;if(!g)g=k6._sampleContext=G0.getContext(new K(f));else g.clearRect(0,0,f+1,f+1);g.save();var m=new l0().scale(t/h.width,n/h.height).translate(-h.x,-h.y);if(m.applyToContext(g),u)u.draw(g,new _({clip:!0,matrices:[m]}));this._matrix.applyToContext(g);var w=this.getElement(),x=this._size;if(w)g.drawImage(w,-x.width/2,-x.height/2);g.restore();var d=g.getImageData(0.5,0.5,Math.ceil(t),Math.ceil(n)).data,l=[0,0,0],P=0;for(var y=0,b=d.length;y<b;y+=4){var z=d[y+3];P+=z,z/=255,l[0]+=d[y]*z,l[1]+=d[y+1]*z,l[2]+=d[y+2]*z}for(var y=0;y<3;y++)l[y]/=P;return P?V0.read(l):null},getPixel:function(){var i=a.read(arguments),h=this.getContext().getImageData(i.x,i.y,1,1).data;return new V0("rgb",[h[0]/255,h[1]/255,h[2]/255],h[3]/255)},setPixel:function(){var i=arguments,h=a.read(i),u=V0.read(i),f=u._convert("rgb"),t=u._alpha,n=this.getContext(!0),g=n.createImageData(1,1),m=g.data;m[0]=f[0]*255,m[1]=f[1]*255,m[2]=f[2]*255,m[3]=t!=null?t*255:255,n.putImageData(g,h.x,h.y)},clear:function(){var i=this._size;this.getContext(!0).clearRect(0,0,i.width+1,i.height+1)},createImageData:function(){var i=K.read(arguments);return this.getContext().createImageData(i.width,i.height)},getImageData:function(){var i=u0.read(arguments);if(i.isEmpty())i=new u0(this._size);return this.getContext().getImageData(i.x,i.y,i.width,i.height)},putImageData:function(i){var h=a.read(arguments,1);this.getContext(!0).putImageData(i,h.x,h.y)},setImageData:function(i){this.setSize(i),this.getContext(!0).putImageData(i,0,0)},_getBounds:function(i,h){var u=new u0(this._size).setCenter(0,0);return i?i._transformBounds(u):u},_hitTestSelf:function(i){if(this._contains(i)){var h=this;return new w6("pixel",h,{offset:i.add(h._size.divide(2)).round(),color:{get:function(){return h.getPixel(this.offset)}}})}},_draw:function(i,h,u){var f=this.getElement();if(f&&f.width>0&&f.height>0){i.globalAlpha=i0.clamp(this._opacity,0,1),this._setStyles(i,h,u);var t=this._smoothing,n=t==="off";L0.setPrefixed(i,n?"imageSmoothingEnabled":"imageSmoothingQuality",n?!1:t),i.drawImage(f,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),K6=m0.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function i(h,u){if(!this._initialize(h,u!==G&&a.read(arguments,1)))this.setDefinition(h instanceof s6?h:new s6(h))},_equals:function(i){return this._definition===i._definition},copyContent:function(i){this.setDefinition(i._definition)},getDefinition:function(){return this._definition},setDefinition:function(i){this._definition=i,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(i,h){var u=this._definition._item;return u._getCachedBounds(u._matrix.prepended(i),h)},_hitTestSelf:function(i,h,u){var f=h.extend({all:!1}),t=this._definition._item._hitTest(i,f,u);if(t)t.item=this;return t},_draw:function(i,h){this._definition._item.draw(i,h)}}),s6=_.extend({_class:"SymbolDefinition",initialize:function i(h,u){if(this._id=I0.get(),this.project=j0.project,h)this.setItem(h,u)},_serialize:function(i,h){return h.add(this,function(){return _.serialize([this._class,this._item],i,!1,h)})},_changed:function(i){if(i&8)m0._clearBoundsCache(this);if(i&1)this.project._changed(i)},getItem:function(){return this._item},setItem:function(i,h){if(i._symbol)i=i.clone();if(this._item)this._item._symbol=null;if(this._item=i,i.remove(),i.setSelected(!1),!h)i.setPosition(new a);i._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(i){return new K6(this,i)},clone:function(){return new s6(this._item.clone(!1))},equals:function(i){return i===this||i&&this._item.equals(i._item)||!1}}),w6=_.extend({_class:"HitResult",initialize:function i(h,u,f){if(this.type=h,this.item=u,f)this.inject(f)},statics:{getOptions:function(i){var h=i&&_.read(i);return new _({type:null,tolerance:j0.settings.hitTolerance,fill:!h,stroke:!h,segments:!h,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},h)}}}),v0=_.extend({_class:"Segment",beans:!0,_selection:0,initialize:function i(h,u,f,t,n,g){var m=arguments.length,w,x,d,l;if(m>0)if(h==null||typeof h==="object")if(m===1&&h&&"point"in h)w=h.point,x=h.handleIn,d=h.handleOut,l=h.selection;else w=h,x=u,d=f,l=t;else w=[h,u],x=f!==G?[f,t]:null,d=n!==G?[n,g]:null;if(new U6(w,this,"_point"),new U6(x,this,"_handleIn"),new U6(d,this,"_handleOut"),l)this.setSelection(l)},_serialize:function(i,h){var u=this._point,f=this._selection,t=f||this.hasHandles()?[u,this._handleIn,this._handleOut]:u;if(f)t.push(f);return _.serialize(t,i,!0,h)},_changed:function(i){var h=this._path;if(!h)return;var u=h._curves,f=this._index,t;if(u){if((!i||i===this._point||i===this._handleIn)&&(t=f>0?u[f-1]:h._closed?u[u.length-1]:null))t._changed();if((!i||i===this._point||i===this._handleOut)&&(t=u[f]))t._changed()}h._changed(41)},getPoint:function(){return this._point},setPoint:function(){this._point.set(a.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(a.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(a.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var i=this._handleIn,h=this._handleOut;return!i.isZero()&&!h.isZero()&&i.isCollinear(h)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(i){var h=this._selection,u=this._path;if(this._selection=i=i||0,u&&i!==h)u._updateSelection(this,h,i),u._changed(257)},_changeSelection:function(i,h){var u=this._selection;this.setSelection(h?u|i:u&~i)},isSelected:function(){return!!(this._selection&7)},setSelected:function(i){this._changeSelection(7,i)},getIndex:function(){return this._index!==G?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var i=this._path,h=this._index;if(i){if(h>0&&!i._closed&&h===i._segments.length-1)h--;return i.getCurves()[h]||null}return null},getLocation:function(){var i=this.getCurve();return i?new u6(i,this===i._segment1?0:1):null},getNext:function(){var i=this._path&&this._path._segments;return i&&(i[this._index+1]||this._path._closed&&i[0])||null},smooth:function(i,h,u){var f=i||{},t=f.type,n=f.factor,g=this.getPrevious(),m=this.getNext(),w=(g||this)._point,x=this._point,d=(m||this)._point,l=w.getDistance(x),P=x.getDistance(d);if(!t||t==="catmull-rom"){var y=n===G?0.5:n,b=Math.pow(l,y),z=b*b,B=Math.pow(P,y),N=B*B;if(!h&&g){var S=2*N+3*B*b+z,s=3*B*(B+b);this.setHandleIn(s!==0?new a((N*w._x+S*x._x-z*d._x)/s-x._x,(N*w._y+S*x._y-z*d._y)/s-x._y):new a)}if(!u&&m){var S=2*z+3*b*B+N,s=3*b*(b+B);this.setHandleOut(s!==0?new a((z*d._x+S*x._x-N*w._x)/s-x._x,(z*d._y+S*x._y-N*w._y)/s-x._y):new a)}}else if(t==="geometric"){if(g&&m){var C=w.subtract(d),I=n===G?0.4:n,o=I*l/(l+P);if(!h)this.setHandleIn(C.multiply(o));if(!u)this.setHandleOut(C.multiply(o-I))}}else throw new Error("Smoothing method \'"+t+"\' not supported.")},getPrevious:function(){var i=this._path&&this._path._segments;return i&&(i[this._index-1]||this._path._closed&&i[i.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var i=this._path;return i&&this._index===i._segments.length-1||!1},reverse:function(){var i=this._handleIn,h=this._handleOut,u=i.clone();i.set(h),h.set(u)},reversed:function(){return new v0(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new v0(this._point,this._handleIn,this._handleOut)},equals:function(i){return i===this||i&&this._class===i._class&&this._point.equals(i._point)&&this._handleIn.equals(i._handleIn)&&this._handleOut.equals(i._handleOut)||!1},toString:function(){var i=["point: "+this._point];if(!this._handleIn.isZero())i.push("handleIn: "+this._handleIn);if(!this._handleOut.isZero())i.push("handleOut: "+this._handleOut);return"{ "+i.join(", ")+" }"},transform:function(i){this._transformCoordinates(i,new Array(6),!0),this._changed()},interpolate:function(i,h,u){var f=1-u,t=u,n=i._point,g=h._point,m=i._handleIn,w=h._handleIn,x=h._handleOut,d=i._handleOut;this._point._set(f*n._x+t*g._x,f*n._y+t*g._y,!0),this._handleIn._set(f*m._x+t*w._x,f*m._y+t*w._y,!0),this._handleOut._set(f*d._x+t*x._x,f*d._y+t*x._y,!0),this._changed()},_transformCoordinates:function(i,h,u){var f=this._point,t=!u||!this._handleIn.isZero()?this._handleIn:null,n=!u||!this._handleOut.isZero()?this._handleOut:null,g=f._x,m=f._y,w=2;if(h[0]=g,h[1]=m,t)h[w++]=t._x+g,h[w++]=t._y+m;if(n)h[w++]=n._x+g,h[w++]=n._y+m;if(i)if(i._transformCoordinates(h,h,w/2),g=h[0],m=h[1],u){if(f._x=g,f._y=m,w=2,t)t._x=h[w++]-g,t._y=h[w++]-m;if(n)n._x=h[w++]-g,n._y=h[w++]-m}else{if(!t)h[w++]=g,h[w++]=m;if(!n)h[w++]=g,h[w++]=m}return h}}),U6=a.extend({initialize:function i(h,u,f){var t,n,g;if(!h)t=n=0;else if((t=h[0])!==G)n=h[1];else{var m=h;if((t=m.x)===G)m=a.read(arguments),t=m.x;n=m.y,g=m.selected}if(this._x=t,this._y=n,this._owner=u,u[f]=this,g)this.setSelected(!0)},_set:function(i,h){return this._x=i,this._y=h,this._owner._changed(this),this},getX:function(){return this._x},setX:function(i){this._x=i,this._owner._changed(this)},getY:function(){return this._y},setY:function(i){this._y=i,this._owner._changed(this)},isZero:function(){var i=i0.isZero;return i(this._x)&&i(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(i){this._owner._changeSelection(this._getSelection(),i)},_getSelection:function(){var i=this._owner;return this===i._point?1:this===i._handleIn?2:this===i._handleOut?4:0}}),Z=_.extend({_class:"Curve",beans:!0,initialize:function i(h,u,f,t,n,g,m,w){var x=arguments.length,d,l,P,y,b,z;if(x===3)this._path=h,d=u,l=f;else if(!x)d=new v0,l=new v0;else if(x===1){if("segment1"in h)d=new v0(h.segment1),l=new v0(h.segment2);else if("point1"in h)P=h.point1,b=h.handle1,z=h.handle2,y=h.point2;else if(Array.isArray(h))P=[h[0],h[1]],y=[h[6],h[7]],b=[h[2]-h[0],h[3]-h[1]],z=[h[4]-h[6],h[5]-h[7]]}else if(x===2)d=new v0(h),l=new v0(u);else if(x===4)P=h,b=u,z=f,y=t;else if(x===8)P=[h,u],y=[m,w],b=[f-h,t-u],z=[n-m,g-w];this._segment1=d||new v0(P,null,b),this._segment2=l||new v0(y,z,null)},_serialize:function(i,h){return _.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],i,!0,h)},_changed:function(){this._length=this._bounds=G},clone:function(){return new Z(this._segment1,this._segment2)},toString:function(){var i=["point1: "+this._segment1._point];if(!this._segment1._handleOut.isZero())i.push("handle1: "+this._segment1._handleOut);if(!this._segment2._handleIn.isZero())i.push("handle2: "+this._segment2._handleIn);return i.push("point2: "+this._segment2._point),"{ "+i.join(", ")+" }"},classify:function(){return Z.classify(this.getValues())},remove:function(){var i=!1;if(this._path){var h=this._segment2,u=h._handleOut;if(i=h.remove(),i)this._segment1._handleOut.set(u)}return i},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(a.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(a.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(a.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(a.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var i=this._path&&this._path._curves;return i&&(i[this._segment1._index+1]||this._path._closed&&i[0])||null},getPrevious:function(){var i=this._path&&this._path._curves;return i&&(i[this._segment1._index-1]||this._path._closed&&i[i.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var i=this._path;return i&&this._segment1._index===i._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(i){this.getPoint1().setSelected(i),this.getHandle1().setSelected(i),this.getHandle2().setSelected(i),this.getPoint2().setSelected(i)},getValues:function(i){return Z.getValues(this._segment1,this._segment2,i)},getPoints:function(){var i=this.getValues(),h=[];for(var u=0;u<8;u+=2)h.push(new a(i[u],i[u+1]));return h}},{getLength:function(){if(this._length==null)this._length=Z.getLength(this.getValues(),0,1);return this._length},getArea:function(){return Z.getArea(this.getValues())},getLine:function(){return new _0(this._segment1._point,this._segment2._point)},getPart:function(i,h){return new Z(Z.getPart(this.getValues(),i,h))},getPartLength:function(i,h){return Z.getLength(this.getValues(),i,h)},divideAt:function(i){return this.divideAtTime(i&&i.curve===this?i.time:this.getTimeAt(i))},divideAtTime:function(i,h){var u=0.00000001,f=1-u,t=null;if(i>=u&&i<=f){var n=Z.subdivide(this.getValues(),i),g=n[0],m=n[1],w=h||this.hasHandles(),x=this._segment1,d=this._segment2,l=this._path;if(w)x._handleOut._set(g[2]-g[0],g[3]-g[1]),d._handleIn._set(m[4]-m[6],m[5]-m[7]);var P=g[6],y=g[7],b=new v0(new a(P,y),w&&new a(g[4]-P,g[5]-y),w&&new a(m[2]-P,m[3]-y));if(l)l.insert(x._index+1,b),t=this.getNext();else this._segment2=b,this._changed(),t=new Z(b,d)}return t},splitAt:function(i){var h=this._path;return h?h.splitAt(i):null},splitAtTime:function(i){return this.splitAt(this.getLocationAtTime(i))},divide:function(i,h){return this.divideAtTime(i===G?0.5:h?i:this.getTimeAt(i))},split:function(i,h){return this.splitAtTime(i===G?0.5:h?i:this.getTimeAt(i))},reversed:function(){return new Z(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(i,h,u,f){var{_point:t,_handleOut:n}=i,g=h._handleIn,m=h._point,w=t.x,x=t.y,d=m.x,l=m.y,P=f?[w,x,w,x,d,l,d,l]:[w,x,w+n._x,x+n._y,d+g._x,l+g._y,d,l];if(u)u._transformCoordinates(P,P,4);return P},subdivide:function(i,h){var u=i[0],f=i[1],t=i[2],n=i[3],g=i[4],m=i[5],w=i[6],x=i[7];if(h===G)h=0.5;var d=1-h,l=d*u+h*t,P=d*f+h*n,y=d*t+h*g,b=d*n+h*m,z=d*g+h*w,B=d*m+h*x,N=d*l+h*y,S=d*P+h*b,s=d*y+h*z,C=d*b+h*B,I=d*N+h*s,o=d*S+h*C;return[[u,f,l,P,N,S,I,o],[I,o,s,C,z,B,w,x]]},getMonoCurves:function(i,h){var u=[],f=h?0:1,t=i[f+0],n=i[f+2],g=i[f+4],m=i[f+6];if(t>=n===n>=g&&n>=g===g>=m||Z.isStraight(i))u.push(i);else{var w=3*(n-g)-t+m,x=2*(t+g)-4*n,d=n-t,l=0.00000001,P=1-l,y=[],b=i0.solveQuadratic(w,x,d,y,l,P);if(!b)u.push(i);else{y.sort();var z=y[0],B=Z.subdivide(i,z);if(u.push(B[0]),b>1)z=(y[1]-z)/(1-z),B=Z.subdivide(B[1],z),u.push(B[0]);u.push(B[1])}}return u},solveCubic:function(i,h,u,f,t,n){var g=i[h],m=i[h+2],w=i[h+4],x=i[h+6],d=0;if(!(g<u&&x<u&&m<u&&w<u||g>u&&x>u&&m>u&&w>u)){var l=3*(m-g),P=3*(w-m)-l,y=x-g-l-P;d=i0.solveCubic(y,P,l,g-u,f,t,n)}return d},getTimeOf:function(i,h){var u=new a(i[0],i[1]),f=new a(i[6],i[7]),t=0.000000000001,n=0.0000001,g=h.isClose(u,t)?0:h.isClose(f,t)?1:null;if(g===null){var m=[h.x,h.y],w=[];for(var x=0;x<2;x++){var d=Z.solveCubic(i,x,m[x],w,0,1);for(var l=0;l<d;l++){var P=w[l];if(h.isClose(Z.getPoint(i,P),n))return P}}}return h.isClose(u,n)?0:h.isClose(f,n)?1:null},getNearestTime:function(i,h){if(Z.isStraight(i)){var u=i[0],f=i[1],t=i[6],n=i[7],g=t-u,m=n-f,w=g*g+m*m;if(w===0)return 0;var x=((h.x-u)*g+(h.y-f)*m)/w;return x<0.000000000001?0:x>0.999999999999?1:Z.getTimeOf(i,new a(u+x*g,f+x*m))}var d=100,l=Infinity,P=0;function y(B){if(B>=0&&B<=1){var N=h.getDistance(Z.getPoint(i,B),!0);if(N<l)return l=N,P=B,!0}}for(var b=0;b<=d;b++)y(b/d);var z=1/(d*2);while(z>0.00000001)if(!y(P-z)&&!y(P+z))z/=2;return P},getPart:function(i,h,u){var f=h>u;if(f){var t=h;h=u,u=t}if(h>0)i=Z.subdivide(i,h)[1];if(u<1)i=Z.subdivide(i,(u-h)/(1-h))[0];return f?[i[6],i[7],i[4],i[5],i[2],i[3],i[0],i[1]]:i},isFlatEnough:function(i,h){var u=i[0],f=i[1],t=i[2],n=i[3],g=i[4],m=i[5],w=i[6],x=i[7],d=3*t-2*u-w,l=3*n-2*f-x,P=3*g-2*w-u,y=3*m-2*x-f;return Math.max(d*d,P*P)+Math.max(l*l,y*y)<=16*h*h},getArea:function(i){var h=i[0],u=i[1],f=i[2],t=i[3],n=i[4],g=i[5],m=i[6],w=i[7];return 3*((w-u)*(f+n)-(m-h)*(t+g)+t*(h-n)-f*(u-g)+w*(n+h/3)-m*(g+u/3))/20},getBounds:function(i){var h=i.slice(0,2),u=h.slice(),f=[0,0];for(var t=0;t<2;t++)Z._addBounds(i[t],i[t+2],i[t+4],i[t+6],t,0,h,u,f);return new u0(h[0],h[1],u[0]-h[0],u[1]-h[1])},_addBounds:function(i,h,u,f,t,n,g,m,w){function x(I,o){var k=I-o,L=I+o;if(k<g[t])g[t]=k;if(L>m[t])m[t]=L}n/=2;var d=g[t]+n,l=m[t]-n;if(i<d||h<d||u<d||f<d||i>l||h>l||u>l||f>l)if(h<i!=h<f&&u<i!=u<f)x(i,0),x(f,0);else{var P=3*(h-u)-i+f,y=2*(i+u)-4*h,b=h-i,z=i0.solveQuadratic(P,y,b,w),B=0.00000001,N=1-B;x(f,0);for(var S=0;S<z;S++){var s=w[S],C=1-s;if(B<=s&&s<=N)x(C*C*C*i+3*C*C*s*h+3*C*s*s*u+s*s*s*f,n)}}}}},_.each(["getBounds","getStrokeBounds","getHandleBounds"],function(i){this[i]=function(){if(!this._bounds)this._bounds={};var h=this._bounds[i];if(!h)h=this._bounds[i]=b0[i]([this._segment1,this._segment2],!1,this._path);return h.clone()}},{}),_.each({isStraight:function(i,h,u,f){if(h.isZero()&&u.isZero())return!0;else{var t=f.subtract(i);if(t.isZero())return!1;else if(t.isCollinear(h)&&t.isCollinear(u)){var n=new _0(i,f),g=0.0000001;if(n.getDistance(i.add(h))<g&&n.getDistance(f.add(u))<g){var m=t.dot(t),w=t.dot(h)/m,x=t.dot(u)/m;return w>=0&&w<=1&&x<=0&&x>=-1}}}return!1},isLinear:function(i,h,u,f){var t=f.subtract(i).divide(3);return h.equals(t)&&u.negate().equals(t)}},function(i,h){this[h]=function(u){var f=this._segment1,t=this._segment2;return i(f._point,f._handleOut,t._handleIn,t._point,u)},this.statics[h]=function(u,f){var t=u[0],n=u[1],g=u[6],m=u[7];return i(new a(t,n),new a(u[2]-t,u[3]-n),new a(u[4]-g,u[5]-m),new a(g,m),f)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(i){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(i||0)},isCollinear:function(i){return i&&this.isStraight()&&i.isStraight()&&this.getLine().isCollinear(i.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(0.5).y)<0.00000001},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(0.5).x)<0.00000001}}),{beans:!1,getLocationAt:function(i,h){return this.getLocationAtTime(h?i:this.getTimeAt(i))},getLocationAtTime:function(i){return i!=null&&i>=0&&i<=1?new u6(this,i):null},getTimeAt:function(i,h){return Z.getTimeAt(this.getValues(),i,h)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var i=a.read(arguments);return i.isZero()?[]:Z.getTimesWithTangent(this.getValues(),i)},getOffsetAtTime:function(i){return this.getPartLength(0,i)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(a.read(arguments)))},getOffsetOf:function(){var i=this.getLocationOf.apply(this,arguments);return i?i.getOffset():null},getTimeOf:function(){return Z.getTimeOf(this.getValues(),a.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var i=a.read(arguments),h=this.getValues(),u=Z.getNearestTime(h,i),f=Z.getPoint(h,u);return new u6(this,u,f,null,i.getDistance(f))},getNearestPoint:function(){var i=this.getNearestLocation.apply(this,arguments);return i?i.getPoint():i}},new function(){var i=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return _.each(i,function(h){this[h+"At"]=function(u,f){var t=this.getValues();return Z[h](t,f?u:Z.getTimeAt(t,u))},this[h+"AtTime"]=function(u){return Z[h](this.getValues(),u)}},{statics:{_evaluateMethods:i}})},new function(){function i(f){var t=f[0],n=f[1],g=f[2],m=f[3],w=f[4],x=f[5],d=f[6],l=f[7],P=9*(g-w)+3*(d-t),y=6*(t+w)-12*g,b=3*(g-t),z=9*(m-x)+3*(l-n),B=6*(n+x)-12*m,N=3*(m-n);return function(S){var s=(P*S+y)*S+b,C=(z*S+B)*S+N;return Math.sqrt(s*s+C*C)}}function h(f,t){return Math.max(2,Math.min(16,Math.ceil(Math.abs(t-f)*32)))}function u(f,t,n,g){if(t==null||t<0||t>1)return null;var m=f[0],w=f[1],x=f[2],d=f[3],l=f[4],P=f[5],y=f[6],b=f[7],z=i0.isZero;if(z(x-m)&&z(d-w))x=m,d=w;if(z(l-y)&&z(P-b))l=y,P=b;var B=3*(x-m),N=3*(l-x)-B,S=y-m-B-N,s=3*(d-w),C=3*(P-d)-s,I=b-w-s-C,o,k;if(n===0)o=t===0?m:t===1?y:((S*t+N)*t+B)*t+m,k=t===0?w:t===1?b:((I*t+C)*t+s)*t+w;else{var L=0.00000001,c=1-L;if(t<L)o=B,k=s;else if(t>c)o=3*(y-l),k=3*(b-P);else o=(3*S*t+2*N)*t+B,k=(3*I*t+2*C)*t+s;if(g){if(o===0&&k===0&&(t<L||t>c))o=l-x,k=P-d;var D=Math.sqrt(o*o+k*k);if(D)o/=D,k/=D}if(n===3){var l=6*S*t+2*N,P=6*I*t+2*C,A=Math.pow(o*o+k*k,1.5);o=A!==0?(o*P-k*l)/A:0,k=0}}return n===2?new a(k,-o):new a(o,k)}return{statics:{classify:function(f){var t=f[0],n=f[1],g=f[2],m=f[3],w=f[4],x=f[5],d=f[6],l=f[7],P=t*(l-x)+n*(w-d)+d*x-l*w,y=g*(n-l)+m*(d-t)+t*l-n*d,b=w*(m-n)+x*(t-g)+g*n-m*t,z=3*b,B=z-y,N=B-y+P,S=Math.sqrt(N*N+B*B+z*z),s=S!==0?1/S:0,C=i0.isZero,I="serpentine";N*=s,B*=s,z*=s;function o(D,A,e){var q=A!==G,E=q&&A>0&&A<1,R=q&&e>0&&e<1;if(q&&(!(E||R)||D==="loop"&&!(E&&R)))D="arch",E=R=!1;return{type:D,roots:E||R?E&&R?A<e?[A,e]:[e,A]:[E?A:e]:null}}if(C(N))return C(B)?o(C(z)?"line":"quadratic"):o(I,z/(3*B));var k=3*B*B-4*N*z;if(C(k))return o("cusp",B/(2*N));var L=k>0?Math.sqrt(k/3):Math.sqrt(-k),c=2*N;return o(k>0?I:"loop",(B+L)/c,(B-L)/c)},getLength:function(f,t,n,g){if(t===G)t=0;if(n===G)n=1;if(Z.isStraight(f)){var m=f;if(n<1)m=Z.subdivide(m,n)[0],t/=n;if(t>0)m=Z.subdivide(m,t)[1];var w=m[6]-m[0],x=m[7]-m[1];return Math.sqrt(w*w+x*x)}return i0.integrate(g||i(f),t,n,h(t,n))},getTimeAt:function(f,t,n){if(n===G)n=t<0?1:0;if(t===0)return n;var g=Math.abs,m=0.000000000001,w=t>0,x=w?n:0,d=w?1:n,l=i(f),P=Z.getLength(f,x,d,l),y=g(t)-P;if(g(y)<m)return w?d:x;else if(y>m)return null;var b=t/P,z=0;function B(N){return z+=i0.integrate(l,n,N,h(n,N)),n=N,z-t}return i0.findRoot(B,l,n+b,x,d,32,0.000000000001)},getPoint:function(f,t){return u(f,t,0,!1)},getTangent:function(f,t){return u(f,t,1,!0)},getWeightedTangent:function(f,t){return u(f,t,1,!1)},getNormal:function(f,t){return u(f,t,2,!0)},getWeightedNormal:function(f,t){return u(f,t,2,!1)},getCurvature:function(f,t){return u(f,t,3,!1).x},getPeaks:function(f){var t=f[0],n=f[1],g=f[2],m=f[3],w=f[4],x=f[5],d=f[6],l=f[7],P=-t+3*g-3*w+d,y=3*t-6*g+3*w,b=-3*t+3*g,z=-n+3*m-3*x+l,B=3*n-6*m+3*x,N=-3*n+3*m,S=0.00000001,s=1-S,C=[];return i0.solveCubic(9*(P*P+z*z),9*(P*y+B*z),2*(y*y+B*B)+3*(b*P+N*z),b*y+B*N,C,S,s),C.sort()}}}},new function(){function i(y,b,z,B,N,S,s){var C=!s&&z.getPrevious()===N,I=!s&&z!==N&&z.getNext()===N,o=0.00000001,k=1-o;if(B!==null&&B>=(C?o:0)&&B<=(I?k:1)){if(S!==null&&S>=(I?o:0)&&S<=(C?k:1)){var L=new u6(z,B,null,s),c=new u6(N,S,null,s);if(L._intersection=c,c._intersection=L,!b||b(L))u6.insert(y,L,!0)}}}function h(y,b,z,B,N,S,s,C,I,o,k,L,c){if(++I>=4096||++C>=40)return I;var D=0.000000001,A=b[0],e=b[1],q=b[6],E=b[7],R=_0.getSignedDistance,X=R(A,e,q,E,b[2],b[3]),O=R(A,e,q,E,b[4],b[5]),H=X*O>0?0.75:0.4444444444444444,Y=H*Math.min(0,X,O),W=H*Math.max(0,X,O),t0=R(A,e,q,E,y[0],y[1]),h0=R(A,e,q,E,y[2],y[3]),g0=R(A,e,q,E,y[4],y[5]),J=R(A,e,q,E,y[6],y[7]),p0=u(t0,h0,g0,J),f0=p0[0],N0=p0[1],s0,C0;if(X===0&&O===0&&t0===0&&h0===0&&g0===0&&J===0||(s0=f(f0,N0,Y,W))==null||(C0=f(f0.reverse(),N0.reverse(),Y,W))==null)return I;var r0=o+(k-o)*s0,P0=o+(k-o)*C0;if(Math.max(c-L,P0-r0)<D){var X0=(r0+P0)/2,O0=(L+c)/2;i(N,S,s?B:z,s?O0:X0,s?z:B,s?X0:O0)}else{y=Z.getPart(y,s0,C0);var Z0=c-L;if(C0-s0>0.8)if(P0-r0>Z0){var E0=Z.subdivide(y,0.5),X0=(r0+P0)/2;I=h(b,E0[0],B,z,N,S,!s,C,I,L,c,r0,X0),I=h(b,E0[1],B,z,N,S,!s,C,I,L,c,X0,P0)}else{var E0=Z.subdivide(b,0.5),O0=(L+c)/2;I=h(E0[0],y,B,z,N,S,!s,C,I,L,O0,r0,P0),I=h(E0[1],y,B,z,N,S,!s,C,I,O0,c,r0,P0)}else if(Z0===0||Z0>=D)I=h(b,y,B,z,N,S,!s,C,I,L,c,r0,P0);else I=h(y,b,z,B,N,S,s,C,I,r0,P0,L,c)}return I}function u(y,b,z,B){var N=[0,y],S=[0.3333333333333333,b],s=[0.6666666666666666,z],C=[1,B],I=b-(2*y+B)/3,o=z-(y+2*B)/3,k;if(I*o<0)k=[[N,S,C],[N,s,C]];else{var L=I/o;k=[L>=2?[N,S,C]:L<=0.5?[N,s,C]:[N,S,s,C],[N,C]]}return(I||o)<0?k.reverse():k}function f(y,b,z,B){if(y[0][1]<z)return t(y,!0,z);else if(b[0][1]>B)return t(b,!1,B);else return y[0][0]}function t(y,b,z){var B=y[0][0],N=y[0][1];for(var S=1,s=y.length;S<s;S++){var C=y[S][0],I=y[S][1];if(b?I>=z:I<=z)return I===z?C:B+(z-N)*(C-B)/(I-N);B=C,N=I}return null}function n(y,b,z,B,N){var S=i0.isZero;if(S(B)&&S(N)){var s=Z.getTimeOf(y,new a(b,z));return s===null?[]:[s]}var C=Math.atan2(-N,B),I=Math.sin(C),o=Math.cos(C),k=[],L=[];for(var c=0;c<8;c+=2){var D=y[c]-b,A=y[c+1]-z;k.push(D*o-A*I,D*I+A*o)}return Z.solveCubic(k,1,0,L,0,1),L}function g(y,b,z,B,N,S,s){var C=b[0],I=b[1],o=b[6],k=b[7],L=n(y,C,I,o-C,k-I);for(var c=0,D=L.length;c<D;c++){var A=L[c],e=Z.getPoint(y,A),q=Z.getTimeOf(b,e);if(q!==null)i(N,S,s?B:z,s?q:A,s?z:B,s?A:q)}}function m(y,b,z,B,N,S){var s=_0.intersect(y[0],y[1],y[6],y[7],b[0],b[1],b[6],b[7]);if(s)i(N,S,z,Z.getTimeOf(y,s),B,Z.getTimeOf(b,s))}function w(y,b,z,B,N,S){var s=0.000000000001,C=Math.min,I=Math.max;if(I(y[0],y[2],y[4],y[6])+s>C(b[0],b[2],b[4],b[6])&&C(y[0],y[2],y[4],y[6])-s<I(b[0],b[2],b[4],b[6])&&I(y[1],y[3],y[5],y[7])+s>C(b[1],b[3],b[5],b[7])&&C(y[1],y[3],y[5],y[7])-s<I(b[1],b[3],b[5],b[7])){var o=l(y,b);if(o)for(var k=0;k<2;k++){var L=o[k];i(N,S,z,L[0],B,L[1],!0)}else{var c=Z.isStraight(y),D=Z.isStraight(b),A=c&&D,e=c&&!D,q=N.length;if((A?m:c||D?g:h)(e?b:y,e?y:b,e?B:z,e?z:B,N,S,e,0,0,0,1,0,1),!A||N.length===q)for(var k=0;k<4;k++){var E=k>>1,R=k&1,X=E*6,O=R*6,H=new a(y[X],y[X+1]),Y=new a(b[O],b[O+1]);if(H.isClose(Y,s))i(N,S,z,E,B,R)}}}return N}function x(y,b,z,B){var N=Z.classify(y);if(N.type==="loop"){var S=N.roots;i(z,B,b,S[0],b,S[1])}return z}function d(y,b,z,B,N,S){var s=0.0000001,C=!b;if(C)b=y;var I=y.length,o=b.length,k=new Array(I),L=C?k:new Array(o),c=[];for(var D=0;D<I;D++)k[D]=y[D].getValues(B);if(!C)for(var D=0;D<o;D++)L[D]=b[D].getValues(N);var A=n0.findCurveBoundsCollisions(k,L,s);for(var e=0;e<I;e++){var q=y[e],E=k[e];if(C)x(E,q,c,z);var R=A[e];if(R)for(var X=0;X<R.length;X++){if(S&&c.length)return c;var O=R[X];if(!C||O>e){var H=b[O],Y=L[O];w(E,Y,q,H,c,z)}}}return c}function l(y,b){function z(J){var p0=J[6]-J[0],f0=J[7]-J[1];return p0*p0+f0*f0}var B=Math.abs,N=_0.getDistance,S=0.00000001,s=0.0000001,C=Z.isStraight(y),I=Z.isStraight(b),o=C&&I,k=z(y)<z(b),L=k?b:y,c=k?y:b,D=L[0],A=L[1],e=L[6]-D,q=L[7]-A;if(N(D,A,e,q,c[0],c[1],!0)<s&&N(D,A,e,q,c[6],c[7],!0)<s){if(!o&&N(D,A,e,q,L[2],L[3],!0)<s&&N(D,A,e,q,L[4],L[5],!0)<s&&N(D,A,e,q,c[2],c[3],!0)<s&&N(D,A,e,q,c[4],c[5],!0)<s)C=I=o=!0}else if(o)return null;if(C^I)return null;var E=[y,b],R=[];for(var X=0;X<4&&R.length<2;X++){var O=X&1,H=O^1,Y=X>>1,W=Z.getTimeOf(E[O],new a(E[H][Y?6:0],E[H][Y?7:1]));if(W!=null){var t0=O?[Y,W]:[W,Y];if(!R.length||B(t0[0]-R[0][0])>S&&B(t0[1]-R[0][1])>S)R.push(t0)}if(X>2&&!R.length)break}if(R.length!==2)R=null;else if(!o){var h0=Z.getPart(y,R[0][0],R[1][0]),g0=Z.getPart(b,R[0][1],R[1][1]);if(B(g0[2]-h0[2])>s||B(g0[3]-h0[3])>s||B(g0[4]-h0[4])>s||B(g0[5]-h0[5])>s)R=null}return R}function P(y,b){var z=y[0],B=y[1],N=y[2],S=y[3],s=y[4],C=y[5],I=y[6],o=y[7],k=b.normalize(),L=k.x,c=k.y,D=3*I-9*s+9*N-3*z,A=3*o-9*C+9*S-3*B,e=6*s-12*N+6*z,q=6*C-12*S+6*B,E=3*N-3*z,R=3*S-3*B,X=2*D*c-2*A*L,O=[];if(Math.abs(X)<i0.CURVETIME_EPSILON){var H=D*R-A*E,X=D*q-A*e;if(X!=0){var Y=-H/X;if(Y>=0&&Y<=1)O.push(Y)}}else{var W=(e*e-4*D*E)*c*c+(-2*e*q+4*A*E+4*D*R)*L*c+(q*q-4*A*R)*L*L,t0=e*c-q*L;if(W>=0&&X!=0){var h0=Math.sqrt(W),g0=-(t0+h0)/X,J=(-t0+h0)/X;if(g0>=0&&g0<=1)O.push(g0);if(J>=0&&J<=1)O.push(J)}}return O}return{getIntersections:function(y){var b=this.getValues(),z=y&&y!==this&&y.getValues();return z?w(b,z,this,y,[]):x(b,this,[])},statics:{getOverlaps:l,getIntersections:d,getCurveLineIntersections:n,getTimesWithTangent:P}}}),u6=_.extend({_class:"CurveLocation",initialize:function i(h,u,f,t,n){if(u>=0.99999999){var g=h.getNext();if(g)u=0,h=g}this._setCurve(h),this._time=u,this._point=f||h.getPointAtTime(u),this._overlap=t,this._distance=n,this._intersection=this._next=this._previous=null},_setPath:function(i){this._path=i,this._version=i?i._version:0},_setCurve:function(i){this._setPath(i._path),this._curve=i,this._segment=null,this._segment1=i._segment1,this._segment2=i._segment2},_setSegment:function(i){var h=i.getCurve();if(h)this._setCurve(h);else this._setPath(i._path),this._segment1=i,this._segment2=null;this._segment=i,this._time=i===this._segment1?0:1,this._point=i._point.clone()},getSegment:function(){var i=this._segment;if(!i){var h=this.getCurve(),u=this.getTime();if(u===0)i=h._segment1;else if(u===1)i=h._segment2;else if(u!=null)i=h.getPartLength(0,u)<h.getPartLength(u,1)?h._segment1:h._segment2;this._segment=i}return i},getCurve:function(){var i=this._path,h=this;if(i&&i._version!==this._version)this._time=this._offset=this._curveOffset=this._curve=null;function u(f){var t=f&&f.getCurve();if(t&&(h._time=t.getTimeOf(h._point))!=null)return h._setCurve(t),t}return this._curve||u(this._segment)||u(this._segment1)||u(this._segment2.getPrevious())},getPath:function(){var i=this.getCurve();return i&&i._path},getIndex:function(){var i=this.getCurve();return i&&i.getIndex()},getTime:function(){var i=this.getCurve(),h=this._time;return i&&h==null?this._time=i.getTimeOf(this._point):h},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var i=this._offset;if(i==null){i=0;var h=this.getPath(),u=this.getIndex();if(h&&u!=null){var f=h.getCurves();for(var t=0;t<u;t++)i+=f[t].getLength()}this._offset=i+=this.getCurveOffset()}return i},getCurveOffset:function(){var i=this._curveOffset;if(i==null){var h=this.getCurve(),u=this.getTime();this._curveOffset=i=u!=null&&h&&h.getPartLength(0,u)}return i},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var i=this.getCurve(),h=i&&i.divideAtTime(this.getTime());if(h)this._setSegment(h._segment1);return h},split:function(){var i=this.getCurve(),h=i._path,u=i&&i.splitAtTime(this.getTime());if(u)this._setSegment(h.getLastSegment());return u},equals:function(i,h){var u=this===i;if(!u&&i instanceof u6){var f=this.getCurve(),t=i.getCurve(),n=f._path,g=t._path;if(n===g){var m=Math.abs,w=0.0000001,x=m(this.getOffset()-i.getOffset()),d=!h&&this._intersection,l=!h&&i._intersection;u=(x<w||n&&m(n.getLength()-x)<w)&&(!d&&!l||d&&l&&d.equals(l,!0))}}return u},toString:function(){var i=[],h=this.getPoint(),u=d0.instance;if(h)i.push("point: "+h);var f=this.getIndex();if(f!=null)i.push("index: "+f);var t=this.getTime();if(t!=null)i.push("time: "+u.number(t));if(this._distance!=null)i.push("distance: "+u.number(this._distance));return"{ "+i.join(", ")+" }"},isTouching:function(){var i=this._intersection;if(i&&this.getTangent().isCollinear(i.getTangent())){var h=this.getCurve(),u=i.getCurve();return!(h.isStraight()&&u.isStraight()&&h.getLine().intersect(u.getLine()))}return!1},isCrossing:function(){var i=this._intersection;if(!i)return!1;var h=this.getTime(),u=i.getTime(),f=0.00000001,t=1-f,n=h>=f&&h<=t,g=u>=f&&u<=t;if(n&&g)return!this.isTouching();var m=this.getCurve(),w=m&&h<f?m.getPrevious():m,x=i.getCurve(),d=x&&u<f?x.getPrevious():x;if(h>t)m=m.getNext();if(u>t)x=x.getNext();if(!w||!m||!d||!x)return!1;var l=[];function P(L,c){var D=L.getValues(),A=Z.classify(D).roots||Z.getPeaks(D),e=A.length,q=Z.getLength(D,c&&e?A[e-1]:0,!c&&e?A[0]:1);l.push(e?q:q/32)}function y(L,c,D){return c<D?L>c&&L<D:L>c||L<D}if(!n)P(w,!0),P(m,!1);if(!g)P(d,!0),P(x,!1);var b=this.getPoint(),z=Math.min.apply(Math,l),B=n?m.getTangentAtTime(h):m.getPointAt(z).subtract(b),N=n?B.negate():w.getPointAt(-z).subtract(b),S=g?x.getTangentAtTime(u):x.getPointAt(z).subtract(b),s=g?S.negate():d.getPointAt(-z).subtract(b),C=N.getAngle(),I=B.getAngle(),o=s.getAngle(),k=S.getAngle();return!!(n?y(C,o,k)^y(I,o,k)&&y(C,k,o)^y(I,k,o):y(o,C,I)^y(k,C,I)&&y(o,I,C)^y(k,I,C))},hasOverlap:function(){return!!this._overlap}},_.each(Z._evaluateMethods,function(i){var h=i+"At";this[i]=function(){var u=this.getCurve(),f=this.getTime();return f!=null&&u&&u[h](f,!0)}},{preserve:!0}),new function(){function i(h,u,f){var t=h.length,n=0,g=t-1;function m(b,z){for(var B=b+z;B>=-1&&B<=t;B+=z){var N=h[(B%t+t)%t];if(!u.getPoint().isClose(N.getPoint(),0.0000001))break;if(u.equals(N))return N}return null}while(n<=g){var w=n+g>>>1,x=h[w],d;if(f&&(d=u.equals(x)?x:m(w,-1)||m(w,1))){if(u._overlap)d._overlap=d._intersection._overlap=!0;return d}var l=u.getPath(),P=x.getPath(),y=l!==P?l._id-P._id:u.getIndex()+u.getTime()-(x.getIndex()+x.getTime());if(y<0)g=w-1;else n=w+1}return h.splice(n,0,u),u}return{statics:{insert:i,expand:function(h){var u=h.slice();for(var f=h.length-1;f>=0;f--)i(u,h[f]._intersection,!1);return u}}}}),I6=m0.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function i(){},statics:{create:function(i){var h,u,f;if(_.isPlainObject(i))u=i.segments,h=i.pathData;else if(Array.isArray(i))u=i;else if(typeof i==="string")h=i;if(u){var t=u[0];f=t&&Array.isArray(t[0])}else if(h)f=(h.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(h);var n=f?f6:b0;return new n(i)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(i){if(this.isClockwise()!=(i=!!i))this.reverse()},setPathData:function(i){var h=i&&i.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),u,f=!1,t,n,g=new a,m=new a;function w(s,C){var I=+u[s];if(f)I+=g[C];return I}function x(s){return new a(w(s,"x"),w(s+1,"y"))}this.clear();for(var d=0,l=h&&h.length;d<l;d++){var P=h[d],y=P[0],b=y.toLowerCase();u=P.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var z=u&&u.length;if(f=y===b,t==="z"&&!/[mz]/.test(b))this.moveTo(g);switch(b){case"m":case"l":var B=b==="m";for(var N=0;N<z;N+=2)if(this[B?"moveTo":"lineTo"](g=x(N)),B)m=g,B=!1;n=g;break;case"h":case"v":var S=b==="h"?"x":"y";g=g.clone();for(var N=0;N<z;N++)g[S]=w(N,S),this.lineTo(g);n=g;break;case"c":for(var N=0;N<z;N+=6)this.cubicCurveTo(x(N),n=x(N+2),g=x(N+4));break;case"s":for(var N=0;N<z;N+=4)this.cubicCurveTo(/[cs]/.test(t)?g.multiply(2).subtract(n):g,n=x(N),g=x(N+2)),t=b;break;case"q":for(var N=0;N<z;N+=4)this.quadraticCurveTo(n=x(N),g=x(N+2));break;case"t":for(var N=0;N<z;N+=2)this.quadraticCurveTo(n=/[qt]/.test(t)?g.multiply(2).subtract(n):g,g=x(N)),t=b;break;case"a":for(var N=0;N<z;N+=7)this.arcTo(g=x(N+5),new K(+u[N],+u[N+1]),+u[N+2],+u[N+4],+u[N+3]);break;case"z":this.closePath(0.000000000001),g=m;break}t=b}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(i){var h=i.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(i):{};return h.onPath||!!(this.getFillRule()==="evenodd"?h.windingL&1||h.windingR&1:h.winding)},getIntersections:function(i,h,u,f){var t=this===i||!i,n=this._matrix._orNullIfIdentity(),g=t?n:(u||i._matrix)._orNullIfIdentity();return t||this.getBounds(n).intersects(i.getBounds(g),0.000000000001)?Z.getIntersections(this.getCurves(),!t&&i.getCurves(),h,n,g,f):[]},getCrossings:function(i){return this.getIntersections(i,function(h){return h.isCrossing()})},getNearestLocation:function(){var i=a.read(arguments),h=this.getCurves(),u=Infinity,f=null;for(var t=0,n=h.length;t<n;t++){var g=h[t].getNearestLocation(i);if(g._distance<u)u=g._distance,f=g}return f},getNearestPoint:function(){var i=this.getNearestLocation.apply(this,arguments);return i?i.getPoint():i},interpolate:function(i,h,u){var f=!this._children,t=f?"_segments":"_children",n=i[t],g=h[t],m=this[t];if(!n||!g||n.length!==g.length)throw new Error("Invalid operands in interpolate() call: "+i+", "+h);var w=m.length,x=g.length;if(w<x){var d=f?v0:b0;for(var l=w;l<x;l++)this.add(new d)}else if(w>x)this[f?"removeSegments":"removeChildren"](x,w);for(var l=0;l<x;l++)m[l].interpolate(n[l],g[l],u);if(f)this.setClosed(i._closed),this._changed(9)},compare:function(i){var h=!1;if(i){var u=this._children||[this],f=i._children?i._children.slice():[i],t=u.length,n=f.length,g=[],m=0;h=!0;var w=n0.findItemBoundsCollisions(u,f,i0.GEOMETRIC_EPSILON);for(var x=t-1;x>=0&&h;x--){var d=u[x];h=!1;var l=w[x];if(l){for(var P=l.length-1;P>=0&&!h;P--)if(d.compare(f[l[P]])){if(!g[l[P]])g[l[P]]=!0,m++;h=!0}}}h=h&&m===n}return h}}),b0=I6.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function i(h){this._closed=!1,this._segments=[],this._version=0;var u=arguments,f=Array.isArray(h)?typeof h[0]==="object"?h:u:h&&(h.size===G&&(h.x!==G||h.point!==G))?u:null;if(f&&f.length>0)this.setSegments(f);else if(this._curves=G,this._segmentSelection=0,!f&&typeof h==="string")this.setPathData(h),h=null;this._initialize(!f&&h)},_equals:function(i){return this._closed===i._closed&&_.equals(this._segments,i._segments)},copyContent:function(i){this.setSegments(i._segments),this._closed=i._closed},_changed:function i(h){if(i.base.call(this,h),h&8){if(this._length=this._area=G,h&32)this._version++;else if(this._curves)for(var u=0,f=this._curves.length;u<f;u++)this._curves[u]._changed()}else if(h&64)this._bounds=G},getStyle:function(){var i=this._parent;return(i instanceof f6?i:this)._style},getSegments:function(){return this._segments},setSegments:function(i){var h=this.isFullySelected(),u=i&&i.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=G,u){var f=i[u-1];if(typeof f==="boolean")this.setClosed(f),u--;this._add(v0.readList(i,0,{},u))}if(h)this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var i=this._curves,h=this._segments;if(!i){var u=this._countCurves();i=this._curves=new Array(u);for(var f=0;f<u;f++)i[f]=new Z(this,h[f],h[f+1]||h[0])}return i},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var i=this.getCurves();return i[i.length-1]},isClosed:function(){return this._closed},setClosed:function(i){if(this._closed!=(i=!!i)){if(this._closed=i,this._curves){var h=this._curves.length=this._countCurves();if(i)this._curves[h-1]=new Z(this,this._segments[h-1],this._segments[0])}this._changed(41)}}},{beans:!0,getPathData:function(i,h){var u=this._segments,f=u.length,t=new d0(h),n=new Array(6),g=!0,m,w,x,d,l,P,y,b,z=[];function B(S,s){if(S._transformCoordinates(i,n),m=n[0],w=n[1],g)z.push("M"+t.pair(m,w)),g=!1;else if(l=n[2],P=n[3],l===m&&P===w&&y===x&&b===d){if(!s){var C=m-x,I=w-d;z.push(C===0?"v"+t.number(I):I===0?"h"+t.number(C):"l"+t.pair(C,I))}}else z.push("c"+t.pair(y-x,b-d)+" "+t.pair(l-x,P-d)+" "+t.pair(m-x,w-d));x=m,d=w,y=n[4],b=n[5]}if(!f)return"";for(var N=0;N<f;N++)B(u[N]);if(this._closed&&f>0)B(u[0],!0),z.push("z");return z.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(i){var h=this._segments,u=new Array(6);for(var f=0,t=h.length;f<t;f++)h[f]._transformCoordinates(i,u,!0);return!0},_add:function(i,g){var u=this._segments,f=this._curves,t=i.length,n=g==null,g=n?u.length:g;for(var m=0;m<t;m++){var w=i[m];if(w._path)w=i[m]=w.clone();if(w._path=this,w._index=g+m,w._selection)this._updateSelection(w,0,w._selection)}if(n)_.push(u,i);else{u.splice.apply(u,[g,0].concat(i));for(var m=g+t,x=u.length;m<x;m++)u[m]._index=m}if(f){var d=this._countCurves(),l=g>0&&g+t-1===d?g-1:g,P=l,y=Math.min(l+t,d);if(i._curves)f.splice.apply(f,[l,0].concat(i._curves)),P+=i._curves.length;for(var m=P;m<y;m++)f.splice(m,0,new Z(this,null,null));this._adjustCurves(l,y)}return this._changed(41),i},_adjustCurves:function(i,h){var u=this._segments,f=this._curves,t;for(var n=i;n<h;n++)t=f[n],t._path=this,t._segment1=u[n],t._segment2=u[n+1]||u[0],t._changed();if(t=f[this._closed&&!i?u.length-1:i-1])t._segment2=u[i]||u[0],t._changed();if(t=f[h])t._segment1=u[h],t._changed()},_countCurves:function(){var i=this._segments.length;return!this._closed&&i>0?i-1:i},add:function(i){var h=arguments;return h.length>1&&typeof i!=="number"?this._add(v0.readList(h)):this._add([v0.read(h)])[0]},insert:function(i,h){var u=arguments;return u.length>2&&typeof h!=="number"?this._add(v0.readList(u,1),i):this._add([v0.read(u,1)],i)[0]},addSegment:function(){return this._add([v0.read(arguments)])[0]},insertSegment:function(i){return this._add([v0.read(arguments,1)],i)[0]},addSegments:function(i){return this._add(v0.readList(i))},insertSegments:function(i,h){return this._add(v0.readList(h),i)},removeSegment:function(i){return this.removeSegments(i,i+1)[0]||null},removeSegments:function(i,h,u){i=i||0,h=_.pick(h,this._segments.length);var f=this._segments,t=this._curves,n=f.length,g=f.splice(i,h-i),m=g.length;if(!m)return g;for(var w=0;w<m;w++){var x=g[w];if(x._selection)this._updateSelection(x,x._selection,0);x._index=x._path=null}for(var w=i,d=f.length;w<d;w++)f[w]._index=w;if(t){var l=i>0&&h===n+(this._closed?1:0)?i-1:i,t=t.splice(l,m);for(var w=t.length-1;w>=0;w--)t[w]._path=null;if(u)g._curves=t.slice(1);this._adjustCurves(l,l)}return this._changed(41),g},clear:"#removeSegments",hasHandles:function(){var i=this._segments;for(var h=0,u=i.length;h<u;h++)if(i[h].hasHandles())return!0;return!1},clearHandles:function(){var i=this._segments;for(var h=0,u=i.length;h<u;h++)i[h].clearHandles()},getLength:function(){if(this._length==null){var i=this.getCurves(),h=0;for(var u=0,f=i.length;u<f;u++)h+=i[u].getLength();this._length=h}return this._length},getArea:function(){var i=this._area;if(i==null){var h=this._segments,u=this._closed;i=0;for(var f=0,t=h.length;f<t;f++){var n=f+1===t;i+=Z.getArea(Z.getValues(h[f],h[n?0:f+1],null,n&&!u))}this._area=i}return i},isFullySelected:function(){var i=this._segments.length;return this.isSelected()&&i>0&&this._segmentSelection===i*7},setFullySelected:function(i){if(i)this._selectSegments(!0);this.setSelected(i)},setSelection:function i(h){if(!(h&1))this._selectSegments(!1);i.base.call(this,h)},_selectSegments:function(i){var h=this._segments,u=h.length,f=i?7:0;this._segmentSelection=f*u;for(var t=0;t<u;t++)h[t]._selection=f},_updateSelection:function(i,h,u){i._selection=u;var f=this._segmentSelection+=u-h;if(f>0)this.setSelected(!0)},divideAt:function(i){var h=this.getLocationAt(i),u;return h&&(u=h.getCurve().divideAt(h.getCurveOffset()))?u._segment1:null},splitAt:function(i){var h=this.getLocationAt(i),u=h&&h.index,f=h&&h.time,t=0.00000001,n=1-t;if(f>n)u++,f=0;var g=this.getCurves();if(u>=0&&u<g.length){if(f>=t)g[u++].divideAtTime(f);var m=this.removeSegments(u,this._segments.length,!0),w;if(this._closed)this.setClosed(!1),w=this;else w=new b0(m0.NO_INSERT),w.insertAbove(this),w.copyAttributes(this);return w._add(m,0),this.addSegment(m[0]),w}return null},split:function(i,h){var u,f=h===G?i:(u=this.getCurves()[i])&&u.getLocationAtTime(h);return f!=null?this.splitAt(f):null},join:function(i,h){var u=h||0;if(i&&i!==this){var f=i._segments,t=this.getLastSegment(),n=i.getLastSegment();if(!n)return this;if(t&&t._point.isClose(n._point,u))i.reverse();var g=i.getFirstSegment();if(t&&t._point.isClose(g._point,u))t.setHandleOut(g._handleOut),this._add(f.slice(1));else{var m=this.getFirstSegment();if(m&&m._point.isClose(g._point,u))i.reverse();if(n=i.getLastSegment(),m&&m._point.isClose(n._point,u))m.setHandleIn(n._handleIn),this._add(f.slice(0,f.length-1),0);else this._add(f.slice())}if(i._closed)this._add([f[0]]);i.remove()}var w=this.getFirstSegment(),x=this.getLastSegment();if(w!==x&&w._point.isClose(x._point,u))w.setHandleIn(x._handleIn),x.remove(),this.setClosed(!0);return this},reduce:function(i){var h=this.getCurves(),u=i&&i.simplify,f=u?0.0000001:0;for(var t=h.length-1;t>=0;t--){var n=h[t];if(!n.hasHandles()&&(!n.hasLength(f)||u&&n.isCollinear(n.getNext())))n.remove()}return this},reverse:function(){this._segments.reverse();for(var i=0,h=this._segments.length;i<h;i++){var u=this._segments[i],f=u._handleIn;u._handleIn=u._handleOut,u._handleOut=f,u._index=i}this._curves=null,this._changed(9)},flatten:function(i){var h=new N8(this,i||0.25,256,!0),u=h.parts,f=u.length,t=[];for(var n=0;n<f;n++)t.push(new v0(u[n].curve.slice(0,2)));if(!this._closed&&f>0)t.push(new v0(u[f-1].curve.slice(6)));this.setSegments(t)},simplify:function(i){var h=new B4(this).fit(i||2.5);if(h)this.setSegments(h);return!!h},smooth:function(i){var h=this,u=i||{},f=u.type||"asymmetric",t=this._segments,n=t.length,g=this._closed;function m(f0,N0){var s0=f0&&f0.index;if(s0!=null){var C0=f0.path;if(C0&&C0!==h)throw new Error(f0._class+" "+s0+" of "+C0+" is not part of "+h);if(N0&&f0 instanceof Z)s0++}else s0=typeof f0==="number"?f0:N0;return Math.min(s0<0&&g?s0%n:s0<0?s0+n:s0,n-1)}var w=g&&u.from===G&&u.to===G,x=m(u.from,0),d=m(u.to,n-1);if(x>d)if(g)x-=n;else{var l=x;x=d,d=l}if(/^(?:asymmetric|continuous)$/.test(f)){var P=f==="asymmetric",y=Math.min,b=d-x+1,z=b-1,B=w?y(b,4):1,N=B,S=B,s=[];if(!g)N=y(1,x),S=y(1,n-d-1);if(z+=N+S,z<=1)return;for(var C=0,I=x-N;C<=z;C++,I++)s[C]=t[(I<0?I+n:I)%n]._point;var o=s[0]._x+2*s[1]._x,k=s[0]._y+2*s[1]._y,L=2,c=z-1,D=[o],A=[k],e=[L],q=[],E=[];for(var C=1;C<z;C++){var R=C<c,X=R?1:P?1:2,O=R?4:P?2:7,H=R?4:P?3:8,Y=R?2:P?0:1,W=X/L;L=e[C]=O-W,o=D[C]=H*s[C]._x+Y*s[C+1]._x-W*o,k=A[C]=H*s[C]._y+Y*s[C+1]._y-W*k}q[c]=D[c]/e[c],E[c]=A[c]/e[c];for(var C=z-2;C>=0;C--)q[C]=(D[C]-q[C+1])/e[C],E[C]=(A[C]-E[C+1])/e[C];q[z]=(3*s[z]._x-q[c])/2,E[z]=(3*s[z]._y-E[c])/2;for(var C=N,t0=z-S,I=x;C<=t0;C++,I++){var h0=t[I<0?I+n:I],g0=h0._point,J=q[C]-g0._x,p0=E[C]-g0._y;if(w||C<t0)h0.setHandleOut(J,p0);if(w||C>N)h0.setHandleIn(-J,-p0)}}else for(var C=x;C<=d;C++)t[C<0?C+n:C].smooth(u,!w&&C===x,!w&&C===d)},toShape:function(i){if(!this._closed)return null;var h=this._segments,u,f,t,n;function g(P,y){var b=h[P],z=b.getNext(),B=h[y],N=B.getNext();return b._handleOut.isZero()&&z._handleIn.isZero()&&B._handleOut.isZero()&&N._handleIn.isZero()&&z._point.subtract(b._point).isCollinear(N._point.subtract(B._point))}function m(P){var y=h[P],b=y.getPrevious(),z=y.getNext();return b._handleOut.isZero()&&y._handleIn.isZero()&&y._handleOut.isZero()&&z._handleIn.isZero()&&y._point.subtract(b._point).isOrthogonal(z._point.subtract(y._point))}function w(P){var y=h[P],b=y.getNext(),z=y._handleOut,B=b._handleIn,N=0.5522847498307936;if(z.isOrthogonal(B)){var S=y._point,s=b._point,C=new _0(S,z,!0).intersect(new _0(s,B,!0),!0);return C&&i0.isZero(z.getLength()/C.subtract(S).getLength()-N)&&i0.isZero(B.getLength()/C.subtract(s).getLength()-N)}return!1}function x(P,y){return h[P]._point.getDistance(h[y]._point)}if(!this.hasHandles()&&h.length===4&&g(0,2)&&g(1,3)&&m(1))u=K0.Rectangle,f=new K(x(0,3),x(0,1)),n=h[1]._point.add(h[2]._point).divide(2);else if(h.length===8&&w(0)&&w(2)&&w(4)&&w(6)&&g(1,5)&&g(3,7))u=K0.Rectangle,f=new K(x(1,6),x(0,3)),t=f.subtract(new K(x(0,7),x(1,2))).divide(2),n=h[3]._point.add(h[4]._point).divide(2);else if(h.length===4&&w(0)&&w(1)&&w(2)&&w(3)){if(i0.isZero(x(0,2)-x(1,3)))u=K0.Circle,t=x(0,2)/2;else u=K0.Ellipse,t=new K(x(2,0)/2,x(3,1)/2);n=h[1]._point}if(u){var d=this.getPosition(!0),l=new u({center:d,size:f,radius:t,insert:!1});if(l.copyAttributes(this,!0),l._matrix.prepend(this._matrix),l.rotate(n.subtract(d).getAngle()+90),i===G||i)l.insertAbove(this);return l}return null},toPath:"#clone",compare:function i(h){if(!h||h instanceof f6)return i.base.call(this,h);var u=this.getCurves(),f=h.getCurves(),t=u.length,n=f.length;if(!t||!n)return t==n;var g=u[0].getValues(),m=[],w=0,x,d=0,l;for(var P=0;P<n;P++){var B=f[P].getValues();m.push(B);var y=Z.getOverlaps(g,B);if(y){x=!P&&y[0][0]>0?n-1:P,l=y[0][1];break}}var b=Math.abs,z=0.00000001,B=m[x],N;while(g&&B){var y=Z.getOverlaps(g,B);if(y){var S=y[0][0];if(b(S-d)<z){if(d=y[1][0],d===1)g=++w<t?u[w].getValues():null,d=0;var s=y[0][1];if(b(s-l)<z){if(!N)N=[x,s];if(l=y[1][1],l===1){if(++x>=n)x=0;B=m[x]||f[x].getValues(),l=0}if(!g)return N[0]===x&&N[1]===l;continue}}}break}return!1},_hitTestSelf:function(i,h,u,f){var t=this,n=this.getStyle(),g=this._segments,m=g.length,w=this._closed,x=h._tolerancePadding,d=x,l,P,y,b,z,B,N=h.stroke&&n.hasStroke(),S=h.fill&&n.hasFill(),s=h.curves,C=N?n.getStrokeWidth()/2:S&&h.tolerance>0||s?0:null;if(C!==null)if(C>0)l=n.getStrokeJoin(),P=n.getStrokeCap(),y=n.getMiterLimit(),d=d.add(b0._getStrokePadding(C,f));else l=P="round";function I(q,E){return i.subtract(q).divide(E).length<=1}function o(q,E,R){if(!h.selected||E.isSelected()){var X=q._point;if(E!==X)E=E.add(X);if(I(E,d))return new w6(R,t,{segment:q,point:E})}}function k(q,E){return(E||h.segments)&&o(q,q._point,"segment")||!E&&h.handles&&(o(q,q._handleIn,"handle-in")||o(q,q._handleOut,"handle-out"))}function L(q){b.add(q)}function c(q){var E=w||q._index>0&&q._index<m-1;if((E?l:P)==="round")return I(q._point,d);else{if(b=new b0({internal:!0,closed:!0}),E){if(!q.isSmooth())b0._addBevelJoin(q,l,C,y,null,f,L,!0)}else if(P==="square")b0._addSquareCap(q,P,C,null,f,L,!0);if(!b.isEmpty()){var R;return b.contains(i)||(R=b.getNearestLocation(i))&&I(R.getPoint(),x)}}}if(h.ends&&!h.segments&&!w){if(B=k(g[0],!0)||k(g[m-1],!0))return B}else if(h.segments||h.handles){for(var D=0;D<m;D++)if(B=k(g[D]))return B}if(C!==null){if(z=this.getNearestLocation(i),z){var A=z.getTime();if(A===0||A===1&&m>1){if(!c(z.getSegment()))z=null}else if(!I(z.getPoint(),d))z=null}if(!z&&l==="miter"&&m>1)for(var D=0;D<m;D++){var e=g[D];if(i.getDistance(e._point)<=y*C&&c(e)){z=e.getLocation();break}}}return!z&&S&&this._contains(i)||z&&!N&&!s?new w6("fill",this):z?new w6(N?"stroke":"curve",this,{location:z,point:z.getPoint()}):null}},_.each(Z._evaluateMethods,function(i){this[i+"At"]=function(h){var u=this.getLocationAt(h);return u&&u[i]()}},{beans:!1,getLocationOf:function(){var i=a.read(arguments),h=this.getCurves();for(var u=0,f=h.length;u<f;u++){var t=h[u].getLocationOf(i);if(t)return t}return null},getOffsetOf:function(){var i=this.getLocationOf.apply(this,arguments);return i?i.getOffset():null},getLocationAt:function(i){if(typeof i==="number"){var h=this.getCurves(),u=0;for(var f=0,t=h.length;f<t;f++){var n=u,g=h[f];if(u+=g.getLength(),u>i)return g.getLocationAt(i-n)}if(h.length>0&&i<=this.getLength())return new u6(h[h.length-1],1)}else if(i&&i.getPath&&i.getPath()===this)return i;return null},getOffsetsWithTangent:function(){var i=a.read(arguments);if(i.isZero())return[];var h=[],u=0,f=this.getCurves();for(var t=0,n=f.length;t<n;t++){var g=f[t],m=g.getTimesWithTangent(i);for(var w=0,x=m.length;w<x;w++){var d=u+g.getOffsetAtTime(m[w]);if(h.indexOf(d)<0)h.push(d)}u+=g.length}return h}}),new function(){function i(u,f,t,n){if(n<=0)return;var g=n/2,m=n-2,w=g-1,x=new Array(6),d,l;function P(S){var s=x[S],C=x[S+1];if(d!=s||l!=C)u.beginPath(),u.moveTo(d,l),u.lineTo(s,C),u.stroke(),u.beginPath(),u.arc(s,C,g,0,Math.PI*2,!0),u.fill()}for(var y=0,b=f.length;y<b;y++){var z=f[y],B=z._selection;if(z._transformCoordinates(t,x),d=x[0],l=x[1],B&2)P(2);if(B&4)P(4);if(u.fillRect(d-g,l-g,n,n),m>0&&!(B&1)){var N=u.fillStyle;u.fillStyle="#ffffff",u.fillRect(d-w,l-w,m,m),u.fillStyle=N}}}function h(u,f,t){var n=f._segments,g=n.length,m=new Array(6),w=!0,x,d,l,P,y,b,z,B;function N(s){if(t)s._transformCoordinates(t,m),x=m[0],d=m[1];else{var C=s._point;x=C._x,d=C._y}if(w)u.moveTo(x,d),w=!1;else{if(t)y=m[2],b=m[3];else{var I=s._handleIn;y=x+I._x,b=d+I._y}if(y===x&&b===d&&z===l&&B===P)u.lineTo(x,d);else u.bezierCurveTo(z,B,y,b,x,d)}if(l=x,P=d,t)z=m[4],B=m[5];else{var I=s._handleOut;z=l+I._x,B=P+I._y}}for(var S=0;S<g;S++)N(n[S]);if(f._closed&&g>0)N(n[0])}return{_draw:function(u,f,t,n){var g=f.dontStart,m=f.dontFinish||f.clip,w=this.getStyle(),x=w.hasFill(),d=w.hasStroke(),l=w.getDashArray(),P=!j0.support.nativeDash&&d&&l&&l.length;if(!g)u.beginPath();if(x||d&&!P||m){if(h(u,this,n),this._closed)u.closePath()}function y(s){return l[(s%P+P)%P]}if(!m&&(x||d)){if(this._setStyles(u,f,t),x)u.fill(w.getFillRule()),u.shadowColor="rgba(0,0,0,0)";if(d){if(P){if(!g)u.beginPath();var b=new N8(this,0.25,32,!1,n),z=b.length,B=-w.getDashOffset(),N,S=0;while(B>0)B-=y(S--)+y(S--);while(B<z){if(N=B+y(S++),B>0||N>0)b.drawPart(u,Math.max(B,0),Math.max(N,0));B=N+y(S++)}}u.stroke()}}},_drawSelected:function(u,f){u.beginPath(),h(u,this,f),u.stroke(),i(u,this._segments,f,j0.settings.handleSize)}}},new function(){function i(h){var u=h._segments;if(!u.length)throw new Error("Use a moveTo() command first");return u[u.length-1]}return{moveTo:function(){var h=this._segments;if(h.length===1)this.removeSegment(0);if(!h.length)this._add([new v0(a.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new v0(a.read(arguments))])},cubicCurveTo:function(){var h=arguments,u=a.read(h),f=a.read(h),t=a.read(h),n=i(this);n.setHandleOut(u.subtract(n._point)),this._add([new v0(t,f.subtract(t))])},quadraticCurveTo:function(){var h=arguments,u=a.read(h),f=a.read(h),t=i(this)._point;this.cubicCurveTo(u.add(t.subtract(u).multiply(0.3333333333333333)),u.add(f.subtract(u).multiply(0.3333333333333333)),f)},curveTo:function(){var h=arguments,u=a.read(h),f=a.read(h),t=_.pick(_.read(h),0.5),n=1-t,g=i(this)._point,m=u.subtract(g.multiply(n*n)).subtract(f.multiply(t*t)).divide(2*t*n);if(m.isNaN())throw new Error("Cannot put a curve through points with parameter = "+t);this.quadraticCurveTo(m,f)},arcTo:function(){var h=arguments,u=Math.abs,f=Math.sqrt,t=i(this),n=t._point,g=a.read(h),b,m=_.peek(h),w=_.pick(m,!0),x,d,l,P;if(typeof w==="boolean")var y=n.add(g).divide(2),b=y.add(y.subtract(n).rotate(w?-90:90));else if(_.remain(h)<=2)b=g,g=a.read(h);else if(!n.equals(g)){var z=K.read(h),B=i0.isZero;if(B(z.width)||B(z.height))return this.lineTo(g);var N=_.read(h),w=!!_.read(h),S=!!_.read(h),y=n.add(g).divide(2),s=n.subtract(y).rotate(-N),C=s.x,I=s.y,o=u(z.width),k=u(z.height),L=o*o,c=k*k,D=C*C,A=I*I,e=f(D/L+A/c);if(e>1)o*=e,k*=e,L=o*o,c=k*k;if(e=(L*c-L*A-c*D)/(L*A+c*D),u(e)<0.000000000001)e=0;if(e<0)throw new Error("Cannot create an arc with the given arguments");if(x=new a(o*I/k,-k*C/o).multiply((S===w?-1:1)*f(e)).rotate(N).add(y),P=new l0().translate(x).rotate(N).scale(o,k),l=P._inverseTransform(n),d=l.getDirectedAngle(P._inverseTransform(g)),!w&&d>0)d-=360;else if(w&&d<0)d+=360}if(b){var q=new _0(n.add(b).divide(2),b.subtract(n).rotate(90),!0),E=new _0(b.add(g).divide(2),g.subtract(b).rotate(90),!0),R=new _0(n,g),X=R.getSide(b);if(x=q.intersect(E,!0),!x){if(!X)return this.lineTo(g);throw new Error("Cannot create an arc with the given arguments")}l=n.subtract(x),d=l.getDirectedAngle(g.subtract(x));var O=R.getSide(x,!0);if(O===0)d=X*u(d);else if(X===O)d+=d<0?360:-360}if(d){var H=0.00001,Y=u(d),W=Y>=360?4:Math.ceil((Y-H)/90),t0=d/W,h0=t0*Math.PI/360,g0=1.3333333333333333*Math.sin(h0)/(1+Math.cos(h0)),J=[];for(var p0=0;p0<=W;p0++){var s=g,f0=null;if(p0<W)if(f0=l.rotate(90).multiply(g0),P)s=P._transformPoint(l),f0=P._transformPoint(l.add(f0)).subtract(s);else s=x.add(l);if(!p0)t.setHandleOut(f0);else{var N0=l.rotate(-90).multiply(g0);if(P)N0=P._transformPoint(l.add(N0)).subtract(s);J.push(new v0(s,N0,f0))}l=l.rotate(t0)}this._add(J)}},lineBy:function(){var h=a.read(arguments),u=i(this)._point;this.lineTo(u.add(h))},curveBy:function(){var h=arguments,u=a.read(h),f=a.read(h),t=_.read(h),n=i(this)._point;this.curveTo(n.add(u),n.add(f),t)},cubicCurveBy:function(){var h=arguments,u=a.read(h),f=a.read(h),t=a.read(h),n=i(this)._point;this.cubicCurveTo(n.add(u),n.add(f),n.add(t))},quadraticCurveBy:function(){var h=arguments,u=a.read(h),f=a.read(h),t=i(this)._point;this.quadraticCurveTo(t.add(u),t.add(f))},arcBy:function(){var h=arguments,u=i(this)._point,f=u.add(a.read(h)),t=_.pick(_.peek(h),!0);if(typeof t==="boolean")this.arcTo(f,t);else this.arcTo(f,u.add(a.read(h)))},closePath:function(h){this.setClosed(!0),this.join(this,h)}}},{_getBounds:function(i,h){var u=h.handle?"getHandleBounds":h.stroke?"getStrokeBounds":"getBounds";return b0[u](this._segments,this._closed,this,i,h)},statics:{getBounds:function(i,h,u,f,t,n){var g=i[0];if(!g)return new u0;var m=new Array(6),w=g._transformCoordinates(f,new Array(6)),x=w.slice(0,2),d=x.slice(),l=new Array(2);function P(z){z._transformCoordinates(f,m);for(var B=0;B<2;B++)Z._addBounds(w[B],w[B+4],m[B+2],m[B],B,n?n[B]:0,x,d,l);var N=w;w=m,m=N}for(var y=1,b=i.length;y<b;y++)P(i[y]);if(h)P(g);return new u0(x[0],x[1],d[0]-x[0],d[1]-x[1])},getStrokeBounds:function(i,h,u,f,t){var n=u.getStyle(),g=n.hasStroke(),m=n.getStrokeWidth(),w=g&&u._getStrokeMatrix(f,t),x=g&&b0._getStrokePadding(m,w),d=b0.getBounds(i,h,u,f,t,x);if(!g)return d;var l=m/2,P=n.getStrokeJoin(),y=n.getStrokeCap(),b=n.getMiterLimit(),z=new u0(new K(x));function B(o){d=d.include(o)}function N(o){d=d.unite(z.setCenter(o._point.transform(f)))}function S(o,k){if(k==="round"||o.isSmooth())N(o);else b0._addBevelJoin(o,k,l,b,f,w,B)}function s(o,k){if(k==="round")N(o);else b0._addSquareCap(o,k,l,f,w,B)}var C=i.length-(h?0:1);if(C>0){for(var I=1;I<C;I++)S(i[I],P);if(h)S(i[0],P);else s(i[0],y),s(i[i.length-1],y)}return d},_getStrokePadding:function(i,h){if(!h)return[i,i];var u=new a(i,0).transform(h),f=new a(0,i).transform(h),t=u.getAngleInRadians(),n=u.getLength(),g=f.getLength(),m=Math.sin(t),w=Math.cos(t),x=Math.tan(t),d=Math.atan2(g*x,n),l=Math.atan2(g,x*n);return[Math.abs(n*Math.cos(d)*w+g*Math.sin(d)*m),Math.abs(g*Math.sin(l)*w+n*Math.cos(l)*m)]},_addBevelJoin:function(i,h,u,f,t,n,g,m){var w=i.getCurve(),x=w.getPrevious(),d=w.getPoint1().transform(t),l=x.getNormalAtTime(1).multiply(u).transform(n),P=w.getNormalAtTime(0).multiply(u).transform(n),y=l.getDirectedAngle(P);if(y<0||y>=180)l=l.negate(),P=P.negate();if(m)g(d);if(g(d.add(l)),h==="miter"){var b=new _0(d.add(l),new a(-l.y,l.x),!0).intersect(new _0(d.add(P),new a(-P.y,P.x),!0),!0);if(b&&d.getDistance(b)<=f*u)g(b)}g(d.add(P))},_addSquareCap:function(i,h,u,f,t,n,g){var m=i._point.transform(f),w=i.getLocation(),x=w.getNormal().multiply(w.getTime()===0?u:-u).transform(t);if(h==="square"){if(g)n(m.subtract(x)),n(m.add(x));m=m.add(x.rotate(-90))}n(m.add(x)),n(m.subtract(x))},getHandleBounds:function(i,h,u,f,t){var n=u.getStyle(),g=t.stroke&&n.hasStroke(),m,w;if(g){var x=u._getStrokeMatrix(f,t),d=n.getStrokeWidth()/2,l=d;if(n.getStrokeJoin()==="miter")l=d*n.getMiterLimit();if(n.getStrokeCap()==="square")l=Math.max(l,d*Math.SQRT2);m=b0._getStrokePadding(d,x),w=b0._getStrokePadding(l,x)}var P=new Array(6),y=Infinity,b=-y,z=y,B=b;for(var N=0,S=i.length;N<S;N++){var s=i[N];s._transformCoordinates(f,P);for(var C=0;C<6;C+=2){var I=!C?w:m,o=I?I[0]:0,k=I?I[1]:0,L=P[C],c=P[C+1],D=L-o,A=L+o,e=c-k,q=c+k;if(D<y)y=D;if(A>b)b=A;if(e<z)z=e;if(q>B)B=q}}return new u0(y,z,b-y,B-z)}}});b0.inject({statics:new function(){var i=0.5522847498307936,h=[new v0([-1,0],[0,i],[0,-i]),new v0([0,-1],[-i,0],[i,0]),new v0([1,0],[0,-i],[0,i]),new v0([0,1],[i,0],[-i,0])];function u(t,n,g){var m=_.getNamed(g),w=new b0(m&&(m.insert==!0?m0.INSERT:m.insert==!1?m0.NO_INSERT:null));return w._add(t),w._closed=n,w.set(m,m0.INSERT)}function f(t,n,g){var m=new Array(4);for(var w=0;w<4;w++){var x=h[w];m[w]=new v0(x._point.multiply(n).add(t),x._handleIn.multiply(n),x._handleOut.multiply(n))}return u(m,!0,g)}return{Line:function(){var t=arguments;return u([new v0(a.readNamed(t,"from")),new v0(a.readNamed(t,"to"))],!1,t)},Circle:function(){var t=arguments,n=a.readNamed(t,"center"),g=_.readNamed(t,"radius");return f(n,new K(g),t)},Rectangle:function(){var t=arguments,n=u0.readNamed(t,"rectangle"),g=K.readNamed(t,"radius",0,{readNull:!0}),m=n.getBottomLeft(!0),w=n.getTopLeft(!0),x=n.getTopRight(!0),d=n.getBottomRight(!0),l;if(!g||g.isZero())l=[new v0(m),new v0(w),new v0(x),new v0(d)];else{g=K.min(g,n.getSize(!0).divide(2));var{width:P,height:y}=g,b=P*i,z=y*i;l=[new v0(m.add(P,0),null,[-b,0]),new v0(m.subtract(0,y),[0,z]),new v0(w.add(0,y),null,[0,-z]),new v0(w.add(P,0),[-b,0],null),new v0(x.subtract(P,0),null,[b,0]),new v0(x.add(0,y),[0,-z],null),new v0(d.subtract(0,y),null,[0,z]),new v0(d.subtract(P,0),[b,0])]}return u(l,!0,t)},RoundRectangle:"#Rectangle",Ellipse:function(){var t=arguments,n=K0._readEllipse(t);return f(n.center,n.radius,t)},Oval:"#Ellipse",Arc:function(){var t=arguments,n=a.readNamed(t,"from"),g=a.readNamed(t,"through"),m=a.readNamed(t,"to"),w=_.getNamed(t),x=new b0(w&&w.insert==!1&&m0.NO_INSERT);return x.moveTo(n),x.arcTo(g,m),x.set(w)},RegularPolygon:function(){var t=arguments,n=a.readNamed(t,"center"),g=_.readNamed(t,"sides"),m=_.readNamed(t,"radius"),w=360/g,x=g%3===0,d=new a(0,x?-m:m),l=x?-1:0.5,P=new Array(g);for(var y=0;y<g;y++)P[y]=new v0(n.add(d.rotate((y+l)*w)));return u(P,!0,t)},Star:function(){var t=arguments,n=a.readNamed(t,"center"),g=_.readNamed(t,"points")*2,m=_.readNamed(t,"radius1"),w=_.readNamed(t,"radius2"),x=360/g,d=new a(0,-1),l=new Array(g);for(var P=0;P<g;P++)l[P]=new v0(n.add(d.rotate(x*P).multiply(P%2?w:m)));return u(l,!0,t)}}}});var f6=I6.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function i(h){if(this._children=[],this._namedChildren={},!this._initialize(h))if(typeof h==="string")this.setPathData(h);else this.addChildren(Array.isArray(h)?h:arguments)},insertChildren:function i(h,u){var f=u,t=f[0];if(t&&typeof t[0]==="number")f=[f];for(var n=u.length-1;n>=0;n--){var g=f[n];if(f===u&&!(g instanceof b0))f=_.slice(f);if(Array.isArray(g))f[n]=new b0({segments:g,insert:!1});else if(g instanceof f6)f.splice.apply(f,[n,1].concat(g.removeChildren())),g.remove()}return i.base.call(this,h,f)},reduce:function i(h){var u=this._children;for(var f=u.length-1;f>=0;f--){var t=u[f].reduce(h);if(t.isEmpty())t.remove()}if(!u.length){var t=new b0(m0.NO_INSERT);return t.copyAttributes(this),t.insertAbove(this),this.remove(),t}return i.base.call(this)},isClosed:function(){var i=this._children;for(var h=0,u=i.length;h<u;h++)if(!i[h]._closed)return!1;return!0},setClosed:function(i){var h=this._children;for(var u=0,f=h.length;u<f;u++)h[u].setClosed(i)},getFirstSegment:function(){var i=this.getFirstChild();return i&&i.getFirstSegment()},getLastSegment:function(){var i=this.getLastChild();return i&&i.getLastSegment()},getCurves:function(){var i=this._children,h=[];for(var u=0,f=i.length;u<f;u++)_.push(h,i[u].getCurves());return h},getFirstCurve:function(){var i=this.getFirstChild();return i&&i.getFirstCurve()},getLastCurve:function(){var i=this.getLastChild();return i&&i.getLastCurve()},getArea:function(){var i=this._children,h=0;for(var u=0,f=i.length;u<f;u++)h+=i[u].getArea();return h},getLength:function(){var i=this._children,h=0;for(var u=0,f=i.length;u<f;u++)h+=i[u].getLength();return h},getPathData:function(i,h){var u=this._children,f=[];for(var t=0,n=u.length;t<n;t++){var g=u[t],m=g._matrix;f.push(g.getPathData(i&&!m.isIdentity()?i.appended(m):i,h))}return f.join("")},_hitTestChildren:function i(h,u,f){return i.base.call(this,h,u.class===b0||u.type==="path"?u:_.set({},u,{fill:!1}),f)},_draw:function(i,h,u,f){var t=this._children;if(!t.length)return;h=h.extend({dontStart:!0,dontFinish:!0}),i.beginPath();for(var n=0,g=t.length;n<g;n++)t[n].draw(i,h,f);if(!h.clip){this._setStyles(i,h,u);var m=this._style;if(m.hasFill())i.fill(m.getFillRule()),i.shadowColor="rgba(0,0,0,0)";if(m.hasStroke())i.stroke()}},_drawSelected:function(i,h,u){var f=this._children;for(var t=0,n=f.length;t<n;t++){var g=f[t],m=g._matrix;if(!u[g._id])g._drawSelected(i,m.isIdentity()?h:h.appended(m))}}},new function(){function i(h,u){var f=h._children;if(u&&!f.length)throw new Error("Use a moveTo() command first");return f[f.length-1]}return _.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(h){this[h]=function(){var u=i(this,!0);u[h].apply(u,arguments)}},{moveTo:function(){var h=i(this),u=h&&h.isEmpty()?h:new b0(m0.NO_INSERT);if(u!==h)this.addChild(u);u.moveTo.apply(u,arguments)},moveBy:function(){var h=i(this,!0),u=h&&h.getLastSegment(),f=a.read(arguments);this.moveTo(u?f.add(u._point):f)},closePath:function(h){i(this,!0).closePath(h)}})},_.each(["reverse","flatten","simplify","smooth"],function(i){this[i]=function(h){var u=this._children,f;for(var t=0,n=u.length;t<n;t++)f=u[t][i](h)||f;return f}},{}));I6.inject(new function(){var{min:i,max:h,abs:u}=Math,f={unite:{"1":!0,"2":!0},intersect:{"2":!0},subtract:{"1":!0},exclude:{"1":!0,"-1":!0}};function t(N){return N._children||[N]}function n(N,S){var s=N.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(S){var C=t(s);for(var I=0,o=C.length;I<o;I++){var N=C[I];if(!N._closed&&!N.isEmpty())N.closePath(0.000000000001),N.getFirstSegment().setHandleIn(0,0),N.getLastSegment().setHandleOut(0,0)}s=s.resolveCrossings().reorient(s.getFillRule()==="nonzero",!0)}return s}function g(N,S,s,C,I){var o=new f6(m0.NO_INSERT);if(o.addChildren(N,!0),o=o.reduce({simplify:S}),!(I&&I.insert==!1))o.insertAbove(C&&s.isSibling(C)&&s.getIndex()<C.getIndex()?C:s);return o.copyAttributes(s,!0),o}function m(N){return N.hasOverlap()||N.isCrossing()}function w(N,S,s,C){if(C&&(C.trace==!1||C.stroke)&&/^(subtract|intersect)$/.test(s))return x(N,S,s);var I=n(N,!0),o=S&&N!==S&&n(S,!0),k=f[s];if(k[s]=!0,o&&(k.subtract||k.exclude)^(o.isClockwise()^I.isClockwise()))o.reverse();var L=y(u6.expand(I.getIntersections(o,m))),c=t(I),D=o&&t(o),A=[],e=[],q;function E(f0){for(var N0=0,s0=f0.length;N0<s0;N0++){var C0=f0[N0];_.push(A,C0._segments),_.push(e,C0.getCurves()),C0._overlapsOnly=!0}}function R(f0){var N0=[];for(var s0=0,C0=f0&&f0.length;s0<C0;s0++)N0.push(e[f0[s0]]);return N0}if(L.length){if(E(c),D)E(D);var X=new Array(e.length);for(var O=0,H=e.length;O<H;O++)X[O]=e[O].getValues();var Y=n0.findCurveBoundsCollisions(X,X,0,!0),W={};for(var O=0;O<e.length;O++){var t0=e[O],h0=t0._path._id,g0=W[h0]=W[h0]||{};g0[t0.getIndex()]={hor:R(Y[O].hor),ver:R(Y[O].ver)}}for(var O=0,H=L.length;O<H;O++)z(L[O]._segment,I,o,W,k);for(var O=0,H=A.length;O<H;O++){var J=A[O],p0=J._intersection;if(!J._winding)z(J,I,o,W,k);if(!(p0&&p0._overlap))J._path._overlapsOnly=!1}q=B(A,k)}else q=P(D?c.concat(D):c.slice(),function(f0){return!!k[f0]});return g(q,!0,N,S,C)}function x(N,S,s){var C=n(N),I=n(S),o=C.getIntersections(I,m),k=s==="subtract",L=s==="divide",c={},D=[];function A(E){if(!c[E._id]&&(L||I.contains(E.getPointAt(E.getLength()/2))^k))return D.unshift(E),c[E._id]=!0}for(var e=o.length-1;e>=0;e--){var q=o[e].split();if(q){if(A(q))q.getFirstSegment().setHandleIn(0,0);C.getLastSegment().setHandleOut(0,0)}}return A(C),g(D,!1,N,S)}function d(N,S){var s=N;while(s){if(s===S)return;s=s._previous}while(N._next&&N._next!==S)N=N._next;if(!N._next){while(S._previous)S=S._previous;N._next=S,S._previous=N}}function l(N){for(var S=N.length-1;S>=0;S--)N[S].clearHandles()}function P(N,S,s){var C=N&&N.length;if(C){var I=_.each(N,function(Y,W){this[Y._id]={container:null,winding:Y.isClockwise()?1:-1,index:W}},{}),o=N.slice().sort(function(Y,W){return u(W.getArea())-u(Y.getArea())}),k=o[0],L=n0.findItemBoundsCollisions(o,null,i0.GEOMETRIC_EPSILON);if(s==null)s=k.isClockwise();for(var c=0;c<C;c++){var D=o[c],A=I[D._id],e=0,q=L[c];if(q){var E=null;for(var R=q.length-1;R>=0;R--)if(q[R]<c){E=E||D.getInteriorPoint();var X=o[q[R]];if(X.contains(E)){var O=I[X._id];e=O.winding,A.winding+=e,A.container=O.exclude?O.container:X;break}}}if(S(A.winding)===S(e))A.exclude=!0,N[A.index]=null;else{var H=A.container;D.setClockwise(H?!H.isClockwise():s)}}}return N}function y(N,S,s){var C=S&&[],I=0.00000001,o=1-I,k=!1,L=s||[],c=s&&{},D,A,e;function q(N0){return N0._path._id+"."+N0._segment1._index}for(var E=(s&&s.length)-1;E>=0;E--){var R=s[E];if(R._path)c[q(R)]=!0}for(var E=N.length-1;E>=0;E--){var X=N[E],O=X._time,H=O,Y=S&&!S(X),R=X._curve,W;if(R){if(R!==A)k=!R.hasHandles()||c&&c[q(R)],D=[],e=null,A=R;else if(e>=I)O/=e}if(Y){if(D)D.push(X);continue}else if(S)C.unshift(X);if(e=H,O<I)W=R._segment1;else if(O>o)W=R._segment2;else{var t0=R.divideAtTime(O,!0);if(k)L.push(R,t0);W=t0._segment1;for(var h0=D.length-1;h0>=0;h0--){var g0=D[h0];g0._time=(g0._time-O)/(1-O)}}X._setSegment(W);var J=W._intersection,p0=X._intersection;if(J){d(J,p0);var f0=J;while(f0)d(f0._intersection,J),f0=f0._next}else W._intersection=p0}if(!s)l(L);return C||N}function b(N,S,s,C,I){var o=Array.isArray(S)?S:S[s?"hor":"ver"],k=s?1:0,L=k^1,c=[N.x,N.y],D=c[k],A=c[L],e=0.000000001,q=0.000001,E=D-e,R=D+e,X=0,O=0,H=0,Y=0,W=!1,t0=!1,h0=1,g0=[],J,p0;function f0(B0){var a0=B0[L+0],$0=B0[L+6];if(A<i(a0,$0)||A>h(a0,$0))return;var T0=B0[k+0],y6=B0[k+2],L6=B0[k+4],d6=B0[k+6];if(a0===$0){if(T0<R&&d6>E||d6<R&&T0>E)W=!0;return}var C6=A===a0?0:A===$0?1:E>h(T0,y6,L6,d6)||R<i(T0,y6,L6,d6)?1:Z.solveCubic(B0,L,A,g0,0,1)>0?g0[0]:1,i6=C6===0?T0:C6===1?d6:Z.getPoint(B0,C6)[s?"y":"x"],t6=a0>$0?1:-1,a6=J[L]>J[L+6]?1:-1,r6=J[k+6];if(A!==a0){if(i6<E)H+=t6;else if(i6>R)Y+=t6;else W=!0;if(i6>D-q&&i6<D+q)h0/=2}else{if(t6!==a6){if(T0<E)H+=t6;else if(T0>R)Y+=t6}else if(T0!=r6){if(r6<R&&i6>R)Y+=t6,W=!0;else if(r6>E&&i6<E)H+=t6,W=!0}h0/=4}return J=B0,!I&&i6>E&&i6<R&&Z.getTangent(B0,C6)[s?"x":"y"]===0&&b(N,S,!s,C,!0)}function N0(B0){var a0=B0[L+0],$0=B0[L+2],T0=B0[L+4],y6=B0[L+6];if(A<=h(a0,$0,T0,y6)&&A>=i(a0,$0,T0,y6)){var L6=B0[k+0],d6=B0[k+2],C6=B0[k+4],i6=B0[k+6],t6=E>h(L6,d6,C6,i6)||R<i(L6,d6,C6,i6)?[B0]:Z.getMonoCurves(B0,s),a6;for(var r6=0,V4=t6.length;r6<V4;r6++)if(a6=f0(t6[r6]))return a6}}for(var s0=0,C0=o.length;s0<C0;s0++){var r0=o[s0],P0=r0._path,X0=r0.getValues(),O0;if(!s0||o[s0-1]._path!==P0){if(J=null,!P0._closed){if(p0=Z.getValues(P0.getLastCurve().getSegment2(),r0.getSegment1(),null,!C),p0[L]!==p0[L+6])J=p0}if(!J){J=X0;var Z0=P0.getLastCurve();while(Z0&&Z0!==r0){var E0=Z0.getValues();if(E0[L]!==E0[L+6]){J=E0;break}Z0=Z0.getPrevious()}}}if(O0=N0(X0))return O0;if(s0+1===C0||o[s0+1]._path!==P0){if(p0&&(O0=N0(p0)))return O0;if(W&&!H&&!Y)H=Y=P0.isClockwise(C)^s?1:-1;if(X+=H,O+=Y,H=Y=0,W)t0=!0,W=!1;p0=null}}return X=u(X),O=u(O),{winding:h(X,O),windingL:X,windingR:O,quality:h0,onPath:t0}}function z(N,S,s,C,I){var o=[],k=N,L=0,e;do{var c=N.getCurve();if(c){var D=c.getLength();o.push({segment:N,curve:c,length:D}),L+=D}N=N.getNext()}while(N&&!N._intersection&&N!==k);var A=[0.5,0.25,0.75],e={winding:0,quality:-1},q=0.001,E=1-q;for(var R=0;R<A.length&&e.quality<0.5;R++){var D=L*A[R];for(var X=0,O=o.length;X<O;X++){var H=o[X],Y=H.length;if(D<=Y){var c=H.curve,W=c._path,t0=W._parent,h0=t0 instanceof f6?t0:W,g0=i0.clamp(c.getTimeAt(D),q,E),J=c.getPointAtTime(g0),p0=u(c.getTangentAtTime(g0).y)<Math.SQRT1_2,f0=null;if(I.subtract&&s){var N0=h0===S?s:S,s0=N0._getWinding(J,p0,!0);if(h0===S&&s0.winding||h0===s&&!s0.winding)if(s0.quality<1)continue;else f0={winding:0,quality:1}}if(f0=f0||b(J,C[W._id][c.getIndex()],p0,!0),f0.quality>e.quality)e=f0;break}D-=Y}}for(var X=o.length-1;X>=0;X--)o[X].segment._winding=e}function B(N,S){var s=[],C;function I(C0){var r0;return!!(C0&&!C0._visited&&(!S||S[(r0=C0._winding||{}).winding]&&!(S.unite&&r0.winding===2&&r0.windingL&&r0.windingR)))}function o(C0){if(C0){for(var r0=0,P0=C.length;r0<P0;r0++)if(C0===C[r0])return!0}return!1}function k(C0){var r0=C0._segments;for(var P0=0,X0=r0.length;P0<X0;P0++)r0[P0]._visited=!0}function L(C0,r0){var P0=C0._intersection,X0=P0,O0=[];if(r0)C=[C0];function Z0(E0,B0){while(E0&&E0!==B0){var a0=E0._segment,$0=a0&&a0._path;if($0){var T0=a0.getNext()||$0.getFirstSegment(),y6=T0._intersection;if(a0!==C0&&(o(a0)||o(T0)||T0&&(I(a0)&&(I(T0)||y6&&I(y6._segment)))))O0.push(a0);if(r0)C.push(a0)}E0=E0._next}}if(P0){Z0(P0);while(P0&&P0._previous)P0=P0._previous;Z0(P0,X0)}return O0}N.sort(function(C0,r0){var P0=C0._intersection,X0=r0._intersection,O0=!!(P0&&P0._overlap),Z0=!!(X0&&X0._overlap),E0=C0._path,B0=r0._path;return O0^Z0?O0?1:-1:!P0^!X0?P0?1:-1:E0!==B0?E0._id-B0._id:C0._index-r0._index});for(var c=0,D=N.length;c<D;c++){var A=N[c],e=I(A),q=null,E=!1,R=!0,X=[],O,H,Y;if(e&&A._path._overlapsOnly){var W=A._path,t0=A._intersection._segment._path;if(W.compare(t0)){if(W.getArea())s.push(W.clone(!1));k(W),k(t0),e=!1}}while(e){var h0=!q,g0=L(A,h0),J=g0.shift(),E=!h0&&(o(A)||o(J)),p0=!E&&J;if(h0)q=new b0(m0.NO_INSERT),O=null;if(E){if(A.isFirst()||A.isLast())R=A._path._closed;A._visited=!0;break}if(p0&&O)X.push(O),O=null;if(!O){if(p0)g0.push(A);O={start:q._segments.length,crossings:g0,visited:H=[],handleIn:Y}}if(p0)A=J;if(!I(A)){q.removeSegments(O.start);for(var f0=0,N0=H.length;f0<N0;f0++)H[f0]._visited=!1;H.length=0;do if(A=O&&O.crossings.shift(),!A||!A._path){if(A=null,O=X.pop(),O)H=O.visited,Y=O.handleIn}while(O&&!I(A));if(!A)break}var s0=A.getNext();q.add(new v0(A._point,Y,s0&&A._handleOut)),A._visited=!0,H.push(A),A=s0||A._path.getFirstSegment(),Y=s0&&s0._handleIn}if(E){if(R)q.getFirstSegment().setHandleIn(Y),q.setClosed(R);if(q.getArea()!==0)s.push(q)}}return s}return{_getWinding:function(N,S,s){return b(N,this.getCurves(),S,s)},unite:function(N,S){return w(this,N,"unite",S)},intersect:function(N,S){return w(this,N,"intersect",S)},subtract:function(N,S){return w(this,N,"subtract",S)},exclude:function(N,S){return w(this,N,"exclude",S)},divide:function(N,S){return S&&(S.trace==!1||S.stroke)?x(this,N,"divide"):g([this.subtract(N,S),this.intersect(N,S)],!0,this,N,S)},resolveCrossings:function(){var N=this._children,S=N||[this];function s(O,H){var Y=O&&O._intersection;return Y&&Y._overlap&&Y._path===H}var C=!1,I=!1,o=this.getIntersections(null,function(O){return O.hasOverlap()&&(C=!0)||O.isCrossing()&&(I=!0)}),k=C&&I&&[];if(o=u6.expand(o),C){var L=y(o,function(O){return O.hasOverlap()},k);for(var c=L.length-1;c>=0;c--){var D=L[c],A=D._path,e=D._segment,q=e.getPrevious(),E=e.getNext();if(s(q,A)&&s(E,A)){if(e.remove(),q._handleOut._set(0,0),E._handleIn._set(0,0),q!==e&&!q.getCurve().hasLength())E._handleIn.set(q._handleIn),q.remove()}}}if(I){if(y(o,C&&function(O){var H=O.getCurve(),Y=O.getSegment(),W=O._intersection,t0=W._curve,h0=W._segment;if(H&&t0&&H._path&&t0._path)return!0;if(Y)Y._intersection=null;if(h0)h0._intersection=null},k),k)l(k);S=B(_.each(S,function(O){_.push(this,O._segments)},[]))}var R=S.length,X;if(R>1&&N){if(S!==N)this.setChildren(S);X=this}else if(R===1&&!N){if(S[0]!==this)this.setSegments(S[0].removeSegments());X=this}if(!X)X=new f6(m0.NO_INSERT),X.addChildren(S),X=X.reduce(),X.copyAttributes(this),this.replaceWith(X);return X},reorient:function(N,S){var s=this._children;if(s&&s.length)this.setChildren(P(this.removeChildren(),function(C){return!!(N?C:C&1)},S));else if(S!==G)this.setClockwise(S);return this},getInteriorPoint:function(){var N=this.getBounds(),S=N.getCenter(!0);if(!this.contains(S)){var s=this.getCurves(),C=S.y,I=[],o=[];for(var k=0,L=s.length;k<L;k++){var c=s[k].getValues(),D=c[1],A=c[3],e=c[5],q=c[7];if(C>=i(D,A,e,q)&&C<=h(D,A,e,q)){var E=Z.getMonoCurves(c);for(var R=0,X=E.length;R<X;R++){var O=E[R],H=O[1],Y=O[7];if(H!==Y&&(C>=H&&C<=Y||C>=Y&&C<=H)){var W=C===H?O[0]:C===Y?O[6]:Z.solveCubic(O,1,C,o,0,1)===1?Z.getPoint(O,o[0]).x:(O[0]+O[6])/2;I.push(W)}}}}if(I.length>1)I.sort(function(t0,h0){return t0-h0}),S.x=(I[0]+I[1])/2}return S}}});var N8=_.extend({_class:"PathFlattener",initialize:function(i,h,u,f,t){var n=[],g=[],m=0,w=1/(u||32),x=i._segments,d=x[0],l;function P(B,N){var S=Z.getValues(B,N,t);n.push(S),y(S,B._index,0,1)}function y(B,N,S,s){if(s-S>w&&!(f&&Z.isStraight(B))&&!Z.isFlatEnough(B,h||0.25)){var C=Z.subdivide(B,0.5),I=(S+s)/2;y(C[0],N,S,I),y(C[1],N,I,s)}else{var o=B[6]-B[0],k=B[7]-B[1],L=Math.sqrt(o*o+k*k);if(L>0)m+=L,g.push({offset:m,curve:B,index:N,time:s})}}for(var b=1,z=x.length;b<z;b++)l=x[b],P(d,l),d=l;if(i._closed)P(l||d,x[0]);this.curves=n,this.parts=g,this.length=m,this.index=0},_get:function(i){var h=this.parts,u=h.length,f,t,n=this.index;for(;;)if(t=n,!n||h[--n].offset<i)break;for(;t<u;t++){var g=h[t];if(g.offset>=i){this.index=t;var m=h[t-1],w=m&&m.index===g.index?m.time:0,x=m?m.offset:0;return{index:g.index,time:w+(g.time-w)*(i-x)/(g.offset-x)}}}return{index:h[u-1].index,time:1}},drawPart:function(i,h,u){var f=this._get(h),t=this._get(u);for(var n=f.index,g=t.index;n<=g;n++){var m=Z.getPart(this.curves[n],n===f.index?f.time:0,n===t.index?t.time:1);if(n===f.index)i.moveTo(m[0],m[1]);i.bezierCurveTo.apply(i,m.slice(2))}}},_.each(Z._evaluateMethods,function(i){this[i+"At"]=function(h){var u=this._get(h);return Z[i](this.curves[u.index],u.time)}},{})),B4=_.extend({initialize:function(i){var h=this.points=[],u=i._segments,f=i._closed;for(var t=0,n,g=u.length;t<g;t++){var m=u[t].point;if(!n||!n.equals(m))h.push(n=m.clone())}if(f)h.unshift(h[h.length-1]),h.push(h[1]);this.closed=f},fit:function(i){var h=this.points,u=h.length,f=null;if(u>0){if(f=[new v0(h[0])],u>1){if(this.fitCubic(f,i,0,u-1,h[1].subtract(h[0]),h[u-2].subtract(h[u-1])),this.closed)f.shift(),f.pop()}}return f},fitCubic:function(i,h,u,f,t,n){var g=this.points;if(f-u===1){var m=g[u],w=g[f],x=m.getDistance(w)/3;this.addCurve(i,[m,m.add(t.normalize(x)),w.add(n.normalize(x)),w]);return}var d=this.chordLengthParameterize(u,f),l=Math.max(h,h*h),P,y=!0;for(var b=0;b<=4;b++){var z=this.generateBezier(u,f,d,t,n),B=this.findMaxError(u,f,z,d);if(B.error<h&&y){this.addCurve(i,z);return}if(P=B.index,B.error>=l)break;y=this.reparameterize(u,f,d,z),l=B.error}var N=g[P-1].subtract(g[P+1]);this.fitCubic(i,h,u,P,t,N),this.fitCubic(i,h,P,f,N.negate(),n)},addCurve:function(i,h){var u=i[i.length-1];u.setHandleOut(h[1].subtract(h[0])),i.push(new v0(h[3],h[2].subtract(h[3])))},generateBezier:function(i,h,u,f,t){var n=0.000000000001,g=Math.abs,m=this.points,w=m[i],x=m[h],d=[[0,0],[0,0]],l=[0,0];for(var P=0,y=h-i+1;P<y;P++){var b=u[P],z=1-b,B=3*b*z,N=z*z*z,S=B*z,s=B*b,C=b*b*b,I=f.normalize(S),o=t.normalize(s),k=m[i+P].subtract(w.multiply(N+S)).subtract(x.multiply(s+C));d[0][0]+=I.dot(I),d[0][1]+=I.dot(o),d[1][0]=d[0][1],d[1][1]+=o.dot(o),l[0]+=I.dot(k),l[1]+=o.dot(k)}var L=d[0][0]*d[1][1]-d[1][0]*d[0][1],c,D;if(g(L)>n){var A=d[0][0]*l[1]-d[1][0]*l[0],e=l[0]*d[1][1]-l[1]*d[0][1];c=e/L,D=A/L}else{var q=d[0][0]+d[0][1],E=d[1][0]+d[1][1];c=D=g(q)>n?l[0]/q:g(E)>n?l[1]/E:0}var R=x.getDistance(w),X=n*R,O,H;if(c<X||D<X)c=D=R/3;else{var Y=x.subtract(w);if(O=f.normalize(c),H=t.normalize(D),O.dot(Y)-H.dot(Y)>R*R)c=D=R/3,O=H=null}return[w,w.add(O||f.normalize(c)),x.add(H||t.normalize(D)),x]},reparameterize:function(i,h,u,f){for(var t=i;t<=h;t++)u[t-i]=this.findRoot(f,this.points[t],u[t-i]);for(var t=1,n=u.length;t<n;t++)if(u[t]<=u[t-1])return!1;return!0},findRoot:function(i,h,u){var f=[],t=[];for(var n=0;n<=2;n++)f[n]=i[n+1].subtract(i[n]).multiply(3);for(var n=0;n<=1;n++)t[n]=f[n+1].subtract(f[n]).multiply(2);var g=this.evaluate(3,i,u),m=this.evaluate(2,f,u),w=this.evaluate(1,t,u),x=g.subtract(h),d=m.dot(m)+x.dot(w);return i0.isMachineZero(d)?u:u-x.dot(m)/d},evaluate:function(i,h,u){var f=h.slice();for(var t=1;t<=i;t++)for(var n=0;n<=i-t;n++)f[n]=f[n].multiply(1-u).add(f[n+1].multiply(u));return f[0]},chordLengthParameterize:function(i,h){var u=[0];for(var f=i+1;f<=h;f++)u[f-i]=u[f-i-1]+this.points[f].getDistance(this.points[f-1]);for(var f=1,t=h-i;f<=t;f++)u[f]/=u[t];return u},findMaxError:function(i,h,u,f){var t=Math.floor((h-i+1)/2),n=0;for(var g=i+1;g<h;g++){var m=this.evaluate(3,u,f[g-i]),w=m.subtract(this.points[g]),x=w.x*w.x+w.y*w.y;if(x>=n)n=x,t=g}return{error:n,index:t}}}),V6=m0.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function i(h){this._content="",this._lines=[];var u=h&&_.isPlainObject(h)&&h.x===G&&h.y===G;this._initialize(u&&h,!u&&a.read(arguments))},_equals:function(i){return this._content===i._content},copyContent:function(i){this.setContent(i._content)},getContent:function(){return this._content},setContent:function(i){this._content=""+i,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),_4=V6.extend({_class:"PointText",initialize:function i(){V6.apply(this,arguments)},getPoint:function(){var i=this._matrix.getTranslation();return new Q(i.x,i.y,this,"setPoint")},setPoint:function(){var i=a.read(arguments);this.translate(i.subtract(this._matrix.getTranslation()))},_draw:function(i,h,u){if(!this._content)return;this._setStyles(i,h,u);var f=this._lines,t=this._style,n=t.hasFill(),g=t.hasStroke(),m=t.getLeading(),w=i.shadowColor;i.font=t.getFontStyle(),i.textAlign=t.getJustification();for(var x=0,d=f.length;x<d;x++){i.shadowColor=w;var l=f[x];if(n)i.fillText(l,0,0),i.shadowColor="rgba(0,0,0,0)";if(g)i.strokeText(l,0,0);i.translate(0,m)}},_getBounds:function(i,h){var u=this._style,f=this._lines,t=f.length,n=u.getJustification(),g=u.getLeading(),m=this.getView().getTextWidth(u.getFontStyle(),f),w=0;if(n!=="left")w-=m/(n==="center"?2:1);var x=new u0(w,t?-0.75*g:0,m,t*g);return i?i._transformBounds(x,x):x}}),V0=_.extend(new function(){var i={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},h={},u={transparent:[0,0,0,0]},f;function t(m){var w=m.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||m.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),x="rgb",d;if(w){var l=w[4]?4:3;d=new Array(l);for(var P=0;P<l;P++){var y=w[P+1];d[P]=parseInt(y.length==1?y+y:y,16)/255}}else if(w=m.match(/^(rgb|hsl)a?\((.*)\)$/)){x=w[1],d=w[2].trim().split(/[,\s]+/g);var b=x==="hsl";for(var P=0,z=Math.min(d.length,4);P<z;P++){var B=d[P],y=parseFloat(B);if(b){if(P===0){var N=B.match(/([a-z]*)$/)[1];y*={turn:360,rad:180/Math.PI,grad:0.9}[N]||1}else if(P<3)y/=100}else if(P<3)y/=/%$/.test(B)?100:255;d[P]=y}}else{var S=u[m];if(!S)if(T){if(!f)f=G0.getContext(1,1,{willReadFrequently:!0}),f.globalCompositeOperation="copy";f.fillStyle="rgba(0,0,0,0)",f.fillStyle=m,f.fillRect(0,0,1,1);var s=f.getImageData(0,0,1,1).data;S=u[m]=[s[0]/255,s[1]/255,s[2]/255]}else S=[0,0,0];d=S.slice()}return[x,d]}var n=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],g={"rgb-hsb":function(m,w,x){var d=Math.max(m,w,x),l=Math.min(m,w,x),P=d-l,y=P===0?0:(d==m?(w-x)/P+(w<x?6:0):d==w?(x-m)/P+2:(m-w)/P+4)*60;return[y,d===0?0:P/d,d]},"hsb-rgb":function(m,w,x){m=(m/60%6+6)%6;var l=Math.floor(m),d=m-l,l=n[l],P=[x,x*(1-w),x*(1-w*d),x*(1-w*(1-d))];return[P[l[0]],P[l[1]],P[l[2]]]},"rgb-hsl":function(m,w,x){var d=Math.max(m,w,x),l=Math.min(m,w,x),P=d-l,y=P===0,b=y?0:(d==m?(w-x)/P+(w<x?6:0):d==w?(x-m)/P+2:(m-w)/P+4)*60,z=(d+l)/2,B=y?0:z<0.5?P/(d+l):P/(2-d-l);return[b,B,z]},"hsl-rgb":function(m,w,x){if(m=(m/360%1+1)%1,w===0)return[x,x,x];var d=[m+0.3333333333333333,m,m-0.3333333333333333],l=x<0.5?x*(1+w):x+w-x*w,P=2*x-l,y=[];for(var b=0;b<3;b++){var z=d[b];if(z<0)z+=1;if(z>1)z-=1;y[b]=6*z<1?P+(l-P)*6*z:2*z<1?l:3*z<2?P+(l-P)*(0.6666666666666666-z)*6:P}return y},"rgb-gray":function(m,w,x){return[m*0.2989+w*0.587+x*0.114]},"gray-rgb":function(m){return[m,m,m]},"gray-hsb":function(m){return[0,0,m]},"gray-hsl":function(m){return[0,0,m]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return _.each(i,function(m,w){h[w]=[],_.each(m,function(x,d){var l=_.capitalize(x),P=/^(hue|saturation)$/.test(x),y=h[w][d]=w==="gradient"?x==="gradient"?function(b){var z=this._components[0];if(b=A6.read(Array.isArray(b)?b:arguments,0,{readNull:!0}),z!==b){if(z)z._removeOwner(this);if(b)b._addOwner(this)}return b}:function(){return a.read(arguments,0,{readNull:x==="highlight",clone:!0})}:function(b){return b==null||isNaN(b)?0:+b};this["get"+l]=function(){return this._type===w||P&&/^hs[bl]$/.test(this._type)?this._components[d]:this._convert(w)[d]},this["set"+l]=function(b){if(this._type!==w&&!(P&&/^hs[bl]$/.test(this._type)))this._components=this._convert(w),this._properties=i[w],this._type=w;this._components[d]=y.call(this,b),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function m(w){var x=arguments,d=this.__read,l=0,P,y,b,z;if(Array.isArray(w))x=w,w=x[0];var B=w!=null&&typeof w;if(B==="string"&&w in i)if(P=w,w=x[1],Array.isArray(w))y=w,b=x[2];else{if(d)l=1;x=_.slice(x,1),B=typeof w}if(!y){if(z=B==="number"?x:B==="object"&&w.length!=null?w:null,z){if(!P)P=z.length>=3?"rgb":"gray";var N=i[P].length;if(b=z[N],d)l+=z===arguments?N+(b!=null?1:0):1;if(z.length>N)z=_.slice(z,0,N)}else if(B==="string"){var S=t(w);if(P=S[0],y=S[1],y.length===4)b=y[3],y.length--}else if(B==="object")if(w.constructor===m){if(P=w._type,y=w._components.slice(),b=w._alpha,P==="gradient")for(var s=1,C=y.length;s<C;s++){var I=y[s];if(I)y[s]=I.clone()}}else if(w.constructor===A6)P="gradient",z=x;else{P="hue"in w?"lightness"in w?"hsl":"hsb":("gradient"in w)||("stops"in w)||("radial"in w)?"gradient":("gray"in w)?"gray":"rgb";var o=i[P],k=h[P];this._components=y=[];for(var s=0,C=o.length;s<C;s++){var L=w[o[s]];if(L==null&&!s&&P==="gradient"&&"stops"in w)L={stops:w.stops,radial:w.radial};if(L=k[s].call(this,L),L!=null)y[s]=L}b=w.alpha}if(d&&P)l=1}if(this._type=P||"rgb",!y){this._components=y=[];var k=h[this._type];for(var s=0,C=k.length;s<C;s++){var L=k[s].call(this,z&&z[s]);if(L!=null)y[s]=L}}if(this._components=y,this._properties=i[this._type],this._alpha=b,d)this.__read=l;return this},set:"#initialize",_serialize:function(m,w){var x=this.getComponents();return _.serialize(/^(gray|rgb)$/.test(this._type)?x:[this._type].concat(x),m,!0,w)},_changed:function(){if(this._canvasStyle=null,this._owner)if(this._setter)this._owner[this._setter](this);else this._owner._changed(129)},_convert:function(m){var w;return this._type===m?this._components.slice():(w=g[this._type+"-"+m])?w.apply(this,this._components):g["rgb-"+m].apply(this,g[this._type+"-rgb"].apply(this,this._components))},convert:function(m){return new V0(m,this._convert(m),this._alpha)},getType:function(){return this._type},setType:function(m){this._components=this._convert(m),this._properties=i[m],this._type=m},getComponents:function(){var m=this._components.slice();if(this._alpha!=null)m.push(this._alpha);return m},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(m){this._alpha=m==null?null:Math.min(Math.max(m,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(m){var w=_.isPlainValue(m,!0)?V0.read(arguments):m;return w===this||w&&this._class===w._class&&this._type===w._type&&this.getAlpha()===w.getAlpha()&&_.equals(this._components,w._components)||!1},toString:function(){var m=this._properties,w=[],x=this._type==="gradient",d=d0.instance;for(var l=0,P=m.length;l<P;l++){var y=this._components[l];if(y!=null)w.push(m[l]+": "+(x?y:d.number(y)))}if(this._alpha!=null)w.push("alpha: "+d.number(this._alpha));return"{ "+w.join(", ")+" }"},toCSS:function(m){var w=this._convert("rgb"),x=m||this._alpha==null?1:this._alpha;function d(l){return Math.round((l<0?0:l>1?1:l)*255)}if(w=[d(w[0]),d(w[1]),d(w[2])],x<1)w.push(x<0?0:x);return m?"#"+((1<<24)+(w[0]<<16)+(w[1]<<8)+w[2]).toString(16).slice(1):(w.length==4?"rgba(":"rgb(")+w.join(",")+")"},toCanvasStyle:function(m,w){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var x=this._components,d=x[0],l=d._stops,P=x[1],y=x[2],b=x[3],z=w&&w.inverted(),B;if(z){if(P=z._transformPoint(P),y=z._transformPoint(y),b)b=z._transformPoint(b)}if(d._radial){var N=y.getDistance(P);if(b){var S=b.subtract(P);if(S.getLength()>N)b=P.add(S.normalize(N-0.1))}var s=b||P;B=m.createRadialGradient(s.x,s.y,0,P.x,P.y,N)}else B=m.createLinearGradient(P.x,P.y,y.x,y.y);for(var C=0,I=l.length;C<I;C++){var o=l[C],k=o._offset;B.addColorStop(k==null?C/(I-1):k,o._color.toCanvasStyle())}return this._canvasStyle=B},transform:function(m){if(this._type==="gradient"){var w=this._components;for(var x=1,d=w.length;x<d;x++){var l=w[x];m._transformPoint(l,l,!0)}this._changed()}},statics:{_types:i,random:function(){var m=Math.random;return new V0(m(),m(),m())},_setOwner:function(m,w,x){if(m){if(m._owner&&w&&m._owner!==w)m=m.clone();if(!m._owner^!w)m._owner=w||null,m._setter=x||null}return m}}})},new function(){var i={add:function(h,u){return h+u},subtract:function(h,u){return h-u},multiply:function(h,u){return h*u},divide:function(h,u){return h/u}};return _.each(i,function(h,u){this[u]=function(f){f=V0.read(arguments);var t=this._type,n=this._components,g=f._convert(t);for(var m=0,w=n.length;m<w;m++)g[m]=h(n[m],g[m]);return new V0(t,g,this._alpha!=null?h(this._alpha,f.getAlpha()):null)}},{})}),A6=_.extend({_class:"Gradient",initialize:function i(h,u){if(this._id=I0.get(),h&&_.isPlainObject(h))this.set(h),h=u=null;if(this._stops==null)this.setStops(h||["white","black"]);if(this._radial==null)this.setRadial(typeof u==="string"&&u==="radial"||u||!1)},_serialize:function(i,h){return h.add(this,function(){return _.serialize([this._stops,this._radial],i,!0,h)})},_changed:function(){for(var i=0,h=this._owners&&this._owners.length;i<h;i++)this._owners[i]._changed()},_addOwner:function(i){if(!this._owners)this._owners=[];this._owners.push(i)},_removeOwner:function(i){var h=this._owners?this._owners.indexOf(i):-1;if(h!=-1){if(this._owners.splice(h,1),!this._owners.length)this._owners=G}},clone:function(){var i=[];for(var h=0,u=this._stops.length;h<u;h++)i[h]=this._stops[h].clone();return new A6(i,this._radial)},getStops:function(){return this._stops},setStops:function(i){if(i.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var h=this._stops;if(h)for(var u=0,f=h.length;u<f;u++)h[u]._owner=G;h=this._stops=J6.readList(i,0,{clone:!0});for(var u=0,f=h.length;u<f;u++)h[u]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(i){this._radial=i,this._changed()},equals:function(i){if(i===this)return!0;if(i&&this._class===i._class){var h=this._stops,u=i._stops,f=h.length;if(f===u.length){for(var t=0;t<f;t++)if(!h[t].equals(u[t]))return!1;return!0}}return!1}}),J6=_.extend({_class:"GradientStop",initialize:function i(h,u){var f=h,t=u;if(typeof h==="object"&&u===G){if(Array.isArray(h)&&typeof h[0]!=="number")f=h[0],t=h[1];else if("color"in h||"offset"in h||"rampPoint"in h)f=h.color,t=h.offset||h.rampPoint||0}this.setColor(f),this.setOffset(t)},clone:function(){return new J6(this._color.clone(),this._offset)},_serialize:function(i,h){var u=this._color,f=this._offset;return _.serialize(f==null?[u]:[u,f],i,!0,h)},_changed:function(){if(this._owner)this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(i){this._offset=i,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){V0._setOwner(this._color,null),this._color=V0._setOwner(V0.read(arguments,0),this,"setColor"),this._changed()},equals:function(i){return i===this||i&&this._class===i._class&&this._color.equals(i._color)&&this._offset==i._offset||!1}}),Q6=_.extend(new function(){var i={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new a,selectedColor:null},h=_.set({},i,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),u=_.set({},h,{fillColor:new V0}),f={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},t={beans:!0},n={_class:"Style",beans:!0,initialize:function g(m,w,x){if(this._values={},this._owner=w,this._project=w&&w._project||x||j0.project,this._defaults=!w||w instanceof q0?h:w instanceof V6?u:i,m)this.set(m)}};return _.each(h,function(g,m){var w=/Color$/.test(m),x=m==="shadowOffset",d=_.capitalize(m),l=f[m],P="set"+d,y="get"+d;n[P]=function(b){var z=this._owner,B=z&&z._children,N=B&&B.length>0&&!(z instanceof f6);if(N)for(var S=0,s=B.length;S<s;S++)B[S]._style[P](b);if((m==="selectedColor"||!N)&&m in this._defaults){var C=this._values[m];if(C!==b){if(w){if(C)V0._setOwner(C,null),C._canvasStyle=null;if(b&&b.constructor===V0)b=V0._setOwner(b,z,N&&P)}if(this._values[m]=b,z)z._changed(l||129)}}},n[y]=function(b){var z=this._owner,B=z&&z._children,N=B&&B.length>0&&!(z instanceof f6),S;if(N&&!b)for(var s=0,C=B.length;s<C;s++){var I=B[s]._style[y]();if(!s)S=I;else if(!_.equals(S,I))return G}else if(m in this._defaults){var S=this._values[m];if(S===G){if(S=this._defaults[m],S&&S.clone)S=S.clone()}else{var o=w?V0:x?a:null;if(o&&!(S&&S.constructor===o))this._values[m]=S=o.read([S],0,{readNull:!0,clone:!0})}}if(S&&w)S=V0._setOwner(S,z,N&&P);return S},t[y]=function(b){return this._style[y](b)},t[P]=function(b){this._style[P](b)}}),_.each({Font:"FontFamily",WindingRule:"FillRule"},function(g,m){var w="get"+m,x="set"+m;n[w]=t[w]="#get"+g,n[x]=t[x]="#set"+g}),m0.inject(t),n},{set:function(i){var h=i instanceof Q6,u=h?i._values:i;if(u){for(var f in u)if(f in this._defaults){var t=u[f];this[f]=t&&h&&t.clone?t.clone():t}}},equals:function(i){function h(u,f,t){var n=u._values,g=f._values,m=f._defaults;for(var w in n){var x=n[w],d=g[w];if(!(t&&(w in g))&&!_.equals(x,d===G?m[w]:d))return!1}return!0}return i===this||i&&this._class===i._class&&h(this,i)&&h(i,this,!0)||!1},_dispose:function(){var i=this.getFillColor();if(i)i._canvasStyle=null;if(i=this.getStrokeColor(),i)i._canvasStyle=null;if(i=this.getShadowColor(),i)i._canvasStyle=null},hasFill:function(){var i=this.getFillColor();return!!i&&i.alpha>0},hasStroke:function(){var i=this.getStrokeColor();return!!i&&i.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var i=this.getShadowColor();return!!i&&i.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var i=this.getFontSize();return this.getFontWeight()+" "+i+(/[a-z]/i.test(i+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function i(){var h=i.base.call(this),u=this.getFontSize();if(/pt|em|%|px/.test(u))u=this.getView().getPixelSize(u);return h!=null?h:u*1.2}}),L0=new function(){function i(h,u,f,t){var n=["","webkit","moz","Moz","ms","o"],g=u[0].toUpperCase()+u.substring(1);for(var m=0;m<6;m++){var w=n[m],x=w?w+g:u;if(x in h){if(f)h[x]=t;else return h[x];break}}}return{getStyles:function(h){var u=h&&h.nodeType!==9?h.ownerDocument:h,f=u&&u.defaultView;return f&&f.getComputedStyle(h,"")},getBounds:function(h,u){var f=h.ownerDocument,t=f.body,n=f.documentElement,g;try{g=h.getBoundingClientRect()}catch(d){g={left:0,top:0,width:0,height:0}}var m=g.left-(n.clientLeft||t.clientLeft||0),w=g.top-(n.clientTop||t.clientTop||0);if(!u){var x=f.defaultView;m+=x.pageXOffset||n.scrollLeft||t.scrollLeft,w+=x.pageYOffset||n.scrollTop||t.scrollTop}return new u0(m,w,g.width,g.height)},getViewportBounds:function(h){var u=h.ownerDocument,f=u.defaultView,t=u.documentElement;return new u0(0,0,f.innerWidth||t.clientWidth,f.innerHeight||t.clientHeight)},getOffset:function(h,u){return L0.getBounds(h,u).getPoint()},getSize:function(h){return L0.getBounds(h,!0).getSize()},isInvisible:function(h){return L0.getSize(h).equals(new K(0,0))},isInView:function(h){return!L0.isInvisible(h)&&L0.getViewportBounds(h).intersects(L0.getBounds(h,!0))},isInserted:function(h){return F.body.contains(h)},getPrefixed:function(h,u){return h&&i(h,u)},setPrefixed:function(h,u,f){if(typeof u==="object")for(var t in u)i(h,t,!0,u[t]);else i(h,u,!0,f)}}},A0={add:function(i,h){if(i)for(var u in h){var f=h[u],t=u.split(/[\s,]+/g);for(var n=0,g=t.length;n<g;n++){var m=t[n],w=i===F&&(m==="touchstart"||m==="touchmove")?{passive:!1}:!1;i.addEventListener(m,f,w)}}},remove:function(i,h){if(i)for(var u in h){var f=h[u],t=u.split(/[\s,]+/g);for(var n=0,g=t.length;n<g;n++)i.removeEventListener(t[n],f,!1)}},getPoint:function(i){var h=i.targetTouches?i.targetTouches.length?i.targetTouches[0]:i.changedTouches[0]:i;return new a(h.pageX||h.clientX+F.documentElement.scrollLeft,h.pageY||h.clientY+F.documentElement.scrollTop)},getTarget:function(i){return i.target||i.srcElement},getRelatedTarget:function(i){return i.relatedTarget||i.toElement},getOffset:function(i,h){return A0.getPoint(i).subtract(L0.getOffset(h||A0.getTarget(i)))}};A0.requestAnimationFrame=new function(){var i=L0.getPrefixed(T,"requestAnimationFrame"),h=!1,u=[],f;function t(){var n=u;u=[];for(var g=0,m=n.length;g<m;g++)n[g]();if(h=i&&u.length,h)i(t)}return function(n){if(u.push(n),i){if(!h)i(t),h=!0}else if(!f)f=setInterval(t,16.666666666666668)}};var c0=_.extend($,{_class:"View",initialize:function i(h,u){function f(l){return u[l]||parseInt(u.getAttribute(l),10)}function t(){var l=L0.getSize(u);return l.isNaN()||l.isZero()?new K(f("width"),f("height")):l}var n;if(T&&u){if(this._id=u.getAttribute("id"),this._id==null)u.setAttribute("id",this._id="paper-view-"+i._id++);A0.add(u,this._viewEvents);var g="none";if(L0.setPrefixed(u.style,{userDrag:g,userSelect:g,touchCallout:g,contentZooming:g,tapHighlightColor:"rgba(0,0,0,0)"}),U.hasAttribute(u,"resize")){var m=this;A0.add(T,this._windowEvents={resize:function(){m.setViewSize(t())}})}if(n=t(),U.hasAttribute(u,"stats")&&typeof Stats!=="undefined"){this._stats=new Stats;var w=this._stats.domElement,x=w.style,d=L0.getOffset(u);x.position="absolute",x.left=d.x+"px",x.top=d.y+"px",F.body.appendChild(w)}}else n=new K(u),u=null;if(this._project=h,this._scope=h._scope,this._element=u,!this._pixelRatio)this._pixelRatio=T&&T.devicePixelRatio||1;if(this._setElementSize(n.width,n.height),this._viewSize=n,i._views.push(this),i._viewsById[this._id]=this,(this._matrix=new l0)._owner=this,!i._focused)i._focused=this;this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!j0.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;if(c0._focused===this)c0._focused=null;c0._views.splice(c0._views.indexOf(this),1),delete c0._viewsById[this._id];var i=this._project;if(i._view===this)i._view=null;return A0.remove(this._element,this._viewEvents),A0.remove(T,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:_.each(m0._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(i){this[i]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(i){if(this._autoUpdate=i,i)this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var i=this;A0.requestAnimationFrame(function(){if(i._requested=!1,i._animate){i.requestUpdate();var h=i._element;if((!L0.getPrefixed(F,"hidden")||U.getAttribute(h,"keepalive")==="true")&&L0.isInView(h))i._handleFrame()}if(i._autoUpdate)i.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){j0=this._scope;var i=Date.now()/1000,h=this._last?i-this._last:0;if(this._last=i,this.emit("frame",new _({delta:h,time:this._time+=h,count:this._count++})),this._stats)this._stats.update()},_animateItem:function(i,h){var u=this._frameItems;if(h){if(u[i._id]={item:i,time:0,count:0},++this._frameItemCount===1)this.on("frame",this._handleFrameItems)}else if(delete u[i._id],--this._frameItemCount===0)this.off("frame",this._handleFrameItems)},_handleFrameItems:function(i){for(var h in this._frameItems){var u=this._frameItems[h];u.item.emit("frame",new _(i,{time:u.time+=i.delta,count:u.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=G},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return this._pixelRatio*72},getViewSize:function(){var i=this._viewSize;return new h6(i.width,i.height,this,"setViewSize")},setViewSize:function(){var i=K.read(arguments),h=i.subtract(this._viewSize);if(h.isZero())return;if(this._setElementSize(i.width,i.height),this._viewSize.set(i),this._changed(),this.emit("resize",{size:i,delta:h}),this._autoUpdate)this.update()},_setElementSize:function(i,h){var u=this._element;if(u){if(u.width!==i)u.width=i;if(u.height!==h)u.height=h}},getBounds:function(){if(!this._bounds)this._bounds=this._matrix.inverted()._transformBounds(new u0(new a,this._viewSize));return this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return L0.isInView(this._element)},isInserted:function(){return L0.isInserted(this._element)},getPixelSize:function(i){var h=this._element,u;if(h){var f=h.parentNode,t=F.createElement("div");t.style.fontSize=i,f.appendChild(t),u=parseFloat(L0.getStyles(t).fontSize),f.removeChild(t)}else u=parseFloat(u);return u},getTextWidth:function(i,h){return 0}},_.each(["rotate","scale","shear","skew"],function(i){var h=i==="rotate";this[i]=function(){var u=arguments,f=(h?_:a).read(u),t=a.read(u,0,{readNull:!0});return this.transform(new l0()[i](f,t||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var i=new l0;return this.transform(i.translate.apply(i,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var i=a.read(arguments);this.translate(this.getCenter().subtract(i))},getZoom:function(){var i=this._decompose().scaling;return(i.x+i.y)/2},setZoom:function(i){this.transform(new l0().scale(i/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(i){var h=this.getRotation();if(h!=null&&i!=null)this.rotate(i-h)},getScaling:function(){var i=this._decompose().scaling;return new Q(i.x,i.y,this,"setScaling")},setScaling:function(){var i=this.getScaling(),h=a.read(arguments,0,{clone:!0,readNull:!0});if(i&&h)this.scale(h.x/i.x,h.y/i.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var i=this._matrix;i.set.apply(i,arguments)},transform:function(i){this._matrix.append(i)},scrollBy:function(){this.translate(a.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(a.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(a.read(arguments))},getEventPoint:function(i){return this.viewToProject(A0.getOffset(i,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(i,h){if(F&&typeof h==="string")h=F.getElementById(h);var u=T?k4:c0;return new u(i,h)}}},new function(){if(!T)return;var i,h,u=!1,f=!1;function t(q){var E=A0.getTarget(q);return E.getAttribute&&c0._viewsById[E.getAttribute("id")]}function n(){var q=c0._focused;if(!q||!q.isVisible()){for(var E=0,R=c0._views.length;E<R;E++)if((q=c0._views[E]).isVisible()){c0._focused=h=q;break}}}function g(q,E,R){q._handleMouseEvent("mousemove",E,R)}var m=T.navigator,w,x,d;if(m.pointerEnabled||m.msPointerEnabled)w="pointerdown MSPointerDown",x="pointermove MSPointerMove",d="pointerup pointercancel MSPointerUp MSPointerCancel";else if(w="touchstart",x="touchmove",d="touchend touchcancel",!(("ontouchstart"in T)&&m.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)))w+=" mousedown",x+=" mousemove",d+=" mouseup";var l={},P={mouseout:function(q){var E=c0._focused,R=A0.getRelatedTarget(q);if(E&&(!R||R.nodeName==="HTML")){var X=A0.getOffset(q,E._element),O=X.x,H=Math.abs,Y=H(O),W=1<<25,t0=Y-W;X.x=H(t0)<Y?t0*(O<0?-1:1):O,g(E,q,E.viewToProject(X))}},scroll:n};l[w]=function(q){var E=c0._focused=t(q);if(!u)u=!0,E._handleMouseEvent("mousedown",q)},P[x]=function(q){var E=c0._focused;if(!f){var R=t(q);if(R){if(E!==R){if(E)g(E,q);if(!i)i=E;E=c0._focused=h=R}}else if(h&&h===E){if(i&&!i.isInserted())i=null;E=c0._focused=i,i=null,n()}}if(E)g(E,q)},P[w]=function(){f=!0},P[d]=function(q){var E=c0._focused;if(E&&u)E._handleMouseEvent("mouseup",q);f=u=!1},A0.add(F,P),A0.add(T,{load:n});var y=!1,b=!1,z={doubleclick:"click",mousedrag:"mousemove"},B=!1,N,S,s,C,I,o,k,L,c;function D(q,E,R,X,O,H,Y){var W=!1,t0;function h0(g0,J){if(g0.responds(J)){if(!t0)t0=new c4(J,X,O,E||g0,H?O.subtract(H):null);if(g0.emit(J,t0)){if(y=!0,t0.prevented)b=!0;if(t0.stopped)return W=!0}}else{var p0=z[J];if(p0)return h0(g0,p0)}}while(q&&q!==Y){if(h0(q,R))break;q=q._parent}return W}function A(q,E,R,X,O,H){return q._project.removeOn(R),b=y=!1,o&&D(o,null,R,X,O,H)||E&&E!==o&&!E.isDescendant(o)&&D(E,null,R==="mousedrag"?"mousemove":R,X,O,H,o)||D(q,o||E||q,R,X,O,H)}var e={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:l,_handleMouseEvent:function(q,E,R){var X=this._itemEvents,O=X.native[q],H=q==="mousemove",Y=this._scope.tool,W=this;function t0(s0){return X.virtual[s0]||W.responds(s0)||Y&&Y.responds(s0)}if(H&&u&&t0("mousedrag"))q="mousedrag";if(!R)R=this.getEventPoint(E);var h0=this.getBounds().contains(R),g0=O&&h0&&W._project.hitTest(R,{tolerance:0,fill:!0,stroke:!0}),J=g0&&g0.item||null,p0=!1,f0={};if(f0[q.substr(5)]=!0,O&&J!==I){if(I)D(I,null,"mouseleave",E,R);if(J)D(J,null,"mouseenter",E,R);I=J}if(B^h0)D(this,null,h0?"mouseenter":"mouseleave",E,R),N=h0?this:null,p0=!0;if((h0||f0.drag)&&!R.equals(s))A(this,J,H?q:"mousemove",E,R,s),p0=!0;if(B=h0,f0.down&&h0||f0.up&&S){if(A(this,J,q,E,R,S),f0.down){if(c=J===k&&Date.now()-L<300,C=k=J,!b&&J){var N0=J;while(N0&&!N0.responds("mousedrag"))N0=N0._parent;if(N0)o=J}S=R}else if(f0.up){if(!b&&J===C)L=Date.now(),A(this,J,c?"doubleclick":"click",E,R,S),c=!1;C=o=null}B=!1,p0=!0}if(s=R,p0&&Y)y=Y._handleMouseEvent(q,E,R,f0)||y;if(E.cancelable!==!1&&(y&&!f0.move||f0.down&&t0("mouseup")))E.preventDefault()},_handleKeyEvent:function(q,E,R,X){var O=this._scope,H=O.tool,Y;function W(t0){if(t0.responds(q))j0=O,t0.emit(q,Y=Y||new L4(q,E,R,X))}if(this.isVisible()){if(W(this),H&&H.responds(q))W(H)}},_countItemEvent:function(q,E){var R=this._itemEvents,X=R.native,O=R.virtual;for(var H in e)X[H]=(X[H]||0)+(e[H][q]||0)*E;O[q]=(O[q]||0)+E},statics:{updateFocus:n,_resetState:function(){u=f=y=B=!1,i=h=N=S=s=C=I=o=k=L=c=null}}}}),k4=c0.extend({_class:"CanvasView",initialize:function i(h,u){if(!(u instanceof T.HTMLCanvasElement)){var f=K.read(arguments,1);if(f.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+_.slice(arguments,1));u=G0.getCanvas(f)}var t=this._context=u.getContext("2d");if(t.save(),this._pixelRatio=1,!/^off|false$/.test(U.getAttribute(u,"hidpi"))){var n=T.devicePixelRatio||1,g=L0.getPrefixed(t,"backingStorePixelRatio")||1;this._pixelRatio=n/g}c0.call(this,h,u),this._needsUpdate=!0},remove:function i(){return this._context.restore(),i.base.call(this)},_setElementSize:function i(h,u){var f=this._pixelRatio;if(i.base.call(this,h*f,u*f),f!==1){var t=this._element,n=this._context;if(!U.hasAttribute(t,"resize")){var g=t.style;g.width=h+"px",g.height=u+"px"}n.restore(),n.save(),n.scale(f,f)}},getContext:function(){return this._context},getPixelSize:function i(h){var u=j0.agent,f;if(u&&u.firefox)f=i.base.call(this,h);else{var t=this._context,n=t.font;t.font=h+" serif",f=parseFloat(t.font),t.font=n}return f},getTextWidth:function(i,h){var u=this._context,f=u.font,t=0;u.font=i;for(var n=0,g=h.length;n<g;n++)t=Math.max(t,u.measureText(h[n]).width);return u.font=f,t},update:function(){if(!this._needsUpdate)return!1;var i=this._project,h=this._context,u=this._viewSize;if(h.clearRect(0,0,u.width+1,u.height+1),i)i.draw(h,this._matrix,this._pixelRatio);return this._needsUpdate=!1,!0}}),E6=_.extend({_class:"Event",initialize:function i(h){this.event=h,this.type=h&&h.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return S8.modifiers}}),L4=E6.extend({_class:"KeyEvent",initialize:function i(h,u,f,t){this.type=h,this.event=u,this.key=f,this.character=t},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),S8=new function(){var i={"\t":"tab"," ":"space","\b":"backspace","\x7F":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},h={tab:"\t",space:" ",enter:"\r"},u={},f={},t,n,g=new _({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var x=j0&&j0.agent;return x&&x.mac?this.meta:this.control}}});function m(x){var d=x.key||x.keyIdentifier;return d=/^U\+/.test(d)?String.fromCharCode(parseInt(d.substr(2),16)):/^Arrow[A-Z]/.test(d)?d.substr(5):d==="Unidentified"||d===G?String.fromCharCode(x.keyCode):d,i[d]||(d.length>1?_.hyphenate(d):d.toLowerCase())}function w(x,d,l,P){var y=x?"keydown":"keyup",b=c0._focused,z;if(u[d]=x,x)f[d]=l;else delete f[d];if(d.length>1&&(z=_.camelize(d))in g){g[z]=x;var B=j0&&j0.agent;if(z==="meta"&&B&&B.mac)if(x)t={};else{for(var N in t)if(N in f)w(!1,N,t[N],P);t=null}}else if(x&&t)t[d]=l;if(b)b._handleKeyEvent(x?"keydown":"keyup",P,d,l)}return A0.add(F,{keydown:function(x){var d=m(x),l=j0&&j0.agent;if(d.length>1||l&&(l.chrome&&(x.altKey||l.mac&&x.metaKey||!l.mac&&x.ctrlKey)))w(!0,d,h[d]||(d.length>1?"":d),x);else n=d},keypress:function(x){if(n){var d=m(x),l=x.charCode,P=l>=32?String.fromCharCode(l):d.length>1?"":d;if(d!==n)d=P.toLowerCase();w(!0,d,P,x),n=null}},keyup:function(x){var d=m(x);if(d in f)w(!1,d,f[d],x)}}),A0.add(T,{blur:function(x){for(var d in f)w(!1,d,f[d],x)}}),{modifiers:g,isDown:function(x){return!!u[x]}}},c4=E6.extend({_class:"MouseEvent",initialize:function i(h,u,f,t,n){this.type=h,this.event=u,this.point=f,this.target=t,this.delta=n},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),M4=E6.extend({_class:"ToolEvent",_item:null,initialize:function i(h,u,f){this.tool=h,this.type=u,this.event=f},_choosePoint:function(i,h){return i?i:h?h.clone():null},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(i){this._point=i},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(i){this._lastPoint=i},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(i){this._downPoint=i},getMiddlePoint:function(){if(!this._middlePoint&&this.tool._lastPoint)return this.tool._point.add(this.tool._lastPoint).divide(2);return this._middlePoint},setMiddlePoint:function(i){this._middlePoint=i},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(i){this._delta=i},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(i){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=i},getItem:function(){if(!this._item){var i=this.tool._scope.project.hitTest(this.getPoint());if(i){var h=i.item,u=h._parent;while(/^(Group|CompoundPath)$/.test(u._class))h=u,u=u._parent;this._item=h}}return this._item},setItem:function(i){this._item=i},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),j7=S0.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function i(h){S0.call(this),this._moveCount=-1,this._downCount=-1,this.set(h)},getMinDistance:function(){return this._minDistance},setMinDistance:function(i){if(this._minDistance=i,i!=null&&this._maxDistance!=null&&i>this._maxDistance)this._maxDistance=i},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(i){if(this._maxDistance=i,this._minDistance!=null&&i!=null&&i<this._minDistance)this._minDistance=i},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(i){this._minDistance=this._maxDistance=i},_handleMouseEvent:function(i,h,u,f){if(j0=this._scope,f.drag&&!this.responds(i))i="mousemove";var t=f.move||f.drag,n=this.responds(i),g=this.minDistance,m=this.maxDistance,w=!1,x=this;function d(P,y){var b=u,z=t?x._point:x._downPoint||b;if(t){if(x._moveCount>=0&&b.equals(z))return!1;if(z&&(P!=null||y!=null)){var B=b.subtract(z),N=B.getLength();if(N<(P||0))return!1;if(y)b=z.add(B.normalize(Math.min(N,y)))}x._moveCount++}if(x._point=b,x._lastPoint=z||b,f.down)x._moveCount=-1,x._downPoint=b,x._downCount++;return!0}function l(){if(n)w=x.emit(i,new M4(x,i,h))||w}if(f.down)d(),l();else if(f.up)d(null,m),l();else if(n)while(d(g,m))l();return w}}),D4=_.extend($,{_class:"Tween",statics:{easings:new _({linear:function(i){return i},easeInQuad:function(i){return i*i},easeOutQuad:function(i){return i*(2-i)},easeInOutQuad:function(i){return i<0.5?2*i*i:-1+2*(2-i)*i},easeInCubic:function(i){return i*i*i},easeOutCubic:function(i){return--i*i*i+1},easeInOutCubic:function(i){return i<0.5?4*i*i*i:(i-1)*(2*i-2)*(2*i-2)+1},easeInQuart:function(i){return i*i*i*i},easeOutQuart:function(i){return 1- --i*i*i*i},easeInOutQuart:function(i){return i<0.5?8*i*i*i*i:1-8*--i*i*i*i},easeInQuint:function(i){return i*i*i*i*i},easeOutQuint:function(i){return 1+--i*i*i*i*i},easeInOutQuint:function(i){return i<0.5?16*i*i*i*i*i:1+16*--i*i*i*i*i}})},initialize:function i(h,u,f,t,n,g){this.object=h;var m=typeof n,w=m==="function";this.type=w?m:m==="string"?n:"linear",this.easing=w?n:i.easings[this.type],this.duration=t,this.running=!1,this._then=null,this._startTime=null;var x=u||f;if(this._keys=x?Object.keys(x):[],this._parsedKeys=this._parseKeys(this._keys),this._from=x&&this._getState(u),this._to=x&&this._getState(f),g!==!1)this.start()},then:function(i){return this._then=i,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(i){if(this.running){if(i>=1)i=1,this.running=!1;var h=this.easing(i),u=this._keys,f=function(d){return typeof d==="function"?d(h,i):d};for(var t=0,n=u&&u.length;t<n;t++){var g=u[t],m=f(this._from[g]),w=f(this._to[g]),x=m&&w&&m.__add&&w.__add?w.__subtract(m).__multiply(h).__add(m):(w-m)*h+m;this._setProperty(this._parsedKeys[g],x)}if(this.responds("update"))this.emit("update",new _({progress:i,factor:h}));if(!this.running&&this._then)this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(i){var h=this._startTime,u=h?(i-h)/this.duration:0;if(!h)this._startTime=i;this.update(u)},_getState:function(i){var h=this._keys,u={};for(var f=0,t=h.length;f<t;f++){var n=h[f],g=this._parsedKeys[n],m=this._getProperty(g),w;if(i){var x=this._resolveValue(m,i[n]);this._setProperty(g,x),w=this._getProperty(g),w=w&&w.clone?w.clone():w,this._setProperty(g,m)}else w=m&&m.clone?m.clone():m;u[n]=w}return u},_resolveValue:function(i,h){if(h){if(Array.isArray(h)&&h.length===2){var u=h[0];return u&&u.match&&u.match(/^[+\-\*\/]=/)?this._calculate(i,u[0],h[1]):h}else if(typeof h==="string"){var f=h.match(/^[+\-*/]=(.*)/);if(f){var t=JSON.parse(f[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(i,h[0],t)}}}return h},_calculate:function(i,h,u){return j0.PaperScript.calculateBinary(i,h,u)},_parseKeys:function(i){var h={};for(var u=0,f=i.length;u<f;u++){var t=i[u],n=t.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");h[t]=n.split("/")}return h},_getProperty:function(i,h){var u=this.object;for(var f=0,t=i.length-(h||0);f<t&&u;f++)u=u[i[f]];return u},_setProperty:function(i,h){var u=this._getProperty(i,1);if(u)u[i[i.length-1]]=h}}),G4={request:function(i){var h=new V.XMLHttpRequest;if(h.open((i.method||"get").toUpperCase(),i.url,_.pick(i.async,!0)),i.mimeType)h.overrideMimeType(i.mimeType);return h.onload=function(){var u=h.status;if(u===0||u===200){if(i.onLoad)i.onLoad.call(h,h.responseText)}else h.onerror()},h.onerror=function(){var u=h.status,f='Could not load "'+i.url+'" (Status: '+u+")";if(i.onError)i.onError(f,u);else throw new Error(f)},h.send(null)}},G0=_.exports.CanvasProvider={canvases:[],getCanvas:function(i,h,u){if(!T)return null;var f,t=!0;if(typeof i==="object")h=i.height,i=i.width;if(this.canvases.length)f=this.canvases.pop();else f=F.createElement("canvas"),t=!1;var n=f.getContext("2d",u||{});if(!n)throw new Error("Canvas "+f+" is unable to provide a 2D context.");if(f.width===i&&f.height===h){if(t)n.clearRect(0,0,i+1,h+1)}else f.width=i,f.height=h;return n.save(),f},getContext:function(i,h,u){var f=this.getCanvas(i,h,u);return f?f.getContext("2d",u||{}):null},release:function(i){var h=i&&i.canvas?i.canvas:i;if(h&&h.getContext)h.getContext("2d").restore(),this.canvases.push(h)}},$6=new function(){var{min:i,max:h,abs:u}=Math,f,t,n,g,m,w,x,d,l,P,y;function b(I,o,k){return 0.2989*I+0.587*o+0.114*k}function z(I,o,k,D){var c=D-b(I,o,k);l=I+c,P=o+c,y=k+c;var D=b(l,P,y),A=i(l,P,y),e=h(l,P,y);if(A<0){var q=D-A;l=D+(l-D)*D/q,P=D+(P-D)*D/q,y=D+(y-D)*D/q}if(e>255){var E=255-D,R=e-D;l=D+(l-D)*E/R,P=D+(P-D)*E/R,y=D+(y-D)*E/R}}function B(I,o,k){return h(I,o,k)-i(I,o,k)}function N(I,o,k,L){var c=[I,o,k],D=h(I,o,k),A=i(I,o,k),e;if(A=A===I?0:A===o?1:2,D=D===I?0:D===o?1:2,e=i(A,D)===0?h(A,D)===1?2:1:0,c[D]>c[A])c[e]=(c[e]-c[A])*L/(c[D]-c[A]),c[D]=L;else c[e]=c[D]=0;c[A]=0,l=c[0],P=c[1],y=c[2]}var S={multiply:function(){l=m*f/255,P=w*t/255,y=x*n/255},screen:function(){l=m+f-m*f/255,P=w+t-w*t/255,y=x+n-x*n/255},overlay:function(){l=m<128?2*m*f/255:255-2*(255-m)*(255-f)/255,P=w<128?2*w*t/255:255-2*(255-w)*(255-t)/255,y=x<128?2*x*n/255:255-2*(255-x)*(255-n)/255},"soft-light":function(){var I=f*m/255;l=I+m*(255-(255-m)*(255-f)/255-I)/255,I=t*w/255,P=I+w*(255-(255-w)*(255-t)/255-I)/255,I=n*x/255,y=I+x*(255-(255-x)*(255-n)/255-I)/255},"hard-light":function(){l=f<128?2*f*m/255:255-2*(255-f)*(255-m)/255,P=t<128?2*t*w/255:255-2*(255-t)*(255-w)/255,y=n<128?2*n*x/255:255-2*(255-n)*(255-x)/255},"color-dodge":function(){l=m===0?0:f===255?255:i(255,255*m/(255-f)),P=w===0?0:t===255?255:i(255,255*w/(255-t)),y=x===0?0:n===255?255:i(255,255*x/(255-n))},"color-burn":function(){l=m===255?255:f===0?0:h(0,255-(255-m)*255/f),P=w===255?255:t===0?0:h(0,255-(255-w)*255/t),y=x===255?255:n===0?0:h(0,255-(255-x)*255/n)},darken:function(){l=m<f?m:f,P=w<t?w:t,y=x<n?x:n},lighten:function(){l=m>f?m:f,P=w>t?w:t,y=x>n?x:n},difference:function(){if(l=m-f,l<0)l=-l;if(P=w-t,P<0)P=-P;if(y=x-n,y<0)y=-y},exclusion:function(){l=m+f*(255-m-m)/255,P=w+t*(255-w-w)/255,y=x+n*(255-x-x)/255},hue:function(){N(f,t,n,B(m,w,x)),z(l,P,y,b(m,w,x))},saturation:function(){N(m,w,x,B(f,t,n)),z(l,P,y,b(m,w,x))},luminosity:function(){z(m,w,x,b(f,t,n))},color:function(){z(f,t,n,b(m,w,x))},add:function(){l=i(m+f,255),P=i(w+t,255),y=i(x+n,255)},subtract:function(){l=h(m-f,0),P=h(w-t,0),y=h(x-n,0)},average:function(){l=(m+f)/2,P=(w+t)/2,y=(x+n)/2},negation:function(){l=255-u(255-f-m),P=255-u(255-t-w),y=255-u(255-n-x)}},s=this.nativeModes=_.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(I){this[I]=!0},{}),C=G0.getContext(1,1,{willReadFrequently:!0});if(C)_.each(S,function(I,o){var k=o==="darken",L=!1;C.save();try{if(C.fillStyle=k?"#300":"#a00",C.fillRect(0,0,1,1),C.globalCompositeOperation=o,C.globalCompositeOperation===o)C.fillStyle=k?"#a00":"#300",C.fillRect(0,0,1,1),L=C.getImageData(0,0,1,1).data[0]!==k?170:51}catch(c){}C.restore(),s[o]=L}),G0.release(C);this.process=function(I,o,k,L,c){var D=o.canvas,A=I==="normal";if(A||s[I]){if(k.save(),k.setTransform(1,0,0,1,0,0),k.globalAlpha=L,!A)k.globalCompositeOperation=I;k.drawImage(D,c.x,c.y),k.restore()}else{var e=S[I];if(!e)return;var q=k.getImageData(c.x,c.y,D.width,D.height),E=q.data,R=o.getImageData(0,0,D.width,D.height).data;for(var X=0,O=E.length;X<O;X+=4){f=R[X],m=E[X],t=R[X+1],w=E[X+1],n=R[X+2],x=E[X+2],g=R[X+3],d=E[X+3],e();var H=g*L/255,Y=1-H;E[X]=H*l+Y*m,E[X+1]=H*P+Y*w,E[X+2]=H*y+Y*x,E[X+3]=g*L+Y*d}k.putImageData(q,c.x,c.y)}}},M0=new function(){var i="http://www.w3.org/2000/svg",h="http://www.w3.org/2000/xmlns",u="http://www.w3.org/1999/xlink",f={href:u,xlink:h,xmlns:h+"/","xmlns:xlink":h+"/"};function t(m,w,x){return g(F.createElementNS(i,m),w,x)}function n(m,w){var x=f[w],d=x?m.getAttributeNS(x,w):m.getAttribute(w);return d==="null"?null:d}function g(m,w,x){for(var d in w){var l=w[d],P=f[d];if(typeof l==="number"&&x)l=x.number(l);if(P)m.setAttributeNS(P,d,l);else m.setAttribute(d,l)}return m}return{svg:i,xmlns:h,xlink:u,create:t,get:n,set:g}},I8=_.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(i,h){return!h&&(i instanceof I6||i instanceof K0||i instanceof V6)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(i,h){var u=_.capitalize(h),f=i[2];this[h]={type:i[1],property:h,attribute:i[0],toSVG:f,fromSVG:f&&_.each(f,function(t,n){this[t]=n},{}),exportFilter:i[3],get:"get"+u,set:"set"+u}},{});new function(){var i;function h(S,s,C){var I=new _,o=S.getTranslation();if(s){var k;if(S.isInvertible())S=S._shiftless(),k=S._inverseTransform(o),o=null;else k=new a;I[C?"cx":"x"]=k.x,I[C?"cy":"y"]=k.y}if(!S.isIdentity()){var L=S.decompose();if(L){var c=[],D=L.rotation,A=L.scaling,e=L.skewing;if(o&&!o.isZero())c.push("translate("+i.point(o)+")");if(D)c.push("rotate("+i.number(D)+")");if(!i0.isZero(A.x-1)||!i0.isZero(A.y-1))c.push("scale("+i.point(A)+")");if(e.x)c.push("skewX("+i.number(e.x)+")");if(e.y)c.push("skewY("+i.number(e.y)+")");I.transform=c.join(" ")}else I.transform="matrix("+S.getValues().join(",")+")"}return I}function u(S,s){var C=h(S._matrix),I=S._children,o=M0.create("g",C,i);for(var k=0,L=I.length;k<L;k++){var c=I[k],D=B(c,s);if(D)if(c.isClipMask()){var A=M0.create("clipPath");A.appendChild(D),b(c,A,"clip"),M0.set(o,{"clip-path":"url(#"+A.id+")"})}else o.appendChild(D)}return o}function f(S,s){var C=h(S._matrix,!0),I=S.getSize(),o=S.getImage();return C.x-=I.width/2,C.y-=I.height/2,C.width=I.width,C.height=I.height,C.href=s.embedImages==!1&&o&&o.src||S.toDataURL(),M0.create("image",C,i)}function t(S,s){var C=s.matchShapes;if(C){var I=S.toShape(!1);if(I)return n(I,s)}var o=S._segments,k=o.length,L,c=h(S._matrix);if(C&&k>=2&&!S.hasHandles())if(k>2){L=S._closed?"polygon":"polyline";var D=[];for(var A=0;A<k;A++)D.push(i.point(o[A]._point));c.points=D.join(" ")}else{L="line";var e=o[0]._point,q=o[1]._point;c.set({x1:e.x,y1:e.y,x2:q.x,y2:q.y})}else L="path",c.d=S.getPathData(null,s.precision);return M0.create(L,c,i)}function n(S){var{_type:s,_radius:C}=S,I=h(S._matrix,!0,s!=="rectangle");if(s==="rectangle"){s="rect";var o=S._size,k=o.width,L=o.height;if(I.x-=k/2,I.y-=L/2,I.width=k,I.height=L,C.isZero())C=null}if(C)if(s==="circle")I.r=C;else I.rx=C.width,I.ry=C.height;return M0.create(s,I,i)}function g(S,s){var C=h(S._matrix),I=S.getPathData(null,s.precision);if(I)C.d=I;return M0.create("path",C,i)}function m(S,s){var C=h(S._matrix,!0),I=S._definition,o=y(I,"symbol"),k=I._item,L=k.getStrokeBounds();if(!o)o=M0.create("symbol",{viewBox:i.rectangle(L)}),o.appendChild(B(k,s)),b(I,o,"symbol");return C.href="#"+o.id,C.x+=L.x,C.y+=L.y,C.width=L.width,C.height=L.height,C.overflow="visible",M0.create("use",C,i)}function w(S){var s=y(S,"color");if(!s){var C=S.getGradient(),I=C._radial,o=S.getOrigin(),k=S.getDestination(),L;if(I){L={cx:o.x,cy:o.y,r:o.getDistance(k)};var c=S.getHighlight();if(c)L.fx=c.x,L.fy=c.y}else L={x1:o.x,y1:o.y,x2:k.x,y2:k.y};L.gradientUnits="userSpaceOnUse",s=M0.create((I?"radial":"linear")+"Gradient",L,i);var D=C._stops;for(var A=0,e=D.length;A<e;A++){var q=D[A],E=q._color,R=E.getAlpha(),X=q._offset;if(L={offset:X==null?A/(e-1):X},E)L["stop-color"]=E.toCSS(!0);if(R<1)L["stop-opacity"]=R;s.appendChild(M0.create("stop",L,i))}b(S,s,"color")}return"url(#"+s.id+")"}function x(S){var s=M0.create("text",h(S._matrix,!0),i);return s.textContent=S._content,s}var d={Group:u,Layer:u,Raster:f,Path:t,Shape:n,CompoundPath:g,SymbolItem:m,PointText:x};function l(S,s,C){var I={},o=!C&&S.getParent(),k=[];if(S._name!=null)I.id=S._name;if(_.each(I8,function(L){var{get:c,type:D}=L,A=S[c]();if(L.exportFilter?L.exportFilter(S,A):!o||!_.equals(o[c](),A)){if(D==="color"&&A!=null){var e=A.getAlpha();if(e<1)I[L.attribute+"-opacity"]=e}if(D==="style")k.push(L.attribute+": "+A);else I[L.attribute]=A==null?"none":D==="color"?A.gradient?w(A,S):A.toCSS(!0):D==="array"?A.join(","):D==="lookup"?L.toSVG[A]:A}}),k.length)I.style=k.join(";");if(I.opacity===1)delete I.opacity;if(!S._visible)I.visibility="hidden";return M0.set(s,I,i)}var P;function y(S,s){if(!P)P={ids:{},svgs:{}};return S&&P.svgs[s+"-"+(S._id||S.__id||(S.__id=I0.get("svg")))]}function b(S,s,C){if(!P)y();var I=P.ids[C]=(P.ids[C]||0)+1;s.id=C+"-"+I,P.svgs[C+"-"+(S._id||S.__id)]=s}function z(S,s){var C=S,I=null;if(P){C=S.nodeName.toLowerCase()==="svg"&&S;for(var o in P.svgs){if(!I){if(!C)C=M0.create("svg"),C.appendChild(S);I=C.insertBefore(M0.create("defs"),C.firstChild)}I.appendChild(P.svgs[o])}P=null}return s.asString?new V.XMLSerializer().serializeToString(C):C}function B(S,s,C){var I=d[S._class],o=I&&I(S,s);if(o){var k=s.onExport;if(k)o=k(S,o,s)||o;var L=JSON.stringify(S._data);if(L&&L!=="{}"&&L!=="null")o.setAttribute("data-paper-data",L)}return o&&l(S,o,C)}function N(S){if(!S)S={};return i=new d0(S.precision),S}m0.inject({exportSVG:function(S){return S=N(S),z(B(this,S,!0),S)}}),g6.inject({exportSVG:function(S){S=N(S);var s=this._children,C=this.getView(),I=_.pick(S.bounds,"view"),o=S.matrix||I==="view"&&C._matrix,k=o&&l0.read([o]),L=I==="view"?new u0([0,0],C.getViewSize()):I==="content"?m0._getBounds(s,k,{stroke:!0}).rect:u0.read([I],0,{readNull:!0}),c={version:"1.1",xmlns:M0.svg,"xmlns:xlink":M0.xlink};if(L){if(c.width=L.width,c.height=L.height,L.x||L.x===0||L.y||L.y===0)c.viewBox=i.rectangle(L)}var D=M0.create("svg",c,i),A=D;if(k&&!k.isIdentity())A=D.appendChild(M0.create("g",h(k),i));for(var e=0,q=s.length;e<q;e++)A.appendChild(B(s[e],S,!0));return z(D,S)}})},new function(){var i={},h;function u(s,C,I,o,k,L){var c=M0.get(s,C)||L,D=c==null?o?null:I?"":0:I?c:parseFloat(c);return/%\s*$/.test(c)?D/100*(k?1:h[/x|^width/.test(C)?"width":"height"]):D}function f(s,C,I,o,k,L,c){return C=u(s,C||"x",!1,o,k,L),I=u(s,I||"y",!1,o,k,c),o&&(C==null||I==null)?null:new a(C,I)}function t(s,C,I,o,k){return C=u(s,C||"width",!1,o,k),I=u(s,I||"height",!1,o,k),o&&(C==null||I==null)?null:new K(C,I)}function n(s,C,I){return s==="none"?null:C==="number"?parseFloat(s):C==="array"?s?s.split(/[\s,]+/g).map(parseFloat):[]:C==="color"?B(s)||s:C==="lookup"?I[s]:s}function g(s,C,I,o){var k=s.childNodes,L=C==="clippath",c=C==="defs",D=new q0,A=D._project,e=A._currentStyle,q=[];if(!L&&!c)D=z(D,s,o),A._currentStyle=D._style.clone();if(o){var E=s.querySelectorAll("defs");for(var R=0,X=E.length;R<X;R++)N(E[R],I,!1)}for(var R=0,X=k.length;R<X;R++){var O=k[R],H;if(O.nodeType===1&&!/^defs$/i.test(O.nodeName)&&(H=N(O,I,!1))&&!(H instanceof s6))q.push(H)}if(D.addChildren(q),L)D=z(D.reduce(),s,o);if(A._currentStyle=e,L||c)D.remove(),D=null;return D}function m(s,C){var I=s.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),o=[];for(var k=0,L=I.length;k<L;k+=2)o.push(new a(parseFloat(I[k]),parseFloat(I[k+1])));var c=new b0(o);if(C==="polygon")c.closePath();return c}function w(s){return I6.create(s.getAttribute("d"))}function x(s,C){var I=(u(s,"href",!0)||"").substring(1),o=C==="radialgradient",k;if(I){if(k=i[I].getGradient(),k._radial^o)k=k.clone(),k._radial=o}else{var L=s.childNodes,c=[];for(var D=0,A=L.length;D<A;D++){var e=L[D];if(e.nodeType===1)c.push(z(new J6,e))}k=new A6(c,o)}var q,E,R,X=u(s,"gradientUnits",!0)!=="userSpaceOnUse";if(o)q=f(s,"cx","cy",!1,X,"50%","50%"),E=q.add(u(s,"r",!1,!1,X,"50%"),0),R=f(s,"fx","fy",!0,X);else q=f(s,"x1","y1",!1,X,"0%","0%"),E=f(s,"x2","y2",!1,X,"100%","0%");var O=z(new V0(k,q,E,R),s);return O._scaleToBounds=X,null}var d={"#document":function(s,C,I,o){var k=s.childNodes;for(var L=0,c=k.length;L<c;L++){var D=k[L];if(D.nodeType===1)return N(D,I,o)}},g,svg:g,clippath:g,polygon:m,polyline:m,path:w,lineargradient:x,radialgradient:x,image:function(s){var C=new k6(u(s,"href",!0));return C.on("load",function(){var I=t(s);this.setSize(I);var o=f(s).add(I.divide(2));this._matrix.append(new l0().translate(o))}),C},symbol:function(s,C,I,o){return new s6(g(s,C,I,o),!0)},defs:g,use:function(s){var C=(u(s,"href",!0)||"").substring(1),I=i[C],o=f(s);return I?I instanceof s6?I.place(o):I.clone().translate(o):null},circle:function(s){return new K0.Circle(f(s,"cx","cy"),u(s,"r"))},ellipse:function(s){return new K0.Ellipse({center:f(s,"cx","cy"),radius:t(s,"rx","ry")})},rect:function(s){return new K0.Rectangle(new u0(f(s),t(s)),t(s,"rx","ry"))},line:function(s){return new b0.Line(f(s,"x1","y1"),f(s,"x2","y2"))},text:function(s){var C=new _4(f(s).add(f(s,"dx","dy")));return C.setContent(s.textContent.trim()||""),C},switch:g};function l(s,C,I,o){if(s.transform){var k=(o.getAttribute(I)||"").split(/\)\s*/g),L=new l0;for(var c=0,D=k.length;c<D;c++){var A=k[c];if(!A)break;var e=A.split(/\(\s*/),q=e[0],E=e[1].split(/[\s,]+/g);for(var R=0,X=E.length;R<X;R++)E[R]=parseFloat(E[R]);switch(q){case"matrix":L.append(new l0(E[0],E[1],E[2],E[3],E[4],E[5]));break;case"rotate":L.rotate(E[0],E[1]||0,E[2]||0);break;case"translate":L.translate(E[0],E[1]||0);break;case"scale":L.scale(E);break;case"skewX":L.skew(E[0],0);break;case"skewY":L.skew(0,E[0]);break}}s.transform(L)}}function P(s,C,I){var o=I==="fill-opacity"?"getFillColor":"getStrokeColor",k=s[o]&&s[o]();if(k)k.setAlpha(parseFloat(C))}var y=_.set(_.each(I8,function(s){this[s.attribute]=function(C,I){if(C[s.set]){if(C[s.set](n(I,s.type,s.fromSVG)),s.type==="color"){var o=C[s.get]();if(o){if(o._scaleToBounds){var k=C.getBounds();o.transform(new l0().translate(k.getPoint()).scale(k.getSize()))}}}}}},{}),{id:function(s,C){if(i[C]=s,s.setName)s.setName(C)},"clip-path":function(s,C){var I=B(C);if(I)if(I=I.clone(),I.setClipMask(!0),s instanceof q0)s.insertChild(0,I);else return new q0(I,s)},gradientTransform:l,transform:l,"fill-opacity":P,"stroke-opacity":P,visibility:function(s,C){if(s.setVisible)s.setVisible(C==="visible")},display:function(s,C){if(s.setVisible)s.setVisible(C!==null)},"stop-color":function(s,C){if(s.setColor)s.setColor(C)},"stop-opacity":function(s,C){if(s._color)s._color.setAlpha(parseFloat(C))},offset:function(s,C){if(s.setOffset){var I=C.match(/(.*)%$/);s.setOffset(I?I[1]/100:parseFloat(C))}},viewBox:function(s,C,I,o,k){var L=new u0(n(C,"array")),c=t(o,null,null,!0),D,A;if(s instanceof q0){var e=c?c.divide(L.getSize()):1,A=new l0().scale(e).translate(L.getPoint().negate());D=s}else if(s instanceof s6){if(c)L.setSize(c);D=s._item}if(D){if(b(o,"overflow",k)!=="visible"){var q=new K0.Rectangle(L);q.setClipMask(!0),D.addChild(q)}if(A)D.transform(A)}}});function b(s,C,I){var o=s.attributes[C],k=o&&o.value;if(!k&&s.style){var L=_.camelize(C);if(k=s.style[L],!k&&I.node[L]!==I.parent[L])k=I.node[L]}return!k?G:k==="none"?null:k}function z(s,C,I){var o=C.parentNode,k={node:L0.getStyles(C)||{},parent:!I&&!/^defs$/i.test(o.tagName)&&L0.getStyles(o)||{}};return _.each(y,function(L,c){var D=b(C,c,k);s=D!==G&&L(s,D,c,C,k)||s}),s}function B(s){var C=s&&s.match(/\((?:["'#]*)([^"')]+)/),I=C&&C[1],o=I&&i[T?I.replace(T.location.href.split("#")[0]+"#",""):I];if(o&&o._scaleToBounds)o=o.clone(),o._scaleToBounds=!0;return o}function N(s,C,I){var o=s.nodeName.toLowerCase(),k=o!=="#document",L=F.body,c,D,A;if(I&&k)h=j0.getView().getSize(),h=t(s,null,null,!0)||h,c=M0.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),D=s.parentNode,A=s.nextSibling,c.appendChild(s),L.appendChild(c);var e=j0.settings,q=e.applyMatrix,E=e.insertItems;e.applyMatrix=!1,e.insertItems=!1;var R=d[o],X=R&&R(s,o,C,I)||null;if(e.insertItems=E,e.applyMatrix=q,X){if(k&&!(X instanceof q0))X=z(X,s,I);var O=C.onImport,H=k&&s.getAttribute("data-paper-data");if(O)X=O(s,X,C)||X;if(C.expandShapes&&X instanceof K0)X.remove(),X=X.toPath();if(H)X._data=JSON.parse(H)}if(c){if(L.removeChild(c),D)if(A)D.insertBefore(s,A);else D.appendChild(s)}if(I){if(i={},X&&_.pick(C.applyMatrix,q))X.matrix.apply(!0,!0)}return X}function S(s,C,I){if(!s)return null;C=typeof C==="function"?{onLoad:C}:C||{};var o=j0,k=null;function L(e){try{var q=typeof e==="object"?e:new V.DOMParser().parseFromString(e.trim(),"image/svg+xml");if(!q.nodeName)throw q=null,new Error("Unsupported SVG source: "+s);if(j0=o,k=N(q,C,!0),!C||C.insert!==!1)I._insertItem(G,k);var E=C.onLoad;if(E)E(k,e)}catch(R){c(R)}}function c(e,q){var E=C.onError;if(E)E(e,q);else throw new Error(e)}if(typeof s==="string"&&!/^[\s\S]*</.test(s)){var D=F.getElementById(s);if(D)L(D);else G4.request({url:s,async:!0,onLoad:L,onError:c})}else if(typeof File!=="undefined"&&s instanceof File){var A=new FileReader;return A.onload=function(){L(A.result)},A.onerror=function(){c(A.error)},A.readAsText(s)}else L(s);return k}m0.inject({importSVG:function(s,C){return S(s,C,this)}}),g6.inject({importSVG:function(s,C){return this.activate(),S(s,C,this)}})};var j0=new(U.inject(_.exports,{Base:_,Numerical:i0,Key:S8,DomEvent:A0,DomElement:L0,document:F,window:T,Symbol:s6,PlacedSymbol:K6}));if(j0.agent.node)(()=>({}))(j0);if(typeof define==="function"&&define.amd)define("paper",j0);else if(typeof p==="object"&&p)p.exports=j0;return j0}.call(v,typeof self==="object"?self:null)}),l5=O8(T8(),1),g8=O8(T8(),1),j=new Q0.Generator("JavaScript");j.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(globalThis).join(","));j.ORDER_ATOMIC=0;j.ORDER_NEW=1.1;j.ORDER_MEMBER=1.2;j.ORDER_FUNCTION_CALL=2;j.ORDER_INCREMENT=3;j.ORDER_DECREMENT=3;j.ORDER_BITWISE_NOT=4.1;j.ORDER_UNARY_PLUS=4.2;j.ORDER_UNARY_NEGATION=4.3;j.ORDER_LOGICAL_NOT=4.4;j.ORDER_TYPEOF=4.5;j.ORDER_VOID=4.6;j.ORDER_DELETE=4.7;j.ORDER_DIVISION=5.1;j.ORDER_MULTIPLICATION=5.2;j.ORDER_MODULUS=5.3;j.ORDER_SUBTRACTION=6.1;j.ORDER_ADDITION=6.2;j.ORDER_BITWISE_SHIFT=7;j.ORDER_RELATIONAL=8;j.ORDER_IN=8;j.ORDER_INSTANCEOF=8;j.ORDER_EQUALITY=9;j.ORDER_BITWISE_AND=10;j.ORDER_BITWISE_XOR=11;j.ORDER_BITWISE_OR=12;j.ORDER_LOGICAL_AND=13;j.ORDER_LOGICAL_OR=14;j.ORDER_CONDITIONAL=15;j.ORDER_ASSIGNMENT=16;j.ORDER_COMMA=17;j.ORDER_NONE=99;j.ORDER_OVERRIDES=[[j.ORDER_FUNCTION_CALL,j.ORDER_MEMBER],[j.ORDER_FUNCTION_CALL,j.ORDER_FUNCTION_CALL],[j.ORDER_MEMBER,j.ORDER_MEMBER],[j.ORDER_MEMBER,j.ORDER_FUNCTION_CALL],[j.ORDER_LOGICAL_NOT,j.ORDER_LOGICAL_NOT],[j.ORDER_MULTIPLICATION,j.ORDER_MULTIPLICATION],[j.ORDER_ADDITION,j.ORDER_ADDITION],[j.ORDER_LOGICAL_AND,j.ORDER_LOGICAL_AND],[j.ORDER_LOGICAL_OR,j.ORDER_LOGICAL_OR]];j.init=function(v){if(j.definitions_=Object.create(null),j.functionNames_=Object.create(null),!j.variableDB_)j.variableDB_=new Q0.Names(j.RESERVED_WORDS_);else j.variableDB_.reset();j.variableDB_.setVariableMap(v.getVariableMap());var p=[],r=v.getAllVariables();for(var V=0;V<r.length;V++){if(r[V].type===Q0.BROADCAST_MESSAGE_VARIABLE_TYPE)continue;const T=j.variableDB_.getName(r[V].getId(),Q0.Variables.NAME_TYPE);if(r[V].type===Q0.LIST_VARIABLE_TYPE)p.push(`let ${T}${Q0.LIST_VARIABLE_TYPE} = [];`);else p.push(`let ${T} = 0;`)}var G=Q0.Variables.allDeveloperVariables(v);for(var V=0;V<G.length;V++){const F=j.variableDB_.getName(G[V],Q0.Names.DEVELOPER_VARIABLE_TYPE);if(r[V].type===Q0.LIST_VARIABLE_TYPE)p.push(`let ${F}List = [];`);else p.push(`let ${F} = 0;`)}if(p.length)j.definitions_.variables=p.join("\n")};j.finish=function(v){var p=[];for(var r in j.definitions_)p.push(j.definitions_[r]);return delete j.definitions_,delete j.functionNames_,j.variableDB_.reset(),p.join("\n\n")+"\n\n\n"+v};j.scrubNakedValue=function(v){return v+";\n"};j.quote_=function(v){return v=v.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"),"'"+v+"'"};j.scrub_=function(v,p){var r="";if(!v.outputConnection||!v.outputConnection.targetConnection){var V=v.getCommentText();if(V=Q0.utils.wrap(V,j.COMMENT_WRAP-3),V)if(v.getProcedureDef)r+="/**\n"+j.prefixLines(V+"\n"," * ")+" */\n";else r+=j.prefixLines(V+"\n","// ");for(var G=0;G<v.inputList.length;G++)if(v.inputList[G].type==Q0.INPUT_VALUE){var T=v.inputList[G].connection.targetBlock();if(T){var V=j.allNestedComments(T);if(V)r+=j.prefixLines(V,"// ")}}}if(v.startHat_){const F=v.nextConnection&&v.nextConnection.targetBlock();let _=j.blockToCode(F);if(_)_=j.prefixLines(_,j.INDENT),p=p.replace("/* nextCode */",`\n${_}`);return r+p}if(v.parentBlock_){const F=v.nextConnection&&v.nextConnection.targetBlock(),_=j.blockToCode(F);return r+p+_}return""};j.getAdjusted=function(v,p,r,V,G){var T=r||0,F=G||j.ORDER_NONE;if(v.workspace.options.oneBasedIndex)T--;var _=v.workspace.options.oneBasedIndex?"1":"0";if(T>0)var $=j.valueToCode(v,p,j.ORDER_ADDITION)||_;else if(T<0)var $=j.valueToCode(v,p,j.ORDER_SUBTRACTION)||_;else if(V)var $=j.valueToCode(v,p,j.ORDER_UNARY_NEGATION)||_;else var $=j.valueToCode(v,p,F)||_;if(Q0.isNumber($)){if($=parseFloat($)+T,V)$=-$}else{if(T>0){$=$+" + "+T;var U=j.ORDER_ADDITION}else if(T<0){$=$+" - "+-T;var U=j.ORDER_SUBTRACTION}if(V){if(T)$="-("+$+")";else $="-"+$;var U=j.ORDER_UNARY_NEGATION}if(U=Math.floor(U),F=Math.floor(F),U&&F>=U)$="("+$+")"}return $};j.control_wait=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);const r=j.valueToCode(v,"DURATION",j.ORDER_NONE);return p+=`await runtime.sleep(${r});\n`,p};j.control_repeat=(v)=>{let p="",r,V;if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);if(r=j.valueToCode(v,"TIMES",j.ORDER_NONE)||"false",V=j.statementToCode(v,"SUBSTACK")||"",j.STATEMENT_SUFFIX)V=j.prefixLines(j.injectId(j.STATEMENT_SUFFIX,v),j.INDENT)+V;return p+=`for (let _ = 0; _ < ${r}; _++) {\n${V}  if (anonymous.aborted) return;\n  await runtime.nextFrame();\n}\n`,p};j.control_forever=(v)=>{let p="",r;if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);if(r=j.statementToCode(v,"SUBSTACK")||"",j.STATEMENT_SUFFIX)r=j.prefixLines(j.injectId(j.STATEMENT_SUFFIX,v),j.INDENT)+r;return p+=`while (true) {\n${r}  if (anonymous.aborted) return;\n  await runtime.nextFrame();\n}\n`,p};j.control_if=(v)=>{let p="",r,V;if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);if(V=j.valueToCode(v,"CONDITION",j.ORDER_NONE)||"false",r=j.statementToCode(v,"SUBSTACK")||"",j.STATEMENT_SUFFIX)r=j.prefixLines(j.injectId(j.STATEMENT_SUFFIX,v),j.INDENT)+r;if(p+=`if (${V}) {\n${r}}\n`,v.getInput("SUBSTACK2")){if(r=j.statementToCode(v,"SUBSTACK2")||"",j.STATEMENT_SUFFIX)r=j.prefixLines(j.injectId(j.STATEMENT_SUFFIX,v),j.INDENT)+r;p+=`else {\n${r}}\n`}return p};j.control_if_else=j.control_if;j.control_wait_until=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);const r=j.valueToCode(v,"CONDITION",j.ORDER_NONE)||"false";return p+=`while (!(${r})) {\n  if (anonymous.aborted) return;\n  await runtime.nextFrame();\n}\n`,p};j.control_repeat_until=(v)=>{let p="",r,V;if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);if(V=j.valueToCode(v,"CONDITION",j.ORDER_NONE)||"false",r=j.statementToCode(v,"SUBSTACK")||"",j.STATEMENT_SUFFIX)r=j.prefixLines(j.injectId(j.STATEMENT_SUFFIX,v),j.INDENT)+r;return p+=`while (!(${V})) {\n${r}  if (anonymous.aborted) return;\n  await runtime.nextFrame();\n}\n`,p};j.control_while=(v)=>{let p="",r,V;if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);if(V=j.valueToCode(v,"CONDITION",j.ORDER_NONE)||"false",r=j.statementToCode(v,"SUBSTACK")||"",j.STATEMENT_SUFFIX)r=j.prefixLines(j.injectId(j.STATEMENT_SUFFIX,v),j.INDENT)+r;return p+=`while (${V}) {\n${r}  if (anonymous.aborted) return;\n  await runtime.nextFrame();\n}\n`,p};j.control_stop=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);switch(v.getFieldValue("STOP_OPTION")){case"all":p+="runtime.stop();\n";break;case"this script":p+="return;\n";break;case"other scripts in sprite":p+="runtime.abort(anonymous.id);\n";break}return p};j.control_start_as_clone=(v)=>{};j.control_create_clone_of=(v)=>{};j.control_delete_this_clone=(v)=>{};j.data_variable=(v)=>{return[`${j.variableDB_.getName(v.getFieldValue("VARIABLE"),k0.Variables.NAME_TYPE)}`,j.ORDER_CONDITIONAL]};j.data_setvariableto=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);const r=j.variableDB_.getName(v.getFieldValue("VARIABLE"),k0.Variables.NAME_TYPE),V=j.valueToCode(v,"VALUE",j.ORDER_NONE)||0;return p+=`${r} = ${V};\n`,p};j.data_changevariableby=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);const r=j.variableDB_.getName(v.getFieldValue("VARIABLE"),k0.Variables.NAME_TYPE),V=j.valueToCode(v,"VALUE",j.ORDER_NONE)||0;return p+=`${r} = (isNaN(${r}) ? 0 : +${r}) + +(${V});\n`,p};j.data_listcontents=(v)=>{return[j.variableDB_.getName(v.getFieldValue("LIST"),k0.Variables.NAME_TYPE)+k0.LIST_VARIABLE_TYPE,j.ORDER_ATOMIC]};j.data_addtolist=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);const r=j.variableDB_.getName(v.getFieldValue("LIST"),k0.Variables.NAME_TYPE)+k0.LIST_VARIABLE_TYPE,V=j.valueToCode(v,"ITEM",j.ORDER_NONE)||0;return p+=`${r}.push(${V});\n`,p};j.data_deleteoflist=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);const r=j.variableDB_.getName(v.getFieldValue("LIST"),k0.Variables.NAME_TYPE)+k0.LIST_VARIABLE_TYPE,V=(j.valueToCode(v,"INDEX",j.ORDER_NONE)||0)-1;return p+=`${V} > -1 && ${r}.splice(${V}, 1);\n`,p};j.data_deletealloflist=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);const r=j.variableDB_.getName(v.getFieldValue("LIST"),k0.Variables.NAME_TYPE)+k0.LIST_VARIABLE_TYPE;return p+=`${r}.length = 0;\n`,p};j.data_insertatlist=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);const r=j.variableDB_.getName(v.getFieldValue("LIST"),k0.Variables.NAME_TYPE)+k0.LIST_VARIABLE_TYPE,V=(j.valueToCode(v,"INDEX",j.ORDER_NONE)||0)-1,G=j.valueToCode(v,"ITEM",j.ORDER_NONE)||0;return p+=`${V} > -1 && ${r}.splice(${V}, 0, ${G});\n`,p};j.data_replaceitemoflist=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);const r=j.variableDB_.getName(v.getFieldValue("LIST"),k0.Variables.NAME_TYPE)+k0.LIST_VARIABLE_TYPE,V=(j.valueToCode(v,"INDEX",j.ORDER_NONE)||0)-1,G=j.valueToCode(v,"ITEM",j.ORDER_NONE)||0;return p+=`${V} > -1 && ${r}.splice(${V}, 1, ${G});\n`,p};j.data_itemoflist=(v)=>{const p=j.variableDB_.getName(v.getFieldValue("LIST"),k0.Variables.NAME_TYPE)+k0.LIST_VARIABLE_TYPE,r=(j.valueToCode(v,"INDEX",j.ORDER_NONE)||0)-1;return[`${r} > -1 ? ${p}[${r}] : ''`,j.ORDER_CONDITIONAL]};j.data_itemnumoflist=(v)=>{const p=j.variableDB_.getName(v.getFieldValue("LIST"),k0.Variables.NAME_TYPE)+k0.LIST_VARIABLE_TYPE,r=j.valueToCode(v,"ITEM",j.ORDER_NONE)||0;return[`(${p}.indexOf(${r}) + 1)`,j.ORDER_NONE]};j.data_lengthoflist=(v)=>{return[`${j.variableDB_.getName(v.getFieldValue("LIST"),k0.Variables.NAME_TYPE)+k0.LIST_VARIABLE_TYPE}.length`,j.ORDER_MEMBER]};j.data_listcontainsitem=(v)=>{const p=j.variableDB_.getName(v.getFieldValue("LIST"),k0.Variables.NAME_TYPE)+k0.LIST_VARIABLE_TYPE,r=j.valueToCode(v,"ITEM",j.ORDER_NONE)||0;return[`${p}.includes(${r})`,j.ORDER_FUNCTION_CALL]};j.event_whenflagclicked=(v)=>{return"runtime.on('start', async function anonymous() {/* nextCode */});\n"};j.event_whengreaterthan=(v)=>{const p=v.getFieldValue("WHENGREATERTHANMENU"),r=j.valueToCode(v,"VALUE",j.ORDER_NONE)||0;return`runtime.onGreaterThen('${p}', ${r}, async function anonymous() {/* nextCode */});\n`};j.event_whenbroadcastreceived=(v)=>{return`runtime.on('${j.variableDB_.getName(v.getFieldValue("BROADCAST_OPTION"),F8.Variables.NAME_TYPE)}', async function anonymous(done) {/* nextCode */  done()\n});\n`};j.event_broadcast_menu=(v)=>{return[j.variableDB_.getName(v.getFieldValue("BROADCAST_OPTION"),F8.Variables.NAME_TYPE),j.ORDER_ATOMIC]};j.event_broadcast=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);const r=j.valueToCode(v,"BROADCAST_INPUT",j.ORDER_NONE)||"None";return p+=`runtime.broadcast('${r}')\n`,p};j.event_broadcastandwait=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);const r=j.valueToCode(v,"BROADCAST_INPUT",j.ORDER_NONE)||"None";return p+=`await runtime.broadcast('${r}')\n`,p};j.math_number=(v)=>{let p=parseFloat(v.getFieldValue("NUM")),r;if(p===Infinity)p="Infinity",r=j.ORDER_FUNCTION_CALL;else if(p===(-Infinity))p="-Infinity",r=j.ORDER_UNARY_SIGN;else if(Number.isNaN(p))p="NaN",r=j.ORDER_UNARY_SIGN;else r=p<0?j.ORDER_UNARY_SIGN:j.ORDER_ATOMIC;return[p,r]};j.math_integer=(v)=>{const p=parseInt(v.getFieldValue("NUM")),r=p<0?j.ORDER_UNARY_SIGN:j.ORDER_ATOMIC;return[p,r]};j.math_whole_number=(v)=>{return[Math.abs(parseInt(v.getFieldValue("NUM"))),j.ORDER_ATOMIC]};j.math_positive_number=(v)=>{let p=parseFloat(v.getFieldValue("NUM")),r;if(p===Infinity)p="Infinity",r=j.ORDER_FUNCTION_CALL;else if(p===(-Infinity))p="-Infinity",r=j.ORDER_FUNCTION_CALL;else if(Number.isNaN(p))p="NaN",r=j.ORDER_FUNCTION_CALL;else p=p<0?0:p,r=j.ORDER_ATOMIC;return[p,r]};j.math_angle=(v)=>{let p=parseFloat(v.getFieldValue("NUM")),r;if(p==Infinity)p="Infinity",r=j.ORDER_FUNCTION_CALL;else if(p==(-Infinity))p="-Infinity",r=j.ORDER_UNARY_SIGN;else p=p%360,p=p<0?p+360:p,r=j.ORDER_ATOMIC;return[p,r]};j.operator_add=(v)=>{const p=j.valueToCode(v,"NUM1",j.ORDER_NONE)||0,r=j.valueToCode(v,"NUM2",j.ORDER_NONE)||0;return[`(${p} + ${r})`,j.ORDER_SUBTRACTION]};j.operator_subtract=(v)=>{const p=j.valueToCode(v,"NUM1",j.ORDER_NONE)||0,r=j.valueToCode(v,"NUM2",j.ORDER_NONE)||0;return[`(${p} - ${r})`,j.ORDER_ADDITION]};j.operator_multiply=(v)=>{const p=j.valueToCode(v,"NUM1",j.ORDER_NONE)||0,r=j.valueToCode(v,"NUM2",j.ORDER_NONE)||0;return[`(${p} * ${r})`,j.ORDER_MULTIPLICATION]};j.operator_divide=(v)=>{const p=j.valueToCode(v,"NUM1",j.ORDER_NONE)||0,r=j.valueToCode(v,"NUM2",j.ORDER_NONE)||0;return[`(${p} / ${r})`,j.ORDER_DIVISION]};j.operator_random=(v)=>{const p=j.valueToCode(v,"FROM",j.ORDER_NONE)||0,r=j.valueToCode(v,"TO",j.ORDER_NONE)||0;return[`runtime.random(${p}, ${r})`,j.ORDER_FUNCTION_CALL]};j.operator_gt=(v)=>{const p=j.valueToCode(v,"OPERAND1",j.ORDER_NONE)||0,r=j.valueToCode(v,"OPERAND2",j.ORDER_NONE)||0;return[`(${p} > ${r})`,j.ORDER_RELATIONAL]};j.operator_lt=(v)=>{const p=j.valueToCode(v,"OPERAND1",j.ORDER_NONE)||0,r=j.valueToCode(v,"OPERAND2",j.ORDER_NONE)||0;return[`(${p} < ${r})`,j.ORDER_RELATIONAL]};j.operator_equals=(v)=>{const p=j.valueToCode(v,"OPERAND1",j.ORDER_NONE)||0,r=j.valueToCode(v,"OPERAND2",j.ORDER_NONE)||0;return[`(${p} == ${r})`,j.ORDER_RELATIONAL]};j.operator_and=(v)=>{const p=j.valueToCode(v,"OPERAND1",j.ORDER_NONE)||0,r=j.valueToCode(v,"OPERAND2",j.ORDER_NONE)||0;return[`(${p} && ${r})`,j.ORDER_LOGICAL_AND]};j.operator_or=(v)=>{const p=j.valueToCode(v,"OPERAND1",j.ORDER_NONE)||0,r=j.valueToCode(v,"OPERAND2",j.ORDER_NONE)||0;return[`(${p} || ${r})`,j.ORDER_LOGICAL_OR]};j.operator_not=(v)=>{return[`!(${j.valueToCode(v,"OPERAND",j.ORDER_NONE)||0})`,j.ORDER_LOGICAL_NOT]};j.operator_join=(v)=>{const p=j.valueToCode(v,"STRING1",j.ORDER_NONE)||"",r=j.valueToCode(v,"STRING2",j.ORDER_NONE)||""};j.operator_constter_of=(v)=>{const p=j.valueToCode(v,"LETTER",j.ORDER_NONE)||"",r=j.valueToCode(v,"STRING",j.ORDER_NONE)||""};j.operator_length=(v)=>{const p=j.valueToCode(v,"STRING",j.ORDER_NONE)||""};j.operator_contains=(v)=>{const p=j.valueToCode(v,"STRING1",j.ORDER_NONE)||"",r=j.valueToCode(v,"STRING2",j.ORDER_NONE)||""};j.operator_mod=(v)=>{const p=j.valueToCode(v,"NUM1",j.ORDER_NONE)||0,r=j.valueToCode(v,"NUM2",j.ORDER_NONE)||0;return[`(${p} % ${r})`,j.ORDER_MODULUS]};j.operator_round=(v)=>{return[`Math.round(${j.valueToCode(v,"NUM",j.ORDER_NONE)||0})`,j.ORDER_FUNCTION_CALL]};j.operator_mathop=(v)=>{const p=j.valueToCode(v,"NUM",j.ORDER_NONE)||0,r=v.getFieldValue("OPERATOR");let V="";if(r==="ceiling")V+=`Math.ceil(${p})`;else if(r==="sin"||r==="cos"||r==="tan")V+=`Math.${r}((Math.PI * ${p}) / 180)`;else if(r==="asin"||r==="acos"||r==="atan")V+=`((Math.${r}(${p}) * 180) / Math.PI)`;else if(r==="ln")V+=`(Math.log(${p})`;else if(r==="log")V+=`(Math.log(${p}) / Math.LN10)`;else if(r==="e ^")V+=`Math.exp(${p})`;else if(r==="10 ^")V+=`Math.pow(10, ${p})`;else V+=`Math.${r}(${p})`;return[V,j.ORDER_FUNCTION_CALL]};j.procedures_definition=(v)=>{};j.procedures_call=(v)=>{};j.procedures_prototype=(v)=>{};j.procedures_declaration=(v)=>{};j.argument_reporter_boolean=(v)=>{};j.argument_reporter_string_number=(v)=>{};j.argument_editor_boolean=(v)=>{};j.argument_editor_string_number=(v)=>{};j.sensing_timer=(v)=>{return["runtime.getTimer()",j.ORDER_FUNCTION_CALL]};j.sensing_resettimer=(v)=>{return"runtime.resetTimer()\n"};j.text=(v)=>{return[j.quote_(v.getFieldValue("TEXT")),j.ORDER_ATOMIC]};var N5=new Set([W0.Events.BLOCK_CHANGE,W0.Events.BLOCK_CREATE,W0.Events.BLOCK_DELETE,W0.Events.BLOCK_MOVE,W0.Events.COMMENT_CHANGE,W0.Events.COMMENT_CREATE,W0.Events.COMMENT_DELETE,W0.Events.COMMENT_MOVE,W0.Events.VAR_CREATE,W0.Events.VAR_DELETE,W0.Events.VAR_RENAME]),S5=function(v){console&&console.warn&&console.warn(v)},z0=function(){z0.init.call(this)},X6=function(v){if(typeof v!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof v)},Y8=function(v){return v._maxListeners===void 0?z0.defaultMaxListeners:v._maxListeners},Z8=function(v,p,r,V){var G,T,F;if(X6(r),T=v._events,T===void 0?(T=v._events=Object.create(null),v._eventsCount=0):(T.newListener!==void 0&&(v.emit("newListener",p,r.listener?r.listener:r),T=v._events),F=T[p]),F===void 0)F=T[p]=r,++v._eventsCount;else if(typeof F=="function"?F=T[p]=V?[r,F]:[F,r]:V?F.unshift(r):F.push(r),G=Y8(v),G>0&&F.length>G&&!F.warned){F.warned=!0;var _=new Error("Possible EventEmitter memory leak detected. "+F.length+" "+String(p)+" listeners added. Use emitter.setMaxListeners() to increase limit");_.name="MaxListenersExceededWarning",_.emitter=v,_.type=p,_.count=F.length,S5(_)}return v},I5=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)},W8=function(v,p,r){var V={fired:!1,wrapFn:void 0,target:v,type:p,listener:r},G=I5.bind(V);return G.listener=r,V.wrapFn=G,G},K8=function(v,p,r){var V=v._events;if(V===void 0)return[];var G=V[p];return G===void 0?[]:typeof G=="function"?r?[G.listener||G]:[G]:r?o5(G):J8(G,G.length)},U8=function(v){var p=this._events;if(p!==void 0){var r=p[v];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0},J8=function(v,p){for(var r=new Array(p),V=0;V<p;++V)r[V]=v[V];return r},z5=function(v,p){for(;p+1<v.length;p++)v[p]=v[p+1];v.pop()},o5=function(v){for(var p=new Array(v.length),r=0;r<p.length;++r)p[r]=v[r].listener||v[r];return p},o6=typeof Reflect=="object"?Reflect:null,e8=o6&&typeof o6.apply=="function"?o6.apply:function(v,p,r){return Function.prototype.apply.call(v,p,r)},e6;o6&&typeof o6.ownKeys=="function"?e6=o6.ownKeys:Object.getOwnPropertySymbols?e6=function(v){return Object.getOwnPropertyNames(v).concat(Object.getOwnPropertySymbols(v))}:e6=function(v){return Object.getOwnPropertyNames(v)};var Q8=Number.isNaN||function(v){return v!==v};z0.EventEmitter=z0;z0.prototype._events=void 0;z0.prototype._eventsCount=0;z0.prototype._maxListeners=void 0;var X8=10;Object.defineProperty(z0,"defaultMaxListeners",{enumerable:!0,get:function(){return X8},set:function(v){if(typeof v!="number"||v<0||Q8(v))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+v+".");X8=v}});z0.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};z0.prototype.setMaxListeners=function(v){if(typeof v!="number"||v<0||Q8(v))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+v+".");return this._maxListeners=v,this};z0.prototype.getMaxListeners=function(){return Y8(this)};z0.prototype.emit=function(v){for(var p=[],r=1;r<arguments.length;r++)p.push(arguments[r]);var V=v==="error",G=this._events;if(G!==void 0)V=V&&G.error===void 0;else if(!V)return!1;if(V){var T;if(p.length>0&&(T=p[0]),T instanceof Error)throw T;var F=new Error("Unhandled error."+(T?" ("+T.message+")":""));throw F.context=T,F}var _=G[v];if(_===void 0)return!1;if(typeof _=="function")e8(_,this,p);else for(var $=_.length,U=J8(_,$),r=0;r<$;++r)e8(U[r],this,p);return!0};z0.prototype.addListener=function(v,p){return Z8(this,v,p,!1)};z0.prototype.on=z0.prototype.addListener;z0.prototype.prependListener=function(v,p){return Z8(this,v,p,!0)};z0.prototype.once=function(v,p){return X6(p),this.on(v,W8(this,v,p)),this};z0.prototype.prependOnceListener=function(v,p){return X6(p),this.prependListener(v,W8(this,v,p)),this};z0.prototype.removeListener=function(v,p){var r,V,G,T,F;if(X6(p),V=this._events,V===void 0)return this;if(r=V[v],r===void 0)return this;if(r===p||r.listener===p)--this._eventsCount===0?this._events=Object.create(null):(delete V[v],V.removeListener&&this.emit("removeListener",v,r.listener||p));else if(typeof r!="function"){for(G=-1,T=r.length-1;T>=0;T--)if(r[T]===p||r[T].listener===p){F=r[T].listener,G=T;break}if(G<0)return this;G===0?r.shift():z5(r,G),r.length===1&&(V[v]=r[0]),V.removeListener!==void 0&&this.emit("removeListener",v,F||p)}return this};z0.prototype.off=z0.prototype.removeListener;z0.prototype.removeAllListeners=function(v){var p,r,V;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[v]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[v]),this;if(arguments.length===0){var G=Object.keys(r),T;for(V=0;V<G.length;++V)T=G[V],T!=="removeListener"&&this.removeAllListeners(T);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(p=r[v],typeof p=="function")this.removeListener(v,p);else if(p!==void 0)for(V=p.length-1;V>=0;V--)this.removeListener(v,p[V]);return this};z0.prototype.listeners=function(v){return K8(this,v,!0)};z0.prototype.rawListeners=function(v){return K8(this,v,!1)};z0.listenerCount=function(v,p){return typeof v.listenerCount=="function"?v.listenerCount(p):U8.call(v,p)};z0.prototype.listenerCount=U8;z0.prototype.eventNames=function(){return this._eventsCount>0?e6(this._events):[]};var J7=z0.prototype;class O6 extends z0{static DEFAULT_FPS=24;constructor(v,p,r=O6.DEFAULT_FPS){super();this._fps=r,this._spf=1/r,this._running=!1,this._requestStop=p,this._timer=0,this._timers=[],this._idCounter=0,this._eventsGroups={},this.openEventsGroup("global"),new Function("runtime",v)(this)}get running(){return this._running}get timer(){return(Date.now()-this._timer)/1000}openEventsGroup(v){this._currentGroupName=v,this._eventsGroups[v]=this._eventsGroups[v]||[]}closeEventsGroup(){this._currentGroupName="global"}abort(v){const p=v.split(":")[0],r=[];this._eventsGroups[p].forEach((V)=>{if(V.id===v)r.push(V);else V._aborted=!0}),this._eventsGroups[p]=r}on(v,p){const r=this._currentGroupName;Object.defineProperties(p,{id:{get:()=>p._id},aborted:{get:()=>p._aborted||!this.running}}),super.on(v,(...V)=>{p._id=`${r}:${++this._idCounter}`,p._aborted=!1,this._eventsGroups[r].push(p),p(...V)})}onGreaterThen(v,p,r){if(v==="TIMER")r._done=!1,this.on("frame",()=>{if(this.timer>p&&!r._done)r();r._done=this.timer>p})}emit(...v){if(this.running)super.emit(...v)}broadcast(v){return new Promise((p)=>{this.emit(v,p)})}start(){this._running=!0,this.emit("beforeStart"),this.on("start",async()=>{while(this.running)this.emit("frame"),await this.nextFrame()}),this._timer=Date.now(),this.emit("start")}async stop(){this._running=!1,await this.nextFrame(),this._timers.forEach(clearTimeout),this._timers.length=0,this._requestStop()}sleep(v){return new Promise((p)=>this._timers.push(setTimeout(p,v*1000)))}nextFrame(){return this.sleep(this._spf)}random(v=1,p=10){return v=Math.ceil(Math.min(v,p)),p=Math.floor(Math.max(v,p)),Math.floor(Math.random()*(p-v+1))+v}resetTimer(){this._timer=Date.now()}}var w0=l5.default;j.motion_attack=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);const r=j.valueToCode(v,"DIRECTION",j.ORDER_NONE)||0,V=j.valueToCode(v,"DISTANCE",j.ORDER_NONE)||100;return p+=`await tank.util.attack(${r}, ${V});\n`,p};j.motion_move=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);const r=j.valueToCode(v,"DIRECTION",j.ORDER_NONE)||0,V=j.valueToCode(v,"SPEED",j.ORDER_NONE)||100;return p+=`tank.util.move(${r}, ${V});\n`,p};j.motion_turnright=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);const r=j.valueToCode(v,"DEGREES",j.ORDER_NONE)||0;return p+=`await tank.util.turnRight(${r});\n`,p};j.motion_turnleft=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);const r=j.valueToCode(v,"DEGREES",j.ORDER_NONE)||0;return p+=`await tank.util.turnLeft(${r});\n`,p};j.motion_pointindirection=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);const r=j.valueToCode(v,"DIRECTION",j.ORDER_NONE)||0;return p+=`await tank.util.setDirection(+${r});\n`,p};j.motion_setspeed=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);const r=j.valueToCode(v,"SPEED",j.ORDER_NONE)||0;return p+=`tank.util.speed = ${r};\n`,p};j.motion_stop=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);return p+="tank.util.speed = 0;\n",p};j.motion_xposition=(v)=>{return["tank.util.x",j.ORDER_ATOMIC]};j.motion_yposition=(v)=>{return["tank.util.y",j.ORDER_ATOMIC]};j.motion_speed=(v)=>{return["tank.util.speed",j.ORDER_ATOMIC]};j.motion_direction=(v)=>{return["tank.util.direction",j.ORDER_ATOMIC]};j.sensing_scanwidth=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);const r=j.valueToCode(v,"WIDTH",j.ORDER_NONE)||5;return p+=`tank.util.scanWidth = ${r};\n`,p};j.sensing_scan=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);const r=j.valueToCode(v,"DIRECTION",j.ORDER_NONE)||0;return p+=`(await tank.util.scan(${r}) !== Infinity)`,[p,j.ORDER_EQUALITY]};j.sensing_scandistance=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);const r=j.valueToCode(v,"DIRECTION",j.ORDER_NONE)||0;return p+=`(await tank.util.scan(${r}))`,[p,j.ORDER_FUNCTION_CALL]};j.sensing_health=(v)=>{let p="";if(j.STATEMENT_PREFIX)p+=j.injectId(j.STATEMENT_PREFIX,v);return p+="tank.util.health",[p,j.ORDER_FUNCTION_CALL]};var _5=()=>`
  <category name="%{BKY_CATEGORY_MOTION}" id="motion" colour="#4C97FF" secondaryColour="#3373CC">
    <block type="motion_attack">
      <value name="DIRECTION">
        <shadow type="math_angle">
          <field name="NUM">90</field>
        </shadow>
      </value>
      <value name="DISTANCE">
        <shadow type="math_number">
          <field name="NUM">200</field>
        </shadow>
      </value>
    </block>
    <block type="motion_move">
      <value name="DIRECTION">
        <shadow type="math_angle">
          <field name="NUM">90</field>
        </shadow>
      </value>
      <value name="SPEED">
        <shadow type="math_number">
          <field name="NUM">100</field>
        </shadow>
      </value>
    </block>
    ${m6}
    <block type="motion_turnright">
      <value name="DEGREES">
        <shadow type="math_number">
          <field name="NUM">15</field>
        </shadow>
      </value>
    </block>
    <block type="motion_turnleft">
      <value name="DEGREES">
        <shadow type="math_number">
          <field name="NUM">15</field>
        </shadow>
      </value>
    </block>
    <block type="motion_pointindirection">
      <value name="DIRECTION">
        <shadow type="math_angle">
          <field name="NUM">90</field>
        </shadow>
      </value>
    </block>
    ${m6}
    <block type="motion_setspeed">
      <value name="SPEED">
        <shadow type="math_number">
          <field name="NUM">50</field>
        </shadow>
      </value>
    </block>
    <block type="motion_stop"/>
    ${m6}
    <block type="motion_speed"/>
    <block type="motion_direction"/>
    ${w8}
  </category>
`,k5=()=>`
  <category name="%{BKY_CATEGORY_SENSING}" id="sensing" colour="#4CBFE6" secondaryColour="#2E8EB8">
    <block type="sensing_scanwidth">
      <value name="WIDTH">
        <shadow type="math_number">
          <field name="NUM">5</field>
        </shadow>
      </value>
    </block>
    <block type="sensing_scan">
      <value name="DIRECTION">
        <shadow type="math_angle">
          <field name="NUM">90</field>
        </shadow>
      </value>
    </block>
    <block type="sensing_scandistance">
      <value name="DIRECTION">
        <shadow type="math_angle">
          <field name="NUM">90</field>
        </shadow>
      </value>
    </block>
    ${m6}
    <block type="sensing_health"/>
    ${m6}
    <block id="timer" type="sensing_timer"/>
    <block type="sensing_resettimer"/>
    ${w8}
  </category>
`,L5=()=>`
  <category name="%{BKY_CATEGORY_OPERATORS}" id="operators" colour="#40BF4A" secondaryColour="#389438">
    <block type="operator_add">
      <value name="NUM1">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
      <value name="NUM2">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    <block type="operator_subtract">
      <value name="NUM1">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
      <value name="NUM2">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    <block type="operator_multiply">
      <value name="NUM1">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
      <value name="NUM2">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    <block type="operator_divide">
      <value name="NUM1">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
      <value name="NUM2">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    ${m6}
    <block type="operator_random">
      <value name="FROM">
        <shadow type="math_number">
          <field name="NUM">1</field>
        </shadow>
      </value>
      <value name="TO">
        <shadow type="math_number">
          <field name="NUM">10</field>
        </shadow>
      </value>
    </block>
    ${m6}
    <block type="operator_gt">
      <value name="OPERAND1">
        <shadow type="text">
          <field name="TEXT"/>
        </shadow>
      </value>
      <value name="OPERAND2">
        <shadow type="text">
          <field name="TEXT">50</field>
        </shadow>
      </value>
    </block>
    <block type="operator_lt">
      <value name="OPERAND1">
        <shadow type="text">
          <field name="TEXT"/>
        </shadow>
      </value>
      <value name="OPERAND2">
        <shadow type="text">
          <field name="TEXT">50</field>
        </shadow>
      </value>
    </block>
    <block type="operator_equals">
      <value name="OPERAND1">
        <shadow type="text">
          <field name="TEXT"/>
        </shadow>
      </value>
      <value name="OPERAND2">
        <shadow type="text">
          <field name="TEXT">50</field>
        </shadow>
      </value>
    </block>
    ${m6}
    <block type="operator_and"/>
    <block type="operator_or"/>
    <block type="operator_not"/>
    ${m6}
    <block type="operator_mod">
      <value name="NUM1">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
      <value name="NUM2">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    <block type="operator_round">
      <value name="NUM">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    ${m6}
    <block type="operator_mathop">
      <value name="NUM">
        <shadow type="math_number">
          <field name="NUM"/>
        </shadow>
      </value>
    </block>
    ${w8}
  </category>
`;function x8(){return B5([{id:"motion",xml:_5()},{id:"sensing",xml:k5()},{id:"operators",xml:L5()}])}import{jsx as G5} from"preact/jsx-runtime";var D5=q6.Content;function p8(){const{getText:v}=c5(),{fileList:p}=M5(),r=p[0],V={MOTION_ATTACK:v("tankwar.blocks.motion_attack","fire in direction %1 at %2 steps"),MOTION_MOVE:v("tankwar.blocks.motion_move","forward in direction %1 at %2 % speed"),MOTION_SETSPEED:v("tankwar.blocks.motion_setspeed","set speed to %1 %"),MOTION_STOP:v("tankwar.blocks.motion_stop","stop"),MOTION_SPEED:v("tankwar.blocks.motion_speed","speed"),SENSING_SCANWIDTH:v("tankwar.blocks.sensing_scanwidth","set scan width to %1"),SENSING_SCAN:v("tankwar.blocks.sensing_scan","scan for enemy in direction %1?"),SENSING_DISTANCE:v("tankwar.blocks.sensing_distance","measure distance of enemy in direction %1"),SENSING_HEALTH:v("tankwar.blocks.sensing_health","health")},G=x8();return G5(D5,{disableGenerator:!0,disableExtension:!0,messages:V,toolbox:G,xml:r.xml})}import{useState as W6} from"preact/hooks";import{classNames as m7} from"@blockcode/ui";import{useState as l4} from"preact/hooks";import{useEditor as u7} from"@blockcode/core";var $8="./assets/background-81dedab007c311a5.png";function B6(v){return new Promise((p)=>{const r=new Image;r.src=v,r.addEventListener("load",()=>p(r))})}var i4="./assets/tank_1-5797dcf7b198a48d.png";var h4="./assets/turret_1-26017ccc46b87689.png";var u4="./assets/tank_2-337708f7538d8787.png";var f4="./assets/turret_2-5c4bb2c458561ace.png";var t4="./assets/tank_3-1d999a2c9dacc246.png";var n4="./assets/turret_3-956bfba650c81c57.png";var v4="./assets/tank_4-f93afcfd2c3d1734.png";var m4="./assets/turret_4-d6c2200ed4ca50b0.png";var g4="./assets/broken-2d9779d033bbcdb5.png";var w4="./assets/bullet-80854a0e7090b0fc.png";var x4="./assets/boom1-65b37ddc26db4cbd.png";var p4="./assets/boom2-82ff355a8e0177ba.png";var s4="./assets/boom3-703bd7bb6580e4d9.png";var W5=20,K5=4,U5=40,T6=500,J5=70,Q5=400,s8=1000,y4=(v,p)=>Math.sqrt((v.x-p.x)**2+(v.y-p.y)**2),P6=(v)=>isNaN(v)?0:+v,F6=(v,p,r)=>Math.min(Math.max(v,p),r),M6=(v)=>v*Math.PI/180,l6=(v)=>parseInt((v%360+360)%360),d4=(v,p)=>l6(v)===l6(p);class o0{static PLACE={LEFT:{get position(){return new w0.Point(w0.view.center.x-300,w0.view.center.y)},rotation:90},RIGHT:{get position(){return new w0.Point(w0.view.center.x+300,w0.view.center.y)},rotation:-90},LEFT_TOP:{get position(){return new w0.Point(w0.view.center.x-300,w0.view.center.y-300)},rotation:135},RIGHT_TOP:{get position(){return new w0.Point(w0.view.center.x+300,w0.view.center.y-300)},rotation:-135},LEFT_BOTTOM:{get position(){return new w0.Point(w0.view.center.x-300,w0.view.center.y+300)},rotation:45},RIGHT_BOTTOM:{get position(){return new w0.Point(w0.view.center.x+300,w0.view.center.y+300)},rotation:-45}};static STYLE={PLAYER:{tank:i4,turret:h4},ENEMY_A:{tank:u4,turret:f4},ENEMY_B:{tank:t4,turret:n4},ENEMY_C:{tank:v4,turret:m4}};constructor(v,p=o0.STYLE.PLAYER,r=o0.PLACE.LEFT){this.raster=new w0.Raster({name:v,scaling:0.2,source:p.tank,position:r.position,rotation:r.rotation,visible:p===o0.STYLE.PLAYER}),this.turretRaster=new w0.Raster({scaling:0.2,source:p.turret,position:r.position,rotation:r.rotation,visible:p===o0.STYLE.PLAYER}),this.raster.util=this,this.turretRaster.owner=this,this._hidden=!0,this._lastScanDistance=0,this._imageCache={},this._timers=[],this.reset()}sleep(v){return new Promise((p)=>this._timers.push(setTimeout(p,v)))}reset(){if(this._speed=0,this._health=100,this._scanWidth=K5,this._scanShape)this._scanShape.remove(),this._scanShape=null;if(this._bulletRaster)this._bulletRaster.remove(),this._bulletRaster=null;if(this._boomRaster)this._boomRaster.remove(),this._boomRaster=null;if(this._collideTester)this._collideTester.remove(),this._collideTester=null;clearTimeout(this._turretReady),this._timers.forEach(clearTimeout),this._timers.length=0}bringToFront(){this.raster.bringToFront(),this.turretRaster.bringToFront()}get running(){return this._running}set running(v){if(this.reset(),this._running=v,v){const p=this.raster.scaling.x*this.raster.width-5;this._collideTester=new w0.Path.Rectangle({point:[this.raster.position.x-p/2,this.raster.position.y-5],size:[p,10],applyMatrix:!1})}}get bullseye(){if(!this._bullseye)this._bullseye=Math.min(this.raster.width,this.raster.height)*this.raster.scaling.x/4;return this._bullseye}get enemies(){if(!this._enemies)this._enemies=["red","yellow","green","player"].filter((v)=>v!==this.raster.name).map((v)=>w0.project.activeLayer.children[v]);return this._enemies}set place(v){if(this.running)return;this.raster.position=this.turretRaster.position=v.position,this.raster.rotation=this.turretRaster.rotation=v.rotation,this.hidden=!1}get hidden(){return this._hidden}set hidden(v){this._hidden=v,this.raster.visible=this.turretRaster.visible=!v}async _turn(v,p){if(!d4(v.rotation,p)){let r=l6(p)-l6(v.rotation);if(r>180)r-=360;if(r<-180)r+=360;await v.tween({rotation:v.rotation+r},s8*(Math.abs(r)/360))}}async attack(v,p){if(!this.running)return;if(this._bulletRaster||this.death)return;v=Math.round(P6(v)),p=P6(p),clearTimeout(this._turretReady),await this._turn(this.turretRaster,v);const r=l6(v),V=M6(90-r);let G=10,T=G*Math.cos(V),F=G*Math.sin(V);if(!this._imageCache.buttet)this._imageCache.buttet=await B6(w4);if(this._bulletRaster)this._bulletRaster.remove(),this._bulletRaster=null;this._bulletRaster=new w0.Raster({image:this._imageCache.buttet,position:this.raster.position,rotation:this.raster.rotation,scaling:this.raster.scaling}),p=F6(p,J5,Q5);const _=p/2,$=G/p/2;while(p>0){if(await this.sleep(15),p<G)T=p*Math.cos(V),F=p*Math.sin(V);if(p-=G,this._bulletRaster.position.x+=T,this._bulletRaster.position.y-=F,this._bulletRaster.scaling.x+=p>_?$:-$,this._bulletRaster.scaling.y=this._bulletRaster.scaling.x,this._bulletRaster.scaling.x<this.raster.scaling.x)this._bulletRaster.scaling=this.raster.scaling}this._boom(this._bulletRaster.position),this._collide(this._bulletRaster,(U)=>{if(y4(U.position,this._bulletRaster.position)<U.util.bullseye)U.util.hurt(10);else U.util.hurt(5)}),this._bulletRaster.remove(),this._bulletRaster=null,this._turretReady=setTimeout(()=>this._turn(this.turretRaster,this.raster.rotation),1000)}async _boom(v){if(!this.running)return;if(!this._imageCache.booms)this._imageCache.booms=[await B6(x4),await B6(p4),await B6(s4)];if(this._boomRaster)this._boomRaster.remove(),this._boomRaster=null;this._boomRaster=new w0.Raster({image:this._imageCache.booms[0],position:v}),await this.sleep(30),this._boomRaster.image=this._imageCache.booms[1],await this.sleep(50),this._boomRaster.image=this._imageCache.booms[2],await this.sleep(90),this._boomRaster.remove(),this._boomRaster=null}_intersectsOrContains(v,p){return v.intersects(p)||p.contains(v.position)}_collide(v,p){if(this.running&&!this.death)this.enemies.forEach((r)=>{if(r.util.death||r.util.hidden)return;if(this._intersectsOrContains(v,r))p(r)})}async move(v,p){if(!this.running)return;if(this.death)return;await this.setDirection(v),this.speed=P6(p)}drive(){if(!this.running)return;if(this.speed===0)return;if(this.hidden||this.death)return;let v=this.speed/W5;const p=M6(90-this.direction),r=this.raster.scaling.y*this.raster.height;this._collideTester.rotation=this.raster.rotation,this._collideTester.position.x=this.raster.position.x+(r/2+5)*Math.cos(p),this._collideTester.position.y=this.raster.position.y-(r/2+5)*Math.sin(p),this.enemies.forEach((V)=>{if(V.util.hidden)return;if(this._intersectsOrContains(this.raster,V)&&this._intersectsOrContains(this._collideTester,V))v=0}),this.raster.position.x+=v*Math.cos(p),this.raster.position.y-=v*Math.sin(p),this.turretRaster.position=this.raster.position}get x(){return this.raster.position.x-w0.view.center.x}get y(){return w0.view.center.y-this.raster.position.y}get speed(){return F6(this._speed,-100,100)}set speed(v){if(!this.running)return;this._speed=F6(v,-100,100)}get speedVelocity(){const v=l6(this.speed<0?180+this.direction:this.direction),p=M6(90-v),r=Math.abs(this.speed);return new w0.Point(r*Math.cos(p),r*Math.sin(p))}get direction(){let v=this.raster.rotation%360;if(v>180)v-=360;if(v<=-180)v+=360;return v}async setDirection(v){if(!this.running)return;v=Math.round(P6(v)),clearTimeout(this._turretReady),this._turn(this.turretRaster,v),await this._turn(this.raster,v)}turnRight(v){let p=this.raster.rotation;return p+=P6(v),this.setDirection(p)}turnLeft(v){return this.turnRight(-P6(v))}hurt(v){if(!this.running)return;if(this._health-=Math.abs(v),this.death)this.raster.visible=this.turretRaster.visible=!1,new w0.Raster({source:g4,scaling:this.raster.scaling,position:this.raster.position,rotation:this.raster.rotation}).insertAbove(w0.project.activeLayer.children.background)}get health(){if(this._health<0)return 0;return this._health}get death(){return this.health<=0}get scanWidth(){return this._scanWidth}set scanWidth(v){v=P6(v),this._scanWidth=F6(v,1,U5)}async scan(v){if(!this.running)return Infinity;if(this._scanShape||this.death)return Infinity;if(v=P6(v),!d4(this._lastScanDistance,v)){let S0=l6(v)-l6(this._lastScanDistance);if(S0>180)S0-=360;if(S0<-180)S0+=360;await this.sleep(s8*(Math.abs(S0)/360)),this._lastScanDistance=v}const p=M6(90-(v-this.scanWidth/2)),r=T6*Math.cos(p),V=T6*Math.sin(p),G=new w0.Point(this.raster.position.x+r,this.raster.position.y-V),T=M6(90-(v+this.scanWidth/2)),F=T6*Math.cos(T),_=T6*Math.sin(T),$=new w0.Point(this.raster.position.x+F,this.raster.position.y-_);if(this._scanShape)this._scanShape.remove(),this._scanShape=null;this._scanShape=new w0.Path({segments:[this.raster.position,G,$],closed:!0,fillColor:{gradient:{stops:[["rgb(255 0 0 0.4)",0],["rgb(255 0 0 0)",0.7]],radial:!0},origin:this.raster.position,destination:G}}),await this.sleep(s8*(this.scanWidth/360));let U=Infinity;return this._collide(this._scanShape,(S0)=>{const n0=y4(this.raster.position,S0.position);if(n0<U)U=n0}),this._scanShape.remove(),this._scanShape=null,U}}class H6 extends O6{get player(){return w0.project.activeLayer.children.player}get redTank(){return w0.project.activeLayer.children.red}get yellowTank(){return w0.project.activeLayer.children.yellow}get greenTank(){return w0.project.activeLayer.children.green}start(){this.player.util.running=!0,this.redTank.util.running=!0,this.yellowTank.util.running=!0,this.greenTank.util.running=!0,super.start()}stop(){super.stop(),this.player.util.running=!1,this.redTank.util.running=!1,this.yellowTank.util.running=!1,this.greenTank.util.running=!1}}var P4=(v="",p=[])=>`
runtime.on('beforeStart', () => {
  runtime.player.util.bringToFront();
});

${p.join("\n")}

((tank) => {
runtime.openEventsGroup('player');
${v}
runtime.closeEventsGroup();
})(runtime.player);

runtime.on('frame', () => {
  runtime.player.util.drive();
  runtime.redTank.util.drive();
  runtime.yellowTank.util.drive();
  runtime.greenTank.util.drive();
});
runtime.start();
`;var D6={};E4(D6,{simple:()=>{{return $5}},senior:()=>{{return h7}},medium:()=>{{return i7}}});var $5=(v,p)=>`
((tank) => {
  runtime.openEventsGroup('${v}_${p}');

  let _angle_ = 0;

  runtime.on('start', async () => {
    if ((tank.util.y > '0')) {
      await tank.util.move(180, 100);
      while (!((tank.util.y < '10'))) {
        if (!runtime.running) return;
        await runtime.nextFrame();
      }
      tank.util.speed = 0;
    }
    else {
      await tank.util.move(0, 100);
      while (!((tank.util.y > '-10'))) {
        if (!runtime.running) return;
        await runtime.nextFrame();
      }
      tank.util.speed = 0;
    }
    runtime.broadcast('@ai_simple_${v}_${p}_start');
    if ((tank.util.x > '0')) {
      await tank.util.move(270, 70);
      while (!((tank.util.x < '-400'))) {
        if (!runtime.running) return;
        await runtime.nextFrame();
      }
    }
    while (true) {
      tank.util.speed = 0;
      await tank.util.move(90, 70);
      while (!((tank.util.x > '400'))) {
        if (!runtime.running) return;
        await runtime.nextFrame();
      }
      tank.util.speed = 0;
      await tank.util.move(270, 70);
      while (!((tank.util.x < '-400'))) {
        if (!runtime.running) return;
        await runtime.nextFrame();
      }
      if (!runtime.running) return;
      await runtime.nextFrame();
    }
  });

  runtime.on('@ai_simple_${v}_${p}_start', async (done) => {
    while (true) {
      while (!((await tank.util.scan(_angle_) < '400') && (await tank.util.scan(_angle_) > '100'))) {
        _angle_ = (isNaN(_angle_) ? 0 : +_angle_) + +(90);
        if (!runtime.running) return;
        await runtime.nextFrame();
      }
      tank.util.speed = 0;
      await tank.util.attack((_angle_ + 1), (await tank.util.scan(_angle_)));
      tank.util.speed = 50;
      if (!runtime.running) return;
      await runtime.nextFrame();
    }
    done()
  });

  runtime.closeEventsGroup();
})(runtime.${v}Tank);
`,i7=(v,p)=>`
((tank) => {
  runtime.openEventsGroup('${v}_${p}');

  let _health_ = 0;
  let _angle_ = 0;
  
  runtime.on('start', async function anonymous() {
    _angle_ = runtime.random(1, 360);
    runtime.broadcast('@ai_medium_${v}_${p}_start')
  });
  
  runtime.on('start', async function anonymous() {
    while (true) {
      _health_ = tank.util.health;
      while (!((tank.util.health < _health_))) {
        if (anonymous.aborted) return;
        await runtime.nextFrame();
      }
      runtime.abort(anonymous.id);
      tank.util.move(runtime.random(1, 360), 100);
      await runtime.sleep(1);
      tank.util.speed = 0;
      runtime.broadcast('@ai_medium_${v}_${p}_start')
      if (anonymous.aborted) return;
      await runtime.nextFrame();
    }
  });
  
  runtime.on('@ai_medium_${v}_${p}_start', async function anonymous(done) {
    while (true) {
      while (!((await tank.util.scan(_angle_) !== Infinity))) {
        _angle_ = (isNaN(_angle_) ? 0 : +_angle_) + +(10);
        if (anonymous.aborted) return;
        await runtime.nextFrame();
      }
      while (((await tank.util.scan(_angle_) !== Infinity) && ((await tank.util.scan(_angle_)) > '400'))) {
        tank.util.move(_angle_, 100);
        if (anonymous.aborted) return;
        await runtime.nextFrame();
      }
      tank.util.speed = 0;
      if (((await tank.util.scan(_angle_)) < '400') && ((await tank.util.scan(_angle_)) > '100')) {
        await tank.util.attack((_angle_ + 1), (await tank.util.scan(_angle_)));
      }
      _angle_ = (isNaN(_angle_) ? 0 : +_angle_) + +(-10);
      if (anonymous.aborted) return;
      await runtime.nextFrame();
    }
    done()
  });
  
  runtime.closeEventsGroup();
})(runtime.${v}Tank);
`,h7=(v,p)=>`
((tank) => {
  runtime.openEventsGroup('${v}_${p}');

  let _angle_ = 0;
  let _health_ = 0;
  
  
  runtime.on('start', async function anonymous() {
    if (((tank.util.y < '5') && (tank.util.y > '-5'))) {
      await tank.util.turnLeft(104);
    }
    else {
      await tank.util.turnLeft(180);
    }
    tank.util.speed = 100;
    while (!(((Math.abs(tank.util.x) > '400') && (Math.abs(tank.util.y) > '400')))) {
      if (anonymous.aborted) return;
      await runtime.nextFrame();
    }
    tank.util.speed = 0;
    runtime.broadcast('@ai_senior_${v}_${p}_start')
  });
  
  runtime.on('@ai_senior_${v}_${p}_start', async function anonymous(done) {
    if ((tank.util.x < '0')) {
      if ((tank.util.y < '0')) {
        _angle_ = '45';
      }
      else {
        _angle_ = '135';
      }
    }
    else {
      if ((tank.util.y < '0')) {
        _angle_ = '-45';
      }
      else {
        _angle_ = '-135';
      }
    }
    await tank.util.setDirection(_angle_);
    runtime.broadcast('@ai_senior_${v}_${p}_watch_health');
    _angle_ = (isNaN(_angle_) ? 0 : +_angle_) + +(-60);
    for (let _ = 0; _ < 78; _++) {
      if (((await tank.util.scan(_angle_)) < '400') && ((await tank.util.scan(_angle_)) > '100')) {
        await tank.util.attack((_angle_ + 1), (await tank.util.scan(_angle_)));
        _angle_ = (isNaN(_angle_) ? 0 : +_angle_) + +(-10);
      }
      _angle_ = (isNaN(_angle_) ? 0 : +_angle_) + +(10);
      if (anonymous.aborted) return;
      await runtime.nextFrame();
    }
    runtime.broadcast('@ai_senior_${v}_${p}_next_place');
    done();
  });
  
  runtime.on('@ai_senior_${v}_${p}_next_place', async function anonymous(done) {
    runtime.abort(anonymous.id);
    if ((runtime.random(1, 3) == '1')) {
      await tank.util.turnLeft(45);
    }
    else {
      await tank.util.turnRight(45);
    }
    tank.util.speed = 100;
    await runtime.sleep(1);
    if (((tank.util.direction > '-5') && (tank.util.direction < '5'))) {
      while (!((tank.util.y > '400'))) {
        if (anonymous.aborted) return;
        await runtime.nextFrame();
      }
    }
    else {
      if (((tank.util.direction > '85') && (tank.util.direction < '95'))) {
        while (!((tank.util.x > '400'))) {
          if (anonymous.aborted) return;
          await runtime.nextFrame();
        }
      }
      else {
        if (((tank.util.direction > '-95') && (tank.util.direction < '-85'))) {
          while (!((tank.util.x < '-400'))) {
            if (anonymous.aborted) return;
            await runtime.nextFrame();
          }
        }
        else {
          while (!((tank.util.y < '-400'))) {
            if (anonymous.aborted) return;
            await runtime.nextFrame();
          }
        }
      }
    }
    tank.util.speed = 0;
    runtime.broadcast('@ai_senior_${v}_${p}_start')
    done()
  });
  
  runtime.on('@ai_senior_${v}_${p}_watch_health', async function anonymous(done) {
    _health_ = tank.util.health;
    while (!((tank.util.health < _health_))) {
      if (anonymous.aborted) return;
      await runtime.nextFrame();
    }
    runtime.broadcast('@ai_senior_${v}_${p}_next_place')
    done()
  });
  
  runtime.closeEventsGroup();
})(runtime.${v}Tank);
`;function j4({playing:v,enemies:p,enemiesAI:r,onRequestStop:V,onChangeHealth:G}){const[T,F]=l4(null),[_,$]=l4(!1),{fileList:U,saveThumb:S0}=u7(),n0=U[0];if(T){const i0=w0.project.activeLayer.children;if(v){if(!_){const I0=[];if(I0.push(D6[r.red]("red",Date.now().toString(36))),p>1)I0.push(D6[r.yellow]("yellow",Date.now().toString(36)));if(p>2)I0.push(D6[r.green]("green",Date.now().toString(36)));const a=P4(n0.script,I0),Q=new H6(a,V);Q.on("frame",()=>{G({player:i0.player.util.health,red:i0.red.util.health,yellow:i0.yellow.util.health,green:i0.green.util.health})}),$(Q)}}else if(_)_.stop(),G({player:100,red:100,yellow:100,green:100}),$(!1);else{if(w0.project.activeLayer.children.forEach((I0)=>{if(I0.name==="background")return;if(I0.util instanceof o0||I0.owner instanceof o0)return;I0.remove()}),p===1)i0.red.util.place=o0.PLACE.RIGHT;else i0.red.util.place=o0.PLACE.RIGHT_TOP;if(p>1)i0.yellow.util.place=o0.PLACE.RIGHT_BOTTOM;else i0.yellow.util.hidden=!0;if(p>2)i0.player.util.place=o0.PLACE.LEFT_TOP,i0.green.util.place=o0.PLACE.LEFT_BOTTOM;else i0.player.util.place=o0.PLACE.LEFT,i0.green.util.hidden=!0;S0(T.toDataURL())}}return f7(H8,{width:"480px",height:"480px",onSetup:(i0)=>{F(i0),w0.view.zoom=0.5,new w0.Raster({name:"background",source:$8,position:w0.view.center}),new o0("player",o0.STYLE.PLAYER,o0.PLACE.LEFT),new o0("red",o0.STYLE.ENEMY_A,o0.PLACE.RIGHT),new o0("yellow",o0.STYLE.ENEMY_B,o0.PLACE.RIGHT_BOTTOM),new o0("green",o0.STYLE.ENEMY_C,o0.PLACE.LEFT_BOTTOM)}})}import{jsx as f7} from"preact/jsx-runtime";import{useLocale as v7} from"@blockcode/core";import{classNames as b4} from"@blockcode/ui";function x6(v){const p=globalThis.document,r=p.createElement("style");r.appendChild(p.createTextNode(v)),p.head.append(r)}x6(".v2Obxa_toolbar-wrapper{height:var(--tool-bar-height);padding:var(--space)0;flex-shrink:0;justify-content:space-between;align-items:center;display:flex}.v2Obxa_green-flag,.v2Obxa_stop-all{user-select:none;cursor:pointer;border:0;border-radius:.25rem;width:2rem;height:2rem;padding:.375rem}.v2Obxa_green-flag:hover,.v2Obxa_stop-all:hover{background:var(--motion-light-transparent)}.v2Obxa_green-flag.v2Obxa_actived{background:var(--motion-transparent)}.v2Obxa_stop-all{opacity:.5}.v2Obxa_stop-all.v2Obxa_actived{opacity:1}.v2Obxa_green-flag.v2Obxa_disabled,.v2Obxa_stop-all.v2Obxa_disabled{opacity:.5}.v2Obxa_toolbar-button{width:calc(2rem + 2px);height:calc(2rem + 2px);padding:.375rem!important}.v2Obxa_space{margin-left:.2rem}.v2Obxa_toolbar-buttons-group{display:flex}.v2Obxa_group-button-first{border-top-right-radius:0;border-bottom-right-radius:0}.v2Obxa_group-button{border-left:none;border-radius:0}.v2Obxa_group-button-last{border-left:none;border-top-left-radius:0;border-bottom-left-radius:0}");var N6={greenFlag:"v2Obxa_green-flag",toolbarButtonsGroup:"v2Obxa_toolbar-buttons-group",groupButton:"v2Obxa_group-button",actived:"v2Obxa_actived",groupButtonLast:"v2Obxa_group-button-last",disabled:"v2Obxa_disabled",stopAll:"v2Obxa_stop-all",toolbarWrapper:"v2Obxa_toolbar-wrapper",toolbarButton:"v2Obxa_toolbar-button",space:"v2Obxa_space",groupButtonFirst:"v2Obxa_group-button-first"};var C4="./assets/icon-green-flag-8eb2c7e7b0a15fba.svg";var r4="./assets/icon-stop-all-21d83d10e3dd785f.svg";import{jsx as Y6} from"preact/jsx-runtime";function y8({playing:v,onPlay:p,onStop:r}){const{getText:V}=v7();return Y6("div",{className:N6.toolbarWrapper,children:Y6("div",{className:N6.toolbarButtonsGroup,children:[Y6("img",{className:b4(N6.greenFlag,{[N6.actived]:v}),src:C4,title:V("tankwar.player.greenFlag","Go"),onClick:p}),Y6("img",{className:b4(N6.stopAll,{[N6.actived]:v}),src:r4,title:V("tankwar.player.stopAll","Stop"),onClick:r})]})})}x6(".XAeOQq_stage-wrapper{position:relative}.XAeOQq_stage{border:1px solid var(--ui-black-transparent);border-radius:var(--space);background:var(--ui-white);width:482px;height:482px;position:relative;overflow:hidden}");var d8={stage:"XAeOQq_stage",stageWrapper:"XAeOQq_stage-wrapper"};import{jsx as Z6} from"preact/jsx-runtime";function P8({playing:v,enemies:p,enemiesAI:r,onChangePlaying:V,onChangeHealth:G}){const T=()=>V(!0),F=()=>V(!1);return Z6("div",{className:d8.stageWrapper,children:[Z6(y8,{playing:v,onPlay:T,onStop:F}),Z6("div",{className:m7(d8.stage),children:Z6(j4,{playing:v,enemies:p,enemiesAI:r,onRequestStop:F,onChangeHealth:G})})]})}import{useLocale as p7,useEditor as s7} from"@blockcode/core";import{classNames as p6,Text as G6,Button as j6,Label as S6,BufferedInput as y7,ComingSoon as d7} from"@blockcode/ui";x6('.lIvsca_stage-info-wrapper{margin-top:var(--space);background:var(--ui-white);color:var(--text-primary);border-radius:var(--space);border:1px solid var(--ui-black-transparent);padding:1rem}.lIvsca_row{justify-content:space-between;margin-top:.5rem;display:flex}.lIvsca_row-primary{margin-top:0}.lIvsca_group{flex-direction:row;align-items:center;display:inline-flex}.lIvsca_full-input{flex:1}.lIvsca_name-input{width:8rem}.lIvsca_button{min-width:calc(2rem + 2px);height:calc(2rem + 2px);padding:.375rem!important}.lIvsca_button-icon{margin:auto}.lIvsca_space{margin-left:.2rem}.lIvsca_toolbar-button-group{display:flex}.lIvsca_group-button-first{border-top-right-radius:0;border-bottom-right-radius:0}.lIvsca_group-button{border-left:none;border-radius:0}.lIvsca_group-button-last{border-left:none;border-top-left-radius:0;border-bottom-left-radius:0}.lIvsca_button-text{flex:auto}.lIvsca_group-button-toggled-on .lIvsca_button-text{color:#4c97ff}.lIvsca_tank-image{width:1.65rem}.lIvsca_health-progress{background:#f5f5f5;border-radius:10px;width:12rem;height:20px}.lIvsca_health-progress:before{counter-reset:progress var(--percent,0);content:counter(progress)"%\u2002";width:calc(12rem*var(--percent,0)/100);color:var(--ui-white);text-align:right;white-space:nowrap;background:#ff6680;border-radius:10px;height:20px;font-size:12px;line-height:20px;display:block;overflow:hidden}');var x0={row:"lIvsca_row",fullInput:"lIvsca_full-input",groupButtonFirst:"lIvsca_group-button-first",groupButtonToggledOn:"lIvsca_group-button-toggled-on",groupButton:"lIvsca_group-button",space:"lIvsca_space",groupButtonLast:"lIvsca_group-button-last",stageInfoWrapper:"lIvsca_stage-info-wrapper",button:"lIvsca_button",group:"lIvsca_group",buttonIcon:"lIvsca_button-icon",healthProgress:"lIvsca_health-progress",rowPrimary:"lIvsca_row-primary",tankImage:"lIvsca_tank-image",buttonText:"lIvsca_button-text",toolbarButtonGroup:"lIvsca_toolbar-button-group",nameInput:"lIvsca_name-input"};var N4="./assets/tank-2-95f1944eace1f71a.png";var S4="./assets/tank-3-fc6d9534c6d7bba5.png";var I4="./assets/tank-4-79e2f163c902d864.png";import{jsx as y0} from"preact/jsx-runtime";var P7=[N4,S4,I4];function l8({playing:v,enemies:p,enemiesAI:r,health:V,onChangeEnemies:G,onChangeEnemyAI:T}){const{getText:F}=p7(),{fileList:_,modifyFile:$}=s7(),U=_[0],S0=(n0,d0)=>{$({[n0]:d0})};return y0("div",{className:x0.stageInfoWrapper,children:[y0("div",{className:p6(x0.row,x0.rowPrimary),children:[y0(S6,{text:F("tankwar.stageInfo.player","Player"),children:y0(y7,{disabled:v,className:x0.nameInput,placeholder:F("tankwar.stageInfo.nickname","Nickname"),onSubmit:(n0)=>S0("name",n0),value:U.name})}),y0(S6,{secondary:!0,className:x0.health,text:F("tankwar.stageInfo.health","Health"),children:y0("div",{className:x0.healthProgress,style:`--percent:${V.player||0}`})})]}),y0("div",{className:x0.row,children:[y0(S6,{secondary:!0,text:F("tankwar.stageInfo.enemies","Enemies"),children:[y0(j6,{disabled:v,className:p6(x0.button,x0.groupButtonFirst,{[x0.groupButtonToggledOn]:p===1}),onClick:()=>G(1),children:y0("div",{className:x0.buttonText,children:"1"})}),y0(j6,{disabled:v,className:p6(x0.button,x0.groupButton,{[x0.groupButtonToggledOn]:p===2}),onClick:()=>G(2),children:y0("div",{className:x0.buttonText,children:"2"})}),y0(j6,{disabled:v,className:p6(x0.button,x0.groupButtonLast,{[x0.groupButtonToggledOn]:p===3}),onClick:()=>G(3),children:y0("div",{className:x0.buttonText,children:"3"})})]}),y0(S6,{secondary:!0,children:[y0(j6,{disabled:v,className:p6(x0.button,x0.groupButtonFirst,{[x0.groupButtonToggledOn]:!0}),onClick:()=>G(1),children:y0("div",{className:x0.buttonText,children:y0(G6,{id:"tankwar.stageInfo.mode.local",defaultMessage:"Local AI"})})}),y0(d7,{placement:"bottom",children:y0(j6,{disabled:v,className:p6(x0.button,x0.groupButtonLast,{[x0.groupButtonToggledOn]:!1}),children:y0("div",{className:x0.buttonText,children:y0(G6,{id:"tankwar.stageInfo.mode.remote",defaultMessage:"Remote Players"})})})})]})]}),["red","yellow","green"].slice(0,p).map((n0,d0)=>y0("div",{className:x0.row,children:[y0(S6,{secondary:!0,children:y0("img",{className:x0.tankImage,src:P7[d0],alt:F(`tankwar.stageInfo.enemy.${n0}`,n0.replace(n0[0],n0[0].toUpperCase())),title:F(`tankwar.stageInfo.enemy.${n0}`,n0.replace(n0[0],n0[0].toUpperCase()))})}),y0(S6,{secondary:!0,children:y0("div",{className:x0.healthProgress,style:`--percent:${V[n0]||0}`})}),y0(S6,{secondary:!0,text:F("tankwar.stageInfo.ai","AI"),children:[y0(j6,{disabled:v,className:p6(x0.button,x0.groupButtonFirst,{[x0.groupButtonToggledOn]:r[n0]==="simple"}),onClick:()=>T(n0,"simple"),children:y0("div",{className:x0.buttonText,children:y0(G6,{id:"tankwar.stageInfo.ai.simple",defaultMessage:"Simple"})})}),y0(j6,{disabled:v,className:p6(x0.button,x0.groupButton,{[x0.groupButtonToggledOn]:r[n0]==="medium"}),onClick:()=>T(n0,"medium"),children:y0("div",{className:x0.buttonText,children:y0(G6,{id:"tankwar.stageInfo.ai.medium",defaultMessage:"Medium"})})}),y0(j6,{disabled:v,className:p6(x0.button,x0.groupButtonLast,{[x0.groupButtonToggledOn]:r[n0]==="senior"}),onClick:()=>T(n0,"senior"),children:y0("div",{className:x0.buttonText,children:y0(G6,{id:"tankwar.stageInfo.ai.senior",defaultMessage:"Senior"})})})]})]},d0))]})}x6(".aTXsAq_sidebar-wrapper{flex-direction:column;height:100%;display:flex}.aTXsAq_stage-wrapper{display:flex}.aTXsAq_selector-wrapper{margin-top:var(--space);flex-direction:row;height:100%;display:flex}");var j8={stageWrapper:"aTXsAq_stage-wrapper",selectorWrapper:"aTXsAq_selector-wrapper",sidebarWrapper:"aTXsAq_sidebar-wrapper"};import{jsx as C8} from"preact/jsx-runtime";function r8(){const[v,p]=W6(!1),[r,V]=W6(3),[G,T]=W6({red:"simple",yellow:"medium",green:"senior"}),[F,_]=W6({player:100,red:100,yellow:100,green:100});return C8("div",{className:j8.sidebarWrapper,children:[C8(P8,{className:j8.stageWrapper,playing:v,enemies:r,enemiesAI:G,onChangePlaying:p,onChangeHealth:_}),C8(l8,{playing:v,enemies:r,enemiesAI:G,health:F,onChangeEnemies:V,onChangeEnemyAI:($,U)=>T({...G,[$]:U})})]})}function b8(){return{fileList:[{id:"player",name:"player"}]}}var z4={"tankwar.player.greenFlag":"Go","tankwar.player.stopAll":"Stop","tankwar.stageInfo.player":"Player","tankwar.stageInfo.nickname":"Nickname","tankwar.stageInfo.enemies":"Enemies","tankwar.stageInfo.health":"Health","tankwar.stageInfo.enemy.red":"Red","tankwar.stageInfo.enemy.yellow":"Yellow","tankwar.stageInfo.enemy.green":"Green","tankwar.stageInfo.mode.local":"Local AI","tankwar.stageInfo.mode.remote":"Remote Players","tankwar.stageInfo.ai":"AI","tankwar.stageInfo.ai.simple":"Simple","tankwar.stageInfo.ai.medium":"Medium","tankwar.stageInfo.ai.senior":"Senior","tankwar.blocks.motion_attack":"fire in direction %1 at %2 steps","tankwar.blocks.motion_move":"forward in direction %1 at %2 % speed","tankwar.blocks.motion_setspeed":"set speed to %1 %","tankwar.blocks.motion_stop":"stop","tankwar.blocks.motion_speed":"speed","tankwar.blocks.sensing_scanwidth":"set scan width to %1","tankwar.blocks.sensing_scan":"scan for enemy in direction %1?","tankwar.blocks.sensing_distance":"measure distance of enemy in direction %1","tankwar.blocks.sensing_health":"health"};var o4={"tankwar.player.greenFlag":"\u8FD0\u884C","tankwar.player.stopAll":"\u505C\u6B62","tankwar.stageInfo.player":"\u73A9\u5BB6","tankwar.stageInfo.nickname":"\u6635\u79F0","tankwar.stageInfo.enemies":"\u654C\u65B9\u6570\u91CF","tankwar.stageInfo.health":"\u751F\u547D\u503C","tankwar.stageInfo.enemy.red":"\u7EA2","tankwar.stageInfo.enemy.yellow":"\u9EC4","tankwar.stageInfo.enemy.green":"\u7EFF","tankwar.stageInfo.mode.local":"\u672C\u673A AI","tankwar.stageInfo.mode.remote":"\u8054\u7F51\u73A9\u5BB6","tankwar.stageInfo.ai":"AI \u7B56\u7565","tankwar.stageInfo.ai.simple":"\u7B80\u5355","tankwar.stageInfo.ai.medium":"\u4E2D\u7B49","tankwar.stageInfo.ai.senior":"\u9AD8\u7EA7","tankwar.blocks.motion_attack":"\u671D\u5411 %1 \u65B9\u5411\u8DDD\u79BB %2 \u6B65\u53D1\u5C04\u70AE\u5F39","tankwar.blocks.motion_move":"\u4EE5 %2 % \u901F\u5EA6\u9762\u5411 %1 \u65B9\u5411\u524D\u8FDB","tankwar.blocks.motion_setspeed":"\u5C06\u901F\u5EA6\u8BBE\u4E3A %1 %","tankwar.blocks.motion_stop":"\u505C\u6B62\u524D\u8FDB","tankwar.blocks.motion_speed":"\u901F\u5EA6","tankwar.blocks.sensing_scanwidth":"\u5C06\u96F7\u8FBE\u626B\u63CF\u5BBD\u5EA6\u8BBE\u4E3A %1","tankwar.blocks.sensing_scan":"\u96F7\u8FBE\u626B\u63CF %1 \u65B9\u5411\u6709\u654C\u4EBA\uFF1F","tankwar.blocks.sensing_distance":"\u96F7\u8FBE\u6D4B\u91CF %1 \u65B9\u5411\u654C\u4EBA\u7684\u8DDD\u79BB","tankwar.blocks.sensing_health":"\u751F\u547D\u503C"};function l7({addLocaleData:v,getText:p,setLayout:r,openStoreLibrary:V,closeStoreLibrary:G,setPrompt:T,setAlert:F,removeAlert:_,openProject:$}){v(a8),v({en:z4,"zh-Hans":o4});const U=()=>{$(Object.assign(b8(p),{selectedIndex:0}))};U(),r({menus:V8({openStoreLibrary:V,closeStoreLibrary:G,newProject:U,setPrompt:T,setAlert:F,removeAlert:_,extendsMenu:[{id:"device",hidden:!0}]}),tabs:[{...q6,Content:p8}],sidebars:[{expand:"right",Content:r8}],pane:!1,tutorials:!0,canEditProjectName:!0})}export{l7 as default};
